var yf=Object.defineProperty;var Ef=(r,e,t)=>e in r?yf(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var G=(r,e,t)=>Ef(r,typeof e!="symbol"?e+"":e,t);import{r as ie,R as Du,j as ye,o as j,e as Cf}from"./index-CDzJiYq6.js";import{r as _f,R as Tf}from"./index-BD8OiV0R.js";import{e as Sf}from"./errorMsgPopup-BRg64j45.js";const Eo=(r,e)=>{const{name:t,value:i}=r.target;e(n=>({...n,[t]:i}))},JS=r=>Object.fromEntries(r.map(e=>[e.id,e.defaultValue!==void 0?e.defaultValue:e.type==="checkbox"?!1:""]));function ku(r){var e,t,i="";if(typeof r=="string"||typeof r=="number")i+=r;else if(typeof r=="object")if(Array.isArray(r)){var n=r.length;for(e=0;e<n;e++)r[e]&&(t=ku(r[e]))&&(i&&(i+=" "),i+=t)}else for(t in r)r[t]&&(i&&(i+=" "),i+=t);return i}function Rt(){for(var r,e,t=0,i="",n=arguments.length;t<n;t++)(r=arguments[t])&&(e=ku(r))&&(i&&(i+=" "),i+=e);return i}const Ru=6048e5,Df=864e5,_a=6e4,Ta=36e5,kf=1e3,Kl=Symbol.for("constructDateFrom");function Ke(r,e){return typeof r=="function"?r(e):r&&typeof r=="object"&&Kl in r?r[Kl](e):r instanceof Date?new r.constructor(e):new Date(e)}function ve(r,e){return Ke(e||r,r)}function wi(r,e,t){const i=ve(r,t==null?void 0:t.in);return isNaN(e)?Ke((t==null?void 0:t.in)||r,NaN):(e&&i.setDate(i.getDate()+e),i)}function yi(r,e,t){const i=ve(r,t==null?void 0:t.in);if(isNaN(e))return Ke(r,NaN);if(!e)return i;const n=i.getDate(),s=Ke(r,i.getTime());s.setMonth(i.getMonth()+e+1,0);const a=s.getDate();return n>=a?s:(i.setFullYear(s.getFullYear(),s.getMonth(),n),i)}function Fu(r,e,t){return Ke(r,+ve(r)+e)}function Rf(r,e,t){return Fu(r,e*Ta)}let Ff={};function Xr(){return Ff}function er(r,e){var o,l,h,u;const t=Xr(),i=(e==null?void 0:e.weekStartsOn)??((l=(o=e==null?void 0:e.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??t.weekStartsOn??((u=(h=t.locale)==null?void 0:h.options)==null?void 0:u.weekStartsOn)??0,n=ve(r,e==null?void 0:e.in),s=n.getDay(),a=(s<i?7:0)+s-i;return n.setDate(n.getDate()-a),n.setHours(0,0,0,0),n}function wn(r,e){return er(r,{...e,weekStartsOn:1})}function Mu(r,e){const t=ve(r,e==null?void 0:e.in),i=t.getFullYear(),n=Ke(t,0);n.setFullYear(i+1,0,4),n.setHours(0,0,0,0);const s=wn(n),a=Ke(t,0);a.setFullYear(i,0,4),a.setHours(0,0,0,0);const o=wn(a);return t.getTime()>=s.getTime()?i+1:t.getTime()>=o.getTime()?i:i-1}function js(r){const e=ve(r),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+r-+t}function rr(r,...e){const t=Ke.bind(null,e.find(i=>typeof i=="object"));return e.map(t)}function Hr(r,e){const t=ve(r,e==null?void 0:e.in);return t.setHours(0,0,0,0),t}function xn(r,e,t){const[i,n]=rr(t==null?void 0:t.in,r,e),s=Hr(i),a=Hr(n),o=+s-js(s),l=+a-js(a);return Math.round((o-l)/Df)}function Mf(r,e){const t=Mu(r,e),i=Ke(r,0);return i.setFullYear(t,0,4),i.setHours(0,0,0,0),wn(i)}function Co(r,e,t){const i=ve(r,t==null?void 0:t.in);return i.setTime(i.getTime()+e*_a),i}function ul(r,e,t){return yi(r,e*3,t)}function Af(r,e,t){return Fu(r,e*1e3)}function Xs(r,e,t){return wi(r,e*7,t)}function ji(r,e,t){return yi(r,e*12,t)}function Ql(r,e){let t,i=e==null?void 0:e.in;return r.forEach(n=>{!i&&typeof n=="object"&&(i=Ke.bind(null,n));const s=ve(n,i);(!t||t<s||isNaN(+s))&&(t=s)}),Ke(i,t||NaN)}function ql(r,e){let t,i=e==null?void 0:e.in;return r.forEach(n=>{!i&&typeof n=="object"&&(i=Ke.bind(null,n));const s=ve(n,i);(!t||t>s||isNaN(+s))&&(t=s)}),Ke(i,t||NaN)}function Of(r,e,t){const[i,n]=rr(t==null?void 0:t.in,r,e);return+Hr(i)==+Hr(n)}function Xi(r){return r instanceof Date||typeof r=="object"&&Object.prototype.toString.call(r)==="[object Date]"}function $s(r){return!(!Xi(r)&&typeof r!="number"||isNaN(+ve(r)))}function Ks(r,e,t){const[i,n]=rr(t==null?void 0:t.in,r,e),s=i.getFullYear()-n.getFullYear(),a=i.getMonth()-n.getMonth();return s*12+a}function Lr(r,e){const t=ve(r,e==null?void 0:e.in);return Math.trunc(t.getMonth()/3)+1}function Qs(r,e,t){const[i,n]=rr(t==null?void 0:t.in,r,e),s=i.getFullYear()-n.getFullYear(),a=Lr(i)-Lr(n);return s*4+a}function qs(r,e,t){const[i,n]=rr(t==null?void 0:t.in,r,e);return i.getFullYear()-n.getFullYear()}function Lf(r,e,t){const[i,n]=rr(t==null?void 0:t.in,r,e),s=Jl(i,n),a=Math.abs(xn(i,n));i.setDate(i.getDate()-s*a);const o=+(Jl(i,n)===-s),l=s*(a-o);return l===0?0:l}function Jl(r,e){const t=r.getFullYear()-e.getFullYear()||r.getMonth()-e.getMonth()||r.getDate()-e.getDate()||r.getHours()-e.getHours()||r.getMinutes()-e.getMinutes()||r.getSeconds()-e.getSeconds()||r.getMilliseconds()-e.getMilliseconds();return t<0?-1:t>0?1:t}function Au(r,e){const t=ve(r,e==null?void 0:e.in);return t.setHours(23,59,59,999),t}function Ou(r,e){const t=ve(r,e==null?void 0:e.in),i=t.getMonth();return t.setFullYear(t.getFullYear(),i+1,0),t.setHours(23,59,59,999),t}function _o(r,e){const t=ve(r,e==null?void 0:e.in),i=t.getMonth(),n=i-i%3;return t.setMonth(n,1),t.setHours(0,0,0,0),t}function Lu(r,e){const t=ve(r,e==null?void 0:e.in);return t.setDate(1),t.setHours(0,0,0,0),t}function Pu(r,e){const t=ve(r,e==null?void 0:e.in),i=t.getFullYear();return t.setFullYear(i+1,0,0),t.setHours(23,59,59,999),t}function Sa(r,e){const t=ve(r,e==null?void 0:e.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}function Pf(r,e){var o,l;const t=Xr(),i=t.weekStartsOn??((l=(o=t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??0,n=ve(r,e==null?void 0:e.in),s=n.getDay(),a=(s<i?-7:0)+6-(s-i);return n.setDate(n.getDate()+a),n.setHours(23,59,59,999),n}const Nf={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},If=(r,e,t)=>{let i;const n=Nf[r];return typeof n=="string"?i=n:e===1?i=n.one:i=n.other.replace("{{count}}",e.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+i:i+" ago":i};function hn(r){return(e={})=>{const t=e.width?String(e.width):r.defaultWidth;return r.formats[t]||r.formats[r.defaultWidth]}}const Bf={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Hf={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},zf={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Wf={date:hn({formats:Bf,defaultWidth:"full"}),time:hn({formats:Hf,defaultWidth:"full"}),dateTime:hn({formats:zf,defaultWidth:"full"})},Vf={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Uf=(r,e,t,i)=>Vf[r];function Ri(r){return(e,t)=>{const i=t!=null&&t.context?String(t.context):"standalone";let n;if(i==="formatting"&&r.formattingValues){const a=r.defaultFormattingWidth||r.defaultWidth,o=t!=null&&t.width?String(t.width):a;n=r.formattingValues[o]||r.formattingValues[a]}else{const a=r.defaultWidth,o=t!=null&&t.width?String(t.width):r.defaultWidth;n=r.values[o]||r.values[a]}const s=r.argumentCallback?r.argumentCallback(e):e;return n[s]}}const Gf={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Yf={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},jf={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Xf={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},$f={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Kf={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Qf=(r,e)=>{const t=Number(r),i=t%100;if(i>20||i<10)switch(i%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},qf={ordinalNumber:Qf,era:Ri({values:Gf,defaultWidth:"wide"}),quarter:Ri({values:Yf,defaultWidth:"wide",argumentCallback:r=>r-1}),month:Ri({values:jf,defaultWidth:"wide"}),day:Ri({values:Xf,defaultWidth:"wide"}),dayPeriod:Ri({values:$f,defaultWidth:"wide",formattingValues:Kf,defaultFormattingWidth:"wide"})};function Fi(r){return(e,t={})=>{const i=t.width,n=i&&r.matchPatterns[i]||r.matchPatterns[r.defaultMatchWidth],s=e.match(n);if(!s)return null;const a=s[0],o=i&&r.parsePatterns[i]||r.parsePatterns[r.defaultParseWidth],l=Array.isArray(o)?Zf(o,d=>d.test(a)):Jf(o,d=>d.test(a));let h;h=r.valueCallback?r.valueCallback(l):l,h=t.valueCallback?t.valueCallback(h):h;const u=e.slice(a.length);return{value:h,rest:u}}}function Jf(r,e){for(const t in r)if(Object.prototype.hasOwnProperty.call(r,t)&&e(r[t]))return t}function Zf(r,e){for(let t=0;t<r.length;t++)if(e(r[t]))return t}function Nu(r){return(e,t={})=>{const i=e.match(r.matchPattern);if(!i)return null;const n=i[0],s=e.match(r.parsePattern);if(!s)return null;let a=r.valueCallback?r.valueCallback(s[0]):s[0];a=t.valueCallback?t.valueCallback(a):a;const o=e.slice(n.length);return{value:a,rest:o}}}const ep=/^(\d+)(th|st|nd|rd)?/i,tp=/\d+/i,ip={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},rp={any:[/^b/i,/^(a|c)/i]},np={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},sp={any:[/1/i,/2/i,/3/i,/4/i]},ap={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},op={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},lp={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},hp={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},up={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},cp={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},dp={ordinalNumber:Nu({matchPattern:ep,parsePattern:tp,valueCallback:r=>parseInt(r,10)}),era:Fi({matchPatterns:ip,defaultMatchWidth:"wide",parsePatterns:rp,defaultParseWidth:"any"}),quarter:Fi({matchPatterns:np,defaultMatchWidth:"wide",parsePatterns:sp,defaultParseWidth:"any",valueCallback:r=>r+1}),month:Fi({matchPatterns:ap,defaultMatchWidth:"wide",parsePatterns:op,defaultParseWidth:"any"}),day:Fi({matchPatterns:lp,defaultMatchWidth:"wide",parsePatterns:hp,defaultParseWidth:"any"}),dayPeriod:Fi({matchPatterns:up,defaultMatchWidth:"any",parsePatterns:cp,defaultParseWidth:"any"})},Iu={code:"en-US",formatDistance:If,formatLong:Wf,formatRelative:Uf,localize:qf,match:dp,options:{weekStartsOn:0,firstWeekContainsDate:1}};function fp(r,e){const t=ve(r,e==null?void 0:e.in);return xn(t,Sa(t))+1}function cl(r,e){const t=ve(r,e==null?void 0:e.in),i=+wn(t)-+Mf(t);return Math.round(i/Ru)+1}function dl(r,e){var u,d,c,f;const t=ve(r,e==null?void 0:e.in),i=t.getFullYear(),n=Xr(),s=(e==null?void 0:e.firstWeekContainsDate)??((d=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??n.firstWeekContainsDate??((f=(c=n.locale)==null?void 0:c.options)==null?void 0:f.firstWeekContainsDate)??1,a=Ke((e==null?void 0:e.in)||r,0);a.setFullYear(i+1,0,s),a.setHours(0,0,0,0);const o=er(a,e),l=Ke((e==null?void 0:e.in)||r,0);l.setFullYear(i,0,s),l.setHours(0,0,0,0);const h=er(l,e);return+t>=+o?i+1:+t>=+h?i:i-1}function pp(r,e){var o,l,h,u;const t=Xr(),i=(e==null?void 0:e.firstWeekContainsDate)??((l=(o=e==null?void 0:e.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??t.firstWeekContainsDate??((u=(h=t.locale)==null?void 0:h.options)==null?void 0:u.firstWeekContainsDate)??1,n=dl(r,e),s=Ke((e==null?void 0:e.in)||r,0);return s.setFullYear(n,0,i),s.setHours(0,0,0,0),er(s,e)}function Bu(r,e){const t=ve(r,e==null?void 0:e.in),i=+er(t,e)-+pp(t,e);return Math.round(i/Ru)+1}function je(r,e){const t=r<0?"-":"",i=Math.abs(r).toString().padStart(e,"0");return t+i}const sr={y(r,e){const t=r.getFullYear(),i=t>0?t:1-t;return je(e==="yy"?i%100:i,e.length)},M(r,e){const t=r.getMonth();return e==="M"?String(t+1):je(t+1,2)},d(r,e){return je(r.getDate(),e.length)},a(r,e){const t=r.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(r,e){return je(r.getHours()%12||12,e.length)},H(r,e){return je(r.getHours(),e.length)},m(r,e){return je(r.getMinutes(),e.length)},s(r,e){return je(r.getSeconds(),e.length)},S(r,e){const t=e.length,i=r.getMilliseconds(),n=Math.trunc(i*Math.pow(10,t-3));return je(n,e.length)}},Jr={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Zl={G:function(r,e,t){const i=r.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(i,{width:"abbreviated"});case"GGGGG":return t.era(i,{width:"narrow"});case"GGGG":default:return t.era(i,{width:"wide"})}},y:function(r,e,t){if(e==="yo"){const i=r.getFullYear(),n=i>0?i:1-i;return t.ordinalNumber(n,{unit:"year"})}return sr.y(r,e)},Y:function(r,e,t,i){const n=dl(r,i),s=n>0?n:1-n;if(e==="YY"){const a=s%100;return je(a,2)}return e==="Yo"?t.ordinalNumber(s,{unit:"year"}):je(s,e.length)},R:function(r,e){const t=Mu(r);return je(t,e.length)},u:function(r,e){const t=r.getFullYear();return je(t,e.length)},Q:function(r,e,t){const i=Math.ceil((r.getMonth()+1)/3);switch(e){case"Q":return String(i);case"QQ":return je(i,2);case"Qo":return t.ordinalNumber(i,{unit:"quarter"});case"QQQ":return t.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(i,{width:"wide",context:"formatting"})}},q:function(r,e,t){const i=Math.ceil((r.getMonth()+1)/3);switch(e){case"q":return String(i);case"qq":return je(i,2);case"qo":return t.ordinalNumber(i,{unit:"quarter"});case"qqq":return t.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(i,{width:"wide",context:"standalone"})}},M:function(r,e,t){const i=r.getMonth();switch(e){case"M":case"MM":return sr.M(r,e);case"Mo":return t.ordinalNumber(i+1,{unit:"month"});case"MMM":return t.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(i,{width:"wide",context:"formatting"})}},L:function(r,e,t){const i=r.getMonth();switch(e){case"L":return String(i+1);case"LL":return je(i+1,2);case"Lo":return t.ordinalNumber(i+1,{unit:"month"});case"LLL":return t.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(i,{width:"wide",context:"standalone"})}},w:function(r,e,t,i){const n=Bu(r,i);return e==="wo"?t.ordinalNumber(n,{unit:"week"}):je(n,e.length)},I:function(r,e,t){const i=cl(r);return e==="Io"?t.ordinalNumber(i,{unit:"week"}):je(i,e.length)},d:function(r,e,t){return e==="do"?t.ordinalNumber(r.getDate(),{unit:"date"}):sr.d(r,e)},D:function(r,e,t){const i=fp(r);return e==="Do"?t.ordinalNumber(i,{unit:"dayOfYear"}):je(i,e.length)},E:function(r,e,t){const i=r.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(i,{width:"short",context:"formatting"});case"EEEE":default:return t.day(i,{width:"wide",context:"formatting"})}},e:function(r,e,t,i){const n=r.getDay(),s=(n-i.weekStartsOn+8)%7||7;switch(e){case"e":return String(s);case"ee":return je(s,2);case"eo":return t.ordinalNumber(s,{unit:"day"});case"eee":return t.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(n,{width:"short",context:"formatting"});case"eeee":default:return t.day(n,{width:"wide",context:"formatting"})}},c:function(r,e,t,i){const n=r.getDay(),s=(n-i.weekStartsOn+8)%7||7;switch(e){case"c":return String(s);case"cc":return je(s,e.length);case"co":return t.ordinalNumber(s,{unit:"day"});case"ccc":return t.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(n,{width:"narrow",context:"standalone"});case"cccccc":return t.day(n,{width:"short",context:"standalone"});case"cccc":default:return t.day(n,{width:"wide",context:"standalone"})}},i:function(r,e,t){const i=r.getDay(),n=i===0?7:i;switch(e){case"i":return String(n);case"ii":return je(n,e.length);case"io":return t.ordinalNumber(n,{unit:"day"});case"iii":return t.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(i,{width:"short",context:"formatting"});case"iiii":default:return t.day(i,{width:"wide",context:"formatting"})}},a:function(r,e,t){const n=r.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(r,e,t){const i=r.getHours();let n;switch(i===12?n=Jr.noon:i===0?n=Jr.midnight:n=i/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(r,e,t){const i=r.getHours();let n;switch(i>=17?n=Jr.evening:i>=12?n=Jr.afternoon:i>=4?n=Jr.morning:n=Jr.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(r,e,t){if(e==="ho"){let i=r.getHours()%12;return i===0&&(i=12),t.ordinalNumber(i,{unit:"hour"})}return sr.h(r,e)},H:function(r,e,t){return e==="Ho"?t.ordinalNumber(r.getHours(),{unit:"hour"}):sr.H(r,e)},K:function(r,e,t){const i=r.getHours()%12;return e==="Ko"?t.ordinalNumber(i,{unit:"hour"}):je(i,e.length)},k:function(r,e,t){let i=r.getHours();return i===0&&(i=24),e==="ko"?t.ordinalNumber(i,{unit:"hour"}):je(i,e.length)},m:function(r,e,t){return e==="mo"?t.ordinalNumber(r.getMinutes(),{unit:"minute"}):sr.m(r,e)},s:function(r,e,t){return e==="so"?t.ordinalNumber(r.getSeconds(),{unit:"second"}):sr.s(r,e)},S:function(r,e){return sr.S(r,e)},X:function(r,e,t){const i=r.getTimezoneOffset();if(i===0)return"Z";switch(e){case"X":return th(i);case"XXXX":case"XX":return Dr(i);case"XXXXX":case"XXX":default:return Dr(i,":")}},x:function(r,e,t){const i=r.getTimezoneOffset();switch(e){case"x":return th(i);case"xxxx":case"xx":return Dr(i);case"xxxxx":case"xxx":default:return Dr(i,":")}},O:function(r,e,t){const i=r.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+eh(i,":");case"OOOO":default:return"GMT"+Dr(i,":")}},z:function(r,e,t){const i=r.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+eh(i,":");case"zzzz":default:return"GMT"+Dr(i,":")}},t:function(r,e,t){const i=Math.trunc(+r/1e3);return je(i,e.length)},T:function(r,e,t){return je(+r,e.length)}};function eh(r,e=""){const t=r>0?"-":"+",i=Math.abs(r),n=Math.trunc(i/60),s=i%60;return s===0?t+String(n):t+String(n)+e+je(s,2)}function th(r,e){return r%60===0?(r>0?"-":"+")+je(Math.abs(r)/60,2):Dr(r,e)}function Dr(r,e=""){const t=r>0?"-":"+",i=Math.abs(r),n=je(Math.trunc(i/60),2),s=je(i%60,2);return t+n+e+s}const ih=(r,e)=>{switch(r){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},Hu=(r,e)=>{switch(r){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},mp=(r,e)=>{const t=r.match(/(P+)(p+)?/)||[],i=t[1],n=t[2];if(!n)return ih(r,e);let s;switch(i){case"P":s=e.dateTime({width:"short"});break;case"PP":s=e.dateTime({width:"medium"});break;case"PPP":s=e.dateTime({width:"long"});break;case"PPPP":default:s=e.dateTime({width:"full"});break}return s.replace("{{date}}",ih(i,e)).replace("{{time}}",Hu(n,e))},To={p:Hu,P:mp},gp=/^D+$/,vp=/^Y+$/,bp=["D","DD","YY","YYYY"];function wp(r){return gp.test(r)}function xp(r){return vp.test(r)}function yp(r,e,t){const i=Ep(r,e,t);if(console.warn(i),bp.includes(r))throw new RangeError(i)}function Ep(r,e,t){const i=r[0]==="Y"?"years":"days of the month";return`Use \`${r.toLowerCase()}\` instead of \`${r}\` (in \`${e}\`) for formatting ${i} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Cp=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,_p=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Tp=/^'([^]*?)'?$/,Sp=/''/g,Dp=/[a-zA-Z]/;function rh(r,e,t){var u,d,c,f,p,v,m,g;const i=Xr(),n=(t==null?void 0:t.locale)??i.locale??Iu,s=(t==null?void 0:t.firstWeekContainsDate)??((d=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??i.firstWeekContainsDate??((f=(c=i.locale)==null?void 0:c.options)==null?void 0:f.firstWeekContainsDate)??1,a=(t==null?void 0:t.weekStartsOn)??((v=(p=t==null?void 0:t.locale)==null?void 0:p.options)==null?void 0:v.weekStartsOn)??i.weekStartsOn??((g=(m=i.locale)==null?void 0:m.options)==null?void 0:g.weekStartsOn)??0,o=ve(r,t==null?void 0:t.in);if(!$s(o))throw new RangeError("Invalid time value");let l=e.match(_p).map(x=>{const b=x[0];if(b==="p"||b==="P"){const F=To[b];return F(x,n.formatLong)}return x}).join("").match(Cp).map(x=>{if(x==="''")return{isToken:!1,value:"'"};const b=x[0];if(b==="'")return{isToken:!1,value:kp(x)};if(Zl[b])return{isToken:!0,value:x};if(b.match(Dp))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");return{isToken:!1,value:x}});n.localize.preprocessor&&(l=n.localize.preprocessor(o,l));const h={firstWeekContainsDate:s,weekStartsOn:a,locale:n};return l.map(x=>{if(!x.isToken)return x.value;const b=x.value;(!(t!=null&&t.useAdditionalWeekYearTokens)&&xp(b)||!(t!=null&&t.useAdditionalDayOfYearTokens)&&wp(b))&&yp(b,e,String(r));const F=Zl[b[0]];return F(o,b,n.localize,h)}).join("")}function kp(r){const e=r.match(Tp);return e?e[1].replace(Sp,"'"):r}function nh(r,e){return ve(r,e==null?void 0:e.in).getDate()}function Rp(r,e){return ve(r,e==null?void 0:e.in).getDay()}function Fp(r,e){const t=ve(r,e==null?void 0:e.in),i=t.getFullYear(),n=t.getMonth(),s=Ke(t,0);return s.setFullYear(i,n+1,0),s.setHours(0,0,0,0),s.getDate()}function Mp(){return Object.assign({},Xr())}function $i(r,e){return ve(r,e==null?void 0:e.in).getHours()}function Ap(r,e){const t=ve(r,e==null?void 0:e.in).getDay();return t===0?7:t}function Ki(r,e){return ve(r,e==null?void 0:e.in).getMinutes()}function Bt(r,e){return ve(r,e==null?void 0:e.in).getMonth()}function mr(r){return ve(r).getSeconds()}function So(r){return+ve(r)}function Re(r,e){return ve(r,e==null?void 0:e.in).getFullYear()}function vr(r,e){return+ve(r)>+ve(e)}function zr(r,e){return+ve(r)<+ve(e)}function Op(r,e){return+ve(r)==+ve(e)}function Lp(r,e){const t=Pp(e)?new e(0):Ke(e,0);return t.setFullYear(r.getFullYear(),r.getMonth(),r.getDate()),t.setHours(r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()),t}function Pp(r){var e;return typeof r=="function"&&((e=r.prototype)==null?void 0:e.constructor)===r}const Np=10;class zu{constructor(){G(this,"subPriority",0)}validate(e,t){return!0}}class Ip extends zu{constructor(e,t,i,n,s){super(),this.value=e,this.validateValue=t,this.setValue=i,this.priority=n,s&&(this.subPriority=s)}validate(e,t){return this.validateValue(e,this.value,t)}set(e,t,i){return this.setValue(e,t,this.value,i)}}class Bp extends zu{constructor(t,i){super();G(this,"priority",Np);G(this,"subPriority",-1);this.context=t||(n=>Ke(i,n))}set(t,i){return i.timestampIsSet?t:Ke(t,Lp(t,this.context))}}class Ue{run(e,t,i,n){const s=this.parse(e,t,i,n);return s?{setter:new Ip(s.value,this.validate,this.set,this.priority,this.subPriority),rest:s.rest}:null}validate(e,t,i){return!0}}class Hp extends Ue{constructor(){super(...arguments);G(this,"priority",140);G(this,"incompatibleTokens",["R","u","t","T"])}parse(t,i,n){switch(i){case"G":case"GG":case"GGG":return n.era(t,{width:"abbreviated"})||n.era(t,{width:"narrow"});case"GGGGG":return n.era(t,{width:"narrow"});case"GGGG":default:return n.era(t,{width:"wide"})||n.era(t,{width:"abbreviated"})||n.era(t,{width:"narrow"})}}set(t,i,n){return i.era=n,t.setFullYear(n,0,1),t.setHours(0,0,0,0),t}}const mt={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},Mi={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function gt(r,e){return r&&{value:e(r.value),rest:r.rest}}function ut(r,e){const t=e.match(r);return t?{value:parseInt(t[0],10),rest:e.slice(t[0].length)}:null}function Ai(r,e){const t=e.match(r);if(!t)return null;if(t[0]==="Z")return{value:0,rest:e.slice(1)};const i=t[1]==="+"?1:-1,n=t[2]?parseInt(t[2],10):0,s=t[3]?parseInt(t[3],10):0,a=t[5]?parseInt(t[5],10):0;return{value:i*(n*Ta+s*_a+a*kf),rest:e.slice(t[0].length)}}function Wu(r){return ut(mt.anyDigitsSigned,r)}function ft(r,e){switch(r){case 1:return ut(mt.singleDigit,e);case 2:return ut(mt.twoDigits,e);case 3:return ut(mt.threeDigits,e);case 4:return ut(mt.fourDigits,e);default:return ut(new RegExp("^\\d{1,"+r+"}"),e)}}function Js(r,e){switch(r){case 1:return ut(mt.singleDigitSigned,e);case 2:return ut(mt.twoDigitsSigned,e);case 3:return ut(mt.threeDigitsSigned,e);case 4:return ut(mt.fourDigitsSigned,e);default:return ut(new RegExp("^-?\\d{1,"+r+"}"),e)}}function fl(r){switch(r){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function Vu(r,e){const t=e>0,i=t?e:1-e;let n;if(i<=50)n=r||100;else{const s=i+50,a=Math.trunc(s/100)*100,o=r>=s%100;n=r+a-(o?100:0)}return t?n:1-n}function Uu(r){return r%400===0||r%4===0&&r%100!==0}class zp extends Ue{constructor(){super(...arguments);G(this,"priority",130);G(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(t,i,n){const s=a=>({year:a,isTwoDigitYear:i==="yy"});switch(i){case"y":return gt(ft(4,t),s);case"yo":return gt(n.ordinalNumber(t,{unit:"year"}),s);default:return gt(ft(i.length,t),s)}}validate(t,i){return i.isTwoDigitYear||i.year>0}set(t,i,n){const s=t.getFullYear();if(n.isTwoDigitYear){const o=Vu(n.year,s);return t.setFullYear(o,0,1),t.setHours(0,0,0,0),t}const a=!("era"in i)||i.era===1?n.year:1-n.year;return t.setFullYear(a,0,1),t.setHours(0,0,0,0),t}}class Wp extends Ue{constructor(){super(...arguments);G(this,"priority",130);G(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(t,i,n){const s=a=>({year:a,isTwoDigitYear:i==="YY"});switch(i){case"Y":return gt(ft(4,t),s);case"Yo":return gt(n.ordinalNumber(t,{unit:"year"}),s);default:return gt(ft(i.length,t),s)}}validate(t,i){return i.isTwoDigitYear||i.year>0}set(t,i,n,s){const a=dl(t,s);if(n.isTwoDigitYear){const l=Vu(n.year,a);return t.setFullYear(l,0,s.firstWeekContainsDate),t.setHours(0,0,0,0),er(t,s)}const o=!("era"in i)||i.era===1?n.year:1-n.year;return t.setFullYear(o,0,s.firstWeekContainsDate),t.setHours(0,0,0,0),er(t,s)}}class Vp extends Ue{constructor(){super(...arguments);G(this,"priority",130);G(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(t,i){return Js(i==="R"?4:i.length,t)}set(t,i,n){const s=Ke(t,0);return s.setFullYear(n,0,4),s.setHours(0,0,0,0),wn(s)}}class Up extends Ue{constructor(){super(...arguments);G(this,"priority",130);G(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(t,i){return Js(i==="u"?4:i.length,t)}set(t,i,n){return t.setFullYear(n,0,1),t.setHours(0,0,0,0),t}}class Gp extends Ue{constructor(){super(...arguments);G(this,"priority",120);G(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(t,i,n){switch(i){case"Q":case"QQ":return ft(i.length,t);case"Qo":return n.ordinalNumber(t,{unit:"quarter"});case"QQQ":return n.quarter(t,{width:"abbreviated",context:"formatting"})||n.quarter(t,{width:"narrow",context:"formatting"});case"QQQQQ":return n.quarter(t,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(t,{width:"wide",context:"formatting"})||n.quarter(t,{width:"abbreviated",context:"formatting"})||n.quarter(t,{width:"narrow",context:"formatting"})}}validate(t,i){return i>=1&&i<=4}set(t,i,n){return t.setMonth((n-1)*3,1),t.setHours(0,0,0,0),t}}class Yp extends Ue{constructor(){super(...arguments);G(this,"priority",120);G(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(t,i,n){switch(i){case"q":case"qq":return ft(i.length,t);case"qo":return n.ordinalNumber(t,{unit:"quarter"});case"qqq":return n.quarter(t,{width:"abbreviated",context:"standalone"})||n.quarter(t,{width:"narrow",context:"standalone"});case"qqqqq":return n.quarter(t,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(t,{width:"wide",context:"standalone"})||n.quarter(t,{width:"abbreviated",context:"standalone"})||n.quarter(t,{width:"narrow",context:"standalone"})}}validate(t,i){return i>=1&&i<=4}set(t,i,n){return t.setMonth((n-1)*3,1),t.setHours(0,0,0,0),t}}class jp extends Ue{constructor(){super(...arguments);G(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);G(this,"priority",110)}parse(t,i,n){const s=a=>a-1;switch(i){case"M":return gt(ut(mt.month,t),s);case"MM":return gt(ft(2,t),s);case"Mo":return gt(n.ordinalNumber(t,{unit:"month"}),s);case"MMM":return n.month(t,{width:"abbreviated",context:"formatting"})||n.month(t,{width:"narrow",context:"formatting"});case"MMMMM":return n.month(t,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(t,{width:"wide",context:"formatting"})||n.month(t,{width:"abbreviated",context:"formatting"})||n.month(t,{width:"narrow",context:"formatting"})}}validate(t,i){return i>=0&&i<=11}set(t,i,n){return t.setMonth(n,1),t.setHours(0,0,0,0),t}}class Xp extends Ue{constructor(){super(...arguments);G(this,"priority",110);G(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(t,i,n){const s=a=>a-1;switch(i){case"L":return gt(ut(mt.month,t),s);case"LL":return gt(ft(2,t),s);case"Lo":return gt(n.ordinalNumber(t,{unit:"month"}),s);case"LLL":return n.month(t,{width:"abbreviated",context:"standalone"})||n.month(t,{width:"narrow",context:"standalone"});case"LLLLL":return n.month(t,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(t,{width:"wide",context:"standalone"})||n.month(t,{width:"abbreviated",context:"standalone"})||n.month(t,{width:"narrow",context:"standalone"})}}validate(t,i){return i>=0&&i<=11}set(t,i,n){return t.setMonth(n,1),t.setHours(0,0,0,0),t}}function $p(r,e,t){const i=ve(r,t==null?void 0:t.in),n=Bu(i,t)-e;return i.setDate(i.getDate()-n*7),ve(i,t==null?void 0:t.in)}class Kp extends Ue{constructor(){super(...arguments);G(this,"priority",100);G(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(t,i,n){switch(i){case"w":return ut(mt.week,t);case"wo":return n.ordinalNumber(t,{unit:"week"});default:return ft(i.length,t)}}validate(t,i){return i>=1&&i<=53}set(t,i,n,s){return er($p(t,n,s),s)}}function Qp(r,e,t){const i=ve(r,t==null?void 0:t.in),n=cl(i,t)-e;return i.setDate(i.getDate()-n*7),i}class qp extends Ue{constructor(){super(...arguments);G(this,"priority",100);G(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(t,i,n){switch(i){case"I":return ut(mt.week,t);case"Io":return n.ordinalNumber(t,{unit:"week"});default:return ft(i.length,t)}}validate(t,i){return i>=1&&i<=53}set(t,i,n){return wn(Qp(t,n))}}const Jp=[31,28,31,30,31,30,31,31,30,31,30,31],Zp=[31,29,31,30,31,30,31,31,30,31,30,31];class e0 extends Ue{constructor(){super(...arguments);G(this,"priority",90);G(this,"subPriority",1);G(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(t,i,n){switch(i){case"d":return ut(mt.date,t);case"do":return n.ordinalNumber(t,{unit:"date"});default:return ft(i.length,t)}}validate(t,i){const n=t.getFullYear(),s=Uu(n),a=t.getMonth();return s?i>=1&&i<=Zp[a]:i>=1&&i<=Jp[a]}set(t,i,n){return t.setDate(n),t.setHours(0,0,0,0),t}}class t0 extends Ue{constructor(){super(...arguments);G(this,"priority",90);G(this,"subpriority",1);G(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(t,i,n){switch(i){case"D":case"DD":return ut(mt.dayOfYear,t);case"Do":return n.ordinalNumber(t,{unit:"date"});default:return ft(i.length,t)}}validate(t,i){const n=t.getFullYear();return Uu(n)?i>=1&&i<=366:i>=1&&i<=365}set(t,i,n){return t.setMonth(0,n),t.setHours(0,0,0,0),t}}function pl(r,e,t){var d,c,f,p;const i=Xr(),n=(t==null?void 0:t.weekStartsOn)??((c=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:c.weekStartsOn)??i.weekStartsOn??((p=(f=i.locale)==null?void 0:f.options)==null?void 0:p.weekStartsOn)??0,s=ve(r,t==null?void 0:t.in),a=s.getDay(),l=(e%7+7)%7,h=7-n,u=e<0||e>6?e-(a+h)%7:(l+h)%7-(a+h)%7;return wi(s,u,t)}class i0 extends Ue{constructor(){super(...arguments);G(this,"priority",90);G(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(t,i,n){switch(i){case"E":case"EE":case"EEE":return n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});case"EEEEE":return n.day(t,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});case"EEEE":default:return n.day(t,{width:"wide",context:"formatting"})||n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"})}}validate(t,i){return i>=0&&i<=6}set(t,i,n,s){return t=pl(t,n,s),t.setHours(0,0,0,0),t}}class r0 extends Ue{constructor(){super(...arguments);G(this,"priority",90);G(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(t,i,n,s){const a=o=>{const l=Math.floor((o-1)/7)*7;return(o+s.weekStartsOn+6)%7+l};switch(i){case"e":case"ee":return gt(ft(i.length,t),a);case"eo":return gt(n.ordinalNumber(t,{unit:"day"}),a);case"eee":return n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});case"eeeee":return n.day(t,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});case"eeee":default:return n.day(t,{width:"wide",context:"formatting"})||n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"})}}validate(t,i){return i>=0&&i<=6}set(t,i,n,s){return t=pl(t,n,s),t.setHours(0,0,0,0),t}}class n0 extends Ue{constructor(){super(...arguments);G(this,"priority",90);G(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(t,i,n,s){const a=o=>{const l=Math.floor((o-1)/7)*7;return(o+s.weekStartsOn+6)%7+l};switch(i){case"c":case"cc":return gt(ft(i.length,t),a);case"co":return gt(n.ordinalNumber(t,{unit:"day"}),a);case"ccc":return n.day(t,{width:"abbreviated",context:"standalone"})||n.day(t,{width:"short",context:"standalone"})||n.day(t,{width:"narrow",context:"standalone"});case"ccccc":return n.day(t,{width:"narrow",context:"standalone"});case"cccccc":return n.day(t,{width:"short",context:"standalone"})||n.day(t,{width:"narrow",context:"standalone"});case"cccc":default:return n.day(t,{width:"wide",context:"standalone"})||n.day(t,{width:"abbreviated",context:"standalone"})||n.day(t,{width:"short",context:"standalone"})||n.day(t,{width:"narrow",context:"standalone"})}}validate(t,i){return i>=0&&i<=6}set(t,i,n,s){return t=pl(t,n,s),t.setHours(0,0,0,0),t}}function s0(r,e,t){const i=ve(r,t==null?void 0:t.in),n=Ap(i,t),s=e-n;return wi(i,s,t)}class a0 extends Ue{constructor(){super(...arguments);G(this,"priority",90);G(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(t,i,n){const s=a=>a===0?7:a;switch(i){case"i":case"ii":return ft(i.length,t);case"io":return n.ordinalNumber(t,{unit:"day"});case"iii":return gt(n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"}),s);case"iiiii":return gt(n.day(t,{width:"narrow",context:"formatting"}),s);case"iiiiii":return gt(n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"}),s);case"iiii":default:return gt(n.day(t,{width:"wide",context:"formatting"})||n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"}),s)}}validate(t,i){return i>=1&&i<=7}set(t,i,n){return t=s0(t,n),t.setHours(0,0,0,0),t}}class o0 extends Ue{constructor(){super(...arguments);G(this,"priority",80);G(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(t,i,n){switch(i){case"a":case"aa":case"aaa":return n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaaa":return n.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(t,{width:"wide",context:"formatting"})||n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,i,n){return t.setHours(fl(n),0,0,0),t}}class l0 extends Ue{constructor(){super(...arguments);G(this,"priority",80);G(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(t,i,n){switch(i){case"b":case"bb":case"bbb":return n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbbb":return n.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(t,{width:"wide",context:"formatting"})||n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,i,n){return t.setHours(fl(n),0,0,0),t}}class h0 extends Ue{constructor(){super(...arguments);G(this,"priority",80);G(this,"incompatibleTokens",["a","b","t","T"])}parse(t,i,n){switch(i){case"B":case"BB":case"BBB":return n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBBB":return n.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(t,{width:"wide",context:"formatting"})||n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,i,n){return t.setHours(fl(n),0,0,0),t}}class u0 extends Ue{constructor(){super(...arguments);G(this,"priority",70);G(this,"incompatibleTokens",["H","K","k","t","T"])}parse(t,i,n){switch(i){case"h":return ut(mt.hour12h,t);case"ho":return n.ordinalNumber(t,{unit:"hour"});default:return ft(i.length,t)}}validate(t,i){return i>=1&&i<=12}set(t,i,n){const s=t.getHours()>=12;return s&&n<12?t.setHours(n+12,0,0,0):!s&&n===12?t.setHours(0,0,0,0):t.setHours(n,0,0,0),t}}class c0 extends Ue{constructor(){super(...arguments);G(this,"priority",70);G(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(t,i,n){switch(i){case"H":return ut(mt.hour23h,t);case"Ho":return n.ordinalNumber(t,{unit:"hour"});default:return ft(i.length,t)}}validate(t,i){return i>=0&&i<=23}set(t,i,n){return t.setHours(n,0,0,0),t}}class d0 extends Ue{constructor(){super(...arguments);G(this,"priority",70);G(this,"incompatibleTokens",["h","H","k","t","T"])}parse(t,i,n){switch(i){case"K":return ut(mt.hour11h,t);case"Ko":return n.ordinalNumber(t,{unit:"hour"});default:return ft(i.length,t)}}validate(t,i){return i>=0&&i<=11}set(t,i,n){return t.getHours()>=12&&n<12?t.setHours(n+12,0,0,0):t.setHours(n,0,0,0),t}}class f0 extends Ue{constructor(){super(...arguments);G(this,"priority",70);G(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(t,i,n){switch(i){case"k":return ut(mt.hour24h,t);case"ko":return n.ordinalNumber(t,{unit:"hour"});default:return ft(i.length,t)}}validate(t,i){return i>=1&&i<=24}set(t,i,n){const s=n<=24?n%24:n;return t.setHours(s,0,0,0),t}}class p0 extends Ue{constructor(){super(...arguments);G(this,"priority",60);G(this,"incompatibleTokens",["t","T"])}parse(t,i,n){switch(i){case"m":return ut(mt.minute,t);case"mo":return n.ordinalNumber(t,{unit:"minute"});default:return ft(i.length,t)}}validate(t,i){return i>=0&&i<=59}set(t,i,n){return t.setMinutes(n,0,0),t}}class m0 extends Ue{constructor(){super(...arguments);G(this,"priority",50);G(this,"incompatibleTokens",["t","T"])}parse(t,i,n){switch(i){case"s":return ut(mt.second,t);case"so":return n.ordinalNumber(t,{unit:"second"});default:return ft(i.length,t)}}validate(t,i){return i>=0&&i<=59}set(t,i,n){return t.setSeconds(n,0),t}}class g0 extends Ue{constructor(){super(...arguments);G(this,"priority",30);G(this,"incompatibleTokens",["t","T"])}parse(t,i){const n=s=>Math.trunc(s*Math.pow(10,-i.length+3));return gt(ft(i.length,t),n)}set(t,i,n){return t.setMilliseconds(n),t}}class v0 extends Ue{constructor(){super(...arguments);G(this,"priority",10);G(this,"incompatibleTokens",["t","T","x"])}parse(t,i){switch(i){case"X":return Ai(Mi.basicOptionalMinutes,t);case"XX":return Ai(Mi.basic,t);case"XXXX":return Ai(Mi.basicOptionalSeconds,t);case"XXXXX":return Ai(Mi.extendedOptionalSeconds,t);case"XXX":default:return Ai(Mi.extended,t)}}set(t,i,n){return i.timestampIsSet?t:Ke(t,t.getTime()-js(t)-n)}}class b0 extends Ue{constructor(){super(...arguments);G(this,"priority",10);G(this,"incompatibleTokens",["t","T","X"])}parse(t,i){switch(i){case"x":return Ai(Mi.basicOptionalMinutes,t);case"xx":return Ai(Mi.basic,t);case"xxxx":return Ai(Mi.basicOptionalSeconds,t);case"xxxxx":return Ai(Mi.extendedOptionalSeconds,t);case"xxx":default:return Ai(Mi.extended,t)}}set(t,i,n){return i.timestampIsSet?t:Ke(t,t.getTime()-js(t)-n)}}class w0 extends Ue{constructor(){super(...arguments);G(this,"priority",40);G(this,"incompatibleTokens","*")}parse(t){return Wu(t)}set(t,i,n){return[Ke(t,n*1e3),{timestampIsSet:!0}]}}class x0 extends Ue{constructor(){super(...arguments);G(this,"priority",20);G(this,"incompatibleTokens","*")}parse(t){return Wu(t)}set(t,i,n){return[Ke(t,n),{timestampIsSet:!0}]}}const y0={G:new Hp,y:new zp,Y:new Wp,R:new Vp,u:new Up,Q:new Gp,q:new Yp,M:new jp,L:new Xp,w:new Kp,I:new qp,d:new e0,D:new t0,E:new i0,e:new r0,c:new n0,i:new a0,a:new o0,b:new l0,B:new h0,h:new u0,H:new c0,K:new d0,k:new f0,m:new p0,s:new m0,S:new g0,X:new v0,x:new b0,t:new w0,T:new x0},E0=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,C0=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,_0=/^'([^]*?)'?$/,T0=/''/g,S0=/\S/,D0=/[a-zA-Z]/;function k0(r,e,t,i){var m,g,x,b,F,A,_,y;const n=()=>Ke((i==null?void 0:i.in)||t,NaN),s=Mp(),a=(i==null?void 0:i.locale)??s.locale??Iu,o=(i==null?void 0:i.firstWeekContainsDate)??((g=(m=i==null?void 0:i.locale)==null?void 0:m.options)==null?void 0:g.firstWeekContainsDate)??s.firstWeekContainsDate??((b=(x=s.locale)==null?void 0:x.options)==null?void 0:b.firstWeekContainsDate)??1,l=(i==null?void 0:i.weekStartsOn)??((A=(F=i==null?void 0:i.locale)==null?void 0:F.options)==null?void 0:A.weekStartsOn)??s.weekStartsOn??((y=(_=s.locale)==null?void 0:_.options)==null?void 0:y.weekStartsOn)??0;if(!e)return r?n():ve(t,i==null?void 0:i.in);const h={firstWeekContainsDate:o,weekStartsOn:l,locale:a},u=[new Bp(i==null?void 0:i.in,t)],d=e.match(C0).map(R=>{const M=R[0];if(M in To){const I=To[M];return I(R,a.formatLong)}return R}).join("").match(E0),c=[];for(let R of d){const M=R[0],I=y0[M];if(I){const{incompatibleTokens:P}=I;if(Array.isArray(P)){const ne=c.find(he=>P.includes(he.token)||he.token===M);if(ne)throw new RangeError(`The format string mustn't contain \`${ne.fullToken}\` and \`${R}\` at the same time`)}else if(I.incompatibleTokens==="*"&&c.length>0)throw new RangeError(`The format string mustn't contain \`${R}\` and any other token at the same time`);c.push({token:M,fullToken:R});const N=I.run(r,R,a.match,h);if(!N)return n();u.push(N.setter),r=N.rest}else{if(M.match(D0))throw new RangeError("Format string contains an unescaped latin alphabet character `"+M+"`");if(R==="''"?R="'":M==="'"&&(R=R0(R)),r.indexOf(R)===0)r=r.slice(R.length);else return n()}}if(r.length>0&&S0.test(r))return n();const f=u.map(R=>R.priority).sort((R,M)=>M-R).filter((R,M,I)=>I.indexOf(R)===M).map(R=>u.filter(M=>M.priority===R).sort((M,I)=>I.subPriority-M.subPriority)).map(R=>R[0]);let p=ve(t,i==null?void 0:i.in);if(isNaN(+p))return n();const v={};for(const R of f){if(!R.validate(p,h))return n();const M=R.set(p,v,h);Array.isArray(M)?(p=M[0],Object.assign(v,M[1])):p=M}return p}function R0(r){return r.match(_0)[1].replace(T0,"'")}function F0(r,e,t){const[i,n]=rr(t==null?void 0:t.in,r,e);return i.getFullYear()===n.getFullYear()&&i.getMonth()===n.getMonth()}function M0(r,e,t){const[i,n]=rr(t==null?void 0:t.in,r,e);return+_o(i)==+_o(n)}function A0(r,e,t){const[i,n]=rr(t==null?void 0:t.in,r,e);return i.getFullYear()===n.getFullYear()}function ts(r,e,t){const i=+ve(r,t==null?void 0:t.in),[n,s]=[+ve(e.start,t==null?void 0:t.in),+ve(e.end,t==null?void 0:t.in)].sort((a,o)=>a-o);return i>=n&&i<=s}function O0(r,e,t){return wi(r,-1,t)}function L0(r,e){const t=()=>Ke(e==null?void 0:e.in,NaN),n=B0(r);let s;if(n.date){const h=H0(n.date,2);s=z0(h.restDateString,h.year)}if(!s||isNaN(+s))return t();const a=+s;let o=0,l;if(n.time&&(o=W0(n.time),isNaN(o)))return t();if(n.timezone){if(l=V0(n.timezone),isNaN(l))return t()}else{const h=new Date(a+o),u=ve(0,e==null?void 0:e.in);return u.setFullYear(h.getUTCFullYear(),h.getUTCMonth(),h.getUTCDate()),u.setHours(h.getUTCHours(),h.getUTCMinutes(),h.getUTCSeconds(),h.getUTCMilliseconds()),u}return ve(a+o+l,e==null?void 0:e.in)}const Cs={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},P0=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,N0=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,I0=/^([+-])(\d{2})(?::?(\d{2}))?$/;function B0(r){const e={},t=r.split(Cs.dateTimeDelimiter);let i;if(t.length>2)return e;if(/:/.test(t[0])?i=t[0]:(e.date=t[0],i=t[1],Cs.timeZoneDelimiter.test(e.date)&&(e.date=r.split(Cs.timeZoneDelimiter)[0],i=r.substr(e.date.length,r.length))),i){const n=Cs.timezone.exec(i);n?(e.time=i.replace(n[1],""),e.timezone=n[1]):e.time=i}return e}function H0(r,e){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),i=r.match(t);if(!i)return{year:NaN,restDateString:""};const n=i[1]?parseInt(i[1]):null,s=i[2]?parseInt(i[2]):null;return{year:s===null?n:s*100,restDateString:r.slice((i[1]||i[2]).length)}}function z0(r,e){if(e===null)return new Date(NaN);const t=r.match(P0);if(!t)return new Date(NaN);const i=!!t[4],n=Bn(t[1]),s=Bn(t[2])-1,a=Bn(t[3]),o=Bn(t[4]),l=Bn(t[5])-1;if(i)return X0(e,o,l)?U0(e,o,l):new Date(NaN);{const h=new Date(0);return!Y0(e,s,a)||!j0(e,n)?new Date(NaN):(h.setUTCFullYear(e,s,Math.max(n,a)),h)}}function Bn(r){return r?parseInt(r):1}function W0(r){const e=r.match(N0);if(!e)return NaN;const t=Qa(e[1]),i=Qa(e[2]),n=Qa(e[3]);return $0(t,i,n)?t*Ta+i*_a+n*1e3:NaN}function Qa(r){return r&&parseFloat(r.replace(",","."))||0}function V0(r){if(r==="Z")return 0;const e=r.match(I0);if(!e)return 0;const t=e[1]==="+"?-1:1,i=parseInt(e[2]),n=e[3]&&parseInt(e[3])||0;return K0(i,n)?t*(i*Ta+n*_a):NaN}function U0(r,e,t){const i=new Date(0);i.setUTCFullYear(r,0,4);const n=i.getUTCDay()||7,s=(e-1)*7+t+1-n;return i.setUTCDate(i.getUTCDate()+s),i}const G0=[31,null,31,30,31,30,31,31,30,31,30,31];function Gu(r){return r%400===0||r%4===0&&r%100!==0}function Y0(r,e,t){return e>=0&&e<=11&&t>=1&&t<=(G0[e]||(Gu(r)?29:28))}function j0(r,e){return e>=1&&e<=(Gu(r)?366:365)}function X0(r,e,t){return e>=1&&e<=53&&t>=0&&t<=6}function $0(r,e,t){return r===24?e===0&&t===0:t>=0&&t<60&&e>=0&&e<60&&r>=0&&r<25}function K0(r,e){return e>=0&&e<=59}function ci(r,e,t){const i=ve(r,t==null?void 0:t.in),n=i.getFullYear(),s=i.getDate(),a=Ke(r,0);a.setFullYear(n,e,15),a.setHours(0,0,0,0);const o=Fp(a);return i.setMonth(e,Math.min(s,o)),i}function Bs(r,e,t){const i=ve(r,t==null?void 0:t.in);return i.setHours(e),i}function Hs(r,e,t){const i=ve(r,t==null?void 0:t.in);return i.setMinutes(e),i}function tn(r,e,t){const i=ve(r,t==null?void 0:t.in),n=Math.trunc(i.getMonth()/3)+1,s=e-n;return ci(i,i.getMonth()+s*3)}function zs(r,e,t){const i=ve(r,t==null?void 0:t.in);return i.setSeconds(e),i}function Ti(r,e,t){const i=ve(r,t==null?void 0:t.in);return isNaN(+i)?Ke(r,NaN):(i.setFullYear(e),i)}function Pr(r,e,t){return yi(r,-e,t)}function Yu(r,e,t){return ul(r,-1,t)}function sh(r,e,t){return Xs(r,-1,t)}function yn(r,e,t){return ji(r,-e,t)}function Da(){return typeof window<"u"}function kn(r){return ju(r)?(r.nodeName||"").toLowerCase():"#document"}function ai(r){var e;return(r==null||(e=r.ownerDocument)==null?void 0:e.defaultView)||window}function Bi(r){var e;return(e=(ju(r)?r.ownerDocument:r.document)||window.document)==null?void 0:e.documentElement}function ju(r){return Da()?r instanceof Node||r instanceof ai(r).Node:!1}function $t(r){return Da()?r instanceof Element||r instanceof ai(r).Element:!1}function Ni(r){return Da()?r instanceof HTMLElement||r instanceof ai(r).HTMLElement:!1}function ah(r){return!Da()||typeof ShadowRoot>"u"?!1:r instanceof ShadowRoot||r instanceof ai(r).ShadowRoot}function cs(r){const{overflow:e,overflowX:t,overflowY:i,display:n}=fi(r);return/auto|scroll|overlay|hidden|clip/.test(e+i+t)&&!["inline","contents"].includes(n)}function Q0(r){return["table","td","th"].includes(kn(r))}function ka(r){return[":popover-open",":modal"].some(e=>{try{return r.matches(e)}catch{return!1}})}function ml(r){const e=gl(),t=$t(r)?fi(r):r;return["transform","translate","scale","rotate","perspective"].some(i=>t[i]?t[i]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(i=>(t.willChange||"").includes(i))||["paint","layout","strict","content"].some(i=>(t.contain||"").includes(i))}function q0(r){let e=br(r);for(;Ni(e)&&!En(e);){if(ml(e))return e;if(ka(e))return null;e=br(e)}return null}function gl(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function En(r){return["html","body","#document"].includes(kn(r))}function fi(r){return ai(r).getComputedStyle(r)}function Ra(r){return $t(r)?{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}:{scrollLeft:r.scrollX,scrollTop:r.scrollY}}function br(r){if(kn(r)==="html")return r;const e=r.assignedSlot||r.parentNode||ah(r)&&r.host||Bi(r);return ah(e)?e.host:e}function Xu(r){const e=br(r);return En(e)?r.ownerDocument?r.ownerDocument.body:r.body:Ni(e)&&cs(e)?e:Xu(e)}function is(r,e,t){var i;e===void 0&&(e=[]),t===void 0&&(t=!0);const n=Xu(r),s=n===((i=r.ownerDocument)==null?void 0:i.body),a=ai(n);if(s){const o=Do(a);return e.concat(a,a.visualViewport||[],cs(n)?n:[],o&&t?is(o):[])}return e.concat(n,is(n,[],t))}function Do(r){return r.parent&&Object.getPrototypeOf(r.parent)?r.frameElement:null}const Cn=Math.min,Nr=Math.max,Zs=Math.round,_s=Math.floor,Pi=r=>({x:r,y:r}),J0={left:"right",right:"left",bottom:"top",top:"bottom"},Z0={start:"end",end:"start"};function em(r,e,t){return Nr(r,Cn(e,t))}function Fa(r,e){return typeof r=="function"?r(e):r}function _n(r){return r.split("-")[0]}function ds(r){return r.split("-")[1]}function tm(r){return r==="x"?"y":"x"}function vl(r){return r==="y"?"height":"width"}function Ar(r){return["top","bottom"].includes(_n(r))?"y":"x"}function bl(r){return tm(Ar(r))}function im(r,e,t){t===void 0&&(t=!1);const i=ds(r),n=bl(r),s=vl(n);let a=n==="x"?i===(t?"end":"start")?"right":"left":i==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(a=ea(a)),[a,ea(a)]}function rm(r){const e=ea(r);return[ko(r),e,ko(e)]}function ko(r){return r.replace(/start|end/g,e=>Z0[e])}function nm(r,e,t){const i=["left","right"],n=["right","left"],s=["top","bottom"],a=["bottom","top"];switch(r){case"top":case"bottom":return t?e?n:i:e?i:n;case"left":case"right":return e?s:a;default:return[]}}function sm(r,e,t,i){const n=ds(r);let s=nm(_n(r),t==="start",i);return n&&(s=s.map(a=>a+"-"+n),e&&(s=s.concat(s.map(ko)))),s}function ea(r){return r.replace(/left|right|bottom|top/g,e=>J0[e])}function am(r){return{top:0,right:0,bottom:0,left:0,...r}}function $u(r){return typeof r!="number"?am(r):{top:r,right:r,bottom:r,left:r}}function ta(r){const{x:e,y:t,width:i,height:n}=r;return{width:i,height:n,top:t,left:e,right:e+i,bottom:t+n,x:e,y:t}}var om=typeof document<"u",lm=function(){},ia=om?ie.useLayoutEffect:lm;const hm={...Du},um=hm.useInsertionEffect,cm=um||(r=>r());function dm(r){const e=ie.useRef(()=>{});return cm(()=>{e.current=r}),ie.useCallback(function(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return e.current==null?void 0:e.current(...i)},[])}function oh(r,e,t){let{reference:i,floating:n}=r;const s=Ar(e),a=bl(e),o=vl(a),l=_n(e),h=s==="y",u=i.x+i.width/2-n.width/2,d=i.y+i.height/2-n.height/2,c=i[o]/2-n[o]/2;let f;switch(l){case"top":f={x:u,y:i.y-n.height};break;case"bottom":f={x:u,y:i.y+i.height};break;case"right":f={x:i.x+i.width,y:d};break;case"left":f={x:i.x-n.width,y:d};break;default:f={x:i.x,y:i.y}}switch(ds(e)){case"start":f[a]-=c*(t&&h?-1:1);break;case"end":f[a]+=c*(t&&h?-1:1);break}return f}const fm=async(r,e,t)=>{const{placement:i="bottom",strategy:n="absolute",middleware:s=[],platform:a}=t,o=s.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(e));let h=await a.getElementRects({reference:r,floating:e,strategy:n}),{x:u,y:d}=oh(h,i,l),c=i,f={},p=0;for(let v=0;v<o.length;v++){const{name:m,fn:g}=o[v],{x,y:b,data:F,reset:A}=await g({x:u,y:d,initialPlacement:i,placement:c,strategy:n,middlewareData:f,rects:h,platform:a,elements:{reference:r,floating:e}});u=x??u,d=b??d,f={...f,[m]:{...f[m],...F}},A&&p<=50&&(p++,typeof A=="object"&&(A.placement&&(c=A.placement),A.rects&&(h=A.rects===!0?await a.getElementRects({reference:r,floating:e,strategy:n}):A.rects),{x:u,y:d}=oh(h,c,l)),v=-1)}return{x:u,y:d,placement:c,strategy:n,middlewareData:f}};async function pm(r,e){var t;e===void 0&&(e={});const{x:i,y:n,platform:s,rects:a,elements:o,strategy:l}=r,{boundary:h="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:c=!1,padding:f=0}=Fa(e,r),p=$u(f),m=o[c?d==="floating"?"reference":"floating":d],g=ta(await s.getClippingRect({element:(t=await(s.isElement==null?void 0:s.isElement(m)))==null||t?m:m.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(o.floating)),boundary:h,rootBoundary:u,strategy:l})),x=d==="floating"?{x:i,y:n,width:a.floating.width,height:a.floating.height}:a.reference,b=await(s.getOffsetParent==null?void 0:s.getOffsetParent(o.floating)),F=await(s.isElement==null?void 0:s.isElement(b))?await(s.getScale==null?void 0:s.getScale(b))||{x:1,y:1}:{x:1,y:1},A=ta(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:x,offsetParent:b,strategy:l}):x);return{top:(g.top-A.top+p.top)/F.y,bottom:(A.bottom-g.bottom+p.bottom)/F.y,left:(g.left-A.left+p.left)/F.x,right:(A.right-g.right+p.right)/F.x}}const mm=r=>({name:"arrow",options:r,async fn(e){const{x:t,y:i,placement:n,rects:s,platform:a,elements:o,middlewareData:l}=e,{element:h,padding:u=0}=Fa(r,e)||{};if(h==null)return{};const d=$u(u),c={x:t,y:i},f=bl(n),p=vl(f),v=await a.getDimensions(h),m=f==="y",g=m?"top":"left",x=m?"bottom":"right",b=m?"clientHeight":"clientWidth",F=s.reference[p]+s.reference[f]-c[f]-s.floating[p],A=c[f]-s.reference[f],_=await(a.getOffsetParent==null?void 0:a.getOffsetParent(h));let y=_?_[b]:0;(!y||!await(a.isElement==null?void 0:a.isElement(_)))&&(y=o.floating[b]||s.floating[p]);const R=F/2-A/2,M=y/2-v[p]/2-1,I=Cn(d[g],M),P=Cn(d[x],M),N=I,ne=y-v[p]-P,he=y/2-v[p]/2+R,se=em(N,he,ne),fe=!l.arrow&&ds(n)!=null&&he!==se&&s.reference[p]/2-(he<N?I:P)-v[p]/2<0,ee=fe?he<N?he-N:he-ne:0;return{[f]:c[f]+ee,data:{[f]:se,centerOffset:he-se-ee,...fe&&{alignmentOffset:ee}},reset:fe}}}),gm=function(r){return r===void 0&&(r={}),{name:"flip",options:r,async fn(e){var t,i;const{placement:n,middlewareData:s,rects:a,initialPlacement:o,platform:l,elements:h}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:c,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:v=!0,...m}=Fa(r,e);if((t=s.arrow)!=null&&t.alignmentOffset)return{};const g=_n(n),x=Ar(o),b=_n(o)===o,F=await(l.isRTL==null?void 0:l.isRTL(h.floating)),A=c||(b||!v?[ea(o)]:rm(o)),_=p!=="none";!c&&_&&A.push(...sm(o,v,p,F));const y=[o,...A],R=await pm(e,m),M=[];let I=((i=s.flip)==null?void 0:i.overflows)||[];if(u&&M.push(R[g]),d){const he=im(n,a,F);M.push(R[he[0]],R[he[1]])}if(I=[...I,{placement:n,overflows:M}],!M.every(he=>he<=0)){var P,N;const he=(((P=s.flip)==null?void 0:P.index)||0)+1,se=y[he];if(se&&(!(d==="alignment"?x!==Ar(se):!1)||I.every(ge=>ge.overflows[0]>0&&Ar(ge.placement)===x)))return{data:{index:he,overflows:I},reset:{placement:se}};let fe=(N=I.filter(ee=>ee.overflows[0]<=0).sort((ee,ge)=>ee.overflows[1]-ge.overflows[1])[0])==null?void 0:N.placement;if(!fe)switch(f){case"bestFit":{var ne;const ee=(ne=I.filter(ge=>{if(_){const _e=Ar(ge.placement);return _e===x||_e==="y"}return!0}).map(ge=>[ge.placement,ge.overflows.filter(_e=>_e>0).reduce((_e,Je)=>_e+Je,0)]).sort((ge,_e)=>ge[1]-_e[1])[0])==null?void 0:ne[0];ee&&(fe=ee);break}case"initialPlacement":fe=o;break}if(n!==fe)return{reset:{placement:fe}}}return{}}}};async function vm(r,e){const{placement:t,platform:i,elements:n}=r,s=await(i.isRTL==null?void 0:i.isRTL(n.floating)),a=_n(t),o=ds(t),l=Ar(t)==="y",h=["left","top"].includes(a)?-1:1,u=s&&l?-1:1,d=Fa(e,r);let{mainAxis:c,crossAxis:f,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return o&&typeof p=="number"&&(f=o==="end"?p*-1:p),l?{x:f*u,y:c*h}:{x:c*h,y:f*u}}const bm=function(r){return r===void 0&&(r=0),{name:"offset",options:r,async fn(e){var t,i;const{x:n,y:s,placement:a,middlewareData:o}=e,l=await vm(e,r);return a===((t=o.offset)==null?void 0:t.placement)&&(i=o.arrow)!=null&&i.alignmentOffset?{}:{x:n+l.x,y:s+l.y,data:{...l,placement:a}}}}};function Ku(r){const e=fi(r);let t=parseFloat(e.width)||0,i=parseFloat(e.height)||0;const n=Ni(r),s=n?r.offsetWidth:t,a=n?r.offsetHeight:i,o=Zs(t)!==s||Zs(i)!==a;return o&&(t=s,i=a),{width:t,height:i,$:o}}function wl(r){return $t(r)?r:r.contextElement}function un(r){const e=wl(r);if(!Ni(e))return Pi(1);const t=e.getBoundingClientRect(),{width:i,height:n,$:s}=Ku(e);let a=(s?Zs(t.width):t.width)/i,o=(s?Zs(t.height):t.height)/n;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const wm=Pi(0);function Qu(r){const e=ai(r);return!gl()||!e.visualViewport?wm:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function xm(r,e,t){return e===void 0&&(e=!1),!t||e&&t!==ai(r)?!1:e}function Wr(r,e,t,i){e===void 0&&(e=!1),t===void 0&&(t=!1);const n=r.getBoundingClientRect(),s=wl(r);let a=Pi(1);e&&(i?$t(i)&&(a=un(i)):a=un(r));const o=xm(s,t,i)?Qu(s):Pi(0);let l=(n.left+o.x)/a.x,h=(n.top+o.y)/a.y,u=n.width/a.x,d=n.height/a.y;if(s){const c=ai(s),f=i&&$t(i)?ai(i):i;let p=c,v=Do(p);for(;v&&i&&f!==p;){const m=un(v),g=v.getBoundingClientRect(),x=fi(v),b=g.left+(v.clientLeft+parseFloat(x.paddingLeft))*m.x,F=g.top+(v.clientTop+parseFloat(x.paddingTop))*m.y;l*=m.x,h*=m.y,u*=m.x,d*=m.y,l+=b,h+=F,p=ai(v),v=Do(p)}}return ta({width:u,height:d,x:l,y:h})}function xl(r,e){const t=Ra(r).scrollLeft;return e?e.left+t:Wr(Bi(r)).left+t}function qu(r,e,t){t===void 0&&(t=!1);const i=r.getBoundingClientRect(),n=i.left+e.scrollLeft-(t?0:xl(r,i)),s=i.top+e.scrollTop;return{x:n,y:s}}function ym(r){let{elements:e,rect:t,offsetParent:i,strategy:n}=r;const s=n==="fixed",a=Bi(i),o=e?ka(e.floating):!1;if(i===a||o&&s)return t;let l={scrollLeft:0,scrollTop:0},h=Pi(1);const u=Pi(0),d=Ni(i);if((d||!d&&!s)&&((kn(i)!=="body"||cs(a))&&(l=Ra(i)),Ni(i))){const f=Wr(i);h=un(i),u.x=f.x+i.clientLeft,u.y=f.y+i.clientTop}const c=a&&!d&&!s?qu(a,l,!0):Pi(0);return{width:t.width*h.x,height:t.height*h.y,x:t.x*h.x-l.scrollLeft*h.x+u.x+c.x,y:t.y*h.y-l.scrollTop*h.y+u.y+c.y}}function Em(r){return Array.from(r.getClientRects())}function Cm(r){const e=Bi(r),t=Ra(r),i=r.ownerDocument.body,n=Nr(e.scrollWidth,e.clientWidth,i.scrollWidth,i.clientWidth),s=Nr(e.scrollHeight,e.clientHeight,i.scrollHeight,i.clientHeight);let a=-t.scrollLeft+xl(r);const o=-t.scrollTop;return fi(i).direction==="rtl"&&(a+=Nr(e.clientWidth,i.clientWidth)-n),{width:n,height:s,x:a,y:o}}function _m(r,e){const t=ai(r),i=Bi(r),n=t.visualViewport;let s=i.clientWidth,a=i.clientHeight,o=0,l=0;if(n){s=n.width,a=n.height;const h=gl();(!h||h&&e==="fixed")&&(o=n.offsetLeft,l=n.offsetTop)}return{width:s,height:a,x:o,y:l}}function Tm(r,e){const t=Wr(r,!0,e==="fixed"),i=t.top+r.clientTop,n=t.left+r.clientLeft,s=Ni(r)?un(r):Pi(1),a=r.clientWidth*s.x,o=r.clientHeight*s.y,l=n*s.x,h=i*s.y;return{width:a,height:o,x:l,y:h}}function lh(r,e,t){let i;if(e==="viewport")i=_m(r,t);else if(e==="document")i=Cm(Bi(r));else if($t(e))i=Tm(e,t);else{const n=Qu(r);i={x:e.x-n.x,y:e.y-n.y,width:e.width,height:e.height}}return ta(i)}function Ju(r,e){const t=br(r);return t===e||!$t(t)||En(t)?!1:fi(t).position==="fixed"||Ju(t,e)}function Sm(r,e){const t=e.get(r);if(t)return t;let i=is(r,[],!1).filter(o=>$t(o)&&kn(o)!=="body"),n=null;const s=fi(r).position==="fixed";let a=s?br(r):r;for(;$t(a)&&!En(a);){const o=fi(a),l=ml(a);!l&&o.position==="fixed"&&(n=null),(s?!l&&!n:!l&&o.position==="static"&&!!n&&["absolute","fixed"].includes(n.position)||cs(a)&&!l&&Ju(r,a))?i=i.filter(u=>u!==a):n=o,a=br(a)}return e.set(r,i),i}function Dm(r){let{element:e,boundary:t,rootBoundary:i,strategy:n}=r;const a=[...t==="clippingAncestors"?ka(e)?[]:Sm(e,this._c):[].concat(t),i],o=a[0],l=a.reduce((h,u)=>{const d=lh(e,u,n);return h.top=Nr(d.top,h.top),h.right=Cn(d.right,h.right),h.bottom=Cn(d.bottom,h.bottom),h.left=Nr(d.left,h.left),h},lh(e,o,n));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function km(r){const{width:e,height:t}=Ku(r);return{width:e,height:t}}function Rm(r,e,t){const i=Ni(e),n=Bi(e),s=t==="fixed",a=Wr(r,!0,s,e);let o={scrollLeft:0,scrollTop:0};const l=Pi(0);function h(){l.x=xl(n)}if(i||!i&&!s)if((kn(e)!=="body"||cs(n))&&(o=Ra(e)),i){const f=Wr(e,!0,s,e);l.x=f.x+e.clientLeft,l.y=f.y+e.clientTop}else n&&h();s&&!i&&n&&h();const u=n&&!i&&!s?qu(n,o):Pi(0),d=a.left+o.scrollLeft-l.x-u.x,c=a.top+o.scrollTop-l.y-u.y;return{x:d,y:c,width:a.width,height:a.height}}function qa(r){return fi(r).position==="static"}function hh(r,e){if(!Ni(r)||fi(r).position==="fixed")return null;if(e)return e(r);let t=r.offsetParent;return Bi(r)===t&&(t=t.ownerDocument.body),t}function Zu(r,e){const t=ai(r);if(ka(r))return t;if(!Ni(r)){let n=br(r);for(;n&&!En(n);){if($t(n)&&!qa(n))return n;n=br(n)}return t}let i=hh(r,e);for(;i&&Q0(i)&&qa(i);)i=hh(i,e);return i&&En(i)&&qa(i)&&!ml(i)?t:i||q0(r)||t}const Fm=async function(r){const e=this.getOffsetParent||Zu,t=this.getDimensions,i=await t(r.floating);return{reference:Rm(r.reference,await e(r.floating),r.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function Mm(r){return fi(r).direction==="rtl"}const Am={convertOffsetParentRelativeRectToViewportRelativeRect:ym,getDocumentElement:Bi,getClippingRect:Dm,getOffsetParent:Zu,getElementRects:Fm,getClientRects:Em,getDimensions:km,getScale:un,isElement:$t,isRTL:Mm};function ec(r,e){return r.x===e.x&&r.y===e.y&&r.width===e.width&&r.height===e.height}function Om(r,e){let t=null,i;const n=Bi(r);function s(){var o;clearTimeout(i),(o=t)==null||o.disconnect(),t=null}function a(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),s();const h=r.getBoundingClientRect(),{left:u,top:d,width:c,height:f}=h;if(o||e(),!c||!f)return;const p=_s(d),v=_s(n.clientWidth-(u+c)),m=_s(n.clientHeight-(d+f)),g=_s(u),b={rootMargin:-p+"px "+-v+"px "+-m+"px "+-g+"px",threshold:Nr(0,Cn(1,l))||1};let F=!0;function A(_){const y=_[0].intersectionRatio;if(y!==l){if(!F)return a();y?a(!1,y):i=setTimeout(()=>{a(!1,1e-7)},1e3)}y===1&&!ec(h,r.getBoundingClientRect())&&a(),F=!1}try{t=new IntersectionObserver(A,{...b,root:n.ownerDocument})}catch{t=new IntersectionObserver(A,b)}t.observe(r)}return a(!0),s}function Lm(r,e,t,i){i===void 0&&(i={});const{ancestorScroll:n=!0,ancestorResize:s=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=i,h=wl(r),u=n||s?[...h?is(h):[],...is(e)]:[];u.forEach(g=>{n&&g.addEventListener("scroll",t,{passive:!0}),s&&g.addEventListener("resize",t)});const d=h&&o?Om(h,t):null;let c=-1,f=null;a&&(f=new ResizeObserver(g=>{let[x]=g;x&&x.target===h&&f&&(f.unobserve(e),cancelAnimationFrame(c),c=requestAnimationFrame(()=>{var b;(b=f)==null||b.observe(e)})),t()}),h&&!l&&f.observe(h),f.observe(e));let p,v=l?Wr(r):null;l&&m();function m(){const g=Wr(r);v&&!ec(v,g)&&t(),v=g,p=requestAnimationFrame(m)}return t(),()=>{var g;u.forEach(x=>{n&&x.removeEventListener("scroll",t),s&&x.removeEventListener("resize",t)}),d==null||d(),(g=f)==null||g.disconnect(),f=null,l&&cancelAnimationFrame(p)}}const Pm=bm,Nm=gm,uh=mm,Im=(r,e,t)=>{const i=new Map,n={platform:Am,...t},s={...n.platform,_c:i};return fm(r,e,{...n,platform:s})};var Bm=typeof document<"u",Hm=function(){},Ws=Bm?ie.useLayoutEffect:Hm;function ra(r,e){if(r===e)return!0;if(typeof r!=typeof e)return!1;if(typeof r=="function"&&r.toString()===e.toString())return!0;let t,i,n;if(r&&e&&typeof r=="object"){if(Array.isArray(r)){if(t=r.length,t!==e.length)return!1;for(i=t;i--!==0;)if(!ra(r[i],e[i]))return!1;return!0}if(n=Object.keys(r),t=n.length,t!==Object.keys(e).length)return!1;for(i=t;i--!==0;)if(!{}.hasOwnProperty.call(e,n[i]))return!1;for(i=t;i--!==0;){const s=n[i];if(!(s==="_owner"&&r.$$typeof)&&!ra(r[s],e[s]))return!1}return!0}return r!==r&&e!==e}function tc(r){return typeof window>"u"?1:(r.ownerDocument.defaultView||window).devicePixelRatio||1}function ch(r,e){const t=tc(r);return Math.round(e*t)/t}function Ja(r){const e=ie.useRef(r);return Ws(()=>{e.current=r}),e}function zm(r){r===void 0&&(r={});const{placement:e="bottom",strategy:t="absolute",middleware:i=[],platform:n,elements:{reference:s,floating:a}={},transform:o=!0,whileElementsMounted:l,open:h}=r,[u,d]=ie.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[c,f]=ie.useState(i);ra(c,i)||f(i);const[p,v]=ie.useState(null),[m,g]=ie.useState(null),x=ie.useCallback(ge=>{ge!==_.current&&(_.current=ge,v(ge))},[]),b=ie.useCallback(ge=>{ge!==y.current&&(y.current=ge,g(ge))},[]),F=s||p,A=a||m,_=ie.useRef(null),y=ie.useRef(null),R=ie.useRef(u),M=l!=null,I=Ja(l),P=Ja(n),N=Ja(h),ne=ie.useCallback(()=>{if(!_.current||!y.current)return;const ge={placement:e,strategy:t,middleware:c};P.current&&(ge.platform=P.current),Im(_.current,y.current,ge).then(_e=>{const Je={..._e,isPositioned:N.current!==!1};he.current&&!ra(R.current,Je)&&(R.current=Je,_f.flushSync(()=>{d(Je)}))})},[c,e,t,P,N]);Ws(()=>{h===!1&&R.current.isPositioned&&(R.current.isPositioned=!1,d(ge=>({...ge,isPositioned:!1})))},[h]);const he=ie.useRef(!1);Ws(()=>(he.current=!0,()=>{he.current=!1}),[]),Ws(()=>{if(F&&(_.current=F),A&&(y.current=A),F&&A){if(I.current)return I.current(F,A,ne);ne()}},[F,A,ne,I,M]);const se=ie.useMemo(()=>({reference:_,floating:y,setReference:x,setFloating:b}),[x,b]),fe=ie.useMemo(()=>({reference:F,floating:A}),[F,A]),ee=ie.useMemo(()=>{const ge={position:t,left:0,top:0};if(!fe.floating)return ge;const _e=ch(fe.floating,u.x),Je=ch(fe.floating,u.y);return o?{...ge,transform:"translate("+_e+"px, "+Je+"px)",...tc(fe.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:_e,top:Je}},[t,o,fe.floating,u.x,u.y]);return ie.useMemo(()=>({...u,update:ne,refs:se,elements:fe,floatingStyles:ee}),[u,ne,se,fe,ee])}const Wm=r=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:r,fn(t){const{element:i,padding:n}=typeof r=="function"?r(t):r;return i&&e(i)?i.current!=null?uh({element:i.current,padding:n}).fn(t):{}:i?uh({element:i,padding:n}).fn(t):{}}}},Vm=(r,e)=>({...Pm(r),options:[r,e]}),Um=(r,e)=>({...Nm(r),options:[r,e]}),Gm=(r,e)=>({...Wm(r),options:[r,e]}),Ym={...Du};let dh=!1,jm=0;const fh=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+jm++;function Xm(){const[r,e]=ie.useState(()=>dh?fh():void 0);return ia(()=>{r==null&&e(fh())},[]),ie.useEffect(()=>{dh=!0},[]),r}const $m=Ym.useId,ic=$m||Xm,Km=ie.forwardRef(function(e,t){const{context:{placement:i,elements:{floating:n},middlewareData:{arrow:s,shift:a}},width:o=14,height:l=7,tipRadius:h=0,strokeWidth:u=0,staticOffset:d,stroke:c,d:f,style:{transform:p,...v}={},...m}=e,g=ic(),[x,b]=ie.useState(!1);if(ia(()=>{if(!n)return;fi(n).direction==="rtl"&&b(!0)},[n]),!n)return null;const[F,A]=i.split("-"),_=F==="top"||F==="bottom";let y=d;(_&&a!=null&&a.x||!_&&a!=null&&a.y)&&(y=null);const R=u*2,M=R/2,I=o/2*(h/-8+1),P=l/2*h/4,N=!!f,ne=y&&A==="end"?"bottom":"top";let he=y&&A==="end"?"right":"left";y&&x&&(he=A==="end"?"left":"right");const se=(s==null?void 0:s.x)!=null?y||s.x:"",fe=(s==null?void 0:s.y)!=null?y||s.y:"",ee=f||"M0,0"+(" H"+o)+(" L"+(o-I)+","+(l-P))+(" Q"+o/2+","+l+" "+I+","+(l-P))+" Z",ge={top:N?"rotate(180deg)":"",left:N?"rotate(90deg)":"rotate(-90deg)",bottom:N?"":"rotate(180deg)",right:N?"rotate(-90deg)":"rotate(90deg)"}[F];return ye.jsxs("svg",{...m,"aria-hidden":!0,ref:t,width:N?o:o+R,height:o,viewBox:"0 0 "+o+" "+(l>o?l:o),style:{position:"absolute",pointerEvents:"none",[he]:se,[ne]:fe,[F]:_||N?"100%":"calc(100% - "+R/2+"px)",transform:[ge,p].filter(_e=>!!_e).join(" "),...v},children:[R>0&&ye.jsx("path",{clipPath:"url(#"+g+")",fill:"none",stroke:c,strokeWidth:R+(f?0:1),d:ee}),ye.jsx("path",{stroke:R&&!f?m.fill:"none",d:ee}),ye.jsx("clipPath",{id:g,children:ye.jsx("rect",{x:-M,y:M*(N?-1:1),width:o+R,height:o})})]})});function Qm(){const r=new Map;return{emit(e,t){var i;(i=r.get(e))==null||i.forEach(n=>n(t))},on(e,t){r.has(e)||r.set(e,new Set),r.get(e).add(t)},off(e,t){var i;(i=r.get(e))==null||i.delete(t)}}}const qm=ie.createContext(null),Jm=ie.createContext(null),Zm=()=>{var r;return((r=ie.useContext(qm))==null?void 0:r.id)||null},eg=()=>ie.useContext(Jm);function tg(r){const{open:e=!1,onOpenChange:t,elements:i}=r,n=ic(),s=ie.useRef({}),[a]=ie.useState(()=>Qm()),o=Zm()!=null,[l,h]=ie.useState(i.reference),u=dm((f,p,v)=>{s.current.openEvent=f?p:void 0,a.emit("openchange",{open:f,event:p,reason:v,nested:o}),t==null||t(f,p,v)}),d=ie.useMemo(()=>({setPositionReference:h}),[]),c=ie.useMemo(()=>({reference:l||i.reference||null,floating:i.floating||null,domReference:i.reference}),[l,i.reference,i.floating]);return ie.useMemo(()=>({dataRef:s,open:e,onOpenChange:u,elements:c,events:a,floatingId:n,refs:d}),[e,u,c,a,n,d])}function ig(r){r===void 0&&(r={});const{nodeId:e}=r,t=tg({...r,elements:{reference:null,floating:null,...r.elements}}),i=r.rootContext||t,n=i.elements,[s,a]=ie.useState(null),[o,l]=ie.useState(null),u=(n==null?void 0:n.domReference)||s,d=ie.useRef(null),c=eg();ia(()=>{u&&(d.current=u)},[u]);const f=zm({...r,elements:{...n,...o&&{reference:o}}}),p=ie.useCallback(b=>{const F=$t(b)?{getBoundingClientRect:()=>b.getBoundingClientRect(),getClientRects:()=>b.getClientRects(),contextElement:b}:b;l(F),f.refs.setReference(F)},[f.refs]),v=ie.useCallback(b=>{($t(b)||b===null)&&(d.current=b,a(b)),($t(f.refs.reference.current)||f.refs.reference.current===null||b!==null&&!$t(b))&&f.refs.setReference(b)},[f.refs]),m=ie.useMemo(()=>({...f.refs,setReference:v,setPositionReference:p,domReference:d}),[f.refs,v,p]),g=ie.useMemo(()=>({...f.elements,domReference:u}),[f.elements,u]),x=ie.useMemo(()=>({...f,...i,refs:m,elements:g,nodeId:e}),[f,m,g,e,i]);return ia(()=>{i.dataRef.current.floatingContext=x;const b=c==null?void 0:c.nodesRef.current.find(F=>F.id===e);b&&(b.context=x)}),ie.useMemo(()=>({...f,context:x,refs:m,elements:g}),[f,m,g,x])}/*!
  react-datepicker v8.4.0
  https://github.com/Hacker0x01/react-datepicker
  Released under the MIT License.
*/var Ro=function(e,t){return Ro=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=n[s])},Ro(e,t)};function St(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Ro(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Be=function(){return Be=Object.assign||function(t){for(var i,n=1,s=arguments.length;n<s;n++){i=arguments[n];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(t[a]=i[a])}return t},Be.apply(this,arguments)};function Oi(r,e,t){if(t||arguments.length===2)for(var i=0,n=e.length,s;i<n;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return r.concat(s||Array.prototype.slice.call(e))}var rg=function(r){var e=r.showTimeSelectOnly,t=e===void 0?!1:e,i=r.showTime,n=i===void 0?!1:i,s=r.className,a=r.children,o=t?"Choose Time":"Choose Date".concat(n?" and Time":"");return j.createElement("div",{className:s,role:"dialog","aria-label":o,"aria-modal":"true"},a)},ng=function(r,e){var t=ie.useRef(null),i=ie.useRef(r);i.current=r;var n=ie.useCallback(function(s){var a,o=s.composed&&s.composedPath&&s.composedPath().find(function(l){return l instanceof Node})||s.target;t.current&&!t.current.contains(o)&&(e&&o instanceof HTMLElement&&o.classList.contains(e)||(a=i.current)===null||a===void 0||a.call(i,s))},[e]);return ie.useEffect(function(){return document.addEventListener("mousedown",n),function(){document.removeEventListener("mousedown",n)}},[n]),t},Ma=function(r){var e=r.children,t=r.onClickOutside,i=r.className,n=r.containerRef,s=r.style,a=r.ignoreClass,o=ng(t,a);return j.createElement("div",{className:i,style:s,ref:function(l){o.current=l,n&&(n.current=l)}},e)},ue;(function(r){r.ArrowUp="ArrowUp",r.ArrowDown="ArrowDown",r.ArrowLeft="ArrowLeft",r.ArrowRight="ArrowRight",r.PageUp="PageUp",r.PageDown="PageDown",r.Home="Home",r.End="End",r.Enter="Enter",r.Space=" ",r.Tab="Tab",r.Escape="Escape",r.Backspace="Backspace",r.X="x"})(ue||(ue={}));function rc(){var r=typeof window<"u"?window:globalThis;return r}var fs=12;function Ye(r){if(r==null)return new Date;var e=typeof r=="string"?L0(r):ve(r);return Aa(e)?e:new Date}function Za(r,e,t,i,n){n===void 0&&(n=Ye());for(var s=Tn(t)||Tn(yl()),a=Array.isArray(e)?e:[e],o=0,l=a;o<l.length;o++){var h=l[o],u=k0(r,h,n,{locale:s});if(Aa(u)&&(!i||r===ot(u,h,t)))return u}return null}function Aa(r,e){return $s(r)&&!zr(r,new Date("1/1/1800"))}function ot(r,e,t){if(t==="en")return rh(r,e,{useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});var i=t?Tn(t):void 0;return t&&!i&&console.warn('A locale object was not found for the provided string ["'.concat(t,'"].')),i=i||Tn(yl()),rh(r,e,{locale:i,useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0})}function hi(r,e){var t=e.dateFormat,i=e.locale,n=Array.isArray(t)&&t.length>0?t[0]:t;return r&&ot(r,n,i)||""}var nc=" - ";function sg(r,e,t){if(!r)return"";var i=hi(r,t),n=e?hi(e,t):"";return"".concat(i).concat(nc).concat(n)}function ag(r,e){if(!(r!=null&&r.length))return"";var t=r[0]?hi(r[0],e):"";if(r.length===1)return t;if(r.length===2&&r[1]){var i=hi(r[1],e);return"".concat(t,", ").concat(i)}var n=r.length-1;return"".concat(t," (+").concat(n,")")}function eo(r,e){var t=e.hour,i=t===void 0?0:t,n=e.minute,s=n===void 0?0:n,a=e.second,o=a===void 0?0:a;return Bs(Hs(zs(r,o),s),i)}function og(r){return cl(r)}function lg(r,e){return ot(r,"ddd",e)}function Vs(r){return Hr(r)}function gr(r,e,t){var i=Tn(e||yl());return er(r,{locale:i,weekStartsOn:t})}function Qi(r){return Lu(r)}function Vn(r){return Sa(r)}function ph(r){return _o(r)}function mh(){return Hr(Ye())}function gh(r){return Au(r)}function hg(r){return Pf(r)}function ug(r){return Ou(r)}function Si(r,e){return r&&e?A0(r,e):!r&&!e}function Yt(r,e){return r&&e?F0(r,e):!r&&!e}function na(r,e){return r&&e?M0(r,e):!r&&!e}function Ie(r,e){return r&&e?Of(r,e):!r&&!e}function Or(r,e){return r&&e?Op(r,e):!r&&!e}function Un(r,e,t){var i,n=Hr(e),s=Au(t);try{i=ts(r,{start:n,end:s})}catch{i=!1}return i}function yl(){var r=rc();return r.__localeId__}function Tn(r){if(typeof r=="string"){var e=rc();return e.__localeData__?e.__localeData__[r]:void 0}else return r}function cg(r,e,t){return e(ot(r,"EEEE",t))}function dg(r,e){return ot(r,"EEEEEE",e)}function fg(r,e){return ot(r,"EEE",e)}function El(r,e){return ot(ci(Ye(),r),"LLLL",e)}function sc(r,e){return ot(ci(Ye(),r),"LLL",e)}function pg(r,e){return ot(tn(Ye(),r),"QQQ",e)}function di(r,e){var t=e===void 0?{}:e,i=t.minDate,n=t.maxDate,s=t.excludeDates,a=t.excludeDateIntervals,o=t.includeDates,l=t.includeDateIntervals,h=t.filterDate;return ps(r,{minDate:i,maxDate:n})||s&&s.some(function(u){return u instanceof Date?Ie(r,u):Ie(r,u.date)})||a&&a.some(function(u){var d=u.start,c=u.end;return ts(r,{start:d,end:c})})||o&&!o.some(function(u){return Ie(r,u)})||l&&!l.some(function(u){var d=u.start,c=u.end;return ts(r,{start:d,end:c})})||h&&!h(Ye(r))||!1}function Cl(r,e){var t=e===void 0?{}:e,i=t.excludeDates,n=t.excludeDateIntervals;return n&&n.length>0?n.some(function(s){var a=s.start,o=s.end;return ts(r,{start:a,end:o})}):i&&i.some(function(s){var a;return s instanceof Date?Ie(r,s):Ie(r,(a=s.date)!==null&&a!==void 0?a:new Date)})||!1}function ac(r,e){var t=e===void 0?{}:e,i=t.minDate,n=t.maxDate,s=t.excludeDates,a=t.includeDates,o=t.filterDate;return ps(r,{minDate:i?Lu(i):void 0,maxDate:n?Ou(n):void 0})||(s==null?void 0:s.some(function(l){return Yt(r,l instanceof Date?l:l.date)}))||a&&!a.some(function(l){return Yt(r,l)})||o&&!o(Ye(r))||!1}function Ts(r,e,t,i){var n=Re(r),s=Bt(r),a=Re(e),o=Bt(e),l=Re(i);return n===a&&n===l?s<=t&&t<=o:n<a?l===n&&s<=t||l===a&&o>=t||l<a&&l>n:!1}function mg(r,e){var t=e===void 0?{}:e,i=t.minDate,n=t.maxDate,s=t.excludeDates,a=t.includeDates;return ps(r,{minDate:i,maxDate:n})||s&&s.some(function(o){return Yt(o instanceof Date?o:o.date,r)})||a&&!a.some(function(o){return Yt(o,r)})||!1}function Ss(r,e){var t=e===void 0?{}:e,i=t.minDate,n=t.maxDate,s=t.excludeDates,a=t.includeDates,o=t.filterDate;return ps(r,{minDate:i,maxDate:n})||(s==null?void 0:s.some(function(l){return na(r,l instanceof Date?l:l.date)}))||a&&!a.some(function(l){return na(r,l)})||o&&!o(Ye(r))||!1}function Ds(r,e,t){if(!e||!t||!$s(e)||!$s(t))return!1;var i=Re(e),n=Re(t);return i<=r&&n>=r}function Us(r,e){var t=e===void 0?{}:e,i=t.minDate,n=t.maxDate,s=t.excludeDates,a=t.includeDates,o=t.filterDate,l=new Date(r,0,1);return ps(l,{minDate:i?Sa(i):void 0,maxDate:n?Pu(n):void 0})||(s==null?void 0:s.some(function(h){return Si(l,h instanceof Date?h:h.date)}))||a&&!a.some(function(h){return Si(l,h)})||o&&!o(Ye(l))||!1}function ks(r,e,t,i){var n=Re(r),s=Lr(r),a=Re(e),o=Lr(e),l=Re(i);return n===a&&n===l?s<=t&&t<=o:n<a?l===n&&s<=t||l===a&&o>=t||l<a&&l>n:!1}function ps(r,e){var t,i=e===void 0?{}:e,n=i.minDate,s=i.maxDate;return(t=n&&xn(r,n)<0||s&&xn(r,s)>0)!==null&&t!==void 0?t:!1}function vh(r,e){return e.some(function(t){return $i(t)===$i(r)&&Ki(t)===Ki(r)&&mr(t)===mr(r)})}function bh(r,e){var t=e===void 0?{}:e,i=t.excludeTimes,n=t.includeTimes,s=t.filterTime;return i&&vh(r,i)||n&&!vh(r,n)||s&&!s(r)||!1}function wh(r,e){var t=e.minTime,i=e.maxTime;if(!t||!i)throw new Error("Both minTime and maxTime props required");var n=Ye();n=Bs(n,$i(r)),n=Hs(n,Ki(r)),n=zs(n,mr(r));var s=Ye();s=Bs(s,$i(t)),s=Hs(s,Ki(t)),s=zs(s,mr(t));var a=Ye();a=Bs(a,$i(i)),a=Hs(a,Ki(i)),a=zs(a,mr(i));var o;try{o=!ts(n,{start:s,end:a})}catch{o=!1}return o}function xh(r,e){var t=e===void 0?{}:e,i=t.minDate,n=t.includeDates,s=Pr(r,1);return i&&Ks(i,s)>0||n&&n.every(function(a){return Ks(a,s)>0})||!1}function yh(r,e){var t=e===void 0?{}:e,i=t.maxDate,n=t.includeDates,s=yi(r,1);return i&&Ks(s,i)>0||n&&n.every(function(a){return Ks(s,a)>0})||!1}function gg(r,e){var t=e===void 0?{}:e,i=t.minDate,n=t.includeDates,s=Sa(r),a=Yu(s);return i&&Qs(i,a)>0||n&&n.every(function(o){return Qs(o,a)>0})||!1}function vg(r,e){var t=e===void 0?{}:e,i=t.maxDate,n=t.includeDates,s=Pu(r),a=ul(s,1);return i&&Qs(a,i)>0||n&&n.every(function(o){return Qs(a,o)>0})||!1}function Eh(r,e){var t=e===void 0?{}:e,i=t.minDate,n=t.includeDates,s=yn(r,1);return i&&qs(i,s)>0||n&&n.every(function(a){return qs(a,s)>0})||!1}function bg(r,e){var t=e===void 0?{}:e,i=t.minDate,n=t.yearItemNumber,s=n===void 0?fs:n,a=Vn(yn(r,s)),o=fr(a,s).endPeriod,l=i&&Re(i);return l&&l>o||!1}function Ch(r,e){var t=e===void 0?{}:e,i=t.maxDate,n=t.includeDates,s=ji(r,1);return i&&qs(s,i)>0||n&&n.every(function(a){return qs(s,a)>0})||!1}function wg(r,e){var t=e===void 0?{}:e,i=t.maxDate,n=t.yearItemNumber,s=n===void 0?fs:n,a=ji(r,s),o=fr(a,s).startPeriod,l=i&&Re(i);return l&&l<o||!1}function oc(r){var e=r.minDate,t=r.includeDates;if(t&&e){var i=t.filter(function(n){return xn(n,e)>=0});return ql(i)}else return t?ql(t):e}function lc(r){var e=r.maxDate,t=r.includeDates;if(t&&e){var i=t.filter(function(n){return xn(n,e)<=0});return Ql(i)}else return t?Ql(t):e}function _h(r,e){var t;r===void 0&&(r=[]),e===void 0&&(e="react-datepicker__day--highlighted");for(var i=new Map,n=0,s=r.length;n<s;n++){var a=r[n];if(Xi(a)){var o=ot(a,"MM.dd.yyyy"),l=i.get(o)||[];l.includes(e)||(l.push(e),i.set(o,l))}else if(typeof a=="object"){var h=Object.keys(a),u=(t=h[0])!==null&&t!==void 0?t:"",d=a[u];if(typeof u=="string"&&Array.isArray(d))for(var c=0,f=d.length;c<f;c++){var p=d[c];if(p){var o=ot(p,"MM.dd.yyyy"),l=i.get(o)||[];l.includes(u)||(l.push(u),i.set(o,l))}}}}return i}function xg(r,e){return r.length!==e.length?!1:r.every(function(t,i){return t===e[i]})}function yg(r,e){r===void 0&&(r=[]),e===void 0&&(e="react-datepicker__day--holidays");var t=new Map;return r.forEach(function(i){var n=i.date,s=i.holidayName;if(Xi(n)){var a=ot(n,"MM.dd.yyyy"),o=t.get(a)||{className:"",holidayNames:[]};if(!("className"in o&&o.className===e&&xg(o.holidayNames,[s]))){o.className=e;var l=o.holidayNames;o.holidayNames=l?Oi(Oi([],l,!0),[s],!1):[s],t.set(a,o)}}}),t}function Eg(r,e,t,i,n){for(var s=n.length,a=[],o=0;o<s;o++){var l=r,h=n[o];h&&(l=Rf(l,$i(h)),l=Co(l,Ki(h)),l=Af(l,mr(h)));var u=Co(r,(t+1)*i);vr(l,e)&&zr(l,u)&&h!=null&&a.push(h)}return a}function Th(r){return r<10?"0".concat(r):"".concat(r)}function fr(r,e){e===void 0&&(e=fs);var t=Math.ceil(Re(r)/e)*e,i=t-(e-1);return{startPeriod:i,endPeriod:t}}function Cg(r){var e=new Date(r.getFullYear(),r.getMonth(),r.getDate()),t=new Date(r.getFullYear(),r.getMonth(),r.getDate(),24);return Math.round((+t-+e)/36e5)}function Sh(r){var e=r.getSeconds(),t=r.getMilliseconds();return ve(r.getTime()-e*1e3-t)}function _g(r,e){return Sh(r).getTime()===Sh(e).getTime()}function Dh(r){if(!Xi(r))throw new Error("Invalid date");var e=new Date(r);return e.setHours(0,0,0,0),e}function kh(r,e){if(!Xi(r)||!Xi(e))throw new Error("Invalid date received");var t=Dh(r),i=Dh(e);return zr(t,i)}function hc(r){return r.key===ue.Space}var Tg=function(r){St(e,r);function e(t){var i=r.call(this,t)||this;return i.inputRef=j.createRef(),i.onTimeChange=function(n){var s,a;i.setState({time:n});var o=i.props.date,l=o instanceof Date&&!isNaN(+o),h=l?o:new Date;if(n!=null&&n.includes(":")){var u=n.split(":"),d=u[0],c=u[1];h.setHours(Number(d)),h.setMinutes(Number(c))}(a=(s=i.props).onChange)===null||a===void 0||a.call(s,h)},i.renderTimeInput=function(){var n=i.state.time,s=i.props,a=s.date,o=s.timeString,l=s.customTimeInput;return l?ie.cloneElement(l,{date:a,value:n,onChange:i.onTimeChange}):j.createElement("input",{type:"time",className:"react-datepicker-time__input",placeholder:"Time",name:"time-input",ref:i.inputRef,onClick:function(){var h;(h=i.inputRef.current)===null||h===void 0||h.focus()},required:!0,value:n,onChange:function(h){i.onTimeChange(h.target.value||o)}})},i.state={time:i.props.timeString},i}return e.getDerivedStateFromProps=function(t,i){return t.timeString!==i.time?{time:t.timeString}:null},e.prototype.render=function(){return j.createElement("div",{className:"react-datepicker__input-time-container"},j.createElement("div",{className:"react-datepicker-time__caption"},this.props.timeInputLabel),j.createElement("div",{className:"react-datepicker-time__input-container"},j.createElement("div",{className:"react-datepicker-time__input"},this.renderTimeInput())))},e}(ie.Component),Sg=function(r){St(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.dayEl=ie.createRef(),t.handleClick=function(i){!t.isDisabled()&&t.props.onClick&&t.props.onClick(i)},t.handleMouseEnter=function(i){!t.isDisabled()&&t.props.onMouseEnter&&t.props.onMouseEnter(i)},t.handleOnKeyDown=function(i){var n,s,a=i.key;a===ue.Space&&(i.preventDefault(),i.key=ue.Enter),(s=(n=t.props).handleOnKeyDown)===null||s===void 0||s.call(n,i)},t.isSameDay=function(i){return Ie(t.props.day,i)},t.isKeyboardSelected=function(){var i;if(t.props.disabledKeyboardNavigation)return!1;var n=t.props.selectsMultiple?(i=t.props.selectedDates)===null||i===void 0?void 0:i.some(function(a){return t.isSameDayOrWeek(a)}):t.isSameDayOrWeek(t.props.selected),s=t.props.preSelection&&t.isDisabled(t.props.preSelection);return!n&&t.isSameDayOrWeek(t.props.preSelection)&&!s},t.isDisabled=function(i){return i===void 0&&(i=t.props.day),di(i,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(){return Cl(t.props.day,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.isStartOfWeek=function(){return Ie(t.props.day,gr(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameWeek=function(i){return t.props.showWeekPicker&&Ie(i,gr(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameDayOrWeek=function(i){return t.isSameDay(i)||t.isSameWeek(i)},t.getHighLightedClass=function(){var i=t.props,n=i.day,s=i.highlightDates;if(!s)return!1;var a=ot(n,"MM.dd.yyyy");return s.get(a)},t.getHolidaysClass=function(){var i,n=t.props,s=n.day,a=n.holidays;if(!a)return[void 0];var o=ot(s,"MM.dd.yyyy");return a.has(o)?[(i=a.get(o))===null||i===void 0?void 0:i.className]:[void 0]},t.isInRange=function(){var i=t.props,n=i.day,s=i.startDate,a=i.endDate;return!s||!a?!1:Un(n,s,a)},t.isInSelectingRange=function(){var i,n=t.props,s=n.day,a=n.selectsStart,o=n.selectsEnd,l=n.selectsRange,h=n.selectsDisabledDaysInRange,u=n.startDate,d=n.endDate,c=(i=t.props.selectingDate)!==null&&i!==void 0?i:t.props.preSelection;return!(a||o||l)||!c||!h&&t.isDisabled()?!1:a&&d&&(zr(c,d)||Or(c,d))?Un(s,c,d):o&&u&&(vr(c,u)||Or(c,u))||l&&u&&!d&&(vr(c,u)||Or(c,u))?Un(s,u,c):!1},t.isSelectingRangeStart=function(){var i;if(!t.isInSelectingRange())return!1;var n=t.props,s=n.day,a=n.startDate,o=n.selectsStart,l=(i=t.props.selectingDate)!==null&&i!==void 0?i:t.props.preSelection;return o?Ie(s,l):Ie(s,a)},t.isSelectingRangeEnd=function(){var i;if(!t.isInSelectingRange())return!1;var n=t.props,s=n.day,a=n.endDate,o=n.selectsEnd,l=n.selectsRange,h=(i=t.props.selectingDate)!==null&&i!==void 0?i:t.props.preSelection;return o||l?Ie(s,h):Ie(s,a)},t.isRangeStart=function(){var i=t.props,n=i.day,s=i.startDate,a=i.endDate;return!s||!a?!1:Ie(s,n)},t.isRangeEnd=function(){var i=t.props,n=i.day,s=i.startDate,a=i.endDate;return!s||!a?!1:Ie(a,n)},t.isWeekend=function(){var i=Rp(t.props.day);return i===0||i===6},t.isAfterMonth=function(){return t.props.month!==void 0&&(t.props.month+1)%12===Bt(t.props.day)},t.isBeforeMonth=function(){return t.props.month!==void 0&&(Bt(t.props.day)+1)%12===t.props.month},t.isCurrentDay=function(){return t.isSameDay(Ye())},t.isSelected=function(){var i;return t.props.selectsMultiple?(i=t.props.selectedDates)===null||i===void 0?void 0:i.some(function(n){return t.isSameDayOrWeek(n)}):t.isSameDayOrWeek(t.props.selected)},t.getClassNames=function(i){var n=t.props.dayClassName?t.props.dayClassName(i):void 0;return Rt("react-datepicker__day",n,"react-datepicker__day--"+lg(t.props.day),{"react-datepicker__day--disabled":t.isDisabled(),"react-datepicker__day--excluded":t.isExcluded(),"react-datepicker__day--selected":t.isSelected(),"react-datepicker__day--keyboard-selected":t.isKeyboardSelected(),"react-datepicker__day--range-start":t.isRangeStart(),"react-datepicker__day--range-end":t.isRangeEnd(),"react-datepicker__day--in-range":t.isInRange(),"react-datepicker__day--in-selecting-range":t.isInSelectingRange(),"react-datepicker__day--selecting-range-start":t.isSelectingRangeStart(),"react-datepicker__day--selecting-range-end":t.isSelectingRangeEnd(),"react-datepicker__day--today":t.isCurrentDay(),"react-datepicker__day--weekend":t.isWeekend(),"react-datepicker__day--outside-month":t.isAfterMonth()||t.isBeforeMonth()},t.getHighLightedClass(),t.getHolidaysClass())},t.getAriaLabel=function(){var i=t.props,n=i.day,s=i.ariaLabelPrefixWhenEnabled,a=s===void 0?"Choose":s,o=i.ariaLabelPrefixWhenDisabled,l=o===void 0?"Not available":o,h=t.isDisabled()||t.isExcluded()?l:a;return"".concat(h," ").concat(ot(n,"PPPP",t.props.locale))},t.getTitle=function(){var i=t.props,n=i.day,s=i.holidays,a=s===void 0?new Map:s,o=i.excludeDates,l=ot(n,"MM.dd.yyyy"),h=[];return a.has(l)&&h.push.apply(h,a.get(l).holidayNames),t.isExcluded()&&h.push(o==null?void 0:o.filter(function(u){return u instanceof Date?Ie(u,n):Ie(u==null?void 0:u.date,n)}).map(function(u){if(!(u instanceof Date))return u==null?void 0:u.message})),h.join(", ")},t.getTabIndex=function(){var i=t.props.selected,n=t.props.preSelection,s=!(t.props.showWeekPicker&&(t.props.showWeekNumber||!t.isStartOfWeek()))&&(t.isKeyboardSelected()||t.isSameDay(i)&&Ie(n,i))?0:-1;return s},t.handleFocusDay=function(){var i;t.shouldFocusDay()&&((i=t.dayEl.current)===null||i===void 0||i.focus({preventScroll:!0}))},t.renderDayContents=function(){return t.props.monthShowsDuplicateDaysEnd&&t.isAfterMonth()||t.props.monthShowsDuplicateDaysStart&&t.isBeforeMonth()?null:t.props.renderDayContents?t.props.renderDayContents(nh(t.props.day),t.props.day):nh(t.props.day)},t.render=function(){return j.createElement("div",{ref:t.dayEl,className:t.getClassNames(t.props.day),onKeyDown:t.handleOnKeyDown,onClick:t.handleClick,onMouseEnter:t.props.usePointerEvent?void 0:t.handleMouseEnter,onPointerEnter:t.props.usePointerEvent?t.handleMouseEnter:void 0,tabIndex:t.getTabIndex(),"aria-label":t.getAriaLabel(),role:"option",title:t.getTitle(),"aria-disabled":t.isDisabled(),"aria-current":t.isCurrentDay()?"date":void 0,"aria-selected":t.isSelected()||t.isInRange()},t.renderDayContents(),t.getTitle()!==""&&j.createElement("span",{className:"overlay"},t.getTitle()))},t}return e.prototype.componentDidMount=function(){this.handleFocusDay()},e.prototype.componentDidUpdate=function(){this.handleFocusDay()},e.prototype.shouldFocusDay=function(){var t=!1;return this.getTabIndex()===0&&this.isSameDay(this.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(t=!0),this.props.inline&&!this.props.shouldFocusDayInline&&(t=!1),this.isDayActiveElement()&&(t=!0),this.isDuplicateDay()&&(t=!1)),t},e.prototype.isDayActiveElement=function(){var t,i,n;return((i=(t=this.props.containerRef)===null||t===void 0?void 0:t.current)===null||i===void 0?void 0:i.contains(document.activeElement))&&((n=document.activeElement)===null||n===void 0?void 0:n.classList.contains("react-datepicker__day"))},e.prototype.isDuplicateDay=function(){return this.props.monthShowsDuplicateDaysEnd&&this.isAfterMonth()||this.props.monthShowsDuplicateDaysStart&&this.isBeforeMonth()},e}(ie.Component),Dg=function(r){St(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.weekNumberEl=ie.createRef(),t.handleClick=function(i){t.props.onClick&&t.props.onClick(i)},t.handleOnKeyDown=function(i){var n,s,a=i.key;a===ue.Space&&(i.preventDefault(),i.key=ue.Enter),(s=(n=t.props).handleOnKeyDown)===null||s===void 0||s.call(n,i)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!Ie(t.props.date,t.props.selected)&&Ie(t.props.date,t.props.preSelection)},t.getTabIndex=function(){return t.props.showWeekPicker&&t.props.showWeekNumber&&(t.isKeyboardSelected()||Ie(t.props.date,t.props.selected)&&Ie(t.props.preSelection,t.props.selected))?0:-1},t.handleFocusWeekNumber=function(i){var n=!1;t.getTabIndex()===0&&!(i!=null&&i.isInputFocused)&&Ie(t.props.date,t.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(n=!0),t.props.inline&&!t.props.shouldFocusDayInline&&(n=!1),t.props.containerRef&&t.props.containerRef.current&&t.props.containerRef.current.contains(document.activeElement)&&document.activeElement&&document.activeElement.classList.contains("react-datepicker__week-number")&&(n=!0)),n&&t.weekNumberEl.current&&t.weekNumberEl.current.focus({preventScroll:!0})},t}return Object.defineProperty(e,"defaultProps",{get:function(){return{ariaLabelPrefix:"week "}},enumerable:!1,configurable:!0}),e.prototype.componentDidMount=function(){this.handleFocusWeekNumber()},e.prototype.componentDidUpdate=function(t){this.handleFocusWeekNumber(t)},e.prototype.render=function(){var t=this.props,i=t.weekNumber,n=t.isWeekDisabled,s=t.ariaLabelPrefix,a=s===void 0?e.defaultProps.ariaLabelPrefix:s,o=t.onClick,l={"react-datepicker__week-number":!0,"react-datepicker__week-number--clickable":!!o&&!n,"react-datepicker__week-number--selected":!!o&&Ie(this.props.date,this.props.selected)};return j.createElement("div",{ref:this.weekNumberEl,className:Rt(l),"aria-label":"".concat(a," ").concat(this.props.weekNumber),onClick:this.handleClick,onKeyDown:this.handleOnKeyDown,tabIndex:this.getTabIndex()},i)},e}(ie.Component),kg=function(r){St(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.isDisabled=function(i){return di(i,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.handleDayClick=function(i,n){t.props.onDayClick&&t.props.onDayClick(i,n)},t.handleDayMouseEnter=function(i){t.props.onDayMouseEnter&&t.props.onDayMouseEnter(i)},t.handleWeekClick=function(i,n,s){for(var a,o,l,h=new Date(i),u=0;u<7;u++){var d=new Date(i);d.setDate(d.getDate()+u);var c=!t.isDisabled(d);if(c){h=d;break}}typeof t.props.onWeekSelect=="function"&&t.props.onWeekSelect(h,n,s),t.props.showWeekPicker&&t.handleDayClick(h,s),((a=t.props.shouldCloseOnSelect)!==null&&a!==void 0?a:e.defaultProps.shouldCloseOnSelect)&&((l=(o=t.props).setOpen)===null||l===void 0||l.call(o,!1))},t.formatWeekNumber=function(i){return t.props.formatWeekNumber?t.props.formatWeekNumber(i):og(i)},t.isWeekDisabled=function(){for(var i=t.startOfWeek(),n=wi(i,6),s=new Date(i);s<=n;){if(!t.isDisabled(s))return!1;s=wi(s,1)}return!0},t.renderDays=function(){var i=t.startOfWeek(),n=[],s=t.formatWeekNumber(i);if(t.props.showWeekNumber){var a=t.props.onWeekSelect||t.props.showWeekPicker?t.handleWeekClick.bind(t,i,s):void 0;n.push(j.createElement(Dg,Be({key:"W"},e.defaultProps,t.props,{weekNumber:s,isWeekDisabled:t.isWeekDisabled(),date:i,onClick:a})))}return n.concat([0,1,2,3,4,5,6].map(function(o){var l=wi(i,o);return j.createElement(Sg,Be({},e.defaultProps,t.props,{ariaLabelPrefixWhenEnabled:t.props.chooseDayAriaLabelPrefix,ariaLabelPrefixWhenDisabled:t.props.disabledDayAriaLabelPrefix,key:l.valueOf(),day:l,onClick:t.handleDayClick.bind(t,l),onMouseEnter:t.handleDayMouseEnter.bind(t,l)}))}))},t.startOfWeek=function(){return gr(t.props.day,t.props.locale,t.props.calendarStartDay)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!Ie(t.startOfWeek(),t.props.selected)&&Ie(t.startOfWeek(),t.props.preSelection)},t}return Object.defineProperty(e,"defaultProps",{get:function(){return{shouldCloseOnSelect:!0}},enumerable:!1,configurable:!0}),e.prototype.render=function(){var t={"react-datepicker__week":!0,"react-datepicker__week--selected":Ie(this.startOfWeek(),this.props.selected),"react-datepicker__week--keyboard-selected":this.isKeyboardSelected()};return j.createElement("div",{className:Rt(t)},this.renderDays())},e}(ie.Component),Hn,Rg=6,cn={TWO_COLUMNS:"two_columns",THREE_COLUMNS:"three_columns",FOUR_COLUMNS:"four_columns"},to=(Hn={},Hn[cn.TWO_COLUMNS]={grid:[[0,1],[2,3],[4,5],[6,7],[8,9],[10,11]],verticalNavigationOffset:2},Hn[cn.THREE_COLUMNS]={grid:[[0,1,2],[3,4,5],[6,7,8],[9,10,11]],verticalNavigationOffset:3},Hn[cn.FOUR_COLUMNS]={grid:[[0,1,2,3],[4,5,6,7],[8,9,10,11]],verticalNavigationOffset:4},Hn),Rs=1;function Rh(r,e){return r?cn.FOUR_COLUMNS:e?cn.TWO_COLUMNS:cn.THREE_COLUMNS}var Fg=function(r){St(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.MONTH_REFS=Oi([],Array(12),!0).map(function(){return ie.createRef()}),t.QUARTER_REFS=Oi([],Array(4),!0).map(function(){return ie.createRef()}),t.isDisabled=function(i){return di(i,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(i){return Cl(i,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.handleDayClick=function(i,n){var s,a;(a=(s=t.props).onDayClick)===null||a===void 0||a.call(s,i,n,t.props.orderInDisplay)},t.handleDayMouseEnter=function(i){var n,s;(s=(n=t.props).onDayMouseEnter)===null||s===void 0||s.call(n,i)},t.handleMouseLeave=function(){var i,n;(n=(i=t.props).onMouseLeave)===null||n===void 0||n.call(i)},t.isRangeStartMonth=function(i){var n=t.props,s=n.day,a=n.startDate,o=n.endDate;return!a||!o?!1:Yt(ci(s,i),a)},t.isRangeStartQuarter=function(i){var n=t.props,s=n.day,a=n.startDate,o=n.endDate;return!a||!o?!1:na(tn(s,i),a)},t.isRangeEndMonth=function(i){var n=t.props,s=n.day,a=n.startDate,o=n.endDate;return!a||!o?!1:Yt(ci(s,i),o)},t.isRangeEndQuarter=function(i){var n=t.props,s=n.day,a=n.startDate,o=n.endDate;return!a||!o?!1:na(tn(s,i),o)},t.isInSelectingRangeMonth=function(i){var n,s=t.props,a=s.day,o=s.selectsStart,l=s.selectsEnd,h=s.selectsRange,u=s.startDate,d=s.endDate,c=(n=t.props.selectingDate)!==null&&n!==void 0?n:t.props.preSelection;return!(o||l||h)||!c?!1:o&&d?Ts(c,d,i,a):l&&u||h&&u&&!d?Ts(u,c,i,a):!1},t.isSelectingMonthRangeStart=function(i){var n;if(!t.isInSelectingRangeMonth(i))return!1;var s=t.props,a=s.day,o=s.startDate,l=s.selectsStart,h=ci(a,i),u=(n=t.props.selectingDate)!==null&&n!==void 0?n:t.props.preSelection;return l?Yt(h,u):Yt(h,o)},t.isSelectingMonthRangeEnd=function(i){var n;if(!t.isInSelectingRangeMonth(i))return!1;var s=t.props,a=s.day,o=s.endDate,l=s.selectsEnd,h=s.selectsRange,u=ci(a,i),d=(n=t.props.selectingDate)!==null&&n!==void 0?n:t.props.preSelection;return l||h?Yt(u,d):Yt(u,o)},t.isInSelectingRangeQuarter=function(i){var n,s=t.props,a=s.day,o=s.selectsStart,l=s.selectsEnd,h=s.selectsRange,u=s.startDate,d=s.endDate,c=(n=t.props.selectingDate)!==null&&n!==void 0?n:t.props.preSelection;return!(o||l||h)||!c?!1:o&&d?ks(c,d,i,a):l&&u||h&&u&&!d?ks(u,c,i,a):!1},t.isWeekInMonth=function(i){var n=t.props.day,s=wi(i,6);return Yt(i,n)||Yt(s,n)},t.isCurrentMonth=function(i,n){return Re(i)===Re(Ye())&&n===Bt(Ye())},t.isCurrentQuarter=function(i,n){return Re(i)===Re(Ye())&&n===Lr(Ye())},t.isSelectedMonth=function(i,n,s){return Bt(s)===n&&Re(i)===Re(s)},t.isSelectMonthInList=function(i,n,s){return s.some(function(a){return t.isSelectedMonth(i,n,a)})},t.isSelectedQuarter=function(i,n,s){return Lr(i)===n&&Re(i)===Re(s)},t.isMonthSelected=function(){var i=t.props,n=i.day,s=i.selected,a=i.selectedDates,o=i.selectsMultiple,l=Bt(n);return o?a==null?void 0:a.some(function(h){return t.isSelectedMonth(n,l,h)}):!!s&&t.isSelectedMonth(n,l,s)},t.renderWeeks=function(){for(var i=[],n=t.props.fixedHeight,s=0,a=!1,o=gr(Qi(t.props.day),t.props.locale,t.props.calendarStartDay),l=function(p){return t.props.showWeekPicker?gr(p,t.props.locale,t.props.calendarStartDay):t.props.preSelection},h=function(p){return t.props.showWeekPicker?gr(p,t.props.locale,t.props.calendarStartDay):t.props.selected},u=t.props.selected?h(t.props.selected):void 0,d=t.props.preSelection?l(t.props.preSelection):void 0;i.push(j.createElement(kg,Be({},t.props,{ariaLabelPrefix:t.props.weekAriaLabelPrefix,key:s,day:o,month:Bt(t.props.day),onDayClick:t.handleDayClick,onDayMouseEnter:t.handleDayMouseEnter,selected:u,preSelection:d,showWeekNumber:t.props.showWeekNumbers}))),!a;){s++,o=Xs(o,1);var c=n&&s>=Rg,f=!n&&!t.isWeekInMonth(o);if(c||f)if(t.props.peekNextMonth)a=!0;else break}return i},t.onMonthClick=function(i,n){var s=t.isMonthDisabledForLabelDate(n),a=s.isDisabled,o=s.labelDate;a||t.handleDayClick(Qi(o),i)},t.onMonthMouseEnter=function(i){var n=t.isMonthDisabledForLabelDate(i),s=n.isDisabled,a=n.labelDate;s||t.handleDayMouseEnter(Qi(a))},t.handleMonthNavigation=function(i,n){var s,a,o,l;(a=(s=t.props).setPreSelection)===null||a===void 0||a.call(s,n),(l=(o=t.MONTH_REFS[i])===null||o===void 0?void 0:o.current)===null||l===void 0||l.focus()},t.handleKeyboardNavigation=function(i,n,s){var a,o=t.props,l=o.selected,h=o.preSelection,u=o.setPreSelection,d=o.minDate,c=o.maxDate,f=o.showFourColumnMonthYearPicker,p=o.showTwoColumnMonthYearPicker;if(h){var v=Rh(f,p),m=t.getVerticalOffset(v),g=(a=to[v])===null||a===void 0?void 0:a.grid,x=function(y,R,M){var I,P,N=R,ne=M;switch(y){case ue.ArrowRight:N=yi(R,Rs),ne=M===11?0:M+Rs;break;case ue.ArrowLeft:N=Pr(R,Rs),ne=M===0?11:M-Rs;break;case ue.ArrowUp:N=Pr(R,m),ne=!((I=g==null?void 0:g[0])===null||I===void 0)&&I.includes(M)?M+12-m:M-m;break;case ue.ArrowDown:N=yi(R,m),ne=!((P=g==null?void 0:g[g.length-1])===null||P===void 0)&&P.includes(M)?M-12+m:M+m;break}return{newCalculatedDate:N,newCalculatedMonth:ne}},b=function(y,R,M){for(var I=40,P=y,N=!1,ne=0,he=x(P,R,M),se=he.newCalculatedDate,fe=he.newCalculatedMonth;!N;){if(ne>=I){se=R,fe=M;break}if(d&&se<d){P=ue.ArrowRight;var ee=x(P,se,fe);se=ee.newCalculatedDate,fe=ee.newCalculatedMonth}if(c&&se>c){P=ue.ArrowLeft;var ee=x(P,se,fe);se=ee.newCalculatedDate,fe=ee.newCalculatedMonth}if(mg(se,t.props)){var ee=x(P,se,fe);se=ee.newCalculatedDate,fe=ee.newCalculatedMonth}else N=!0;ne++}return{newCalculatedDate:se,newCalculatedMonth:fe}};if(n===ue.Enter){t.isMonthDisabled(s)||(t.onMonthClick(i,s),u==null||u(l));return}var F=b(n,h,s),A=F.newCalculatedDate,_=F.newCalculatedMonth;switch(n){case ue.ArrowRight:case ue.ArrowLeft:case ue.ArrowUp:case ue.ArrowDown:t.handleMonthNavigation(_,A);break}}},t.getVerticalOffset=function(i){var n,s;return(s=(n=to[i])===null||n===void 0?void 0:n.verticalNavigationOffset)!==null&&s!==void 0?s:0},t.onMonthKeyDown=function(i,n){var s=t.props,a=s.disabledKeyboardNavigation,o=s.handleOnMonthKeyDown,l=i.key;l!==ue.Tab&&i.preventDefault(),a||t.handleKeyboardNavigation(i,l,n),o&&o(i)},t.onQuarterClick=function(i,n){var s=tn(t.props.day,n);Ss(s,t.props)||t.handleDayClick(ph(s),i)},t.onQuarterMouseEnter=function(i){var n=tn(t.props.day,i);Ss(n,t.props)||t.handleDayMouseEnter(ph(n))},t.handleQuarterNavigation=function(i,n){var s,a,o,l;t.isDisabled(n)||t.isExcluded(n)||((a=(s=t.props).setPreSelection)===null||a===void 0||a.call(s,n),(l=(o=t.QUARTER_REFS[i-1])===null||o===void 0?void 0:o.current)===null||l===void 0||l.focus())},t.onQuarterKeyDown=function(i,n){var s,a,o=i.key;if(!t.props.disabledKeyboardNavigation)switch(o){case ue.Enter:t.onQuarterClick(i,n),(a=(s=t.props).setPreSelection)===null||a===void 0||a.call(s,t.props.selected);break;case ue.ArrowRight:if(!t.props.preSelection)break;t.handleQuarterNavigation(n===4?1:n+1,ul(t.props.preSelection,1));break;case ue.ArrowLeft:if(!t.props.preSelection)break;t.handleQuarterNavigation(n===1?4:n-1,Yu(t.props.preSelection));break}},t.isMonthDisabledForLabelDate=function(i){var n,s=t.props,a=s.day,o=s.minDate,l=s.maxDate,h=s.excludeDates,u=s.includeDates,d=ci(a,i);return{isDisabled:(n=(o||l||h||u)&&ac(d,t.props))!==null&&n!==void 0?n:!1,labelDate:d}},t.isMonthDisabled=function(i){var n=t.isMonthDisabledForLabelDate(i).isDisabled;return n},t.getMonthClassNames=function(i){var n=t.props,s=n.day,a=n.startDate,o=n.endDate,l=n.preSelection,h=n.monthClassName,u=h?h(ci(s,i)):void 0,d=t.getSelection();return Rt("react-datepicker__month-text","react-datepicker__month-".concat(i),u,{"react-datepicker__month-text--disabled":t.isMonthDisabled(i),"react-datepicker__month-text--selected":d?t.isSelectMonthInList(s,i,d):void 0,"react-datepicker__month-text--keyboard-selected":!t.props.disabledKeyboardNavigation&&l&&t.isSelectedMonth(s,i,l)&&!t.isMonthSelected()&&!t.isMonthDisabled(i),"react-datepicker__month-text--in-selecting-range":t.isInSelectingRangeMonth(i),"react-datepicker__month-text--in-range":a&&o?Ts(a,o,i,s):void 0,"react-datepicker__month-text--range-start":t.isRangeStartMonth(i),"react-datepicker__month-text--range-end":t.isRangeEndMonth(i),"react-datepicker__month-text--selecting-range-start":t.isSelectingMonthRangeStart(i),"react-datepicker__month-text--selecting-range-end":t.isSelectingMonthRangeEnd(i),"react-datepicker__month-text--today":t.isCurrentMonth(s,i)})},t.getTabIndex=function(i){if(t.props.preSelection==null)return"-1";var n=Bt(t.props.preSelection),s=t.isMonthDisabledForLabelDate(n).isDisabled,a=i===n&&!(s||t.props.disabledKeyboardNavigation)?"0":"-1";return a},t.getQuarterTabIndex=function(i){if(t.props.preSelection==null)return"-1";var n=Lr(t.props.preSelection),s=Ss(t.props.day,t.props),a=i===n&&!(s||t.props.disabledKeyboardNavigation)?"0":"-1";return a},t.getAriaLabel=function(i){var n=t.props,s=n.chooseDayAriaLabelPrefix,a=s===void 0?"Choose":s,o=n.disabledDayAriaLabelPrefix,l=o===void 0?"Not available":o,h=n.day,u=n.locale,d=ci(h,i),c=t.isDisabled(d)||t.isExcluded(d)?l:a;return"".concat(c," ").concat(ot(d,"MMMM yyyy",u))},t.getQuarterClassNames=function(i){var n=t.props,s=n.day,a=n.startDate,o=n.endDate,l=n.selected,h=n.minDate,u=n.maxDate,d=n.excludeDates,c=n.includeDates,f=n.filterDate,p=n.preSelection,v=n.disabledKeyboardNavigation,m=(h||u||d||c||f)&&Ss(tn(s,i),t.props);return Rt("react-datepicker__quarter-text","react-datepicker__quarter-".concat(i),{"react-datepicker__quarter-text--disabled":m,"react-datepicker__quarter-text--selected":l?t.isSelectedQuarter(s,i,l):void 0,"react-datepicker__quarter-text--keyboard-selected":!v&&p&&t.isSelectedQuarter(s,i,p)&&!m,"react-datepicker__quarter-text--in-selecting-range":t.isInSelectingRangeQuarter(i),"react-datepicker__quarter-text--in-range":a&&o?ks(a,o,i,s):void 0,"react-datepicker__quarter-text--range-start":t.isRangeStartQuarter(i),"react-datepicker__quarter-text--range-end":t.isRangeEndQuarter(i),"react-datepicker__quarter-text--today":t.isCurrentQuarter(s,i)})},t.getMonthContent=function(i){var n=t.props,s=n.showFullMonthYearPicker,a=n.renderMonthContent,o=n.locale,l=n.day,h=sc(i,o),u=El(i,o);return a?a(i,h,u,l):s?u:h},t.getQuarterContent=function(i){var n,s=t.props,a=s.renderQuarterContent,o=s.locale,l=pg(i,o);return(n=a==null?void 0:a(i,l))!==null&&n!==void 0?n:l},t.renderMonths=function(){var i,n=t.props,s=n.showTwoColumnMonthYearPicker,a=n.showFourColumnMonthYearPicker,o=n.day,l=n.selected,h=(i=to[Rh(a,s)])===null||i===void 0?void 0:i.grid;return h==null?void 0:h.map(function(u,d){return j.createElement("div",{className:"react-datepicker__month-wrapper",key:d},u.map(function(c,f){return j.createElement("div",{ref:t.MONTH_REFS[c],key:f,onClick:function(p){t.onMonthClick(p,c)},onKeyDown:function(p){hc(p)&&(p.preventDefault(),p.key=ue.Enter),t.onMonthKeyDown(p,c)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onMonthMouseEnter(c)},onPointerEnter:t.props.usePointerEvent?function(){return t.onMonthMouseEnter(c)}:void 0,tabIndex:Number(t.getTabIndex(c)),className:t.getMonthClassNames(c),"aria-disabled":t.isMonthDisabled(c),role:"option","aria-label":t.getAriaLabel(c),"aria-current":t.isCurrentMonth(o,c)?"date":void 0,"aria-selected":l?t.isSelectedMonth(o,c,l):void 0},t.getMonthContent(c))}))})},t.renderQuarters=function(){var i=t.props,n=i.day,s=i.selected,a=[1,2,3,4];return j.createElement("div",{className:"react-datepicker__quarter-wrapper"},a.map(function(o,l){return j.createElement("div",{key:l,ref:t.QUARTER_REFS[l],role:"option",onClick:function(h){t.onQuarterClick(h,o)},onKeyDown:function(h){t.onQuarterKeyDown(h,o)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onQuarterMouseEnter(o)},onPointerEnter:t.props.usePointerEvent?function(){return t.onQuarterMouseEnter(o)}:void 0,className:t.getQuarterClassNames(o),"aria-selected":s?t.isSelectedQuarter(n,o,s):void 0,tabIndex:Number(t.getQuarterTabIndex(o)),"aria-current":t.isCurrentQuarter(n,o)?"date":void 0},t.getQuarterContent(o))}))},t.getClassNames=function(){var i=t.props,n=i.selectingDate,s=i.selectsStart,a=i.selectsEnd,o=i.showMonthYearPicker,l=i.showQuarterYearPicker,h=i.showWeekPicker;return Rt("react-datepicker__month",{"react-datepicker__month--selecting-range":n&&(s||a)},{"react-datepicker__monthPicker":o},{"react-datepicker__quarterPicker":l},{"react-datepicker__weekPicker":h})},t}return e.prototype.getSelection=function(){var t=this.props,i=t.selected,n=t.selectedDates,s=t.selectsMultiple;if(s)return n;if(i)return[i]},e.prototype.render=function(){var t=this.props,i=t.showMonthYearPicker,n=t.showQuarterYearPicker,s=t.day,a=t.ariaLabelPrefix,o=a===void 0?"Month ":a,l=o?o.trim()+" ":"";return j.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":"".concat(l).concat(ot(s,"MMMM, yyyy",this.props.locale)),role:"listbox"},i?this.renderMonths():n?this.renderQuarters():this.renderWeeks())},e}(ie.Component),Mg=function(r){St(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.isSelectedMonth=function(i){return t.props.month===i},t.renderOptions=function(){return t.props.monthNames.map(function(i,n){return j.createElement("div",{className:t.isSelectedMonth(n)?"react-datepicker__month-option react-datepicker__month-option--selected_month":"react-datepicker__month-option",key:i,onClick:t.onChange.bind(t,n),"aria-selected":t.isSelectedMonth(n)?"true":void 0},t.isSelectedMonth(n)?j.createElement("span",{className:"react-datepicker__month-option--selected"},""):"",i)})},t.onChange=function(i){return t.props.onChange(i)},t.handleClickOutside=function(){return t.props.onCancel()},t}return e.prototype.render=function(){return j.createElement(Ma,{className:"react-datepicker__month-dropdown",onClickOutside:this.handleClickOutside},this.renderOptions())},e}(ie.Component),Ag=function(r){St(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(i){return i.map(function(n,s){return j.createElement("option",{key:n,value:s},n)})},t.renderSelectMode=function(i){return j.createElement("select",{value:t.props.month,className:"react-datepicker__month-select",onChange:function(n){return t.onChange(parseInt(n.target.value))}},t.renderSelectOptions(i))},t.renderReadView=function(i,n){return j.createElement("div",{key:"read",style:{visibility:i?"visible":"hidden"},className:"react-datepicker__month-read-view",onClick:t.toggleDropdown},j.createElement("span",{className:"react-datepicker__month-read-view--down-arrow"}),j.createElement("span",{className:"react-datepicker__month-read-view--selected-month"},n[t.props.month]))},t.renderDropdown=function(i){return j.createElement(Mg,Be({key:"dropdown"},t.props,{monthNames:i,onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(i){var n=t.state.dropdownVisible,s=[t.renderReadView(!n,i)];return n&&s.unshift(t.renderDropdown(i)),s},t.onChange=function(i){t.toggleDropdown(),i!==t.props.month&&t.props.onChange(i)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return e.prototype.render=function(){var t=this,i=[0,1,2,3,4,5,6,7,8,9,10,11].map(this.props.useShortMonthInDropdown?function(s){return sc(s,t.props.locale)}:function(s){return El(s,t.props.locale)}),n;switch(this.props.dropdownMode){case"scroll":n=this.renderScrollMode(i);break;case"select":n=this.renderSelectMode(i);break}return j.createElement("div",{className:"react-datepicker__month-dropdown-container react-datepicker__month-dropdown-container--".concat(this.props.dropdownMode)},n)},e}(ie.Component);function Og(r,e){for(var t=[],i=Qi(r),n=Qi(e);!vr(i,n);)t.push(Ye(i)),i=yi(i,1);return t}var Lg=function(r){St(e,r);function e(t){var i=r.call(this,t)||this;return i.renderOptions=function(){return i.state.monthYearsList.map(function(n){var s=So(n),a=Si(i.props.date,n)&&Yt(i.props.date,n);return j.createElement("div",{className:a?"react-datepicker__month-year-option--selected_month-year":"react-datepicker__month-year-option",key:s,onClick:i.onChange.bind(i,s),"aria-selected":a?"true":void 0},a?j.createElement("span",{className:"react-datepicker__month-year-option--selected"},""):"",ot(n,i.props.dateFormat,i.props.locale))})},i.onChange=function(n){return i.props.onChange(n)},i.handleClickOutside=function(){i.props.onCancel()},i.state={monthYearsList:Og(i.props.minDate,i.props.maxDate)},i}return e.prototype.render=function(){var t=Rt({"react-datepicker__month-year-dropdown":!0,"react-datepicker__month-year-dropdown--scrollable":this.props.scrollableMonthYearDropdown});return j.createElement(Ma,{className:t,onClickOutside:this.handleClickOutside},this.renderOptions())},e}(ie.Component),Pg=function(r){St(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var i=Qi(t.props.minDate),n=Qi(t.props.maxDate),s=[];!vr(i,n);){var a=So(i);s.push(j.createElement("option",{key:a,value:a},ot(i,t.props.dateFormat,t.props.locale))),i=yi(i,1)}return s},t.onSelectChange=function(i){t.onChange(parseInt(i.target.value))},t.renderSelectMode=function(){return j.createElement("select",{value:So(Qi(t.props.date)),className:"react-datepicker__month-year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(i){var n=ot(t.props.date,t.props.dateFormat,t.props.locale);return j.createElement("div",{key:"read",style:{visibility:i?"visible":"hidden"},className:"react-datepicker__month-year-read-view",onClick:t.toggleDropdown},j.createElement("span",{className:"react-datepicker__month-year-read-view--down-arrow"}),j.createElement("span",{className:"react-datepicker__month-year-read-view--selected-month-year"},n))},t.renderDropdown=function(){return j.createElement(Lg,Be({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var i=t.state.dropdownVisible,n=[t.renderReadView(!i)];return i&&n.unshift(t.renderDropdown()),n},t.onChange=function(i){t.toggleDropdown();var n=Ye(i);Si(t.props.date,n)&&Yt(t.props.date,n)||t.props.onChange(n)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return e.prototype.render=function(){var t;switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode();break;case"select":t=this.renderSelectMode();break}return j.createElement("div",{className:"react-datepicker__month-year-dropdown-container react-datepicker__month-year-dropdown-container--".concat(this.props.dropdownMode)},t)},e}(ie.Component),Ng=function(r){St(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.state={height:null},t.scrollToTheSelectedTime=function(){requestAnimationFrame(function(){var i,n,s;t.list&&(t.list.scrollTop=(s=t.centerLi&&e.calcCenterPosition(t.props.monthRef?t.props.monthRef.clientHeight-((n=(i=t.header)===null||i===void 0?void 0:i.clientHeight)!==null&&n!==void 0?n:0):t.list.clientHeight,t.centerLi))!==null&&s!==void 0?s:0)})},t.handleClick=function(i){var n,s;(t.props.minTime||t.props.maxTime)&&wh(i,t.props)||(t.props.excludeTimes||t.props.includeTimes||t.props.filterTime)&&bh(i,t.props)||(s=(n=t.props).onChange)===null||s===void 0||s.call(n,i)},t.isSelectedTime=function(i){return t.props.selected&&_g(t.props.selected,i)},t.isDisabledTime=function(i){return(t.props.minTime||t.props.maxTime)&&wh(i,t.props)||(t.props.excludeTimes||t.props.includeTimes||t.props.filterTime)&&bh(i,t.props)},t.liClasses=function(i){var n,s=["react-datepicker__time-list-item",t.props.timeClassName?t.props.timeClassName(i):void 0];return t.isSelectedTime(i)&&s.push("react-datepicker__time-list-item--selected"),t.isDisabledTime(i)&&s.push("react-datepicker__time-list-item--disabled"),t.props.injectTimes&&($i(i)*3600+Ki(i)*60+mr(i))%(((n=t.props.intervals)!==null&&n!==void 0?n:e.defaultProps.intervals)*60)!==0&&s.push("react-datepicker__time-list-item--injected"),s.join(" ")},t.handleOnKeyDown=function(i,n){var s,a;i.key===ue.Space&&(i.preventDefault(),i.key=ue.Enter),(i.key===ue.ArrowUp||i.key===ue.ArrowLeft)&&i.target instanceof HTMLElement&&i.target.previousSibling&&(i.preventDefault(),i.target.previousSibling instanceof HTMLElement&&i.target.previousSibling.focus()),(i.key===ue.ArrowDown||i.key===ue.ArrowRight)&&i.target instanceof HTMLElement&&i.target.nextSibling&&(i.preventDefault(),i.target.nextSibling instanceof HTMLElement&&i.target.nextSibling.focus()),i.key===ue.Enter&&t.handleClick(n),(a=(s=t.props).handleOnKeyDown)===null||a===void 0||a.call(s,i)},t.renderTimes=function(){for(var i,n=[],s=typeof t.props.format=="string"?t.props.format:"p",a=(i=t.props.intervals)!==null&&i!==void 0?i:e.defaultProps.intervals,o=t.props.selected||t.props.openToDate||Ye(),l=Vs(o),h=t.props.injectTimes&&t.props.injectTimes.sort(function(m,g){return m.getTime()-g.getTime()}),u=60*Cg(o),d=u/a,c=0;c<d;c++){var f=Co(l,c*a);if(n.push(f),h){var p=Eg(l,f,c,a,h);n=n.concat(p)}}var v=n.reduce(function(m,g){return g.getTime()<=o.getTime()?g:m},n[0]);return n.map(function(m){return j.createElement("li",{key:m.valueOf(),onClick:t.handleClick.bind(t,m),className:t.liClasses(m),ref:function(g){m===v&&(t.centerLi=g)},onKeyDown:function(g){t.handleOnKeyDown(g,m)},tabIndex:m===v?0:-1,role:"option","aria-selected":t.isSelectedTime(m)?"true":void 0,"aria-disabled":t.isDisabledTime(m)?"true":void 0},ot(m,s,t.props.locale))})},t.renderTimeCaption=function(){return t.props.showTimeCaption===!1?j.createElement(j.Fragment,null):j.createElement("div",{className:"react-datepicker__header react-datepicker__header--time ".concat(t.props.showTimeSelectOnly?"react-datepicker__header--time--only":""),ref:function(i){t.header=i}},j.createElement("div",{className:"react-datepicker-time__header"},t.props.timeCaption))},t}return Object.defineProperty(e,"defaultProps",{get:function(){return{intervals:30,todayButton:null,timeCaption:"Time",showTimeCaption:!0}},enumerable:!1,configurable:!0}),e.prototype.componentDidMount=function(){this.scrollToTheSelectedTime(),this.observeDatePickerHeightChanges()},e.prototype.componentWillUnmount=function(){var t;(t=this.resizeObserver)===null||t===void 0||t.disconnect()},e.prototype.observeDatePickerHeightChanges=function(){var t=this,i=this.props.monthRef;this.updateContainerHeight(),i&&(this.resizeObserver=new ResizeObserver(function(){t.updateContainerHeight()}),this.resizeObserver.observe(i))},e.prototype.updateContainerHeight=function(){this.props.monthRef&&this.header&&this.setState({height:this.props.monthRef.clientHeight-this.header.clientHeight})},e.prototype.render=function(){var t=this,i,n=this.state.height;return j.createElement("div",{className:"react-datepicker__time-container ".concat(((i=this.props.todayButton)!==null&&i!==void 0?i:e.defaultProps.todayButton)?"react-datepicker__time-container--with-today-button":"")},this.renderTimeCaption(),j.createElement("div",{className:"react-datepicker__time"},j.createElement("div",{className:"react-datepicker__time-box"},j.createElement("ul",{className:"react-datepicker__time-list",ref:function(s){t.list=s},style:n?{height:n}:{},role:"listbox","aria-label":this.props.timeCaption},this.renderTimes()))))},e.calcCenterPosition=function(t,i){return i.offsetTop-(t/2-i.clientHeight/2)},e}(ie.Component),Fh=3,Ig=function(r){St(e,r);function e(t){var i=r.call(this,t)||this;return i.YEAR_REFS=Oi([],Array(i.props.yearItemNumber),!0).map(function(){return ie.createRef()}),i.isDisabled=function(n){return di(n,{minDate:i.props.minDate,maxDate:i.props.maxDate,excludeDates:i.props.excludeDates,includeDates:i.props.includeDates,filterDate:i.props.filterDate})},i.isExcluded=function(n){return Cl(n,{excludeDates:i.props.excludeDates})},i.selectingDate=function(){var n;return(n=i.props.selectingDate)!==null&&n!==void 0?n:i.props.preSelection},i.updateFocusOnPaginate=function(n){var s=function(){var a,o;(o=(a=i.YEAR_REFS[n])===null||a===void 0?void 0:a.current)===null||o===void 0||o.focus()};window.requestAnimationFrame(s)},i.handleYearClick=function(n,s){i.props.onDayClick&&i.props.onDayClick(n,s)},i.handleYearNavigation=function(n,s){var a,o,l,h,u=i.props,d=u.date,c=u.yearItemNumber;if(!(d===void 0||c===void 0)){var f=fr(d,c).startPeriod;i.isDisabled(s)||i.isExcluded(s)||((o=(a=i.props).setPreSelection)===null||o===void 0||o.call(a,s),n-f<0?i.updateFocusOnPaginate(c-(f-n)):n-f>=c?i.updateFocusOnPaginate(Math.abs(c-(n-f))):(h=(l=i.YEAR_REFS[n-f])===null||l===void 0?void 0:l.current)===null||h===void 0||h.focus())}},i.isSameDay=function(n,s){return Ie(n,s)},i.isCurrentYear=function(n){return n===Re(Ye())},i.isRangeStart=function(n){return i.props.startDate&&i.props.endDate&&Si(Ti(Ye(),n),i.props.startDate)},i.isRangeEnd=function(n){return i.props.startDate&&i.props.endDate&&Si(Ti(Ye(),n),i.props.endDate)},i.isInRange=function(n){return Ds(n,i.props.startDate,i.props.endDate)},i.isInSelectingRange=function(n){var s=i.props,a=s.selectsStart,o=s.selectsEnd,l=s.selectsRange,h=s.startDate,u=s.endDate;return!(a||o||l)||!i.selectingDate()?!1:a&&u?Ds(n,i.selectingDate(),u):o&&h||l&&h&&!u?Ds(n,h,i.selectingDate()):!1},i.isSelectingRangeStart=function(n){var s;if(!i.isInSelectingRange(n))return!1;var a=i.props,o=a.startDate,l=a.selectsStart,h=Ti(Ye(),n);return l?Si(h,(s=i.selectingDate())!==null&&s!==void 0?s:null):Si(h,o??null)},i.isSelectingRangeEnd=function(n){var s;if(!i.isInSelectingRange(n))return!1;var a=i.props,o=a.endDate,l=a.selectsEnd,h=a.selectsRange,u=Ti(Ye(),n);return l||h?Si(u,(s=i.selectingDate())!==null&&s!==void 0?s:null):Si(u,o??null)},i.isKeyboardSelected=function(n){if(!(i.props.date===void 0||i.props.selected==null||i.props.preSelection==null)){var s=i.props,a=s.minDate,o=s.maxDate,l=s.excludeDates,h=s.includeDates,u=s.filterDate,d=Vn(Ti(i.props.date,n)),c=(a||o||l||h||u)&&Us(n,i.props);return!i.props.disabledKeyboardNavigation&&!i.props.inline&&!Ie(d,Vn(i.props.selected))&&Ie(d,Vn(i.props.preSelection))&&!c}},i.isSelectedYear=function(n){var s=i.props,a=s.selectsMultiple,o=s.selected,l=s.selectedDates;return a?l==null?void 0:l.some(function(h){return n===Re(h)}):!!o&&n===Re(o)},i.onYearClick=function(n,s){var a=i.props.date;a!==void 0&&i.handleYearClick(Vn(Ti(a,s)),n)},i.onYearKeyDown=function(n,s){var a,o,l=n.key,h=i.props,u=h.date,d=h.yearItemNumber,c=h.handleOnKeyDown;if(l!==ue.Tab&&n.preventDefault(),!i.props.disabledKeyboardNavigation)switch(l){case ue.Enter:if(i.props.selected==null)break;i.onYearClick(n,s),(o=(a=i.props).setPreSelection)===null||o===void 0||o.call(a,i.props.selected);break;case ue.ArrowRight:if(i.props.preSelection==null)break;i.handleYearNavigation(s+1,ji(i.props.preSelection,1));break;case ue.ArrowLeft:if(i.props.preSelection==null)break;i.handleYearNavigation(s-1,yn(i.props.preSelection,1));break;case ue.ArrowUp:{if(u===void 0||d===void 0||i.props.preSelection==null)break;var f=fr(u,d).startPeriod,p=Fh,v=s-p;if(v<f){var m=d%p;s>=f&&s<f+m?p=m:p+=m,v=s-p}i.handleYearNavigation(v,yn(i.props.preSelection,p));break}case ue.ArrowDown:{if(u===void 0||d===void 0||i.props.preSelection==null)break;var g=fr(u,d).endPeriod,p=Fh,v=s+p;if(v>g){var m=d%p;s<=g&&s>g-m?p=m:p+=m,v=s+p}i.handleYearNavigation(v,ji(i.props.preSelection,p));break}}c&&c(n)},i.getYearClassNames=function(n){var s=i.props,a=s.date,o=s.minDate,l=s.maxDate,h=s.excludeDates,u=s.includeDates,d=s.filterDate,c=s.yearClassName;return Rt("react-datepicker__year-text","react-datepicker__year-".concat(n),a?c==null?void 0:c(Ti(a,n)):void 0,{"react-datepicker__year-text--selected":i.isSelectedYear(n),"react-datepicker__year-text--disabled":(o||l||h||u||d)&&Us(n,i.props),"react-datepicker__year-text--keyboard-selected":i.isKeyboardSelected(n),"react-datepicker__year-text--range-start":i.isRangeStart(n),"react-datepicker__year-text--range-end":i.isRangeEnd(n),"react-datepicker__year-text--in-range":i.isInRange(n),"react-datepicker__year-text--in-selecting-range":i.isInSelectingRange(n),"react-datepicker__year-text--selecting-range-start":i.isSelectingRangeStart(n),"react-datepicker__year-text--selecting-range-end":i.isSelectingRangeEnd(n),"react-datepicker__year-text--today":i.isCurrentYear(n)})},i.getYearTabIndex=function(n){if(i.props.disabledKeyboardNavigation||i.props.preSelection==null)return"-1";var s=Re(i.props.preSelection),a=Us(n,i.props);return n===s&&!a?"0":"-1"},i.getYearContent=function(n){return i.props.renderYearContent?i.props.renderYearContent(n):n},i}return e.prototype.render=function(){var t=this,i=[],n=this.props,s=n.date,a=n.yearItemNumber,o=n.onYearMouseEnter,l=n.onYearMouseLeave;if(s===void 0)return null;for(var h=fr(s,a),u=h.startPeriod,d=h.endPeriod,c=function(v){i.push(j.createElement("div",{ref:f.YEAR_REFS[v-u],onClick:function(m){t.onYearClick(m,v)},onKeyDown:function(m){hc(m)&&(m.preventDefault(),m.key=ue.Enter),t.onYearKeyDown(m,v)},tabIndex:Number(f.getYearTabIndex(v)),className:f.getYearClassNames(v),onMouseEnter:f.props.usePointerEvent?void 0:function(m){return o(m,v)},onPointerEnter:f.props.usePointerEvent?function(m){return o(m,v)}:void 0,onMouseLeave:f.props.usePointerEvent?void 0:function(m){return l(m,v)},onPointerLeave:f.props.usePointerEvent?function(m){return l(m,v)}:void 0,key:v,"aria-current":f.isCurrentYear(v)?"date":void 0},f.getYearContent(v)))},f=this,p=u;p<=d;p++)c(p);return j.createElement("div",{className:"react-datepicker__year"},j.createElement("div",{className:"react-datepicker__year-wrapper",onMouseLeave:this.props.usePointerEvent?void 0:this.props.clearSelectingDate,onPointerLeave:this.props.usePointerEvent?this.props.clearSelectingDate:void 0},i))},e}(ie.Component);function Bg(r,e,t,i){for(var n=[],s=0;s<2*e+1;s++){var a=r+e-s,o=!0;t&&(o=Re(t)<=a),i&&o&&(o=Re(i)>=a),o&&n.push(a)}return n}var Hg=function(r){St(e,r);function e(t){var i=r.call(this,t)||this;i.renderOptions=function(){var o=i.props.year,l=i.state.yearsList.map(function(d){return j.createElement("div",{className:o===d?"react-datepicker__year-option react-datepicker__year-option--selected_year":"react-datepicker__year-option",key:d,onClick:i.onChange.bind(i,d),"aria-selected":o===d?"true":void 0},o===d?j.createElement("span",{className:"react-datepicker__year-option--selected"},""):"",d)}),h=i.props.minDate?Re(i.props.minDate):null,u=i.props.maxDate?Re(i.props.maxDate):null;return(!u||!i.state.yearsList.find(function(d){return d===u}))&&l.unshift(j.createElement("div",{className:"react-datepicker__year-option",key:"upcoming",onClick:i.incrementYears},j.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-upcoming"}))),(!h||!i.state.yearsList.find(function(d){return d===h}))&&l.push(j.createElement("div",{className:"react-datepicker__year-option",key:"previous",onClick:i.decrementYears},j.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-previous"}))),l},i.onChange=function(o){i.props.onChange(o)},i.handleClickOutside=function(){i.props.onCancel()},i.shiftYears=function(o){var l=i.state.yearsList.map(function(h){return h+o});i.setState({yearsList:l})},i.incrementYears=function(){return i.shiftYears(1)},i.decrementYears=function(){return i.shiftYears(-1)};var n=t.yearDropdownItemNumber,s=t.scrollableYearDropdown,a=n||(s?10:5);return i.state={yearsList:Bg(i.props.year,a,i.props.minDate,i.props.maxDate)},i.dropdownRef=ie.createRef(),i}return e.prototype.componentDidMount=function(){var t=this.dropdownRef.current;if(t){var i=t.children?Array.from(t.children):null,n=i?i.find(function(s){return s.ariaSelected}):null;t.scrollTop=n&&n instanceof HTMLElement?n.offsetTop+(n.clientHeight-t.clientHeight)/2:(t.scrollHeight-t.clientHeight)/2}},e.prototype.render=function(){var t=Rt({"react-datepicker__year-dropdown":!0,"react-datepicker__year-dropdown--scrollable":this.props.scrollableYearDropdown});return j.createElement(Ma,{className:t,containerRef:this.dropdownRef,onClickOutside:this.handleClickOutside},this.renderOptions())},e}(ie.Component),zg=function(r){St(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var i=t.props.minDate?Re(t.props.minDate):1900,n=t.props.maxDate?Re(t.props.maxDate):2100,s=[],a=i;a<=n;a++)s.push(j.createElement("option",{key:a,value:a},a));return s},t.onSelectChange=function(i){t.onChange(parseInt(i.target.value))},t.renderSelectMode=function(){return j.createElement("select",{value:t.props.year,className:"react-datepicker__year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(i){return j.createElement("div",{key:"read",style:{visibility:i?"visible":"hidden"},className:"react-datepicker__year-read-view",onClick:function(n){return t.toggleDropdown(n)}},j.createElement("span",{className:"react-datepicker__year-read-view--down-arrow"}),j.createElement("span",{className:"react-datepicker__year-read-view--selected-year"},t.props.year))},t.renderDropdown=function(){return j.createElement(Hg,Be({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var i=t.state.dropdownVisible,n=[t.renderReadView(!i)];return i&&n.unshift(t.renderDropdown()),n},t.onChange=function(i){t.toggleDropdown(),i!==t.props.year&&t.props.onChange(i)},t.toggleDropdown=function(i){t.setState({dropdownVisible:!t.state.dropdownVisible},function(){t.props.adjustDateOnChange&&t.handleYearChange(t.props.date,i)})},t.handleYearChange=function(i,n){var s;(s=t.onSelect)===null||s===void 0||s.call(t,i,n),t.setOpen()},t.onSelect=function(i,n){var s,a;(a=(s=t.props).onSelect)===null||a===void 0||a.call(s,i,n)},t.setOpen=function(){var i,n;(n=(i=t.props).setOpen)===null||n===void 0||n.call(i,!0)},t}return e.prototype.render=function(){var t;switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode();break;case"select":t=this.renderSelectMode();break}return j.createElement("div",{className:"react-datepicker__year-dropdown-container react-datepicker__year-dropdown-container--".concat(this.props.dropdownMode)},t)},e}(ie.Component),Wg=["react-datepicker__year-select","react-datepicker__month-select","react-datepicker__month-year-select"],Vg=function(r){var e=(r.className||"").split(/\s+/);return Wg.some(function(t){return e.indexOf(t)>=0})},Ug=function(r){St(e,r);function e(t){var i=r.call(this,t)||this;return i.monthContainer=void 0,i.handleClickOutside=function(n){i.props.onClickOutside(n)},i.setClickOutsideRef=function(){return i.containerRef.current},i.handleDropdownFocus=function(n){var s,a;Vg(n.target)&&((a=(s=i.props).onDropdownFocus)===null||a===void 0||a.call(s,n))},i.getDateInView=function(){var n=i.props,s=n.preSelection,a=n.selected,o=n.openToDate,l=oc(i.props),h=lc(i.props),u=Ye(),d=o||a||s;return d||(l&&zr(u,l)?l:h&&vr(u,h)?h:u)},i.increaseMonth=function(){i.setState(function(n){var s=n.date;return{date:yi(s,1)}},function(){return i.handleMonthChange(i.state.date)})},i.decreaseMonth=function(){i.setState(function(n){var s=n.date;return{date:Pr(s,1)}},function(){return i.handleMonthChange(i.state.date)})},i.handleDayClick=function(n,s,a){i.props.onSelect(n,s,a),i.props.setPreSelection&&i.props.setPreSelection(n)},i.handleDayMouseEnter=function(n){i.setState({selectingDate:n}),i.props.onDayMouseEnter&&i.props.onDayMouseEnter(n)},i.handleMonthMouseLeave=function(){i.setState({selectingDate:void 0}),i.props.onMonthMouseLeave&&i.props.onMonthMouseLeave()},i.handleYearMouseEnter=function(n,s){i.setState({selectingDate:Ti(Ye(),s)}),i.props.onYearMouseEnter&&i.props.onYearMouseEnter(n,s)},i.handleYearMouseLeave=function(n,s){i.props.onYearMouseLeave&&i.props.onYearMouseLeave(n,s)},i.handleYearChange=function(n){var s,a,o,l;(a=(s=i.props).onYearChange)===null||a===void 0||a.call(s,n),i.setState({isRenderAriaLiveMessage:!0}),i.props.adjustDateOnChange&&(i.props.onSelect(n),(l=(o=i.props).setOpen)===null||l===void 0||l.call(o,!0)),i.props.setPreSelection&&i.props.setPreSelection(n)},i.getEnabledPreSelectionDateForMonth=function(n){if(!di(n,i.props))return n;for(var s=Qi(n),a=ug(n),o=Lf(a,s),l=null,h=0;h<=o;h++){var u=wi(s,h);if(!di(u,i.props)){l=u;break}}return l},i.handleMonthChange=function(n){var s,a,o,l=(s=i.getEnabledPreSelectionDateForMonth(n))!==null&&s!==void 0?s:n;i.handleCustomMonthChange(l),i.props.adjustDateOnChange&&(i.props.onSelect(l),(o=(a=i.props).setOpen)===null||o===void 0||o.call(a,!0)),i.props.setPreSelection&&i.props.setPreSelection(l)},i.handleCustomMonthChange=function(n){var s,a;(a=(s=i.props).onMonthChange)===null||a===void 0||a.call(s,n),i.setState({isRenderAriaLiveMessage:!0})},i.handleMonthYearChange=function(n){i.handleYearChange(n),i.handleMonthChange(n)},i.changeYear=function(n){i.setState(function(s){var a=s.date;return{date:Ti(a,Number(n))}},function(){return i.handleYearChange(i.state.date)})},i.changeMonth=function(n){i.setState(function(s){var a=s.date;return{date:ci(a,Number(n))}},function(){return i.handleMonthChange(i.state.date)})},i.changeMonthYear=function(n){i.setState(function(s){var a=s.date;return{date:Ti(ci(a,Bt(n)),Re(n))}},function(){return i.handleMonthYearChange(i.state.date)})},i.header=function(n){n===void 0&&(n=i.state.date);var s=gr(n,i.props.locale,i.props.calendarStartDay),a=[];return i.props.showWeekNumbers&&a.push(j.createElement("div",{key:"W",className:"react-datepicker__day-name"},i.props.weekLabel||"#")),a.concat([0,1,2,3,4,5,6].map(function(o){var l=wi(s,o),h=i.formatWeekday(l,i.props.locale),u=i.props.weekDayClassName?i.props.weekDayClassName(l):void 0;return j.createElement("div",{key:o,"aria-label":ot(l,"EEEE",i.props.locale),className:Rt("react-datepicker__day-name",u)},h)}))},i.formatWeekday=function(n,s){return i.props.formatWeekDay?cg(n,i.props.formatWeekDay,s):i.props.useWeekdaysShort?fg(n,s):dg(n,s)},i.decreaseYear=function(){i.setState(function(n){var s,a=n.date;return{date:yn(a,i.props.showYearPicker?(s=i.props.yearItemNumber)!==null&&s!==void 0?s:e.defaultProps.yearItemNumber:1)}},function(){return i.handleYearChange(i.state.date)})},i.clearSelectingDate=function(){i.setState({selectingDate:void 0})},i.renderPreviousButton=function(){var n,s,a;if(!i.props.renderCustomHeader){var o=(n=i.props.monthsShown)!==null&&n!==void 0?n:e.defaultProps.monthsShown,l=i.props.showPreviousMonths?o-1:0,h=(s=i.props.monthSelectedIn)!==null&&s!==void 0?s:l,u=Pr(i.state.date,h),d;switch(!0){case i.props.showMonthYearPicker:d=Eh(i.state.date,i.props);break;case i.props.showYearPicker:d=bg(i.state.date,i.props);break;case i.props.showQuarterYearPicker:d=gg(i.state.date,i.props);break;default:d=xh(u,i.props);break}if(!(!((a=i.props.forceShowMonthNavigation)!==null&&a!==void 0?a:e.defaultProps.forceShowMonthNavigation)&&!i.props.showDisabledMonthNavigation&&d||i.props.showTimeSelectOnly)){var c=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--previous"],f=["react-datepicker__navigation","react-datepicker__navigation--previous"],p=i.decreaseMonth;(i.props.showMonthYearPicker||i.props.showQuarterYearPicker||i.props.showYearPicker)&&(p=i.decreaseYear),d&&i.props.showDisabledMonthNavigation&&(f.push("react-datepicker__navigation--previous--disabled"),p=void 0);var v=i.props.showMonthYearPicker||i.props.showQuarterYearPicker||i.props.showYearPicker,m=i.props,g=m.previousMonthButtonLabel,x=g===void 0?e.defaultProps.previousMonthButtonLabel:g,b=m.previousYearButtonLabel,F=b===void 0?e.defaultProps.previousYearButtonLabel:b,A=i.props,_=A.previousMonthAriaLabel,y=_===void 0?typeof x=="string"?x:"Previous Month":_,R=A.previousYearAriaLabel,M=R===void 0?typeof F=="string"?F:"Previous Year":R;return j.createElement("button",{type:"button",className:f.join(" "),onClick:p,onKeyDown:i.props.handleOnKeyDown,"aria-label":v?M:y},j.createElement("span",{className:c.join(" ")},v?F:x))}}},i.increaseYear=function(){i.setState(function(n){var s,a=n.date;return{date:ji(a,i.props.showYearPicker?(s=i.props.yearItemNumber)!==null&&s!==void 0?s:e.defaultProps.yearItemNumber:1)}},function(){return i.handleYearChange(i.state.date)})},i.renderNextButton=function(){var n;if(!i.props.renderCustomHeader){var s;switch(!0){case i.props.showMonthYearPicker:s=Ch(i.state.date,i.props);break;case i.props.showYearPicker:s=wg(i.state.date,i.props);break;case i.props.showQuarterYearPicker:s=vg(i.state.date,i.props);break;default:s=yh(i.state.date,i.props);break}if(!(!((n=i.props.forceShowMonthNavigation)!==null&&n!==void 0?n:e.defaultProps.forceShowMonthNavigation)&&!i.props.showDisabledMonthNavigation&&s||i.props.showTimeSelectOnly)){var a=["react-datepicker__navigation","react-datepicker__navigation--next"],o=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--next"];i.props.showTimeSelect&&a.push("react-datepicker__navigation--next--with-time"),i.props.todayButton&&a.push("react-datepicker__navigation--next--with-today-button");var l=i.increaseMonth;(i.props.showMonthYearPicker||i.props.showQuarterYearPicker||i.props.showYearPicker)&&(l=i.increaseYear),s&&i.props.showDisabledMonthNavigation&&(a.push("react-datepicker__navigation--next--disabled"),l=void 0);var h=i.props.showMonthYearPicker||i.props.showQuarterYearPicker||i.props.showYearPicker,u=i.props,d=u.nextMonthButtonLabel,c=d===void 0?e.defaultProps.nextMonthButtonLabel:d,f=u.nextYearButtonLabel,p=f===void 0?e.defaultProps.nextYearButtonLabel:f,v=i.props,m=v.nextMonthAriaLabel,g=m===void 0?typeof c=="string"?c:"Next Month":m,x=v.nextYearAriaLabel,b=x===void 0?typeof p=="string"?p:"Next Year":x;return j.createElement("button",{type:"button",className:a.join(" "),onClick:l,onKeyDown:i.props.handleOnKeyDown,"aria-label":h?b:g},j.createElement("span",{className:o.join(" ")},h?p:c))}}},i.renderCurrentMonth=function(n){n===void 0&&(n=i.state.date);var s=["react-datepicker__current-month"];return i.props.showYearDropdown&&s.push("react-datepicker__current-month--hasYearDropdown"),i.props.showMonthDropdown&&s.push("react-datepicker__current-month--hasMonthDropdown"),i.props.showMonthYearDropdown&&s.push("react-datepicker__current-month--hasMonthYearDropdown"),j.createElement("h2",{className:s.join(" ")},ot(n,i.props.dateFormat,i.props.locale))},i.renderYearDropdown=function(n){if(n===void 0&&(n=!1),!(!i.props.showYearDropdown||n))return j.createElement(zg,Be({},e.defaultProps,i.props,{date:i.state.date,onChange:i.changeYear,year:Re(i.state.date)}))},i.renderMonthDropdown=function(n){if(n===void 0&&(n=!1),!(!i.props.showMonthDropdown||n))return j.createElement(Ag,Be({},e.defaultProps,i.props,{month:Bt(i.state.date),onChange:i.changeMonth}))},i.renderMonthYearDropdown=function(n){if(n===void 0&&(n=!1),!(!i.props.showMonthYearDropdown||n))return j.createElement(Pg,Be({},e.defaultProps,i.props,{date:i.state.date,onChange:i.changeMonthYear}))},i.handleTodayButtonClick=function(n){i.props.onSelect(mh(),n),i.props.setPreSelection&&i.props.setPreSelection(mh())},i.renderTodayButton=function(){if(!(!i.props.todayButton||i.props.showTimeSelectOnly))return j.createElement("div",{className:"react-datepicker__today-button",onClick:i.handleTodayButtonClick},i.props.todayButton)},i.renderDefaultHeader=function(n){var s=n.monthDate,a=n.i;return j.createElement("div",{className:"react-datepicker__header ".concat(i.props.showTimeSelect?"react-datepicker__header--has-time-select":"")},i.renderCurrentMonth(s),j.createElement("div",{className:"react-datepicker__header__dropdown react-datepicker__header__dropdown--".concat(i.props.dropdownMode),onFocus:i.handleDropdownFocus},i.renderMonthDropdown(a!==0),i.renderMonthYearDropdown(a!==0),i.renderYearDropdown(a!==0)),j.createElement("div",{className:"react-datepicker__day-names"},i.header(s)))},i.renderCustomHeader=function(n){var s,a,o=n.monthDate,l=n.i;if(i.props.showTimeSelect&&!i.state.monthContainer||i.props.showTimeSelectOnly)return null;var h=xh(i.state.date,i.props),u=yh(i.state.date,i.props),d=Eh(i.state.date,i.props),c=Ch(i.state.date,i.props),f=!i.props.showMonthYearPicker&&!i.props.showQuarterYearPicker&&!i.props.showYearPicker;return j.createElement("div",{className:"react-datepicker__header react-datepicker__header--custom",onFocus:i.props.onDropdownFocus},(a=(s=i.props).renderCustomHeader)===null||a===void 0?void 0:a.call(s,Be(Be({},i.state),{customHeaderCount:l,monthDate:o,changeMonth:i.changeMonth,changeYear:i.changeYear,decreaseMonth:i.decreaseMonth,increaseMonth:i.increaseMonth,decreaseYear:i.decreaseYear,increaseYear:i.increaseYear,prevMonthButtonDisabled:h,nextMonthButtonDisabled:u,prevYearButtonDisabled:d,nextYearButtonDisabled:c})),f&&j.createElement("div",{className:"react-datepicker__day-names"},i.header(o)))},i.renderYearHeader=function(n){var s=n.monthDate,a=i.props,o=a.showYearPicker,l=a.yearItemNumber,h=l===void 0?e.defaultProps.yearItemNumber:l,u=fr(s,h),d=u.startPeriod,c=u.endPeriod;return j.createElement("div",{className:"react-datepicker__header react-datepicker-year-header"},o?"".concat(d," - ").concat(c):Re(s))},i.renderHeader=function(n){var s=n.monthDate,a=n.i,o=a===void 0?0:a,l={monthDate:s,i:o};switch(!0){case i.props.renderCustomHeader!==void 0:return i.renderCustomHeader(l);case(i.props.showMonthYearPicker||i.props.showQuarterYearPicker||i.props.showYearPicker):return i.renderYearHeader(l);default:return i.renderDefaultHeader(l)}},i.renderMonths=function(){var n,s;if(!(i.props.showTimeSelectOnly||i.props.showYearPicker)){for(var a=[],o=(n=i.props.monthsShown)!==null&&n!==void 0?n:e.defaultProps.monthsShown,l=i.props.showPreviousMonths?o-1:0,h=i.props.showMonthYearPicker||i.props.showQuarterYearPicker?ji(i.state.date,l):Pr(i.state.date,l),u=(s=i.props.monthSelectedIn)!==null&&s!==void 0?s:l,d=0;d<o;++d){var c=d-u+l,f=i.props.showMonthYearPicker||i.props.showQuarterYearPicker?ji(h,c):yi(h,c),p="month-".concat(d),v=d<o-1,m=d>0;a.push(j.createElement("div",{key:p,ref:function(g){i.monthContainer=g??void 0},className:"react-datepicker__month-container"},i.renderHeader({monthDate:f,i:d}),j.createElement(Fg,Be({},e.defaultProps,i.props,{containerRef:i.containerRef,ariaLabelPrefix:i.props.monthAriaLabelPrefix,day:f,onDayClick:i.handleDayClick,handleOnKeyDown:i.props.handleOnDayKeyDown,handleOnMonthKeyDown:i.props.handleOnKeyDown,onDayMouseEnter:i.handleDayMouseEnter,onMouseLeave:i.handleMonthMouseLeave,orderInDisplay:d,selectingDate:i.state.selectingDate,monthShowsDuplicateDaysEnd:v,monthShowsDuplicateDaysStart:m}))))}return a}},i.renderYears=function(){if(!i.props.showTimeSelectOnly&&i.props.showYearPicker)return j.createElement("div",{className:"react-datepicker__year--container"},i.renderHeader({monthDate:i.state.date}),j.createElement(Ig,Be({},e.defaultProps,i.props,{selectingDate:i.state.selectingDate,date:i.state.date,onDayClick:i.handleDayClick,clearSelectingDate:i.clearSelectingDate,onYearMouseEnter:i.handleYearMouseEnter,onYearMouseLeave:i.handleYearMouseLeave})))},i.renderTimeSection=function(){if(i.props.showTimeSelect&&(i.state.monthContainer||i.props.showTimeSelectOnly))return j.createElement(Ng,Be({},e.defaultProps,i.props,{onChange:i.props.onTimeChange,format:i.props.timeFormat,intervals:i.props.timeIntervals,monthRef:i.state.monthContainer}))},i.renderInputTimeSection=function(){var n=i.props.selected?new Date(i.props.selected):void 0,s=n&&Aa(n)&&!!i.props.selected,a=s?"".concat(Th(n.getHours()),":").concat(Th(n.getMinutes())):"";if(i.props.showTimeInput)return j.createElement(Tg,Be({},e.defaultProps,i.props,{date:n,timeString:a,onChange:i.props.onTimeChange}))},i.renderAriaLiveRegion=function(){var n,s=fr(i.state.date,(n=i.props.yearItemNumber)!==null&&n!==void 0?n:e.defaultProps.yearItemNumber),a=s.startPeriod,o=s.endPeriod,l;return i.props.showYearPicker?l="".concat(a," - ").concat(o):i.props.showMonthYearPicker||i.props.showQuarterYearPicker?l=Re(i.state.date):l="".concat(El(Bt(i.state.date),i.props.locale)," ").concat(Re(i.state.date)),j.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},i.state.isRenderAriaLiveMessage&&l)},i.renderChildren=function(){if(i.props.children)return j.createElement("div",{className:"react-datepicker__children-container"},i.props.children)},i.containerRef=ie.createRef(),i.state={date:i.getDateInView(),selectingDate:void 0,monthContainer:void 0,isRenderAriaLiveMessage:!1},i}return Object.defineProperty(e,"defaultProps",{get:function(){return{monthsShown:1,forceShowMonthNavigation:!1,timeCaption:"Time",previousYearButtonLabel:"Previous Year",nextYearButtonLabel:"Next Year",previousMonthButtonLabel:"Previous Month",nextMonthButtonLabel:"Next Month",yearItemNumber:fs}},enumerable:!1,configurable:!0}),e.prototype.componentDidMount=function(){var t=this;this.props.showTimeSelect&&(this.assignMonthContainer=function(){t.setState({monthContainer:t.monthContainer})}())},e.prototype.componentDidUpdate=function(t){var i=this;if(this.props.preSelection&&(!Ie(this.props.preSelection,t.preSelection)||this.props.monthSelectedIn!==t.monthSelectedIn)){var n=!Yt(this.state.date,this.props.preSelection);this.setState({date:this.props.preSelection},function(){return n&&i.handleCustomMonthChange(i.state.date)})}else this.props.openToDate&&!Ie(this.props.openToDate,t.openToDate)&&this.setState({date:this.props.openToDate})},e.prototype.render=function(){var t=this.props.container||rg;return j.createElement(Ma,{onClickOutside:this.handleClickOutside,style:{display:"contents"},ignoreClass:this.props.outsideClickIgnoreClass},j.createElement("div",{style:{display:"contents"},ref:this.containerRef},j.createElement(t,{className:Rt("react-datepicker",this.props.className,{"react-datepicker--time-only":this.props.showTimeSelectOnly}),showTime:this.props.showTimeSelect||this.props.showTimeInput,showTimeSelectOnly:this.props.showTimeSelectOnly},this.renderAriaLiveRegion(),this.renderPreviousButton(),this.renderNextButton(),this.renderMonths(),this.renderYears(),this.renderTodayButton(),this.renderTimeSection(),this.renderInputTimeSection(),this.renderChildren())))},e}(ie.Component),Gg=function(r){var e=r.icon,t=r.className,i=t===void 0?"":t,n=r.onClick,s="react-datepicker__calendar-icon";if(typeof e=="string")return j.createElement("i",{className:"".concat(s," ").concat(e," ").concat(i),"aria-hidden":"true",onClick:n});if(j.isValidElement(e)){var a=e;return j.cloneElement(a,{className:"".concat(a.props.className||""," ").concat(s," ").concat(i),onClick:function(o){typeof a.props.onClick=="function"&&a.props.onClick(o),typeof n=="function"&&n(o)}})}return j.createElement("svg",{className:"".concat(s," ").concat(i),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",onClick:n},j.createElement("path",{d:"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"}))},uc=function(r){St(e,r);function e(t){var i=r.call(this,t)||this;return i.portalRoot=null,i.el=document.createElement("div"),i}return e.prototype.componentDidMount=function(){this.portalRoot=(this.props.portalHost||document).getElementById(this.props.portalId),this.portalRoot||(this.portalRoot=document.createElement("div"),this.portalRoot.setAttribute("id",this.props.portalId),(this.props.portalHost||document.body).appendChild(this.portalRoot)),this.portalRoot.appendChild(this.el)},e.prototype.componentWillUnmount=function(){this.portalRoot&&this.portalRoot.removeChild(this.el)},e.prototype.render=function(){return Tf.createPortal(this.props.children,this.el)},e}(ie.Component),Yg="[tabindex], a, button, input, select, textarea",jg=function(r){return(r instanceof HTMLAnchorElement||!r.disabled)&&r.tabIndex!==-1},cc=function(r){St(e,r);function e(t){var i=r.call(this,t)||this;return i.getTabChildren=function(){var n;return Array.prototype.slice.call((n=i.tabLoopRef.current)===null||n===void 0?void 0:n.querySelectorAll(Yg),1,-1).filter(jg)},i.handleFocusStart=function(){var n=i.getTabChildren();n&&n.length>1&&n[n.length-1].focus()},i.handleFocusEnd=function(){var n=i.getTabChildren();n&&n.length>1&&n[0].focus()},i.tabLoopRef=ie.createRef(),i}return e.prototype.render=function(){var t;return((t=this.props.enableTabLoop)!==null&&t!==void 0?t:e.defaultProps.enableTabLoop)?j.createElement("div",{className:"react-datepicker__tab-loop",ref:this.tabLoopRef},j.createElement("div",{className:"react-datepicker__tab-loop__start",tabIndex:0,onFocus:this.handleFocusStart}),this.props.children,j.createElement("div",{className:"react-datepicker__tab-loop__end",tabIndex:0,onFocus:this.handleFocusEnd})):this.props.children},e.defaultProps={enableTabLoop:!0},e}(ie.Component);function Xg(r){var e=function(t){var i,n=typeof t.hidePopper=="boolean"?t.hidePopper:!0,s=ie.useRef(null),a=ig(Be({open:!n,whileElementsMounted:Lm,placement:t.popperPlacement,middleware:Oi([Um({padding:15}),Vm(10),Gm({element:s})],(i=t.popperModifiers)!==null&&i!==void 0?i:[],!0)},t.popperProps)),o=Be(Be({},t),{hidePopper:n,popperProps:Be(Be({},a),{arrowRef:s})});return j.createElement(r,Be({},o))};return e}var $g=function(r){St(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e,"defaultProps",{get:function(){return{hidePopper:!0}},enumerable:!1,configurable:!0}),e.prototype.render=function(){var t=this.props,i=t.className,n=t.wrapperClassName,s=t.hidePopper,a=s===void 0?e.defaultProps.hidePopper:s,o=t.popperComponent,l=t.targetComponent,h=t.enableTabLoop,u=t.popperOnKeyDown,d=t.portalId,c=t.portalHost,f=t.popperProps,p=t.showArrow,v=void 0;if(!a){var m=Rt("react-datepicker-popper",i);v=j.createElement(cc,{enableTabLoop:h},j.createElement("div",{ref:f.refs.setFloating,style:f.floatingStyles,className:m,"data-placement":f.placement,onKeyDown:u},o,p&&j.createElement(Km,{ref:f.arrowRef,context:f.context,fill:"currentColor",strokeWidth:1,height:8,width:16,style:{transform:"translateY(-1px)"},className:"react-datepicker__triangle"})))}this.props.popperContainer&&(v=ie.createElement(this.props.popperContainer,{},v)),d&&!a&&(v=j.createElement(uc,{portalId:d,portalHost:c},v));var g=Rt("react-datepicker-wrapper",n);return j.createElement(j.Fragment,null,j.createElement("div",{ref:f.refs.setReference,className:g},l),v)},e}(ie.Component),Kg=Xg($g),Mh="react-datepicker-ignore-onclickoutside";function Qg(r,e){return r&&e?Bt(r)!==Bt(e)||Re(r)!==Re(e):r!==e}var io="Date input not valid.",qg=function(r){St(e,r);function e(t){var i=r.call(this,t)||this;return i.calendar=null,i.input=null,i.getPreSelection=function(){return i.props.openToDate?i.props.openToDate:i.props.selectsEnd&&i.props.startDate?i.props.startDate:i.props.selectsStart&&i.props.endDate?i.props.endDate:Ye()},i.modifyHolidays=function(){var n;return(n=i.props.holidays)===null||n===void 0?void 0:n.reduce(function(s,a){var o=new Date(a.date);return Aa(o)?Oi(Oi([],s,!0),[Be(Be({},a),{date:o})],!1):s},[])},i.calcInitialState=function(){var n,s=i.getPreSelection(),a=oc(i.props),o=lc(i.props),l=a&&zr(s,Vs(a))?a:o&&vr(s,gh(o))?o:s;return{open:i.props.startOpen||!1,preventFocus:!1,inputValue:null,preSelection:(n=i.props.selectsRange?i.props.startDate:i.props.selected)!==null&&n!==void 0?n:l,highlightDates:_h(i.props.highlightDates),focused:!1,shouldFocusDayInline:!1,isRenderAriaLiveMessage:!1,wasHidden:!1}},i.resetHiddenStatus=function(){i.setState(Be(Be({},i.state),{wasHidden:!1}))},i.setHiddenStatus=function(){i.setState(Be(Be({},i.state),{wasHidden:!0}))},i.setHiddenStateOnVisibilityHidden=function(){document.visibilityState==="hidden"&&i.setHiddenStatus()},i.clearPreventFocusTimeout=function(){i.preventFocusTimeout&&clearTimeout(i.preventFocusTimeout)},i.setFocus=function(){var n,s;(s=(n=i.input)===null||n===void 0?void 0:n.focus)===null||s===void 0||s.call(n,{preventScroll:!0})},i.setBlur=function(){var n,s;(s=(n=i.input)===null||n===void 0?void 0:n.blur)===null||s===void 0||s.call(n),i.cancelFocusInput()},i.deferBlur=function(){requestAnimationFrame(function(){i.setBlur()})},i.setOpen=function(n,s){s===void 0&&(s=!1),i.setState({open:n,preSelection:n&&i.state.open?i.state.preSelection:i.calcInitialState().preSelection,lastPreSelectChange:ro},function(){n||i.setState(function(a){return{focused:s?a.focused:!1}},function(){!s&&i.deferBlur(),i.setState({inputValue:null})})})},i.inputOk=function(){return Xi(i.state.preSelection)},i.isCalendarOpen=function(){return i.props.open===void 0?i.state.open&&!i.props.disabled&&!i.props.readOnly:i.props.open},i.handleFocus=function(n){var s,a,o=i.state.wasHidden,l=o?i.state.open:!0;o&&i.resetHiddenStatus(),i.state.preventFocus||((a=(s=i.props).onFocus)===null||a===void 0||a.call(s,n),l&&!i.props.preventOpenOnFocus&&!i.props.readOnly&&i.setOpen(!0)),i.setState({focused:!0})},i.sendFocusBackToInput=function(){i.preventFocusTimeout&&i.clearPreventFocusTimeout(),i.setState({preventFocus:!0},function(){i.preventFocusTimeout=setTimeout(function(){i.setFocus(),i.setState({preventFocus:!1})})})},i.cancelFocusInput=function(){clearTimeout(i.inputFocusTimeout),i.inputFocusTimeout=void 0},i.deferFocusInput=function(){i.cancelFocusInput(),i.inputFocusTimeout=setTimeout(function(){return i.setFocus()},1)},i.handleDropdownFocus=function(){i.cancelFocusInput()},i.handleBlur=function(n){var s,a;(!i.state.open||i.props.withPortal||i.props.showTimeInput)&&((a=(s=i.props).onBlur)===null||a===void 0||a.call(s,n)),i.state.open&&i.props.open===!1&&i.setOpen(!1),i.setState({focused:!1})},i.handleCalendarClickOutside=function(n){var s,a;i.props.inline||i.setOpen(!1),(a=(s=i.props).onClickOutside)===null||a===void 0||a.call(s,n),i.props.withPortal&&n.preventDefault()},i.handleChange=function(){for(var n,s,a,o,l,h=[],u=0;u<arguments.length;u++)h[u]=arguments[u];var d=h[0];if(!(i.props.onChangeRaw&&(i.props.onChangeRaw.apply(i,h),!d||typeof d.isDefaultPrevented!="function"||d.isDefaultPrevented()))){i.setState({inputValue:(d==null?void 0:d.target)instanceof HTMLInputElement?d.target.value:null,lastPreSelectChange:Jg});var c=i.props,f=c.selectsRange,p=c.startDate,v=c.endDate,m=(n=i.props.dateFormat)!==null&&n!==void 0?n:e.defaultProps.dateFormat,g=(s=i.props.strictParsing)!==null&&s!==void 0?s:e.defaultProps.strictParsing,x=(d==null?void 0:d.target)instanceof HTMLInputElement?d.target.value:"";if(f){var b=x.split(m.includes("-")?nc:"-",2).map(function(P){return P.trim()}),F=b[0],A=b[1],_=Za(F??"",m,i.props.locale,g),y=Za(A??"",m,i.props.locale,g),R=(p==null?void 0:p.getTime())!==(_==null?void 0:_.getTime()),M=(v==null?void 0:v.getTime())!==(y==null?void 0:y.getTime());if(!R&&!M||_&&di(_,i.props)||y&&di(y,i.props))return;(o=(a=i.props).onChange)===null||o===void 0||o.call(a,[_,y],d)}else{var I=Za(x,m,i.props.locale,g,(l=i.props.selected)!==null&&l!==void 0?l:void 0);(I||!x)&&i.setSelected(I,d,!0)}}},i.handleSelect=function(n,s,a){if(!i.props.readOnly){if(i.props.shouldCloseOnSelect&&!i.props.showTimeSelect&&i.sendFocusBackToInput(),i.props.onChangeRaw&&i.props.onChangeRaw(s),i.setSelected(n,s,!1,a),i.props.showDateSelect&&i.setState({isRenderAriaLiveMessage:!0}),!i.props.shouldCloseOnSelect||i.props.showTimeSelect)i.setPreSelection(n);else if(!i.props.inline){i.props.selectsRange||i.setOpen(!1);var o=i.props,l=o.startDate,h=o.endDate;l&&!h&&(i.props.swapRange||!kh(n,l))&&i.setOpen(!1)}}},i.setSelected=function(n,s,a,o){var l,h,u=n;if(i.props.showYearPicker){if(u!==null&&Us(Re(u),i.props))return}else if(i.props.showMonthYearPicker){if(u!==null&&ac(u,i.props))return}else if(u!==null&&di(u,i.props))return;var d=i.props,c=d.onChange,f=d.selectsRange,p=d.startDate,v=d.endDate,m=d.selectsMultiple,g=d.selectedDates,x=d.minTime,b=d.swapRange;if(!Or(i.props.selected,u)||i.props.allowSameDay||f||m)if(u!==null&&(i.props.selected&&(!a||!i.props.showTimeSelect&&!i.props.showTimeSelectOnly&&!i.props.showTimeInput)&&(u=eo(u,{hour:$i(i.props.selected),minute:Ki(i.props.selected),second:mr(i.props.selected)})),!a&&(i.props.showTimeSelect||i.props.showTimeSelectOnly)&&x&&(u=eo(u,{hour:x.getHours(),minute:x.getMinutes(),second:x.getSeconds()})),i.props.inline||i.setState({preSelection:u}),i.props.focusSelectedMonth||i.setState({monthSelectedIn:o})),f){var F=!p&&!v,A=p&&!v,_=p&&v;F?c==null||c([u,null],s):A&&(u===null?c==null||c([null,null],s):kh(u,p)?b?c==null||c([u,p],s):c==null||c([u,null],s):c==null||c([p,u],s)),_&&(c==null||c([u,null],s))}else if(m){if(u!==null)if(!(g!=null&&g.length))c==null||c([u],s);else{var y=g.some(function(M){return Ie(M,u)});if(y){var R=g.filter(function(M){return!Ie(M,u)});c==null||c(R,s)}else c==null||c(Oi(Oi([],g,!0),[u],!1),s)}}else c==null||c(u,s);a||((h=(l=i.props).onSelect)===null||h===void 0||h.call(l,u,s),i.setState({inputValue:null}))},i.setPreSelection=function(n){if(!i.props.readOnly){var s=Xi(i.props.minDate),a=Xi(i.props.maxDate),o=!0;if(n){var l=Vs(n);if(s&&a)o=Un(n,i.props.minDate,i.props.maxDate);else if(s){var h=Vs(i.props.minDate);o=vr(n,h)||Or(l,h)}else if(a){var u=gh(i.props.maxDate);o=zr(n,u)||Or(l,u)}}o&&i.setState({preSelection:n})}},i.toggleCalendar=function(){i.setOpen(!i.state.open)},i.handleTimeChange=function(n){var s,a;if(!(i.props.selectsRange||i.props.selectsMultiple)){var o=i.props.selected?i.props.selected:i.getPreSelection(),l=i.props.selected?n:eo(o,{hour:$i(n),minute:Ki(n)});i.setState({preSelection:l}),(a=(s=i.props).onChange)===null||a===void 0||a.call(s,l),i.props.shouldCloseOnSelect&&!i.props.showTimeInput&&(i.sendFocusBackToInput(),i.setOpen(!1)),i.props.showTimeInput&&i.setOpen(!0),(i.props.showTimeSelectOnly||i.props.showTimeSelect)&&i.setState({isRenderAriaLiveMessage:!0}),i.setState({inputValue:null})}},i.onInputClick=function(){var n,s;!i.props.disabled&&!i.props.readOnly&&i.setOpen(!0),(s=(n=i.props).onInputClick)===null||s===void 0||s.call(n)},i.onInputKeyDown=function(n){var s,a,o,l,h,u;(a=(s=i.props).onKeyDown)===null||a===void 0||a.call(s,n);var d=n.key;if(!i.state.open&&!i.props.inline&&!i.props.preventOpenOnFocus){(d===ue.ArrowDown||d===ue.ArrowUp||d===ue.Enter)&&((o=i.onInputClick)===null||o===void 0||o.call(i));return}if(i.state.open){if(d===ue.ArrowDown||d===ue.ArrowUp){n.preventDefault();var c=i.props.showTimeSelectOnly?".react-datepicker__time-list-item[tabindex='0']":i.props.showWeekPicker&&i.props.showWeekNumbers?'.react-datepicker__week-number[tabindex="0"]':i.props.showFullMonthYearPicker||i.props.showMonthYearPicker?'.react-datepicker__month-text[tabindex="0"]':'.react-datepicker__day[tabindex="0"]',f=((l=i.calendar)===null||l===void 0?void 0:l.containerRef.current)instanceof Element&&i.calendar.containerRef.current.querySelector(c);f instanceof HTMLElement&&f.focus({preventScroll:!0});return}var p=Ye(i.state.preSelection);d===ue.Enter?(n.preventDefault(),n.target.blur(),i.inputOk()&&i.state.lastPreSelectChange===ro?(i.handleSelect(p,n),!i.props.shouldCloseOnSelect&&i.setPreSelection(p)):i.setOpen(!1)):d===ue.Escape?(n.preventDefault(),n.target.blur(),i.sendFocusBackToInput(),i.setOpen(!1)):d===ue.Tab&&i.setOpen(!1),i.inputOk()||(u=(h=i.props).onInputError)===null||u===void 0||u.call(h,{code:1,msg:io})}},i.onPortalKeyDown=function(n){var s=n.key;s===ue.Escape&&(n.preventDefault(),i.setState({preventFocus:!0},function(){i.setOpen(!1),setTimeout(function(){i.setFocus(),i.setState({preventFocus:!1})})}))},i.onDayKeyDown=function(n){var s,a,o,l,h,u,d=i.props,c=d.minDate,f=d.maxDate,p=d.disabledKeyboardNavigation,v=d.showWeekPicker,m=d.shouldCloseOnSelect,g=d.locale,x=d.calendarStartDay,b=d.adjustDateOnChange,F=d.inline;if((a=(s=i.props).onKeyDown)===null||a===void 0||a.call(s,n),!p){var A=n.key,_=n.shiftKey,y=Ye(i.state.preSelection),R=function(se,fe){var ee=fe;switch(se){case ue.ArrowRight:ee=v?Xs(fe,1):wi(fe,1);break;case ue.ArrowLeft:ee=v?sh(fe):O0(fe);break;case ue.ArrowUp:ee=sh(fe);break;case ue.ArrowDown:ee=Xs(fe,1);break;case ue.PageUp:ee=_?yn(fe,1):Pr(fe,1);break;case ue.PageDown:ee=_?ji(fe,1):yi(fe,1);break;case ue.Home:ee=gr(fe,g,x);break;case ue.End:ee=hg(fe);break}return ee},M=function(se,fe){for(var ee=40,ge=se,_e=!1,Je=0,tt=R(se,fe);!_e;){if(Je>=ee){tt=fe;break}c&&tt<c&&(ge=ue.ArrowRight,tt=di(c,i.props)?R(ge,tt):c),f&&tt>f&&(ge=ue.ArrowLeft,tt=di(f,i.props)?R(ge,tt):f),di(tt,i.props)?((ge===ue.PageUp||ge===ue.Home)&&(ge=ue.ArrowRight),(ge===ue.PageDown||ge===ue.End)&&(ge=ue.ArrowLeft),tt=R(ge,tt)):_e=!0,Je++}return tt};if(A===ue.Enter){n.preventDefault(),i.handleSelect(y,n),!m&&i.setPreSelection(y);return}else if(A===ue.Escape){n.preventDefault(),i.setOpen(!1),i.inputOk()||(l=(o=i.props).onInputError)===null||l===void 0||l.call(o,{code:1,msg:io});return}var I=null;switch(A){case ue.ArrowLeft:case ue.ArrowRight:case ue.ArrowUp:case ue.ArrowDown:case ue.PageUp:case ue.PageDown:case ue.Home:case ue.End:I=M(A,y);break}if(!I){(u=(h=i.props).onInputError)===null||u===void 0||u.call(h,{code:1,msg:io});return}if(n.preventDefault(),i.setState({lastPreSelectChange:ro}),b&&i.setSelected(I),i.setPreSelection(I),F){var P=Bt(y),N=Bt(I),ne=Re(y),he=Re(I);P!==N||ne!==he?i.setState({shouldFocusDayInline:!0}):i.setState({shouldFocusDayInline:!1})}}},i.onPopperKeyDown=function(n){var s=n.key;s===ue.Escape&&(n.preventDefault(),i.sendFocusBackToInput(),i.setOpen(!1))},i.onClearClick=function(n){n&&n.preventDefault&&n.preventDefault(),i.sendFocusBackToInput();var s=i.props,a=s.selectsRange,o=s.onChange;a?o==null||o([null,null],n):o==null||o(null,n),i.setState({inputValue:null})},i.clear=function(){i.onClearClick()},i.onScroll=function(n){typeof i.props.closeOnScroll=="boolean"&&i.props.closeOnScroll?(n.target===document||n.target===document.documentElement||n.target===document.body)&&i.setOpen(!1):typeof i.props.closeOnScroll=="function"&&i.props.closeOnScroll(n)&&i.setOpen(!1)},i.renderCalendar=function(){var n,s;return!i.props.inline&&!i.isCalendarOpen()?null:j.createElement(Ug,Be({showMonthYearDropdown:void 0,ref:function(a){i.calendar=a}},i.props,i.state,{setOpen:i.setOpen,dateFormat:(n=i.props.dateFormatCalendar)!==null&&n!==void 0?n:e.defaultProps.dateFormatCalendar,onSelect:i.handleSelect,onClickOutside:i.handleCalendarClickOutside,holidays:yg(i.modifyHolidays()),outsideClickIgnoreClass:Mh,onDropdownFocus:i.handleDropdownFocus,onTimeChange:i.handleTimeChange,className:i.props.calendarClassName,container:i.props.calendarContainer,handleOnKeyDown:i.props.onKeyDown,handleOnDayKeyDown:i.onDayKeyDown,setPreSelection:i.setPreSelection,dropdownMode:(s=i.props.dropdownMode)!==null&&s!==void 0?s:e.defaultProps.dropdownMode}),i.props.children)},i.renderAriaLiveRegion=function(){var n=i.props,s=n.dateFormat,a=s===void 0?e.defaultProps.dateFormat:s,o=n.locale,l=i.props.showTimeInput||i.props.showTimeSelect,h=l?"PPPPp":"PPPP",u;return i.props.selectsRange?u="Selected start date: ".concat(hi(i.props.startDate,{dateFormat:h,locale:o}),". ").concat(i.props.endDate?"End date: "+hi(i.props.endDate,{dateFormat:h,locale:o}):""):i.props.showTimeSelectOnly?u="Selected time: ".concat(hi(i.props.selected,{dateFormat:a,locale:o})):i.props.showYearPicker?u="Selected year: ".concat(hi(i.props.selected,{dateFormat:"yyyy",locale:o})):i.props.showMonthYearPicker?u="Selected month: ".concat(hi(i.props.selected,{dateFormat:"MMMM yyyy",locale:o})):i.props.showQuarterYearPicker?u="Selected quarter: ".concat(hi(i.props.selected,{dateFormat:"yyyy, QQQ",locale:o})):u="Selected date: ".concat(hi(i.props.selected,{dateFormat:h,locale:o})),j.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},u)},i.renderDateInput=function(){var n,s,a,o=Rt(i.props.className,(n={},n[Mh]=i.state.open,n)),l=i.props.customInput||j.createElement("input",{type:"text"}),h=i.props.customInputRef||"ref",u=i.props,d=u.dateFormat,c=d===void 0?e.defaultProps.dateFormat:d,f=u.locale,p=typeof i.props.value=="string"?i.props.value:typeof i.state.inputValue=="string"?i.state.inputValue:i.props.selectsRange?sg(i.props.startDate,i.props.endDate,{dateFormat:c,locale:f}):i.props.selectsMultiple?ag((a=i.props.selectedDates)!==null&&a!==void 0?a:[],{dateFormat:c,locale:f}):hi(i.props.selected,{dateFormat:c,locale:f});return ie.cloneElement(l,(s={},s[h]=function(v){i.input=v},s.value=p,s.onBlur=i.handleBlur,s.onChange=i.handleChange,s.onClick=i.onInputClick,s.onFocus=i.handleFocus,s.onKeyDown=i.onInputKeyDown,s.id=i.props.id,s.name=i.props.name,s.form=i.props.form,s.autoFocus=i.props.autoFocus,s.placeholder=i.props.placeholderText,s.disabled=i.props.disabled,s.autoComplete=i.props.autoComplete,s.className=Rt(l.props.className,o),s.title=i.props.title,s.readOnly=i.props.readOnly,s.required=i.props.required,s.tabIndex=i.props.tabIndex,s["aria-describedby"]=i.props.ariaDescribedBy,s["aria-invalid"]=i.props.ariaInvalid,s["aria-labelledby"]=i.props.ariaLabelledBy,s["aria-required"]=i.props.ariaRequired,s))},i.renderClearButton=function(){var n=i.props,s=n.isClearable,a=n.disabled,o=n.selected,l=n.startDate,h=n.endDate,u=n.clearButtonTitle,d=n.clearButtonClassName,c=d===void 0?"":d,f=n.ariaLabelClose,p=f===void 0?"Close":f,v=n.selectedDates,m=n.readOnly;return s&&!m&&(o!=null||l!=null||h!=null||v!=null&&v.length)?j.createElement("button",{type:"button",className:Rt("react-datepicker__close-icon",c,{"react-datepicker__close-icon--disabled":a}),disabled:a,"aria-label":p,onClick:i.onClearClick,title:u,tabIndex:-1}):null},i.state=i.calcInitialState(),i.preventFocusTimeout=void 0,i}return Object.defineProperty(e,"defaultProps",{get:function(){return{allowSameDay:!1,dateFormat:"MM/dd/yyyy",dateFormatCalendar:"LLLL yyyy",disabled:!1,disabledKeyboardNavigation:!1,dropdownMode:"scroll",preventOpenOnFocus:!1,monthsShown:1,readOnly:!1,withPortal:!1,selectsDisabledDaysInRange:!1,shouldCloseOnSelect:!0,showTimeSelect:!1,showTimeInput:!1,showPreviousMonths:!1,showMonthYearPicker:!1,showFullMonthYearPicker:!1,showTwoColumnMonthYearPicker:!1,showFourColumnMonthYearPicker:!1,showYearPicker:!1,showQuarterYearPicker:!1,showWeekPicker:!1,strictParsing:!1,swapRange:!1,timeIntervals:30,timeCaption:"Time",previousMonthAriaLabel:"Previous Month",previousMonthButtonLabel:"Previous Month",nextMonthAriaLabel:"Next Month",nextMonthButtonLabel:"Next Month",previousYearAriaLabel:"Previous Year",previousYearButtonLabel:"Previous Year",nextYearAriaLabel:"Next Year",nextYearButtonLabel:"Next Year",timeInputLabel:"Time",enableTabLoop:!0,yearItemNumber:fs,focusSelectedMonth:!1,showPopperArrow:!0,excludeScrollbar:!0,customTimeInput:null,calendarStartDay:void 0,toggleCalendarOnIconClick:!1,usePointerEvent:!1}},enumerable:!1,configurable:!0}),e.prototype.componentDidMount=function(){window.addEventListener("scroll",this.onScroll,!0),document.addEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},e.prototype.componentDidUpdate=function(t,i){var n,s,a,o;t.inline&&Qg(t.selected,this.props.selected)&&this.setPreSelection(this.props.selected),this.state.monthSelectedIn!==void 0&&t.monthsShown!==this.props.monthsShown&&this.setState({monthSelectedIn:0}),t.highlightDates!==this.props.highlightDates&&this.setState({highlightDates:_h(this.props.highlightDates)}),!i.focused&&!Or(t.selected,this.props.selected)&&this.setState({inputValue:null}),i.open!==this.state.open&&(i.open===!1&&this.state.open===!0&&((s=(n=this.props).onCalendarOpen)===null||s===void 0||s.call(n)),i.open===!0&&this.state.open===!1&&((o=(a=this.props).onCalendarClose)===null||o===void 0||o.call(a)))},e.prototype.componentWillUnmount=function(){this.clearPreventFocusTimeout(),window.removeEventListener("scroll",this.onScroll,!0),document.removeEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},e.prototype.renderInputContainer=function(){var t=this.props,i=t.showIcon,n=t.icon,s=t.calendarIconClassname,a=t.calendarIconClassName,o=t.toggleCalendarOnIconClick,l=this.state.open;return s&&console.warn("calendarIconClassname props is deprecated. should use calendarIconClassName props."),j.createElement("div",{className:"react-datepicker__input-container".concat(i?" react-datepicker__view-calendar-icon":"")},i&&j.createElement(Gg,Be({icon:n,className:Rt(a,!a&&s,l&&"react-datepicker-ignore-onclickoutside")},o?{onClick:this.toggleCalendar}:null)),this.state.isRenderAriaLiveMessage&&this.renderAriaLiveRegion(),this.renderDateInput(),this.renderClearButton())},e.prototype.render=function(){var t=this.renderCalendar();if(this.props.inline)return t;if(this.props.withPortal){var i=this.state.open?j.createElement(cc,{enableTabLoop:this.props.enableTabLoop},j.createElement("div",{className:"react-datepicker__portal",tabIndex:-1,onKeyDown:this.onPortalKeyDown},t)):null;return this.state.open&&this.props.portalId&&(i=j.createElement(uc,Be({portalId:this.props.portalId},this.props),i)),j.createElement("div",null,this.renderInputContainer(),i)}return j.createElement(Kg,Be({},this.props,{className:this.props.popperClassName,hidePopper:!this.isCalendarOpen(),targetComponent:this.renderInputContainer(),popperComponent:t,popperOnKeyDown:this.onPopperKeyDown,showArrow:this.props.showPopperArrow}))},e}(ie.Component),Jg="input",ro="navigate";const Zg={lessThanXSeconds:{one:"1 ",other:"{{count}} "},xSeconds:{one:"1",other:"{{count}}"},halfAMinute:"30",lessThanXMinutes:{one:"1 ",other:"{{count}} "},xMinutes:{one:"1",other:"{{count}}"},aboutXHours:{one:" 1",other:" {{count}}"},xHours:{one:"1",other:"{{count}}"},xDays:{one:"1",other:"{{count}}"},aboutXWeeks:{one:" 1",other:" {{count}}"},xWeeks:{one:"1",other:"{{count}}"},aboutXMonths:{one:" 1",other:" {{count}}"},xMonths:{one:"1",other:"{{count}}"},aboutXYears:{one:" 1",other:" {{count}}"},xYears:{one:"1",other:"{{count}}"},overXYears:{one:"1 ",other:"{{count}} "},almostXYears:{one:" 1",other:" {{count}}"}},ev=(r,e,t)=>{let i;const n=Zg[r];return typeof n=="string"?i=n:e===1?i=n.one:i=n.other.replace("{{count}}",e.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?i+" ":i+" ":i},tv={full:"y M d EEEE",long:"y M d",medium:"y.MM.dd",short:"y.MM.dd"},iv={full:"a H mm ss zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},rv={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},nv={date:hn({formats:tv,defaultWidth:"full"}),time:hn({formats:iv,defaultWidth:"full"}),dateTime:hn({formats:rv,defaultWidth:"full"})},sv={lastWeek:"'' eeee p",yesterday:"'' p",today:"'' p",tomorrow:"'' p",nextWeek:"'' eeee p",other:"P"},av=(r,e,t,i)=>sv[r],ov={narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["",""]},lv={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1","2","3","4"]},hv={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1","2","3","4","5","6","7","8","9","10","11","12"],wide:["1","2","3","4","5","6","7","8","9","10","11","12"]},uv={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},cv={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},dv={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},fv=(r,e)=>{const t=Number(r);switch(String(e==null?void 0:e.unit)){case"minute":case"second":return String(t);case"date":return t+"";default:return t+""}},pv={ordinalNumber:fv,era:Ri({values:ov,defaultWidth:"wide"}),quarter:Ri({values:lv,defaultWidth:"wide",argumentCallback:r=>r-1}),month:Ri({values:hv,defaultWidth:"wide"}),day:Ri({values:uv,defaultWidth:"wide"}),dayPeriod:Ri({values:cv,defaultWidth:"wide",formattingValues:dv,defaultFormattingWidth:"wide"})},mv=/^(\d+)(|)?/i,gv=/\d+/i,vv={narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(|)/i},bv={any:[/^(bc|)/i,/^(ad|)/i]},wv={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]?/i},xv={any:[/1/i,/2/i,/3/i,/4/i]},yv={narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])/i,wide:/^(1[012]|[123456789])/i},Ev={any:[/^1?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},Cv={narrow:/^[]/,short:/^[]/,abbreviated:/^[]/,wide:/^[]/},_v={any:[/^/,/^/,/^/,/^/,/^/,/^/,/^/]},Tv={any:/^(am|pm|||||||)/i},Sv={any:{am:/^(am|)/i,pm:/^(pm|)/i,midnight:/^/i,noon:/^/i,morning:/^/i,afternoon:/^/i,evening:/^/i,night:/^/i}},Dv={ordinalNumber:Nu({matchPattern:mv,parsePattern:gv,valueCallback:r=>parseInt(r,10)}),era:Fi({matchPatterns:vv,defaultMatchWidth:"wide",parsePatterns:bv,defaultParseWidth:"any"}),quarter:Fi({matchPatterns:wv,defaultMatchWidth:"wide",parsePatterns:xv,defaultParseWidth:"any",valueCallback:r=>r+1}),month:Fi({matchPatterns:yv,defaultMatchWidth:"wide",parsePatterns:Ev,defaultParseWidth:"any"}),day:Fi({matchPatterns:Cv,defaultMatchWidth:"wide",parsePatterns:_v,defaultParseWidth:"any"}),dayPeriod:Fi({matchPatterns:Tv,defaultMatchWidth:"any",parsePatterns:Sv,defaultParseWidth:"any"})},kv={code:"ko",formatDistance:ev,formatLong:nv,formatRelative:av,localize:pv,match:Dv,options:{weekStartsOn:0,firstWeekContainsDate:1}},Rv=({id:r,type:e,value:t,onChange:i,placeholder:n,width:s,height:a,backgroundColor:o,color:l,enabled:h,minDate:u,maxDate:d})=>{const c={width:"150px",height:"30px",backgroundColor:"#ffffff",color:"#000000"},f=(F,A)=>F==="default"||!F?A:F,p=ie.useCallback(F=>!(F instanceof Date)||isNaN(F)?"":F.toISOString().split("T")[0],[]),v=ie.useCallback(F=>!(F instanceof Date)||isNaN(F)?"":`${F.getFullYear()}-${(F.getMonth()+1).toString().padStart(2,"0")}`,[]),m=ie.useCallback(F=>{const A=e==="startmonth"||e==="endmonth"?v(F):p(F);i({target:{value:A||"",id:r}})},[r,e,i,p,v]),g=ie.useCallback(F=>{const[A,_]=F||[null,null],y={start:A&&!isNaN(A)?p(A):"",end:_&&!isNaN(_)?p(_):""};i({target:{value:y,id:r}})},[r,i,p]),x=ie.useCallback(F=>{const[A,_]=F||[null,null],y={start:A&&!isNaN(A)?v(A):"",end:_&&!isNaN(_)?v(_):""};i({target:{value:y,id:r}})},[r,i,v]),b={id:r,selected:t&&typeof t=="string"&&!isNaN(new Date(t))?new Date(t):null,placeholderText:n||"",dateFormat:e.includes("month")?"yyyy-MM":"yyyy-MM-dd",locale:kv,showYearDropdown:!0,showMonthDropdown:!0,dropdownMode:"select",popperPlacement:"bottom",className:"custom-datepicker-input",style:{width:f(s,c.width),height:f(a,c.height),backgroundColor:f(o,c.backgroundColor),color:f(l,c.color),boxSizing:"border-box",margin:0},disabled:h===!1,minDate:u&&!isNaN(new Date(u))?new Date(u):null,maxDate:d&&!isNaN(new Date(d))?new Date(d):null};return ye.jsx(qg,{...b,onChange:e==="dayperiod"?g:e==="monthperiod"?x:m,selectsRange:e==="dayperiod"||e==="monthperiod",showMonthYearPicker:e==="startmonth"||e==="endmonth"||e==="monthperiod",startDate:t!=null&&t.start&&!isNaN(new Date(t.start))?new Date(t.start):null,endDate:t!=null&&t.end&&!isNaN(new Date(t.end))?new Date(t.end):null})},Fv="_searchSection_rti0d_1",Mv="_formGroupContainer_rti0d_13",Av="_searchFields_rti0d_20",Ov="_formGroup_rti0d_13",Lv="_radioGroup_rti0d_44",Pv="_radioLabel_rti0d_49",Nv="_buttonContainer_rti0d_55",Iv="_popupIcon_rti0d_61",ar={searchSection:Fv,formGroupContainer:Mv,searchFields:Av,formGroup:Ov,radioGroup:Lv,radioLabel:Pv,buttonContainer:Nv,popupIcon:Iv},ZS=({config:r,filters:e,setFilters:t,onEvent:i})=>{const n={width:"150px",height:"30px",backgroundColor:"#ffffff",color:"#000000"},s=255,a=new Date,o=a.toISOString().split("T")[0],l=`${a.getFullYear()}-${(a.getMonth()+1).toString().padStart(2,"0")}`,h=(m,g)=>m==="default"||!m?g:m;ie.useEffect(()=>{var x;const m=((x=r.areas.find(b=>b.type==="search"))==null?void 0:x.fields)||[],g={};m.forEach(b=>{["day","startday","endday"].includes(b.type)&&e[b.id]===void 0?g[b.id]=b.defaultValue||o:["startmonth","endmonth"].includes(b.type)&&e[b.id]===void 0?g[b.id]=b.defaultValue||l:["dayperiod","monthperiod"].includes(b.type)&&e[b.id]===void 0&&(g[b.id]=b.defaultValue||{start:b.type==="dayperiod"?o:l,end:b.type==="dayperiod"?o:l})}),Object.keys(g).length>0&&t(b=>({...b,...g}))},[r,e,t]);const u=(m,g)=>{var _;const{id:x,maxLength:b,type:F}=g;let A=((_=m.target)==null?void 0:_.value)??m;if(F==="text"||F==="textarea"){const y=Cf.validateVarcharLength(A,b||s,g.label||"");if(!y.valid){Sf(y.error);return}}t(y=>({...y,[x]:A})),g.event?i(g.event,{id:x,value:A}):F==="select"&&i("selectChange",{id:x,value:A})},d=(m,g)=>{t(x=>({...x,[g.id]:m.target.checked})),g.event&&i(g.event,{id:g.id,checked:m.target.checked})},c=(m,g)=>{Eo(m,t),g.event&&i(g.event,{id:g.id,value:m.target.value})},f=m=>{const{id:g,type:x}=m;let b={};g==="rangeEndDate"?b={rangeStartDate:o,rangeEndDate:o}:g==="rangeEndMonth"?b={rangeStartMonth:l,rangeEndMonth:l}:["dayperiod","monthperiod"].includes(x)?b[g]={start:x==="dayperiod"?o:l,end:x==="dayperiod"?o:l}:b[g]=x==="startmonth"||x==="endmonth"?l:o,t(F=>({...F,...b})),i("dateChange",{id:g,value:b[g]||Object.values(b)[0]})},p=m=>m.type==="startday"&&e.rangeEndDate?{maxDate:e.rangeEndDate}:m.type==="endday"&&e.rangeStartDate?{minDate:e.rangeStartDate}:m.type==="startmonth"&&e.rangeEndMonth?{maxDate:e.rangeEndMonth}:m.type==="endmonth"&&e.rangeStartMonth?{minDate:e.rangeStartMonth}:{},v=()=>{var b,F;const m=((b=r.areas.find(A=>A.type==="search"))==null?void 0:b.fields)||[],g=((F=r.areas.find(A=>A.type==="buttons"))==null?void 0:F.fields)||[],x={};return m.forEach(A=>{const _=A.row||1;x[_]||(x[_]={search:[],buttons:[]}),x[_].search.push(A)}),g.forEach(A=>{const _=A.row||1;x[_]||(x[_]={search:[],buttons:[]}),x[_].buttons.push(A)}),Object.keys(x).map(A=>ye.jsxs("div",{className:ar.formGroupContainer,children:[ye.jsx("div",{className:ar.searchFields,children:x[A].search.map(_=>ye.jsxs("div",{className:ar.formGroup,children:[_.labelVisible!==!1&&_.label&&ye.jsx("label",{htmlFor:_.id,children:_.label}),ye.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[(_.type==="text"||_.type==="textarea")&&(_.type==="text"?ye.jsx("input",{id:_.id,name:_.id,type:"text",placeholder:_.placeholder||"",value:e[_.id]||"",onChange:y=>u(y,_),style:{width:h(_.width,n.width),height:h(_.height,n.height),backgroundColor:h(_.backgroundColor,n.backgroundColor),color:h(_.color,n.color),boxSizing:"border-box",margin:0},disabled:_.enabled===!1}):ye.jsx("textarea",{id:_.id,name:_.id,placeholder:_.placeholder||"",value:e[_.id]||"",onChange:y=>u(y,_),style:{width:h(_.width,n.width),height:h(_.height,n.height),backgroundColor:h(_.backgroundColor),color:h(_.color,n.color),boxSizing:"border-box",margin:0},disabled:_.enabled===!1})),["day","startday","endday","startmonth","endmonth","dayperiod","monthperiod"].includes(_.type)&&ye.jsxs("div",{style:{width:h(_.width,n.width),height:h(_.height,n.height),display:"flex",alignItems:"center"},children:[ye.jsx(Rv,{id:_.id,type:_.type,value:e[_.id],onChange:y=>u(y,_),placeholder:_.placeholder||_.label||"",width:"100%",height:"100%",backgroundColor:_.backgroundColor,color:_.color,enabled:_.enabled,...p(_)}),ye.jsx("button",{className:"btn btn-link p-0 ms-2",onClick:()=>f(_),title:"",style:{lineHeight:"1"},children:ye.jsx("i",{className:"bi bi-x-square fs-6"})})]}),_.type==="select"&&ye.jsx("select",{id:_.id,name:_.id,value:e[_.id]||"",onChange:y=>u(y,_),style:{width:h(_.width,n.width),height:h(_.height,n.height),backgroundColor:h(_.backgroundColor,n.backgroundColor),color:h(_.color,n.color),boxSizing:"border-box",margin:0},disabled:_.enabled===!1,children:_.options.map(y=>ye.jsx("option",{value:y.value,children:y.label},y.value))}),_.type==="radio"&&ye.jsx("div",{className:ar.radioGroup,children:_.options.map(y=>ye.jsxs("label",{className:ar.radioLabel,children:[ye.jsx("input",{type:"radio",name:_.id,value:y.value,checked:e[_.id]===y.value,onChange:R=>c(R,_),disabled:_.enabled===!1}),y.label]},y.value))}),_.type==="checkbox"&&ye.jsx("input",{type:"checkbox",id:_.id,name:_.id,checked:e[_.id]||!1,onChange:y=>d(y,_),disabled:_.enabled===!1}),_.type==="popupIcon"&&ye.jsx("button",{className:ar.popupIcon,onClick:()=>i(_.eventType,{id:_.id}),style:{width:h(_.width,n.width),height:h(_.height,n.height),backgroundColor:h(_.backgroundColor,n.backgroundColor),color:h(_.color,n.color),boxSizing:"border-box",margin:0},disabled:_.enabled===!1,children:"+"}),_.type==="button"&&ye.jsx("button",{id:_.id,onClick:()=>i(_.eventType,{id:_.id}),style:{width:h(_.width,"80px"),height:h(_.height,"30px"),backgroundColor:h(_.backgroundColor,"#00c4b4"),color:h(_.color,"#ffffff"),boxSizing:"border-box",margin:0,border:"none",borderRadius:"4px",cursor:_.enabled?"pointer":"not-allowed"},disabled:_.enabled===!1,children:_.label})]})]},_.id))}),x[A].buttons.length>0&&ye.jsx("div",{className:ar.buttonContainer,children:x[A].buttons.map(_=>ye.jsx("button",{onClick:()=>i(_.eventType,{id:_.id}),style:{width:h(_.width,"80px"),height:h(_.height,"30px"),backgroundColor:h(_.backgroundColor,"#00c4b4"),color:h(_.color,"#ffffff"),boxSizing:"border-box",margin:0},disabled:_.enabled===!1,children:_.label},_.id))})]},`row-${A}`))};return ye.jsx("div",{className:ar.searchSection,children:v()})},Bv="_searchSection_tc1xz_1",Hv="_formGroupContainer_tc1xz_12",zv="_formGroup_tc1xz_12",Wv="_buttonContainer_tc1xz_38",Vv="_downloadButton_tc1xz_44",Uv="_btnGroupCustom_tc1xz_58",Gv="_btn_tc1xz_58",Yv="_container_tc1xz_78",jv="_tableWrapper_tc1xz_97",Xv="_tableSection_tc1xz_101",$v="_loading_tc1xz_106",Kv="_spin_tc1xz_1",Qv="_noData_tc1xz_136",qv="_deleteButton_tc1xz_143",Jv="_deletedRow_tc1xz_149",Zv="_editedRow_tc1xz_153",eb="_addedRow_tc1xz_157",tb="_smallFont_tc1xz_161",ib="_formTable_tc1xz_165",rb="_formLabel_tc1xz_180",nb="_formInput_tc1xz_187",sb="_formSelect_tc1xz_197",ab="_margin1_tc1xz_201",ob="_tableTitleRow_tc1xz_205",lb="_tableTitle_tc1xz_205",hb="_resultText_tc1xz_215",ub="_rowCountText_tc1xz_219",vi={searchSection:Bv,formGroupContainer:Hv,formGroup:zv,buttonContainer:Wv,downloadButton:Vv,btnGroupCustom:Uv,btn:Gv,container:Yv,tableWrapper:jv,tableSection:Xv,loading:$v,spin:Kv,noData:Qv,deleteButton:qv,deletedRow:Jv,editedRow:Zv,addedRow:eb,smallFont:tb,formTable:ib,formLabel:rb,formInput:nb,formSelect:sb,margin1:ab,tableTitleRow:ob,tableTitle:lb,resultText:hb,rowCountText:ub},cb=({rowCount:r})=>ye.jsx("div",{className:vi.tableTitleRow,children:ye.jsxs("div",{className:vi.tableTitle,children:[ye.jsx("span",{className:vi.resultText,children:" ("}),ye.jsxs("span",{className:vi.rowCountText,children:[r," Rows"]}),ye.jsx("span",{className:vi.resultText,children:")"})]})}),eD=({filterFields:r,filters:e,setFilters:t,onDownloadExcel:i,children:n,buttonStyles:s,rowCount:a})=>ye.jsxs("div",{children:[ye.jsxs("div",{className:vi.searchSection,children:[ye.jsxs("div",{className:vi.formGroupContainer,children:[r.map(o=>ye.jsxs("div",{className:vi.formGroup,children:[ye.jsx("label",{htmlFor:o.id,children:o.label}),o.type==="text"?ye.jsx("input",{id:o.id,name:o.id,type:"text",placeholder:o.placeholder,value:e[o.id]||"",onChange:l=>Eo(l,t),style:{width:o.width||"auto",height:o.height||"auto"}}):o.type==="select"?ye.jsx("select",{id:o.id,name:o.id,value:e[o.id]||"",onChange:l=>Eo(l,t),style:{width:o.width||"auto",height:o.height||"auto"},children:o.options.map(l=>ye.jsx("option",{value:l.value,children:l.label},l.value))}):null]},o.id)),n&&ye.jsx("div",{className:s==null?void 0:s.btnGroupCustom,children:n})]}),ye.jsx("div",{className:vi.buttonContainer,children:ye.jsx("button",{onClick:i,className:vi.downloadButton,children:" "})})]}),ye.jsx("div",{className:vi.tableTitleRow,children:ye.jsx(cb,{rowCount:a||0})})]});class At{constructor(e){this.table=e}reloadData(e,t,i){return this.table.dataLoader.load(e,void 0,void 0,void 0,t,i)}langText(){return this.table.modules.localize.getText(...arguments)}langBind(){return this.table.modules.localize.bind(...arguments)}langLocale(){return this.table.modules.localize.getLocale(...arguments)}commsConnections(){return this.table.modules.comms.getConnections(...arguments)}commsSend(){return this.table.modules.comms.send(...arguments)}layoutMode(){return this.table.modules.layout.getMode()}layoutRefresh(e){return this.table.modules.layout.layout(e)}subscribe(){return this.table.eventBus.subscribe(...arguments)}unsubscribe(){return this.table.eventBus.unsubscribe(...arguments)}subscribed(e){return this.table.eventBus.subscribed(e)}subscriptionChange(){return this.table.eventBus.subscriptionChange(...arguments)}dispatch(){return this.table.eventBus.dispatch(...arguments)}chain(){return this.table.eventBus.chain(...arguments)}confirm(){return this.table.eventBus.confirm(...arguments)}dispatchExternal(){return this.table.externalEvents.dispatch(...arguments)}subscribedExternal(e){return this.table.externalEvents.subscribed(e)}subscriptionChangeExternal(){return this.table.externalEvents.subscriptionChange(...arguments)}options(e){return this.table.options[e]}setOption(e,t){return typeof t<"u"&&(this.table.options[e]=t),this.table.options[e]}deprecationCheck(e,t,i){return this.table.deprecationAdvisor.check(e,t,i)}deprecationCheckMsg(e,t){return this.table.deprecationAdvisor.checkMsg(e,t)}deprecationMsg(e){return this.table.deprecationAdvisor.msg(e)}module(e){return this.table.module(e)}}class et{static elVisible(e){return!(e.offsetWidth<=0&&e.offsetHeight<=0)}static elOffset(e){var t=e.getBoundingClientRect();return{top:t.top+window.pageYOffset-document.documentElement.clientTop,left:t.left+window.pageXOffset-document.documentElement.clientLeft}}static retrieveNestedData(e,t,i){var n=e?t.split(e):[t],s=n.length,a;for(let o=0;o<s&&(i=i[n[o]],a=i,!!i);o++);return a}static deepClone(e,t,i=[]){var n={}.__proto__,s=[].__proto__;t||(t=Object.assign(Array.isArray(e)?[]:{},e));for(var a in e){let o=e[a],l,h;o!=null&&typeof o=="object"&&(o.__proto__===n||o.__proto__===s)&&(l=i.findIndex(u=>u.subject===o),l>-1?t[a]=i[l].copy:(h=Object.assign(Array.isArray(o)?[]:{},o),i.unshift({subject:o,copy:h}),t[a]=this.deepClone(o,h,i)))}return t}}let db=class dc extends At{constructor(e,t,i){super(e),this.element=t,this.container=this._lookupContainer(),this.parent=i,this.reversedX=!1,this.childPopup=null,this.blurable=!1,this.blurCallback=null,this.blurEventsBound=!1,this.renderedCallback=null,this.visible=!1,this.hideable=!0,this.element.classList.add("tabulator-popup-container"),this.blurEvent=this.hide.bind(this,!1),this.escEvent=this._escapeCheck.bind(this),this.destroyBinding=this.tableDestroyed.bind(this),this.destroyed=!1}tableDestroyed(){this.destroyed=!0,this.hide(!0)}_lookupContainer(){var e=this.table.options.popupContainer;return typeof e=="string"?(e=document.querySelector(e),e||console.warn("Menu Error - no container element found matching selector:",this.table.options.popupContainer,"(defaulting to document body)")):e===!0&&(e=this.table.element),e&&!this._checkContainerIsParent(e)&&(e=!1,console.warn("Menu Error - container element does not contain this table:",this.table.options.popupContainer,"(defaulting to document body)")),e||(e=document.body),e}_checkContainerIsParent(e,t=this.table.element){return e===t?!0:t.parentNode?this._checkContainerIsParent(e,t.parentNode):!1}renderCallback(e){this.renderedCallback=e}containerEventCoords(e){var t=!(e instanceof MouseEvent),i=t?e.touches[0].pageX:e.pageX,n=t?e.touches[0].pageY:e.pageY;if(this.container!==document.body){let s=et.elOffset(this.container);i-=s.left,n-=s.top}return{x:i,y:n}}elementPositionCoords(e,t="right"){var i=et.elOffset(e),n,s,a;switch(this.container!==document.body&&(n=et.elOffset(this.container),i.left-=n.left,i.top-=n.top),t){case"right":s=i.left+e.offsetWidth,a=i.top-1;break;case"bottom":s=i.left,a=i.top+e.offsetHeight;break;case"left":s=i.left,a=i.top-1;break;case"top":s=i.left,a=i.top;break;case"center":s=i.left+e.offsetWidth/2,a=i.top+e.offsetHeight/2;break}return{x:s,y:a,offset:i}}show(e,t){var i,n,s,a,o;return this.destroyed||this.table.destroyed?this:(e instanceof HTMLElement?(s=e,o=this.elementPositionCoords(e,t),a=o.offset,i=o.x,n=o.y):typeof e=="number"?(a={top:0,left:0},i=e,n=t):(o=this.containerEventCoords(e),i=o.x,n=o.y,this.reversedX=!1),this.element.style.top=n+"px",this.element.style.left=i+"px",this.container.appendChild(this.element),typeof this.renderedCallback=="function"&&this.renderedCallback(),this._fitToScreen(i,n,s,a,t),this.visible=!0,this.subscribe("table-destroy",this.destroyBinding),this.element.addEventListener("mousedown",l=>{l.stopPropagation()}),this)}_fitToScreen(e,t,i,n,s){var a=this.container===document.body?document.documentElement.scrollTop:this.container.scrollTop;(e+this.element.offsetWidth>=this.container.offsetWidth||this.reversedX)&&(this.element.style.left="",i?this.element.style.right=this.container.offsetWidth-n.left+"px":this.element.style.right=this.container.offsetWidth-e+"px",this.reversedX=!0);let o=Math.max(this.container.offsetHeight,a?this.container.scrollHeight:0);if(t+this.element.offsetHeight>o)if(i)switch(s){case"bottom":this.element.style.top=parseInt(this.element.style.top)-this.element.offsetHeight-i.offsetHeight-1+"px";break;default:this.element.style.top=parseInt(this.element.style.top)-this.element.offsetHeight+i.offsetHeight+1+"px"}else this.element.style.height=o+"px"}isVisible(){return this.visible}hideOnBlur(e){return this.blurable=!0,this.visible&&(setTimeout(()=>{this.visible&&(this.table.rowManager.element.addEventListener("scroll",this.blurEvent),this.subscribe("cell-editing",this.blurEvent),document.body.addEventListener("click",this.blurEvent),document.body.addEventListener("contextmenu",this.blurEvent),document.body.addEventListener("mousedown",this.blurEvent),window.addEventListener("resize",this.blurEvent),document.body.addEventListener("keydown",this.escEvent),this.blurEventsBound=!0)},100),this.blurCallback=e),this}_escapeCheck(e){e.keyCode==27&&this.hide()}blockHide(){this.hideable=!1}restoreHide(){this.hideable=!0}hide(e=!1){return this.visible&&this.hideable&&(this.blurable&&this.blurEventsBound&&(document.body.removeEventListener("keydown",this.escEvent),document.body.removeEventListener("click",this.blurEvent),document.body.removeEventListener("contextmenu",this.blurEvent),document.body.removeEventListener("mousedown",this.blurEvent),window.removeEventListener("resize",this.blurEvent),this.table.rowManager.element.removeEventListener("scroll",this.blurEvent),this.unsubscribe("cell-editing",this.blurEvent),this.blurEventsBound=!1),this.childPopup&&this.childPopup.hide(),this.parent&&(this.parent.childPopup=null),this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.visible=!1,this.blurCallback&&!e&&this.blurCallback(),this.unsubscribe("table-destroy",this.destroyBinding)),this}child(e){return this.childPopup&&this.childPopup.hide(),this.childPopup=new dc(this.table,e,this),this.childPopup}};class ke extends At{constructor(e,t){super(e),this._handler=null}initialize(){}registerTableOption(e,t){this.table.optionsList.register(e,t)}registerColumnOption(e,t){this.table.columnManager.optionsList.register(e,t)}registerTableFunction(e,t){typeof this.table[e]>"u"?this.table[e]=(...i)=>(this.table.initGuard(e),t(...i)):console.warn("Unable to bind table function, name already in use",e)}registerComponentFunction(e,t,i){return this.table.componentFunctionBinder.bind(e,t,i)}registerDataHandler(e,t){this.table.rowManager.registerDataPipelineHandler(e,t),this._handler=e}registerDisplayHandler(e,t){this.table.rowManager.registerDisplayPipelineHandler(e,t),this._handler=e}displayRows(e){var t=this.table.rowManager.displayRows.length-1,i;if(this._handler&&(i=this.table.rowManager.displayPipeline.findIndex(n=>n.handler===this._handler),i>-1&&(t=i)),e&&(t=t+e),this._handler)return t>-1?this.table.rowManager.getDisplayRows(t):this.activeRows()}activeRows(){return this.table.rowManager.activeRows}refreshData(e,t){t||(t=this._handler),t&&this.table.rowManager.refreshActiveData(t,!1,e)}footerAppend(e){return this.table.footerManager.append(e)}footerPrepend(e){return this.table.footerManager.prepend(e)}footerRemove(e){return this.table.footerManager.remove(e)}popup(e,t){return new db(this.table,e,t)}alert(e,t){return this.table.alertManager.alert(e,t)}clearAlert(){return this.table.alertManager.clear()}}var fb={rownum:function(r,e,t,i,n,s){return s.getPosition()}};const sn=class sn extends ke{constructor(e){super(e),this.allowedTypes=["","data","download","clipboard","print","htmlOutput"],this.registerColumnOption("accessor"),this.registerColumnOption("accessorParams"),this.registerColumnOption("accessorData"),this.registerColumnOption("accessorDataParams"),this.registerColumnOption("accessorDownload"),this.registerColumnOption("accessorDownloadParams"),this.registerColumnOption("accessorClipboard"),this.registerColumnOption("accessorClipboardParams"),this.registerColumnOption("accessorPrint"),this.registerColumnOption("accessorPrintParams"),this.registerColumnOption("accessorHtmlOutput"),this.registerColumnOption("accessorHtmlOutputParams")}initialize(){this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("row-data-retrieve",this.transformRow.bind(this))}initializeColumn(e){var t=!1,i={};this.allowedTypes.forEach(n=>{var s="accessor"+(n.charAt(0).toUpperCase()+n.slice(1)),a;e.definition[s]&&(a=this.lookupAccessor(e.definition[s]),a&&(t=!0,i[s]={accessor:a,params:e.definition[s+"Params"]||{}}))}),t&&(e.modules.accessor=i)}lookupAccessor(e){var t=!1;switch(typeof e){case"string":sn.accessors[e]?t=sn.accessors[e]:console.warn("Accessor Error - No such accessor found, ignoring: ",e);break;case"function":t=e;break}return t}transformRow(e,t){var i="accessor"+(t.charAt(0).toUpperCase()+t.slice(1)),n=e.getComponent(),s=et.deepClone(e.data||{});return this.table.columnManager.traverse(function(a){var o,l,h,u;a.modules.accessor&&(l=a.modules.accessor[i]||a.modules.accessor.accessor||!1,l&&(o=a.getFieldValue(s),o!="undefined"&&(u=a.getComponent(),h=typeof l.params=="function"?l.params(o,s,t,u,n):l.params,a.setFieldValue(s,l.accessor(o,s,t,h,u,n)))))}),s}};G(sn,"moduleName","accessor"),G(sn,"accessors",fb);let Fo=sn;var pb={method:"GET"};function Mo(r,e){var t=[];if(e=e||"",Array.isArray(r))r.forEach((n,s)=>{t=t.concat(Mo(n,e?e+"["+s+"]":s))});else if(typeof r=="object")for(var i in r)t=t.concat(Mo(r[i],e?e+"["+i+"]":i));else t.push({key:e,value:r});return t}function mb(r){var e=Mo(r),t=[];return e.forEach(function(i){t.push(encodeURIComponent(i.key)+"="+encodeURIComponent(i.value))}),t.join("&")}function fc(r,e,t){return r&&t&&Object.keys(t).length&&(!e.method||e.method.toLowerCase()=="get")&&(e.method="get",r+=(r.includes("?")?"&":"?")+mb(t)),r}function gb(r,e,t){var i;return new Promise((n,s)=>{if(r=this.urlGenerator.call(this.table,r,e,t),e.method.toUpperCase()!="GET")if(i=typeof this.table.options.ajaxContentType=="object"?this.table.options.ajaxContentType:this.contentTypeFormatters[this.table.options.ajaxContentType],i){for(var a in i.headers)e.headers||(e.headers={}),typeof e.headers[a]>"u"&&(e.headers[a]=i.headers[a]);e.body=i.body.call(this,r,e,t)}else console.warn("Ajax Error - Invalid ajaxContentType value:",this.table.options.ajaxContentType);r?(typeof e.headers>"u"&&(e.headers={}),typeof e.headers.Accept>"u"&&(e.headers.Accept="application/json"),typeof e.headers["X-Requested-With"]>"u"&&(e.headers["X-Requested-With"]="XMLHttpRequest"),typeof e.mode>"u"&&(e.mode="cors"),e.mode=="cors"?(typeof e.headers.Origin>"u"&&(e.headers.Origin=window.location.origin),typeof e.credentials>"u"&&(e.credentials="same-origin")):typeof e.credentials>"u"&&(e.credentials="include"),fetch(r,e).then(o=>{o.ok?o.json().then(l=>{n(l)}).catch(l=>{s(l),console.warn("Ajax Load Error - Invalid JSON returned",l)}):(console.error("Ajax Load Error - Connection Error: "+o.status,o.statusText),s(o))}).catch(o=>{console.error("Ajax Load Error - Connection Error: ",o),s(o)})):(console.warn("Ajax Load Error - No URL Set"),n([]))})}function Ao(r,e){var t=[];if(e=e||"",Array.isArray(r))r.forEach((n,s)=>{t=t.concat(Ao(n,e?e+"["+s+"]":s))});else if(typeof r=="object")for(var i in r)t=t.concat(Ao(r[i],e?e+"["+i+"]":i));else t.push({key:e,value:r});return t}var vb={json:{headers:{"Content-Type":"application/json"},body:function(r,e,t){return JSON.stringify(t)}},form:{headers:{},body:function(r,e,t){var i=Ao(t),n=new FormData;return i.forEach(function(s){n.append(s.key,s.value)}),n}}};const gi=class gi extends ke{constructor(e){super(e),this.config={},this.url="",this.urlGenerator=!1,this.params=!1,this.loaderPromise=!1,this.registerTableOption("ajaxURL",!1),this.registerTableOption("ajaxURLGenerator",!1),this.registerTableOption("ajaxParams",{}),this.registerTableOption("ajaxConfig","get"),this.registerTableOption("ajaxContentType","form"),this.registerTableOption("ajaxRequestFunc",!1),this.registerTableOption("ajaxRequesting",function(){}),this.registerTableOption("ajaxResponse",!1),this.contentTypeFormatters=gi.contentTypeFormatters}initialize(){this.loaderPromise=this.table.options.ajaxRequestFunc||gi.defaultLoaderPromise,this.urlGenerator=this.table.options.ajaxURLGenerator||gi.defaultURLGenerator,this.table.options.ajaxURL&&this.setUrl(this.table.options.ajaxURL),this.setDefaultConfig(this.table.options.ajaxConfig),this.registerTableFunction("getAjaxUrl",this.getUrl.bind(this)),this.subscribe("data-loading",this.requestDataCheck.bind(this)),this.subscribe("data-params",this.requestParams.bind(this)),this.subscribe("data-load",this.requestData.bind(this))}requestParams(e,t,i,n){var s=this.table.options.ajaxParams;return s&&(typeof s=="function"&&(s=s.call(this.table)),n=Object.assign(Object.assign({},s),n)),n}requestDataCheck(e,t,i,n){return!!(!e&&this.url||typeof e=="string")}requestData(e,t,i,n,s){var a;return!s&&this.requestDataCheck(e)?(e&&this.setUrl(e),a=this.generateConfig(i),this.sendRequest(this.url,t,a)):s}setDefaultConfig(e={}){this.config=Object.assign({},gi.defaultConfig),typeof e=="string"?this.config.method=e:Object.assign(this.config,e)}generateConfig(e={}){var t=Object.assign({},this.config);return typeof e=="string"?t.method=e:Object.assign(t,e),t}setUrl(e){this.url=e}getUrl(){return this.url}sendRequest(e,t,i){return this.table.options.ajaxRequesting.call(this.table,e,t)!==!1?this.loaderPromise(e,i,t).then(n=>(this.table.options.ajaxResponse&&(n=this.table.options.ajaxResponse.call(this.table,e,t,n)),n)):Promise.reject()}};G(gi,"moduleName","ajax"),G(gi,"defaultConfig",pb),G(gi,"defaultURLGenerator",fc),G(gi,"defaultLoaderPromise",gb),G(gi,"contentTypeFormatters",vb);let Oo=gi;var bb={replace:function(r){return this.table.setData(r)},update:function(r){return this.table.updateOrAddData(r)},insert:function(r){return this.table.addData(r)}},wb={table:function(r){var e=[],t=!0,i=this.table.columnManager.columns,n=[],s=[];return r=r.split(`
`),r.forEach(function(a){e.push(a.split("	"))}),e.length&&!(e.length===1&&e[0].length<2)?(e[0].forEach(function(a){var o=i.find(function(l){return a&&l.definition.title&&a.trim()&&l.definition.title.trim()===a.trim()});o?n.push(o):t=!1}),t||(t=!0,n=[],e[0].forEach(function(a){var o=i.find(function(l){return a&&l.field&&a.trim()&&l.field.trim()===a.trim()});o?n.push(o):t=!1}),t||(n=this.table.columnManager.columnsByIndex)),t&&e.shift(),e.forEach(function(a){var o={};a.forEach(function(l,h){n[h]&&(o[n[h].field]=l)}),s.push(o)}),s):!1}},xb={copyToClipboard:["ctrl + 67","meta + 67"]},yb={copyToClipboard:function(r){this.table.modules.edit.currentCell||this.table.modExists("clipboard",!0)&&this.table.modules.clipboard.copy(!1,!0)}},Eb={keybindings:{bindings:xb,actions:yb}};const or=class or extends ke{constructor(e){super(e),this.mode=!0,this.pasteParser=function(){},this.pasteAction=function(){},this.customSelection=!1,this.rowRange=!1,this.blocked=!0,this.registerTableOption("clipboard",!1),this.registerTableOption("clipboardCopyStyled",!0),this.registerTableOption("clipboardCopyConfig",!1),this.registerTableOption("clipboardCopyFormatter",!1),this.registerTableOption("clipboardCopyRowRange","active"),this.registerTableOption("clipboardPasteParser","table"),this.registerTableOption("clipboardPasteAction","insert"),this.registerColumnOption("clipboard"),this.registerColumnOption("titleClipboard")}initialize(){this.mode=this.table.options.clipboard,this.rowRange=this.table.options.clipboardCopyRowRange,(this.mode===!0||this.mode==="copy")&&this.table.element.addEventListener("copy",e=>{var t,i,n;this.blocked||(e.preventDefault(),this.customSelection?(t=this.customSelection,this.table.options.clipboardCopyFormatter&&(t=this.table.options.clipboardCopyFormatter("plain",t))):(n=this.table.modules.export.generateExportList(this.table.options.clipboardCopyConfig,this.table.options.clipboardCopyStyled,this.rowRange,"clipboard"),i=this.table.modules.export.generateHTMLTable(n),t=i?this.generatePlainContent(n):"",this.table.options.clipboardCopyFormatter&&(t=this.table.options.clipboardCopyFormatter("plain",t),i=this.table.options.clipboardCopyFormatter("html",i))),window.clipboardData&&window.clipboardData.setData?window.clipboardData.setData("Text",t):e.clipboardData&&e.clipboardData.setData?(e.clipboardData.setData("text/plain",t),i&&e.clipboardData.setData("text/html",i)):e.originalEvent&&e.originalEvent.clipboardData.setData&&(e.originalEvent.clipboardData.setData("text/plain",t),i&&e.originalEvent.clipboardData.setData("text/html",i)),this.dispatchExternal("clipboardCopied",t,i),this.reset())}),(this.mode===!0||this.mode==="paste")&&this.table.element.addEventListener("paste",e=>{this.paste(e)}),this.setPasteParser(this.table.options.clipboardPasteParser),this.setPasteAction(this.table.options.clipboardPasteAction),this.registerTableFunction("copyToClipboard",this.copy.bind(this))}reset(){this.blocked=!0,this.customSelection=!1}generatePlainContent(e){var t=[];return e.forEach(i=>{var n=[];i.columns.forEach(s=>{var a="";if(s)if(i.type==="group"&&(s.value=s.component.getKey()),s.value===null)a="";else switch(typeof s.value){case"object":a=JSON.stringify(s.value);break;case"undefined":a="";break;default:a=s.value}n.push(a)}),t.push(n.join("	"))}),t.join(`
`)}copy(e,t){var i,n;this.blocked=!1,this.customSelection=!1,(this.mode===!0||this.mode==="copy")&&(this.rowRange=e||this.table.options.clipboardCopyRowRange,typeof window.getSelection<"u"&&typeof document.createRange<"u"?(e=document.createRange(),e.selectNodeContents(this.table.element),i=window.getSelection(),i.toString()&&t&&(this.customSelection=i.toString()),i.removeAllRanges(),i.addRange(e)):typeof document.selection<"u"&&typeof document.body.createTextRange<"u"&&(n=document.body.createTextRange(),n.moveToElementText(this.table.element),n.select()),document.execCommand("copy"),i&&i.removeAllRanges())}setPasteAction(e){switch(typeof e){case"string":this.pasteAction=or.pasteActions[e],this.pasteAction||console.warn("Clipboard Error - No such paste action found:",e);break;case"function":this.pasteAction=e;break}}setPasteParser(e){switch(typeof e){case"string":this.pasteParser=or.pasteParsers[e],this.pasteParser||console.warn("Clipboard Error - No such paste parser found:",e);break;case"function":this.pasteParser=e;break}}paste(e){var t,i,n;this.checkPasteOrigin(e)&&(t=this.getPasteData(e),i=this.pasteParser.call(this,t),i?(e.preventDefault(),this.table.modExists("mutator")&&(i=this.mutateData(i)),n=this.pasteAction.call(this,i),this.dispatchExternal("clipboardPasted",t,i,n)):this.dispatchExternal("clipboardPasteError",t))}mutateData(e){var t=[];return Array.isArray(e)?e.forEach(i=>{t.push(this.table.modules.mutator.transformRow(i,"clipboard"))}):t=e,t}checkPasteOrigin(e){var t=!0,i=this.confirm("clipboard-paste",[e]);return(i||!["DIV","SPAN"].includes(e.target.tagName))&&(t=!1),t}getPasteData(e){var t;return window.clipboardData&&window.clipboardData.getData?t=window.clipboardData.getData("Text"):e.clipboardData&&e.clipboardData.getData?t=e.clipboardData.getData("text/plain"):e.originalEvent&&e.originalEvent.clipboardData.getData&&(t=e.originalEvent.clipboardData.getData("text/plain")),t}};G(or,"moduleName","clipboard"),G(or,"moduleExtensions",Eb),G(or,"pasteActions",bb),G(or,"pasteParsers",wb);let Lo=or;class Cb{constructor(e){return this._row=e,new Proxy(this,{get:function(t,i,n){return typeof t[i]<"u"?t[i]:t._row.table.componentFunctionBinder.handle("row",t._row,i)}})}getData(e){return this._row.getData(e)}getElement(){return this._row.getElement()}getTable(){return this._row.table}getCells(){var e=[];return this._row.getCells().forEach(function(t){e.push(t.getComponent())}),e}getCell(e){var t=this._row.getCell(e);return t?t.getComponent():!1}_getSelf(){return this._row}}class pc{constructor(e){return this._cell=e,new Proxy(this,{get:function(t,i,n){return typeof t[i]<"u"?t[i]:t._cell.table.componentFunctionBinder.handle("cell",t._cell,i)}})}getValue(){return this._cell.getValue()}getOldValue(){return this._cell.getOldValue()}getInitialValue(){return this._cell.initialValue}getElement(){return this._cell.getElement()}getRow(){return this._cell.row.getComponent()}getData(e){return this._cell.row.getData(e)}getType(){return"cell"}getField(){return this._cell.column.getField()}getColumn(){return this._cell.column.getComponent()}setValue(e,t){typeof t>"u"&&(t=!0),this._cell.setValue(e,t)}restoreOldValue(){this._cell.setValueActual(this._cell.getOldValue())}restoreInitialValue(){this._cell.setValueActual(this._cell.initialValue)}checkHeight(){this._cell.checkHeight()}getTable(){return this._cell.table}_getSelf(){return this._cell}}class ms extends At{constructor(e,t){super(e.table),this.table=e.table,this.column=e,this.row=t,this.element=null,this.value=null,this.initialValue,this.oldValue=null,this.modules={},this.height=null,this.width=null,this.minWidth=null,this.component=null,this.loaded=!1,this.build()}build(){this.generateElement(),this.setWidth(),this._configureCell(),this.setValueActual(this.column.getFieldValue(this.row.data)),this.initialValue=this.value}generateElement(){this.element=document.createElement("div"),this.element.className="tabulator-cell",this.element.setAttribute("role","gridcell"),this.column.isRowHeader&&this.element.classList.add("tabulator-row-header")}_configureCell(){var e=this.element,t=this.column.getField(),i={top:"flex-start",bottom:"flex-end",middle:"center"},n={left:"flex-start",right:"flex-end",center:"center"};if(e.style.textAlign=this.column.hozAlign,this.column.vertAlign&&(e.style.display="inline-flex",e.style.alignItems=i[this.column.vertAlign]||"",this.column.hozAlign&&(e.style.justifyContent=n[this.column.hozAlign]||"")),t&&e.setAttribute("tabulator-field",t),this.column.definition.cssClass){var s=this.column.definition.cssClass.split(" ");s.forEach(a=>{e.classList.add(a)})}this.dispatch("cell-init",this),this.column.visible||this.hide()}_generateContents(){var e;switch(e=this.chain("cell-format",this,null,()=>this.element.innerHTML=this.value),typeof e){case"object":if(e instanceof Node){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.element.appendChild(e)}else this.element.innerHTML="",e!=null&&console.warn("Format Error - Formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:",e);break;case"undefined":this.element.innerHTML="";break;default:this.element.innerHTML=e}}cellRendered(){this.dispatch("cell-rendered",this)}getElement(e){return this.loaded||(this.loaded=!0,e||this.layoutElement()),this.element}getValue(){return this.value}getOldValue(){return this.oldValue}setValue(e,t,i){var n=this.setValueProcessData(e,t,i);n&&(this.dispatch("cell-value-updated",this),this.cellRendered(),this.column.definition.cellEdited&&this.column.definition.cellEdited.call(this.table,this.getComponent()),this.dispatchExternal("cellEdited",this.getComponent()),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.table.rowManager.getData()))}setValueProcessData(e,t,i){var n=!1;return(this.value!==e||i)&&(n=!0,t&&(e=this.chain("cell-value-changing",[this,e],null,e))),this.setValueActual(e),n&&this.dispatch("cell-value-changed",this),n}setValueActual(e){this.oldValue=this.value,this.value=e,this.dispatch("cell-value-save-before",this),this.column.setFieldValue(this.row.data,e),this.dispatch("cell-value-save-after",this),this.loaded&&this.layoutElement()}layoutElement(){this._generateContents(),this.dispatch("cell-layout",this)}setWidth(){this.width=this.column.width,this.element.style.width=this.column.widthStyled}clearWidth(){this.width="",this.element.style.width=""}getWidth(){return this.width||this.element.offsetWidth}setMinWidth(){this.minWidth=this.column.minWidth,this.element.style.minWidth=this.column.minWidthStyled}setMaxWidth(){this.maxWidth=this.column.maxWidth,this.element.style.maxWidth=this.column.maxWidthStyled}checkHeight(){this.row.reinitializeHeight()}clearHeight(){this.element.style.height="",this.height=null,this.dispatch("cell-height",this,"")}setHeight(){this.height=this.row.height,this.element.style.height=this.row.heightStyled,this.dispatch("cell-height",this,this.row.heightStyled)}getHeight(){return this.height||this.element.offsetHeight}show(){this.element.style.display=this.column.vertAlign?"inline-flex":""}hide(){this.element.style.display="none"}delete(){this.dispatch("cell-delete",this),!this.table.rowManager.redrawBlock&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=!1,this.column.deleteCell(this),this.row.deleteCell(this),this.calcs={}}getIndex(){return this.row.getCellIndex(this)}getComponent(){return this.component||(this.component=new pc(this)),this.component}}class mc{constructor(e){return this._column=e,this.type="ColumnComponent",new Proxy(this,{get:function(t,i,n){return typeof t[i]<"u"?t[i]:t._column.table.componentFunctionBinder.handle("column",t._column,i)}})}getElement(){return this._column.getElement()}getDefinition(){return this._column.getDefinition()}getField(){return this._column.getField()}getTitleDownload(){return this._column.getTitleDownload()}getCells(){var e=[];return this._column.cells.forEach(function(t){e.push(t.getComponent())}),e}isVisible(){return this._column.visible}show(){this._column.isGroup?this._column.columns.forEach(function(e){e.show()}):this._column.show()}hide(){this._column.isGroup?this._column.columns.forEach(function(e){e.hide()}):this._column.hide()}toggle(){this._column.visible?this.hide():this.show()}delete(){return this._column.delete()}getSubColumns(){var e=[];return this._column.columns.length&&this._column.columns.forEach(function(t){e.push(t.getComponent())}),e}getParentColumn(){return this._column.getParentComponent()}_getSelf(){return this._column}scrollTo(e,t){return this._column.table.columnManager.scrollToColumn(this._column,e,t)}getTable(){return this._column.table}move(e,t){var i=this._column.table.columnManager.findColumn(e);i?this._column.table.columnManager.moveColumn(this._column,i,t):console.warn("Move Error - No matching column found:",i)}getNextColumn(){var e=this._column.nextColumn();return e?e.getComponent():!1}getPrevColumn(){var e=this._column.prevColumn();return e?e.getComponent():!1}updateDefinition(e){return this._column.updateDefinition(e)}getWidth(){return this._column.getWidth()}setWidth(e){var t;return e===!0?t=this._column.reinitializeWidth(!0):t=this._column.setWidth(e),this._column.table.columnManager.rerenderColumns(!0),t}}var gc={title:void 0,field:void 0,columns:void 0,visible:void 0,hozAlign:void 0,vertAlign:void 0,width:void 0,minWidth:40,maxWidth:void 0,maxInitialWidth:void 0,cssClass:void 0,variableHeight:void 0,headerVertical:void 0,headerHozAlign:void 0,headerWordWrap:!1,editableTitle:void 0};const Rr=class Rr extends At{constructor(e,t,i){super(t.table),this.definition=e,this.parent=t,this.type="column",this.columns=[],this.cells=[],this.isGroup=!1,this.isRowHeader=i,this.element=this.createElement(),this.contentElement=!1,this.titleHolderElement=!1,this.titleElement=!1,this.groupElement=this.createGroupElement(),this.hozAlign="",this.vertAlign="",this.field="",this.fieldStructure="",this.getFieldValue="",this.setFieldValue="",this.titleDownload=null,this.titleFormatterRendered=!1,this.mapDefinitions(),this.setField(this.definition.field),this.modules={},this.width=null,this.widthStyled="",this.maxWidth=null,this.maxWidthStyled="",this.maxInitialWidth=null,this.minWidth=null,this.minWidthStyled="",this.widthFixed=!1,this.visible=!0,this.component=null,this.definition.columns?(this.isGroup=!0,this.definition.columns.forEach((n,s)=>{var a=new Rr(n,this);this.attachColumn(a)}),this.checkColumnVisibility()):t.registerColumnField(this),this._initialize()}createElement(){var e=document.createElement("div");switch(e.classList.add("tabulator-col"),e.setAttribute("role","columnheader"),e.setAttribute("aria-sort","none"),this.isRowHeader&&e.classList.add("tabulator-row-header"),this.table.options.columnHeaderVertAlign){case"middle":e.style.justifyContent="center";break;case"bottom":e.style.justifyContent="flex-end";break}return e}createGroupElement(){var e=document.createElement("div");return e.classList.add("tabulator-col-group-cols"),e}mapDefinitions(){var e=this.table.options.columnDefaults;if(e)for(let t in e)typeof this.definition[t]>"u"&&(this.definition[t]=e[t]);this.definition=this.table.columnManager.optionsList.generate(Rr.defaultOptionList,this.definition)}checkDefinition(){Object.keys(this.definition).forEach(e=>{Rr.defaultOptionList.indexOf(e)===-1&&console.warn("Invalid column definition option in '"+(this.field||this.definition.title)+"' column:",e)})}setField(e){this.field=e,this.fieldStructure=e?this.table.options.nestedFieldSeparator?e.split(this.table.options.nestedFieldSeparator):[e]:[],this.getFieldValue=this.fieldStructure.length>1?this._getNestedData:this._getFlatData,this.setFieldValue=this.fieldStructure.length>1?this._setNestedData:this._setFlatData}registerColumnPosition(e){this.parent.registerColumnPosition(e)}registerColumnField(e){this.parent.registerColumnField(e)}reRegisterPosition(){this.isGroup?this.columns.forEach(function(e){e.reRegisterPosition()}):this.registerColumnPosition(this)}_initialize(){for(var e=this.definition;this.element.firstChild;)this.element.removeChild(this.element.firstChild);e.headerVertical&&(this.element.classList.add("tabulator-col-vertical"),e.headerVertical==="flip"&&this.element.classList.add("tabulator-col-vertical-flip")),this.contentElement=this._buildColumnHeaderContent(),this.element.appendChild(this.contentElement),this.isGroup?this._buildGroupHeader():this._buildColumnHeader(),this.dispatch("column-init",this)}_buildColumnHeader(){var e=this.definition;if(this.dispatch("column-layout",this),typeof e.visible<"u"&&(e.visible?this.show(!0):this.hide(!0)),e.cssClass){var t=e.cssClass.split(" ");t.forEach(i=>{this.element.classList.add(i)})}e.field&&this.element.setAttribute("tabulator-field",e.field),this.setMinWidth(parseInt(e.minWidth)),e.maxInitialWidth&&(this.maxInitialWidth=parseInt(e.maxInitialWidth)),e.maxWidth&&this.setMaxWidth(parseInt(e.maxWidth)),this.reinitializeWidth(),this.hozAlign=this.definition.hozAlign,this.vertAlign=this.definition.vertAlign,this.titleElement.style.textAlign=this.definition.headerHozAlign}_buildColumnHeaderContent(){var e=document.createElement("div");return e.classList.add("tabulator-col-content"),this.titleHolderElement=document.createElement("div"),this.titleHolderElement.classList.add("tabulator-col-title-holder"),e.appendChild(this.titleHolderElement),this.titleElement=this._buildColumnHeaderTitle(),this.titleHolderElement.appendChild(this.titleElement),e}_buildColumnHeaderTitle(){var e=this.definition,t=document.createElement("div");if(t.classList.add("tabulator-col-title"),e.headerWordWrap&&t.classList.add("tabulator-col-title-wrap"),e.editableTitle){var i=document.createElement("input");i.classList.add("tabulator-title-editor"),i.addEventListener("click",n=>{n.stopPropagation(),i.focus()}),i.addEventListener("mousedown",n=>{n.stopPropagation()}),i.addEventListener("change",()=>{e.title=i.value,this.dispatchExternal("columnTitleChanged",this.getComponent())}),t.appendChild(i),e.field?this.langBind("columns|"+e.field,n=>{i.value=n||e.title||"&nbsp;"}):i.value=e.title||"&nbsp;"}else e.field?this.langBind("columns|"+e.field,n=>{this._formatColumnHeaderTitle(t,n||e.title||"&nbsp;")}):this._formatColumnHeaderTitle(t,e.title||"&nbsp;");return t}_formatColumnHeaderTitle(e,t){var i=this.chain("column-format",[this,t,e],null,()=>t);switch(typeof i){case"object":i instanceof Node?e.appendChild(i):(e.innerHTML="",console.warn("Format Error - Title formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:",i));break;case"undefined":e.innerHTML="";break;default:e.innerHTML=i}}_buildGroupHeader(){if(this.element.classList.add("tabulator-col-group"),this.element.setAttribute("role","columngroup"),this.element.setAttribute("aria-title",this.definition.title),this.definition.cssClass){var e=this.definition.cssClass.split(" ");e.forEach(t=>{this.element.classList.add(t)})}this.titleElement.style.textAlign=this.definition.headerHozAlign,this.element.appendChild(this.groupElement)}_getFlatData(e){return e[this.field]}_getNestedData(e){var t=e,i=this.fieldStructure,n=i.length,s;for(let a=0;a<n&&(t=t[i[a]],s=t,!!t);a++);return s}_setFlatData(e,t){this.field&&(e[this.field]=t)}_setNestedData(e,t){var i=e,n=this.fieldStructure,s=n.length;for(let a=0;a<s;a++)if(a==s-1)i[n[a]]=t;else{if(!i[n[a]])if(typeof t<"u")i[n[a]]={};else break;i=i[n[a]]}}attachColumn(e){this.groupElement?(this.columns.push(e),this.groupElement.appendChild(e.getElement()),e.columnRendered()):console.warn("Column Warning - Column being attached to another column instead of column group")}verticalAlign(e,t){var i=this.parent.isGroup?this.parent.getGroupElement().clientHeight:t||this.parent.getHeadersElement().clientHeight;this.element.style.height=i+"px",this.dispatch("column-height",this,this.element.style.height),this.isGroup&&(this.groupElement.style.minHeight=i-this.contentElement.offsetHeight+"px"),this.columns.forEach(function(n){n.verticalAlign(e)})}clearVerticalAlign(){this.element.style.paddingTop="",this.element.style.height="",this.element.style.minHeight="",this.groupElement.style.minHeight="",this.columns.forEach(function(e){e.clearVerticalAlign()}),this.dispatch("column-height",this,"")}getElement(){return this.element}getGroupElement(){return this.groupElement}getField(){return this.field}getTitleDownload(){return this.titleDownload}getFirstColumn(){return this.isGroup?this.columns.length?this.columns[0].getFirstColumn():!1:this}getLastColumn(){return this.isGroup?this.columns.length?this.columns[this.columns.length-1].getLastColumn():!1:this}getColumns(e){var t=[];return e?this.columns.forEach(i=>{t.push(i),t=t.concat(i.getColumns(!0))}):t=this.columns,t}getCells(){return this.cells}getTopColumn(){return this.parent.isGroup?this.parent.getTopColumn():this}getDefinition(e){var t=[];return this.isGroup&&e&&(this.columns.forEach(function(i){t.push(i.getDefinition(!0))}),this.definition.columns=t),this.definition}checkColumnVisibility(){var e=!1;this.columns.forEach(function(t){t.visible&&(e=!0)}),e?(this.show(),this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!1)):this.hide()}show(e,t){this.visible||(this.visible=!0,this.element.style.display="",this.parent.isGroup&&this.parent.checkColumnVisibility(),this.cells.forEach(function(i){i.show()}),!this.isGroup&&this.width===null&&this.reinitializeWidth(),this.table.columnManager.verticalAlignHeaders(),this.dispatch("column-show",this,t),e||this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!0),this.parent.isGroup&&this.parent.matchChildWidths(),this.silent||this.table.columnManager.rerenderColumns())}hide(e,t){this.visible&&(this.visible=!1,this.element.style.display="none",this.table.columnManager.verticalAlignHeaders(),this.parent.isGroup&&this.parent.checkColumnVisibility(),this.cells.forEach(function(i){i.hide()}),this.dispatch("column-hide",this,t),e||this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!1),this.parent.isGroup&&this.parent.matchChildWidths(),this.silent||this.table.columnManager.rerenderColumns())}matchChildWidths(){var e=0;this.contentElement&&this.columns.length&&(this.columns.forEach(function(t){t.visible&&(e+=t.getWidth())}),this.contentElement.style.maxWidth=e-1+"px",this.table.initialized&&(this.element.style.width=e+"px"),this.parent.isGroup&&this.parent.matchChildWidths())}removeChild(e){var t=this.columns.indexOf(e);t>-1&&this.columns.splice(t,1),this.columns.length||this.delete()}setWidth(e){this.widthFixed=!0,this.setWidthActual(e)}setWidthActual(e){isNaN(e)&&(e=Math.floor(this.table.element.clientWidth/100*parseInt(e))),e=Math.max(this.minWidth,e),this.maxWidth&&(e=Math.min(this.maxWidth,e)),this.width=e,this.widthStyled=e?e+"px":"",this.element.style.width=this.widthStyled,this.isGroup||this.cells.forEach(function(t){t.setWidth()}),this.parent.isGroup&&this.parent.matchChildWidths(),this.dispatch("column-width",this),this.subscribedExternal("columnWidth")&&this.dispatchExternal("columnWidth",this.getComponent())}checkCellHeights(){var e=[];this.cells.forEach(function(t){t.row.heightInitialized&&(t.row.getElement().offsetParent!==null?(e.push(t.row),t.row.clearCellHeight()):t.row.heightInitialized=!1)}),e.forEach(function(t){t.calcHeight()}),e.forEach(function(t){t.setCellHeight()})}getWidth(){var e=0;return this.isGroup?this.columns.forEach(function(t){t.visible&&(e+=t.getWidth())}):e=this.width,e}getLeftOffset(){var e=this.element.offsetLeft;return this.parent.isGroup&&(e+=this.parent.getLeftOffset()),e}getHeight(){return Math.ceil(this.element.getBoundingClientRect().height)}setMinWidth(e){this.maxWidth&&e>this.maxWidth&&(e=this.maxWidth,console.warn("the minWidth ("+e+"px) for column '"+this.field+"' cannot be bigger that its maxWidth ("+this.maxWidthStyled+")")),this.minWidth=e,this.minWidthStyled=e?e+"px":"",this.element.style.minWidth=this.minWidthStyled,this.cells.forEach(function(t){t.setMinWidth()})}setMaxWidth(e){this.minWidth&&e<this.minWidth&&(e=this.minWidth,console.warn("the maxWidth ("+e+"px) for column '"+this.field+"' cannot be smaller that its minWidth ("+this.minWidthStyled+")")),this.maxWidth=e,this.maxWidthStyled=e?e+"px":"",this.element.style.maxWidth=this.maxWidthStyled,this.cells.forEach(function(t){t.setMaxWidth()})}delete(){return new Promise((e,t)=>{this.isGroup&&this.columns.forEach(function(n){n.delete()}),this.dispatch("column-delete",this);var i=this.cells.length;for(let n=0;n<i;n++)this.cells[0].delete();this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=!1,this.contentElement=!1,this.titleElement=!1,this.groupElement=!1,this.parent.isGroup&&this.parent.removeChild(this),this.table.columnManager.deregisterColumn(this),this.table.columnManager.rerenderColumns(!0),this.dispatch("column-deleted",this),e()})}columnRendered(){this.titleFormatterRendered&&this.titleFormatterRendered(),this.dispatch("column-rendered",this)}generateCell(e){var t=new ms(this,e);return this.cells.push(t),t}nextColumn(){var e=this.table.columnManager.findColumnIndex(this);return e>-1?this._nextVisibleColumn(e+1):!1}_nextVisibleColumn(e){var t=this.table.columnManager.getColumnByIndex(e);return!t||t.visible?t:this._nextVisibleColumn(e+1)}prevColumn(){var e=this.table.columnManager.findColumnIndex(this);return e>-1?this._prevVisibleColumn(e-1):!1}_prevVisibleColumn(e){var t=this.table.columnManager.getColumnByIndex(e);return!t||t.visible?t:this._prevVisibleColumn(e-1)}reinitializeWidth(e){this.widthFixed=!1,typeof this.definition.width<"u"&&!e&&this.setWidth(this.definition.width),this.dispatch("column-width-fit-before",this),this.fitToData(e),this.dispatch("column-width-fit-after",this)}fitToData(e){if(!this.isGroup){this.widthFixed||(this.element.style.width="",this.cells.forEach(n=>{n.clearWidth()}));var t=this.element.offsetWidth;if((!this.width||!this.widthFixed)&&(this.cells.forEach(n=>{var s=n.getWidth();s>t&&(t=s)}),t)){var i=t+1;e?this.setWidth(i):(this.maxInitialWidth&&!e&&(i=Math.min(i,this.maxInitialWidth)),this.setWidthActual(i))}}}updateDefinition(e){var t;return this.isGroup||this.parent.isGroup?(console.error("Column Update Error - The updateDefinition function is only available on ungrouped columns"),Promise.reject("Column Update Error - The updateDefinition function is only available on columns, not column groups")):(t=Object.assign({},this.getDefinition()),t=Object.assign(t,e),this.table.columnManager.addColumn(t,!1,this).then(i=>(t.field==this.field&&(this.field=!1),this.delete().then(()=>i.getComponent()))))}deleteCell(e){var t=this.cells.indexOf(e);t>-1&&this.cells.splice(t,1)}getComponent(){return this.component||(this.component=new mc(this)),this.component}getPosition(){return this.table.columnManager.getVisibleColumnsByIndex().indexOf(this)+1}getParentComponent(){return this.parent instanceof Rr?this.parent.getComponent():!1}};G(Rr,"defaultOptionList",gc);let Ir=Rr;class Oa{constructor(e){return this._row=e,new Proxy(this,{get:function(t,i,n){return typeof t[i]<"u"?t[i]:t._row.table.componentFunctionBinder.handle("row",t._row,i)}})}getData(e){return this._row.getData(e)}getElement(){return this._row.getElement()}getCells(){var e=[];return this._row.getCells().forEach(function(t){e.push(t.getComponent())}),e}getCell(e){var t=this._row.getCell(e);return t?t.getComponent():!1}getIndex(){return this._row.getData("data")[this._row.table.options.index]}getPosition(){return this._row.getPosition()}watchPosition(e){return this._row.watchPosition(e)}delete(){return this._row.delete()}scrollTo(e,t){return this._row.table.rowManager.scrollToRow(this._row,e,t)}move(e,t){this._row.moveToRow(e,t)}update(e){return this._row.updateData(e)}normalizeHeight(){this._row.normalizeHeight(!0)}_getSelf(){return this._row}reformat(){return this._row.reinitialize()}getTable(){return this._row.table}getNextRow(){var e=this._row.nextRow();return e&&e.getComponent()}getPrevRow(){var e=this._row.prevRow();return e&&e.getComponent()}}class It extends At{constructor(e,t,i="row"){super(t.table),this.parent=t,this.data={},this.type=i,this.element=!1,this.modules={},this.cells=[],this.height=0,this.heightStyled="",this.manualHeight=!1,this.outerHeight=0,this.initialized=!1,this.heightInitialized=!1,this.position=0,this.positionWatchers=[],this.component=null,this.created=!1,this.setData(e)}create(){this.created||(this.created=!0,this.generateElement())}createElement(){var e=document.createElement("div");e.classList.add("tabulator-row"),e.setAttribute("role","row"),this.element=e}getElement(){return this.create(),this.element}detachElement(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}generateElement(){this.createElement(),this.dispatch("row-init",this)}generateCells(){this.cells=this.table.columnManager.generateCells(this)}initialize(e,t){if(this.create(),!this.initialized||e){for(this.deleteCells();this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.dispatch("row-layout-before",this),this.generateCells(),this.initialized=!0,this.table.columnManager.renderer.renderRowCells(this,t),e&&this.normalizeHeight(),this.dispatch("row-layout",this),this.table.options.rowFormatter&&this.table.options.rowFormatter(this.getComponent()),this.dispatch("row-layout-after",this)}else this.table.columnManager.renderer.rerenderRowCells(this,t)}rendered(){this.cells.forEach(e=>{e.cellRendered()})}reinitializeHeight(){this.heightInitialized=!1,this.element&&this.element.offsetParent!==null&&this.normalizeHeight(!0)}deinitialize(){this.initialized=!1}deinitializeHeight(){this.heightInitialized=!1}reinitialize(e){this.initialized=!1,this.heightInitialized=!1,this.manualHeight||(this.height=0,this.heightStyled=""),this.element&&this.element.offsetParent!==null&&this.initialize(!0),this.dispatch("row-relayout",this)}calcHeight(e){var t=0,i=0;this.table.options.rowHeight?this.height=this.table.options.rowHeight:(i=this.calcMinHeight(),t=this.calcMaxHeight(),e?this.height=Math.max(t,i):this.height=this.manualHeight?this.height:Math.max(t,i)),this.heightStyled=this.height?this.height+"px":"",this.outerHeight=this.element.offsetHeight}calcMinHeight(){return this.table.options.resizableRows?this.element.clientHeight:0}calcMaxHeight(){var e=0;return this.cells.forEach(function(t){var i=t.getHeight();i>e&&(e=i)}),e}setCellHeight(){this.cells.forEach(function(e){e.setHeight()}),this.heightInitialized=!0}clearCellHeight(){this.cells.forEach(function(e){e.clearHeight()})}normalizeHeight(e){e&&!this.table.options.rowHeight&&this.clearCellHeight(),this.calcHeight(e),this.setCellHeight()}setHeight(e,t){(this.height!=e||t)&&(this.manualHeight=!0,this.height=e,this.heightStyled=e?e+"px":"",this.setCellHeight(),this.outerHeight=this.element.offsetHeight,this.subscribedExternal("rowHeight")&&this.dispatchExternal("rowHeight",this.getComponent()))}getHeight(){return this.outerHeight}getWidth(){return this.element.offsetWidth}deleteCell(e){var t=this.cells.indexOf(e);t>-1&&this.cells.splice(t,1)}setData(e){this.data=this.chain("row-data-init-before",[this,e],void 0,e),this.dispatch("row-data-init-after",this)}updateData(e){var t=this.element&&et.elVisible(this.element),i={},n;return new Promise((s,a)=>{typeof e=="string"&&(e=JSON.parse(e)),this.dispatch("row-data-save-before",this),this.subscribed("row-data-changing")&&(i=Object.assign(i,this.data),i=Object.assign(i,e)),n=this.chain("row-data-changing",[this,i,e],null,e);for(let o in n)this.data[o]=n[o];this.dispatch("row-data-save-after",this);for(let o in e)this.table.columnManager.getColumnsByFieldRoot(o).forEach(h=>{let u=this.getCell(h.getField());if(u){let d=h.getFieldValue(n);u.getValue()!==d&&(u.setValueProcessData(d),t&&u.cellRendered())}});t?(this.normalizeHeight(!0),this.table.options.rowFormatter&&this.table.options.rowFormatter(this.getComponent())):(this.initialized=!1,this.height=0,this.heightStyled=""),this.dispatch("row-data-changed",this,t,e),this.dispatchExternal("rowUpdated",this.getComponent()),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.table.rowManager.getData()),s()})}getData(e){return e?this.chain("row-data-retrieve",[this,e],null,this.data):this.data}getCell(e){var t=!1;return e=this.table.columnManager.findColumn(e),!this.initialized&&this.cells.length===0&&this.generateCells(),t=this.cells.find(function(i){return i.column===e}),t}getCellIndex(e){return this.cells.findIndex(function(t){return t===e})}findCell(e){return this.cells.find(t=>t.element===e)}getCells(){return!this.initialized&&this.cells.length===0&&this.generateCells(),this.cells}nextRow(){var e=this.table.rowManager.nextDisplayRow(this,!0);return e||!1}prevRow(){var e=this.table.rowManager.prevDisplayRow(this,!0);return e||!1}moveToRow(e,t){var i=this.table.rowManager.findRow(e);i?(this.table.rowManager.moveRowActual(this,i,!t),this.table.rowManager.refreshActiveData("display",!1,!0)):console.warn("Move Error - No matching row found:",e)}delete(){return this.dispatch("row-delete",this),this.deleteActual(),Promise.resolve()}deleteActual(e){this.detachModules(),this.table.rowManager.deleteRow(this,e),this.deleteCells(),this.initialized=!1,this.heightInitialized=!1,this.element=!1,this.dispatch("row-deleted",this)}detachModules(){this.dispatch("row-deleting",this)}deleteCells(){var e=this.cells.length;for(let t=0;t<e;t++)this.cells[0].delete()}wipe(){if(this.detachModules(),this.deleteCells(),this.element){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.element.parentNode&&this.element.parentNode.removeChild(this.element)}this.element=!1,this.modules={}}isDisplayed(){return this.table.rowManager.getDisplayRows().includes(this)}getPosition(){return this.isDisplayed()?this.position:!1}setPosition(e){e!=this.position&&(this.position=e,this.positionWatchers.forEach(t=>{t(this.position)}))}watchPosition(e){this.positionWatchers.push(e),e(this.position)}getGroup(){return this.modules.group||!1}getComponent(){return this.component||(this.component=new Oa(this)),this.component}}var _b={avg:function(r,e,t){var i=0,n=typeof t.precision<"u"?t.precision:2;return r.length&&(i=r.reduce(function(s,a){return Number(s)+Number(a)}),i=i/r.length,i=n!==!1?i.toFixed(n):i),parseFloat(i).toString()},max:function(r,e,t){var i=null,n=typeof t.precision<"u"?t.precision:!1;return r.forEach(function(s){s=Number(s),(s>i||i===null)&&(i=s)}),i!==null?n!==!1?i.toFixed(n):i:""},min:function(r,e,t){var i=null,n=typeof t.precision<"u"?t.precision:!1;return r.forEach(function(s){s=Number(s),(s<i||i===null)&&(i=s)}),i!==null?n!==!1?i.toFixed(n):i:""},sum:function(r,e,t){var i=0,n=typeof t.precision<"u"?t.precision:!1;return r.length&&r.forEach(function(s){s=Number(s),i+=isNaN(s)?0:Number(s)}),n!==!1?i.toFixed(n):i},concat:function(r,e,t){var i=0;return r.length&&(i=r.reduce(function(n,s){return String(n)+String(s)})),i},count:function(r,e,t){var i=0;return r.length&&r.forEach(function(n){n&&i++}),i},unique:function(r,e,t){var i=r.filter((n,s)=>(r||n===0)&&r.indexOf(n)===s);return i.length}};const lr=class lr extends ke{constructor(e){super(e),this.topCalcs=[],this.botCalcs=[],this.genColumn=!1,this.topElement=this.createElement(),this.botElement=this.createElement(),this.topRow=!1,this.botRow=!1,this.topInitialized=!1,this.botInitialized=!1,this.blocked=!1,this.recalcAfterBlock=!1,this.registerTableOption("columnCalcs",!0),this.registerColumnOption("topCalc"),this.registerColumnOption("topCalcParams"),this.registerColumnOption("topCalcFormatter"),this.registerColumnOption("topCalcFormatterParams"),this.registerColumnOption("bottomCalc"),this.registerColumnOption("bottomCalcParams"),this.registerColumnOption("bottomCalcFormatter"),this.registerColumnOption("bottomCalcFormatterParams")}createElement(){var e=document.createElement("div");return e.classList.add("tabulator-calcs-holder"),e}initialize(){this.genColumn=new Ir({field:"value"},this),this.subscribe("cell-value-changed",this.cellValueChanged.bind(this)),this.subscribe("column-init",this.initializeColumnCheck.bind(this)),this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("scroll-horizontal",this.scrollHorizontal.bind(this)),this.subscribe("row-added",this.rowsUpdated.bind(this)),this.subscribe("column-moved",this.recalcActiveRows.bind(this)),this.subscribe("column-add",this.recalcActiveRows.bind(this)),this.subscribe("data-refreshed",this.recalcActiveRowsRefresh.bind(this)),this.subscribe("table-redraw",this.tableRedraw.bind(this)),this.subscribe("rows-visible",this.visibleRows.bind(this)),this.subscribe("scrollbar-vertical",this.adjustForScrollbar.bind(this)),this.subscribe("redraw-blocked",this.blockRedraw.bind(this)),this.subscribe("redraw-restored",this.restoreRedraw.bind(this)),this.subscribe("table-redrawing",this.resizeHolderWidth.bind(this)),this.subscribe("column-resized",this.resizeHolderWidth.bind(this)),this.subscribe("column-show",this.resizeHolderWidth.bind(this)),this.subscribe("column-hide",this.resizeHolderWidth.bind(this)),this.registerTableFunction("getCalcResults",this.getResults.bind(this)),this.registerTableFunction("recalc",this.userRecalc.bind(this)),this.resizeHolderWidth()}resizeHolderWidth(){this.topElement.style.minWidth=this.table.columnManager.headersElement.offsetWidth+"px"}tableRedraw(e){this.recalc(this.table.rowManager.activeRows),e&&this.redraw()}blockRedraw(){this.blocked=!0,this.recalcAfterBlock=!1}restoreRedraw(){this.blocked=!1,this.recalcAfterBlock&&(this.recalcAfterBlock=!1,this.recalcActiveRowsRefresh())}userRecalc(){this.recalc(this.table.rowManager.activeRows)}blockCheck(){return this.blocked&&(this.recalcAfterBlock=!0),this.blocked}visibleRows(e,t){return this.topRow&&t.unshift(this.topRow),this.botRow&&t.push(this.botRow),t}rowsUpdated(e){this.table.options.groupBy?this.recalcRowGroup(e):this.recalcActiveRows()}recalcActiveRowsRefresh(){this.table.options.groupBy&&this.table.options.dataTreeStartExpanded&&this.table.options.dataTree?this.recalcAll():this.recalcActiveRows()}recalcActiveRows(){this.recalc(this.table.rowManager.activeRows)}cellValueChanged(e){(e.column.definition.topCalc||e.column.definition.bottomCalc)&&(this.table.options.groupBy?((this.table.options.columnCalcs=="table"||this.table.options.columnCalcs=="both")&&this.recalcActiveRows(),this.table.options.columnCalcs!="table"&&this.recalcRowGroup(e.row)):this.recalcActiveRows())}initializeColumnCheck(e){(e.definition.topCalc||e.definition.bottomCalc)&&this.initializeColumn(e)}initializeColumn(e){var t=e.definition,i={topCalcParams:t.topCalcParams||{},botCalcParams:t.bottomCalcParams||{}};if(t.topCalc){switch(typeof t.topCalc){case"string":lr.calculations[t.topCalc]?i.topCalc=lr.calculations[t.topCalc]:console.warn("Column Calc Error - No such calculation found, ignoring: ",t.topCalc);break;case"function":i.topCalc=t.topCalc;break}i.topCalc&&(e.modules.columnCalcs=i,this.topCalcs.push(e),this.table.options.columnCalcs!="group"&&this.initializeTopRow())}if(t.bottomCalc){switch(typeof t.bottomCalc){case"string":lr.calculations[t.bottomCalc]?i.botCalc=lr.calculations[t.bottomCalc]:console.warn("Column Calc Error - No such calculation found, ignoring: ",t.bottomCalc);break;case"function":i.botCalc=t.bottomCalc;break}i.botCalc&&(e.modules.columnCalcs=i,this.botCalcs.push(e),this.table.options.columnCalcs!="group"&&this.initializeBottomRow())}}registerColumnField(){}removeCalcs(){var e=!1;this.topInitialized&&(this.topInitialized=!1,this.topElement.parentNode.removeChild(this.topElement),e=!0),this.botInitialized&&(this.botInitialized=!1,this.footerRemove(this.botElement),e=!0),e&&this.table.rowManager.adjustTableSize()}reinitializeCalcs(){this.topCalcs.length&&this.initializeTopRow(),this.botCalcs.length&&this.initializeBottomRow()}initializeTopRow(){var e=document.createDocumentFragment();this.topInitialized||(e.appendChild(document.createElement("br")),e.appendChild(this.topElement),this.table.columnManager.getContentsElement().insertBefore(e,this.table.columnManager.headersElement.nextSibling),this.topInitialized=!0)}initializeBottomRow(){this.botInitialized||(this.footerPrepend(this.botElement),this.botInitialized=!0)}scrollHorizontal(e){this.botInitialized&&this.botRow&&(this.botElement.scrollLeft=e)}recalc(e){var t,i;if(!this.blockCheck()&&(this.topInitialized||this.botInitialized)){if(t=this.rowsToData(e),this.topInitialized){for(this.topRow&&this.topRow.deleteCells(),i=this.generateRow("top",t),this.topRow=i;this.topElement.firstChild;)this.topElement.removeChild(this.topElement.firstChild);this.topElement.appendChild(i.getElement()),i.initialize(!0)}if(this.botInitialized){for(this.botRow&&this.botRow.deleteCells(),i=this.generateRow("bottom",t),this.botRow=i;this.botElement.firstChild;)this.botElement.removeChild(this.botElement.firstChild);this.botElement.appendChild(i.getElement()),i.initialize(!0)}this.table.rowManager.adjustTableSize(),this.table.modExists("frozenColumns")&&this.table.modules.frozenColumns.layout()}}recalcRowGroup(e){this.recalcGroup(this.table.modules.groupRows.getRowGroup(e))}recalcAll(){if((this.topCalcs.length||this.botCalcs.length)&&(this.table.options.columnCalcs!=="group"&&this.recalcActiveRows(),this.table.options.groupBy&&this.table.options.columnCalcs!=="table")){var e=this.table.modules.groupRows.getChildGroups();e.forEach(t=>{this.recalcGroup(t)})}}recalcGroup(e){var t,i;this.blockCheck()||e&&e.calcs&&(e.calcs.bottom&&(t=this.rowsToData(e.rows),i=this.generateRowData("bottom",t),e.calcs.bottom.updateData(i),e.calcs.bottom.reinitialize()),e.calcs.top&&(t=this.rowsToData(e.rows),i=this.generateRowData("top",t),e.calcs.top.updateData(i),e.calcs.top.reinitialize()))}generateTopRow(e){return this.generateRow("top",this.rowsToData(e))}generateBottomRow(e){return this.generateRow("bottom",this.rowsToData(e))}rowsToData(e){var t=[],i=this.table.options.dataTree&&this.table.options.dataTreeChildColumnCalcs,n=this.table.modules.dataTree;return e.forEach(s=>{var a;t.push(s.getData()),i&&((a=s.modules.dataTree)!=null&&a.open)&&this.rowsToData(n.getFilteredTreeChildren(s)).forEach(o=>{t.push(s)})}),t}generateRow(e,t){var i=this.generateRowData(e,t),n;return this.table.modExists("mutator")&&this.table.modules.mutator.disable(),n=new It(i,this,"calc"),this.table.modExists("mutator")&&this.table.modules.mutator.enable(),n.getElement().classList.add("tabulator-calcs","tabulator-calcs-"+e),n.component=!1,n.getComponent=()=>(n.component||(n.component=new Cb(n)),n.component),n.generateCells=()=>{var s=[];this.table.columnManager.columnsByIndex.forEach(a=>{this.genColumn.setField(a.getField()),this.genColumn.hozAlign=a.hozAlign,a.definition[e+"CalcFormatter"]&&this.table.modExists("format")?this.genColumn.modules.format={formatter:this.table.modules.format.lookupFormatter(a.definition[e+"CalcFormatter"]),params:a.definition[e+"CalcFormatterParams"]||{}}:this.genColumn.modules.format={formatter:this.table.modules.format.lookupFormatter("plaintext"),params:{}},this.genColumn.definition.cssClass=a.definition.cssClass;var o=new ms(this.genColumn,n);o.getElement(),o.column=a,o.setWidth(),a.cells.push(o),s.push(o),a.visible||o.hide()}),n.cells=s},n}generateRowData(e,t){var i={},n=e=="top"?this.topCalcs:this.botCalcs,s=e=="top"?"topCalc":"botCalc",a,o;return n.forEach(function(l){var h=[];l.modules.columnCalcs&&l.modules.columnCalcs[s]&&(t.forEach(function(u){h.push(l.getFieldValue(u))}),o=s+"Params",a=typeof l.modules.columnCalcs[o]=="function"?l.modules.columnCalcs[o](h,t):l.modules.columnCalcs[o],l.setFieldValue(i,l.modules.columnCalcs[s](h,t,a)))}),i}hasTopCalcs(){return!!this.topCalcs.length}hasBottomCalcs(){return!!this.botCalcs.length}redraw(){this.topRow&&this.topRow.normalizeHeight(!0),this.botRow&&this.botRow.normalizeHeight(!0)}getResults(){var e={},t;return this.table.options.groupBy&&this.table.modExists("groupRows")?(t=this.table.modules.groupRows.getGroups(!0),t.forEach(i=>{e[i.getKey()]=this.getGroupResults(i)})):e={top:this.topRow?this.topRow.getData():{},bottom:this.botRow?this.botRow.getData():{}},e}getGroupResults(e){var t=e._getSelf(),i=e.getSubGroups(),n={},s={};return i.forEach(a=>{n[a.getKey()]=this.getGroupResults(a)}),s={top:t.calcs.top?t.calcs.top.getData():{},bottom:t.calcs.bottom?t.calcs.bottom.getData():{},groups:n},s}adjustForScrollbar(e){this.botRow&&(this.table.rtl?this.botElement.style.paddingLeft=e+"px":this.botElement.style.paddingRight=e+"px")}};G(lr,"moduleName","columnCalcs"),G(lr,"calculations",_b);let Po=lr;class vc extends ke{constructor(e){super(e),this.indent=10,this.field="",this.collapseEl=null,this.expandEl=null,this.branchEl=null,this.elementField=!1,this.startOpen=function(){},this.registerTableOption("dataTree",!1),this.registerTableOption("dataTreeFilter",!0),this.registerTableOption("dataTreeSort",!0),this.registerTableOption("dataTreeElementColumn",!1),this.registerTableOption("dataTreeBranchElement",!0),this.registerTableOption("dataTreeChildIndent",9),this.registerTableOption("dataTreeChildField","_children"),this.registerTableOption("dataTreeCollapseElement",!1),this.registerTableOption("dataTreeExpandElement",!1),this.registerTableOption("dataTreeStartExpanded",!1),this.registerTableOption("dataTreeChildColumnCalcs",!1),this.registerTableOption("dataTreeSelectPropagate",!1),this.registerComponentFunction("row","treeCollapse",this.collapseRow.bind(this)),this.registerComponentFunction("row","treeExpand",this.expandRow.bind(this)),this.registerComponentFunction("row","treeToggle",this.toggleRow.bind(this)),this.registerComponentFunction("row","getTreeParent",this.getTreeParent.bind(this)),this.registerComponentFunction("row","getTreeChildren",this.getRowChildren.bind(this)),this.registerComponentFunction("row","addTreeChild",this.addTreeChildRow.bind(this)),this.registerComponentFunction("row","isTreeExpanded",this.isRowExpanded.bind(this))}initialize(){if(this.table.options.dataTree){var e=null,t=this.table.options;switch(this.field=t.dataTreeChildField,this.indent=t.dataTreeChildIndent,this.options("movableRows")&&console.warn("The movableRows option is not available with dataTree enabled, moving of child rows could result in unpredictable behavior"),t.dataTreeBranchElement?t.dataTreeBranchElement===!0?(this.branchEl=document.createElement("div"),this.branchEl.classList.add("tabulator-data-tree-branch")):typeof t.dataTreeBranchElement=="string"?(e=document.createElement("div"),e.innerHTML=t.dataTreeBranchElement,this.branchEl=e.firstChild):this.branchEl=t.dataTreeBranchElement:(this.branchEl=document.createElement("div"),this.branchEl.classList.add("tabulator-data-tree-branch-empty")),t.dataTreeCollapseElement?typeof t.dataTreeCollapseElement=="string"?(e=document.createElement("div"),e.innerHTML=t.dataTreeCollapseElement,this.collapseEl=e.firstChild):this.collapseEl=t.dataTreeCollapseElement:(this.collapseEl=document.createElement("div"),this.collapseEl.classList.add("tabulator-data-tree-control"),this.collapseEl.tabIndex=0,this.collapseEl.innerHTML="<div class='tabulator-data-tree-control-collapse'></div>"),t.dataTreeExpandElement?typeof t.dataTreeExpandElement=="string"?(e=document.createElement("div"),e.innerHTML=t.dataTreeExpandElement,this.expandEl=e.firstChild):this.expandEl=t.dataTreeExpandElement:(this.expandEl=document.createElement("div"),this.expandEl.classList.add("tabulator-data-tree-control"),this.expandEl.tabIndex=0,this.expandEl.innerHTML="<div class='tabulator-data-tree-control-expand'></div>"),typeof t.dataTreeStartExpanded){case"boolean":this.startOpen=function(i,n){return t.dataTreeStartExpanded};break;case"function":this.startOpen=t.dataTreeStartExpanded;break;default:this.startOpen=function(i,n){return t.dataTreeStartExpanded[n]};break}this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-layout-after",this.layoutRow.bind(this)),this.subscribe("row-deleting",this.rowDeleting.bind(this)),this.subscribe("row-deleted",this.rowDelete.bind(this),0),this.subscribe("row-data-changed",this.rowDataChanged.bind(this),10),this.subscribe("cell-value-updated",this.cellValueChanged.bind(this)),this.subscribe("edit-cancelled",this.cellValueChanged.bind(this)),this.subscribe("column-moving-rows",this.columnMoving.bind(this)),this.subscribe("table-built",this.initializeElementField.bind(this)),this.subscribe("table-redrawing",this.tableRedrawing.bind(this)),this.registerDisplayHandler(this.getRows.bind(this),30)}}tableRedrawing(e){var t;e&&(t=this.table.rowManager.getRows(),t.forEach(i=>{this.reinitializeRowChildren(i)}))}initializeElementField(){var e=this.table.columnManager.getFirstVisibleColumn();this.elementField=this.table.options.dataTreeElementColumn||(e?e.field:!1)}getRowChildren(e){return this.getTreeChildren(e,!0)}columnMoving(){var e=[];return this.table.rowManager.rows.forEach(t=>{e=e.concat(this.getTreeChildren(t,!1,!0))}),e}rowDataChanged(e,t,i){this.redrawNeeded(i)&&(this.initializeRow(e),t&&(this.layoutRow(e),this.refreshData(!0)))}cellValueChanged(e){var t=e.column.getField();t===this.elementField&&this.layoutRow(e.row)}initializeRow(e){var t=e.getData()[this.field],i=Array.isArray(t),n=i||!i&&typeof t=="object"&&t!==null;!n&&e.modules.dataTree&&e.modules.dataTree.branchEl&&e.modules.dataTree.branchEl.parentNode.removeChild(e.modules.dataTree.branchEl),!n&&e.modules.dataTree&&e.modules.dataTree.controlEl&&e.modules.dataTree.controlEl.parentNode.removeChild(e.modules.dataTree.controlEl),e.modules.dataTree={index:e.modules.dataTree?e.modules.dataTree.index:0,open:n?e.modules.dataTree?e.modules.dataTree.open:this.startOpen(e.getComponent(),0):!1,controlEl:e.modules.dataTree&&n?e.modules.dataTree.controlEl:!1,branchEl:e.modules.dataTree&&n?e.modules.dataTree.branchEl:!1,parent:e.modules.dataTree?e.modules.dataTree.parent:!1,children:n}}reinitializeRowChildren(e){var t=this.getTreeChildren(e,!1,!0);t.forEach(function(i){i.reinitialize(!0)})}layoutRow(e){var t=this.elementField?e.getCell(this.elementField):e.getCells()[0],i=t.getElement(),n=e.modules.dataTree;n.branchEl&&(n.branchEl.parentNode&&n.branchEl.parentNode.removeChild(n.branchEl),n.branchEl=!1),n.controlEl&&(n.controlEl.parentNode&&n.controlEl.parentNode.removeChild(n.controlEl),n.controlEl=!1),this.generateControlElement(e,i),e.getElement().classList.add("tabulator-tree-level-"+n.index),n.index&&(this.branchEl?(n.branchEl=this.branchEl.cloneNode(!0),i.insertBefore(n.branchEl,i.firstChild),this.table.rtl?n.branchEl.style.marginRight=(n.branchEl.offsetWidth+n.branchEl.style.marginLeft)*(n.index-1)+n.index*this.indent+"px":n.branchEl.style.marginLeft=(n.branchEl.offsetWidth+n.branchEl.style.marginRight)*(n.index-1)+n.index*this.indent+"px"):this.table.rtl?i.style.paddingRight=parseInt(window.getComputedStyle(i,null).getPropertyValue("padding-right"))+n.index*this.indent+"px":i.style.paddingLeft=parseInt(window.getComputedStyle(i,null).getPropertyValue("padding-left"))+n.index*this.indent+"px")}generateControlElement(e,t){var i=e.modules.dataTree,n=i.controlEl;t=t||e.getCells()[0].getElement(),i.children!==!1&&(i.open?(i.controlEl=this.collapseEl.cloneNode(!0),i.controlEl.addEventListener("click",s=>{s.stopPropagation(),this.collapseRow(e)})):(i.controlEl=this.expandEl.cloneNode(!0),i.controlEl.addEventListener("click",s=>{s.stopPropagation(),this.expandRow(e)})),i.controlEl.addEventListener("mousedown",s=>{s.stopPropagation()}),n&&n.parentNode===t?n.parentNode.replaceChild(i.controlEl,n):t.insertBefore(i.controlEl,t.firstChild))}getRows(e){var t=[];return e.forEach((i,n)=>{var s,a;t.push(i),i instanceof It&&(i.create(),s=i.modules.dataTree,!s.index&&s.children!==!1&&(a=this.getChildren(i,!1,!0),a.forEach(o=>{o.create(),t.push(o)})))}),t}getChildren(e,t,i){var n=e.modules.dataTree,s=[],a=[];return n.children!==!1&&(n.open||t)&&(Array.isArray(n.children)||(n.children=this.generateChildren(e)),this.table.modExists("filter")&&this.table.options.dataTreeFilter?s=this.table.modules.filter.filter(n.children):s=n.children,this.table.modExists("sort")&&this.table.options.dataTreeSort&&this.table.modules.sort.sort(s,i),s.forEach(o=>{a.push(o);var l=this.getChildren(o,!1,!0);l.forEach(h=>{a.push(h)})})),a}generateChildren(e){var t=[],i=e.getData()[this.field];return Array.isArray(i)||(i=[i]),i.forEach(n=>{var s=new It(n||{},this.table.rowManager);s.create(),s.modules.dataTree.index=e.modules.dataTree.index+1,s.modules.dataTree.parent=e,s.modules.dataTree.children&&(s.modules.dataTree.open=this.startOpen(s.getComponent(),s.modules.dataTree.index)),t.push(s)}),t}expandRow(e,t){var i=e.modules.dataTree;i.children!==!1&&(i.open=!0,e.reinitialize(),this.refreshData(!0),this.dispatchExternal("dataTreeRowExpanded",e.getComponent(),e.modules.dataTree.index))}collapseRow(e){var t=e.modules.dataTree;t.children!==!1&&(t.open=!1,e.reinitialize(),this.refreshData(!0),this.dispatchExternal("dataTreeRowCollapsed",e.getComponent(),e.modules.dataTree.index))}toggleRow(e){var t=e.modules.dataTree;t.children!==!1&&(t.open?this.collapseRow(e):this.expandRow(e))}isRowExpanded(e){return e.modules.dataTree.open}getTreeParent(e){return e.modules.dataTree.parent?e.modules.dataTree.parent.getComponent():!1}getTreeParentRoot(e){return e.modules.dataTree&&e.modules.dataTree.parent?this.getTreeParentRoot(e.modules.dataTree.parent):e}getFilteredTreeChildren(e){var t=e.modules.dataTree,i=[],n;return t.children&&(Array.isArray(t.children)||(t.children=this.generateChildren(e)),this.table.modExists("filter")&&this.table.options.dataTreeFilter?n=this.table.modules.filter.filter(t.children):n=t.children,n.forEach(s=>{s instanceof It&&i.push(s)})),i}rowDeleting(e){var t=e.modules.dataTree;t&&t.children&&Array.isArray(t.children)&&t.children.forEach(i=>{i instanceof It&&i.wipe()})}rowDelete(e){var t=e.modules.dataTree.parent,i;t&&(i=this.findChildIndex(e,t),i!==!1&&t.data[this.field].splice(i,1),t.data[this.field].length||delete t.data[this.field],this.initializeRow(t),this.layoutRow(t)),this.refreshData(!0)}addTreeChildRow(e,t,i,n){var s=!1;typeof t=="string"&&(t=JSON.parse(t)),Array.isArray(e.data[this.field])||(e.data[this.field]=[],e.modules.dataTree.open=this.startOpen(e.getComponent(),e.modules.dataTree.index)),typeof n<"u"&&(s=this.findChildIndex(n,e),s!==!1&&e.data[this.field].splice(i?s:s+1,0,t)),s===!1&&(i?e.data[this.field].unshift(t):e.data[this.field].push(t)),this.initializeRow(e),this.layoutRow(e),this.refreshData(!0)}findChildIndex(e,t){var i=!1;return typeof e=="object"?e instanceof It?i=e.data:e instanceof Oa?i=e._getSelf().data:typeof HTMLElement<"u"&&e instanceof HTMLElement?t.modules.dataTree&&(i=t.modules.dataTree.children.find(n=>n instanceof It?n.element===e:!1),i&&(i=i.data)):e===null&&(i=!1):typeof e>"u"?i=!1:i=t.data[this.field].find(n=>n.data[this.table.options.index]==e),i&&(Array.isArray(t.data[this.field])&&(i=t.data[this.field].indexOf(i)),i==-1&&(i=!1)),i}getTreeChildren(e,t,i){var n=e.modules.dataTree,s=[];return n&&n.children&&(Array.isArray(n.children)||(n.children=this.generateChildren(e)),n.children.forEach(a=>{a instanceof It&&(s.push(t?a.getComponent():a),i&&this.getTreeChildren(a,t,i).forEach(o=>{s.push(o)}))})),s}getChildField(){return this.field}redrawNeeded(e){return(this.field?typeof e[this.field]<"u":!1)||(this.elementField?typeof e[this.elementField]<"u":!1)}}G(vc,"moduleName","dataTree");function Tb(r,e={},t){var i=e.delimiter?e.delimiter:",",n=[],s=[];r.forEach(a=>{var o=[];switch(a.type){case"group":console.warn("Download Warning - CSV downloader cannot process row groups");break;case"calc":console.warn("Download Warning - CSV downloader cannot process column calculations");break;case"header":a.columns.forEach((l,h)=>{l&&l.depth===1&&(s[h]=typeof l.value>"u"||l.value===null?"":'"'+String(l.value).split('"').join('""')+'"')});break;case"row":a.columns.forEach(l=>{if(l){switch(typeof l.value){case"object":l.value=l.value!==null?JSON.stringify(l.value):"";break;case"undefined":l.value="";break}o.push('"'+String(l.value).split('"').join('""')+'"')}}),n.push(o.join(i));break}}),s.length&&n.unshift(s.join(i)),n=n.join(`
`),e.bom&&(n="\uFEFF"+n),t(n,"text/csv")}function Sb(r,e,t){var i=[];r.forEach(n=>{var s={};switch(n.type){case"header":break;case"group":console.warn("Download Warning - JSON downloader cannot process row groups");break;case"calc":console.warn("Download Warning - JSON downloader cannot process column calculations");break;case"row":n.columns.forEach(a=>{a&&(s[a.component.getTitleDownload()||a.component.getField()]=a.value)}),i.push(s);break}}),i=JSON.stringify(i,null,"	"),t(i,"application/json")}function Db(r,e={},t){var i=[],n=[],s={},a=e.rowGroupStyles||{fontStyle:"bold",fontSize:12,cellPadding:6,fillColor:220},o=e.rowCalcStyles||{fontStyle:"bold",fontSize:10,cellPadding:4,fillColor:232},l=e.jsPDF||{},h=e.title?e.title:"",u,d;l.orientation||(l.orientation=e.orientation||"landscape"),l.unit||(l.unit="pt"),r.forEach(f=>{switch(f.type){case"header":i.push(c(f));break;case"group":n.push(c(f,a));break;case"calc":n.push(c(f,o));break;case"row":n.push(c(f));break}});function c(f,p){var v=[];return f.columns.forEach(m=>{var g;if(m){switch(typeof m.value){case"object":m.value=m.value!==null?JSON.stringify(m.value):"";break;case"undefined":m.value="";break}g={content:m.value,colSpan:m.width,rowSpan:m.height},p&&(g.styles=p),v.push(g)}}),v}u=this.dependencyRegistry.lookup("jspdf","jsPDF"),d=new u(l),e.autoTable&&(typeof e.autoTable=="function"?s=e.autoTable(d)||{}:s=e.autoTable),h&&(s.didDrawPage=function(f){d.text(h,40,30)}),s.head=i,s.body=n,d.autoTable(s),e.documentProcessing&&e.documentProcessing(d),t(d.output("arraybuffer"),"application/pdf")}function kb(r,e,t){var i=this,n=e.sheetName||"Sheet1",s=this.dependencyRegistry.lookup("XLSX"),a=s.utils.book_new(),o=new At(this),l="compress"in e?e.compress:!0,h=e.writeOptions||{bookType:"xlsx",bookSST:!0,compression:l},u;h.type="binary",a.SheetNames=[],a.Sheets={};function d(){var p=[],v=[],m={},g={s:{c:0,r:0},e:{c:r[0]?r[0].columns.reduce((x,b)=>x+(b&&b.width?b.width:1),0):0,r:r.length}};return r.forEach((x,b)=>{var F=[];x.columns.forEach(function(A,_){A?(F.push(!(A.value instanceof Date)&&typeof A.value=="object"?JSON.stringify(A.value):A.value),(A.width>1||A.height>-1)&&(A.height>1||A.width>1)&&v.push({s:{r:b,c:_},e:{r:b+A.height-1,c:_+A.width-1}})):F.push("")}),p.push(F)}),s.utils.sheet_add_aoa(m,p),m["!ref"]=s.utils.encode_range(g),v.length&&(m["!merges"]=v),m}if(e.sheetOnly){t(d());return}if(e.sheets)for(var c in e.sheets)e.sheets[c]===!0?(a.SheetNames.push(c),a.Sheets[c]=d()):(a.SheetNames.push(c),o.commsSend(e.sheets[c],"download","intercept",{type:"xlsx",options:{sheetOnly:!0},active:i.active,intercept:function(p){a.Sheets[c]=p}}));else a.SheetNames.push(n),a.Sheets[n]=d();e.documentProcessing&&(a=e.documentProcessing(a));function f(p){for(var v=new ArrayBuffer(p.length),m=new Uint8Array(v),g=0;g!=p.length;++g)m[g]=p.charCodeAt(g)&255;return v}u=s.write(a,h),t(f(u),"application/octet-stream")}function Rb(r,e,t){this.modExists("export",!0)&&t(this.modules.export.generateHTMLTable(r),"text/html")}function Fb(r,e,t){const i=[];r.forEach(n=>{const s={};switch(n.type){case"header":break;case"group":console.warn("Download Warning - JSON downloader cannot process row groups");break;case"calc":console.warn("Download Warning - JSON downloader cannot process column calculations");break;case"row":n.columns.forEach(a=>{a&&(s[a.component.getTitleDownload()||a.component.getField()]=a.value)}),i.push(JSON.stringify(s));break}}),t(i.join(`
`),"application/x-ndjson")}var Mb={csv:Tb,json:Sb,jsonLines:Fb,pdf:Db,xlsx:kb,html:Rb};const an=class an extends ke{constructor(e){super(e),this.registerTableOption("downloadEncoder",function(t,i){return new Blob([t],{type:i})}),this.registerTableOption("downloadConfig",{}),this.registerTableOption("downloadRowRange","active"),this.registerColumnOption("download"),this.registerColumnOption("titleDownload")}initialize(){this.deprecatedOptionsCheck(),this.registerTableFunction("download",this.download.bind(this)),this.registerTableFunction("downloadToTab",this.downloadToTab.bind(this))}deprecatedOptionsCheck(){}downloadToTab(e,t,i,n){this.download(e,t,i,n,!0)}download(e,t,i,n,s){var a=!1;function o(h,u){s?s===!0?this.triggerDownload(h,u,e,t,!0):s(h):this.triggerDownload(h,u,e,t)}if(typeof e=="function"?a=e:an.downloaders[e]?a=an.downloaders[e]:console.warn("Download Error - No such download type found: ",e),a){var l=this.generateExportList(n);a.call(this.table,l,i||{},o.bind(this))}}generateExportList(e){var t=this.table.modules.export.generateExportList(this.table.options.downloadConfig,!1,e||this.table.options.downloadRowRange,"download"),i=this.table.options.groupHeaderDownload;return i&&!Array.isArray(i)&&(i=[i]),t.forEach(n=>{var s;n.type==="group"&&(s=n.columns[0],i&&i[n.indent]&&(s.value=i[n.indent](s.value,n.component._group.getRowCount(),n.component._group.getData(),n.component)))}),t}triggerDownload(e,t,i,n,s){var a=document.createElement("a"),o=this.table.options.downloadEncoder(e,t);o&&(s?window.open(window.URL.createObjectURL(o)):(n=n||"Tabulator."+(typeof i=="function"?"txt":i),navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(o,n):(a.setAttribute("href",window.URL.createObjectURL(o)),a.setAttribute("download",n),a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a))),this.dispatchExternal("downloadComplete"))}commsReceived(e,t,i){switch(t){case"intercept":this.download(i.type,"",i.options,i.active,i.intercept);break}}};G(an,"moduleName","download"),G(an,"downloaders",Mb);let No=an;function La(r,e){var t=e.mask,i=typeof e.maskLetterChar<"u"?e.maskLetterChar:"A",n=typeof e.maskNumberChar<"u"?e.maskNumberChar:"9",s=typeof e.maskWildcardChar<"u"?e.maskWildcardChar:"*";function a(o){var l=t[o];typeof l<"u"&&l!==s&&l!==i&&l!==n&&(r.value=r.value+""+l,a(o+1))}r.addEventListener("keydown",o=>{var l=r.value.length,h=o.key;if(o.keyCode>46&&!o.ctrlKey&&!o.metaKey){if(l>=t.length)return o.preventDefault(),o.stopPropagation(),!1;switch(t[l]){case i:if(h.toUpperCase()==h.toLowerCase())return o.preventDefault(),o.stopPropagation(),!1;break;case n:if(isNaN(h))return o.preventDefault(),o.stopPropagation(),!1;break;case s:break;default:if(h!==t[l])return o.preventDefault(),o.stopPropagation(),!1}}}),r.addEventListener("keyup",o=>{o.keyCode>46&&e.maskAutoFill&&a(r.value.length)}),r.placeholder||(r.placeholder=t),e.maskAutoFill&&a(r.value.length)}function Ab(r,e,t,i,n){var s=r.getValue(),a=document.createElement("input");if(a.setAttribute("type",n.search?"search":"text"),a.style.padding="4px",a.style.width="100%",a.style.boxSizing="border-box",n.elementAttributes&&typeof n.elementAttributes=="object")for(let l in n.elementAttributes)l.charAt(0)=="+"?(l=l.slice(1),a.setAttribute(l,a.getAttribute(l)+n.elementAttributes["+"+l])):a.setAttribute(l,n.elementAttributes[l]);a.value=typeof s<"u"?s:"",e(function(){r.getType()==="cell"&&(a.focus({preventScroll:!0}),a.style.height="100%",n.selectContents&&a.select())});function o(l){(s===null||typeof s>"u")&&a.value!==""||a.value!==s?t(a.value)&&(s=a.value):i()}return a.addEventListener("change",o),a.addEventListener("blur",o),a.addEventListener("keydown",function(l){switch(l.keyCode){case 13:o();break;case 27:i();break;case 35:case 36:l.stopPropagation();break}}),n.mask&&La(a,n),a}function Ob(r,e,t,i,n){var s=r.getValue(),a=n.verticalNavigation||"hybrid",o=String(s!==null&&typeof s<"u"?s:""),l=document.createElement("textarea"),h=0;if(l.style.display="block",l.style.padding="2px",l.style.height="100%",l.style.width="100%",l.style.boxSizing="border-box",l.style.whiteSpace="pre-wrap",l.style.resize="none",n.elementAttributes&&typeof n.elementAttributes=="object")for(let d in n.elementAttributes)d.charAt(0)=="+"?(d=d.slice(1),l.setAttribute(d,l.getAttribute(d)+n.elementAttributes["+"+d])):l.setAttribute(d,n.elementAttributes[d]);l.value=o,e(function(){r.getType()==="cell"&&(l.focus({preventScroll:!0}),l.style.height="100%",l.scrollHeight,l.style.height=l.scrollHeight+"px",r.getRow().normalizeHeight(),n.selectContents&&l.select())});function u(d){(s===null||typeof s>"u")&&l.value!==""||l.value!==s?(t(l.value)&&(s=l.value),setTimeout(function(){r.getRow().normalizeHeight()},300)):i()}return l.addEventListener("change",u),l.addEventListener("blur",u),l.addEventListener("keyup",function(){l.style.height="";var d=l.scrollHeight;l.style.height=d+"px",d!=h&&(h=d,r.getRow().normalizeHeight())}),l.addEventListener("keydown",function(d){switch(d.keyCode){case 13:d.shiftKey&&n.shiftEnterSubmit&&u();break;case 27:i();break;case 38:(a=="editor"||a=="hybrid"&&l.selectionStart)&&(d.stopImmediatePropagation(),d.stopPropagation());break;case 40:(a=="editor"||a=="hybrid"&&l.selectionStart!==l.value.length)&&(d.stopImmediatePropagation(),d.stopPropagation());break;case 35:case 36:d.stopPropagation();break}}),n.mask&&La(l,n),l}function Lb(r,e,t,i,n){var s=r.getValue(),a=n.verticalNavigation||"editor",o=document.createElement("input");if(o.setAttribute("type","number"),typeof n.max<"u"&&o.setAttribute("max",n.max),typeof n.min<"u"&&o.setAttribute("min",n.min),typeof n.step<"u"&&o.setAttribute("step",n.step),o.style.padding="4px",o.style.width="100%",o.style.boxSizing="border-box",n.elementAttributes&&typeof n.elementAttributes=="object")for(let u in n.elementAttributes)u.charAt(0)=="+"?(u=u.slice(1),o.setAttribute(u,o.getAttribute(u)+n.elementAttributes["+"+u])):o.setAttribute(u,n.elementAttributes[u]);o.value=s;var l=function(u){h()};e(function(){r.getType()==="cell"&&(o.removeEventListener("blur",l),o.focus({preventScroll:!0}),o.style.height="100%",o.addEventListener("blur",l),n.selectContents&&o.select())});function h(){var u=o.value;!isNaN(u)&&u!==""&&(u=Number(u)),u!==s?t(u)&&(s=u):i()}return o.addEventListener("keydown",function(u){switch(u.keyCode){case 13:h();break;case 27:i();break;case 38:case 40:a=="editor"&&(u.stopImmediatePropagation(),u.stopPropagation());break;case 35:case 36:u.stopPropagation();break}}),n.mask&&La(o,n),o}function Pb(r,e,t,i,n){var s=r.getValue(),a=document.createElement("input");if(a.setAttribute("type","range"),typeof n.max<"u"&&a.setAttribute("max",n.max),typeof n.min<"u"&&a.setAttribute("min",n.min),typeof n.step<"u"&&a.setAttribute("step",n.step),a.style.padding="4px",a.style.width="100%",a.style.boxSizing="border-box",n.elementAttributes&&typeof n.elementAttributes=="object")for(let l in n.elementAttributes)l.charAt(0)=="+"?(l=l.slice(1),a.setAttribute(l,a.getAttribute(l)+n.elementAttributes["+"+l])):a.setAttribute(l,n.elementAttributes[l]);a.value=s,e(function(){r.getType()==="cell"&&(a.focus({preventScroll:!0}),a.style.height="100%")});function o(){var l=a.value;!isNaN(l)&&l!==""&&(l=Number(l)),l!=s?t(l)&&(s=l):i()}return a.addEventListener("blur",function(l){o()}),a.addEventListener("keydown",function(l){switch(l.keyCode){case 13:o();break;case 27:i();break}}),a}function Nb(r,e,t,i,n){var s=n.format,a=n.verticalNavigation||"editor",o=s?window.DateTime||luxon.DateTime:null,l=r.getValue(),h=document.createElement("input");function u(c){var f;return o.isDateTime(c)?f=c:s==="iso"?f=o.fromISO(String(c)):f=o.fromFormat(String(c),s),f.toFormat("yyyy-MM-dd")}if(h.type="date",h.style.padding="4px",h.style.width="100%",h.style.boxSizing="border-box",n.max&&h.setAttribute("max",s?u(n.max):n.max),n.min&&h.setAttribute("min",s?u(n.min):n.min),n.elementAttributes&&typeof n.elementAttributes=="object")for(let c in n.elementAttributes)c.charAt(0)=="+"?(c=c.slice(1),h.setAttribute(c,h.getAttribute(c)+n.elementAttributes["+"+c])):h.setAttribute(c,n.elementAttributes[c]);l=typeof l<"u"?l:"",s&&(o?l=u(l):console.error("Editor Error - 'date' editor 'format' param is dependant on luxon.js")),h.value=l,e(function(){r.getType()==="cell"&&(h.focus({preventScroll:!0}),h.style.height="100%",n.selectContents&&h.select())});function d(){var c=h.value,f;if((l===null||typeof l>"u")&&c!==""||c!==l){if(c&&s)switch(f=o.fromFormat(String(c),"yyyy-MM-dd"),s){case!0:c=f;break;case"iso":c=f.toISO();break;default:c=f.toFormat(s)}t(c)&&(l=h.value)}else i()}return h.addEventListener("blur",function(c){(c.relatedTarget||c.rangeParent||c.explicitOriginalTarget!==h)&&d()}),h.addEventListener("keydown",function(c){switch(c.keyCode){case 13:d();break;case 27:i();break;case 35:case 36:c.stopPropagation();break;case 38:case 40:a=="editor"&&(c.stopImmediatePropagation(),c.stopPropagation());break}}),h}function Ib(r,e,t,i,n){var s=n.format,a=n.verticalNavigation||"editor",o=s?window.DateTime||luxon.DateTime:null,l,h=r.getValue(),u=document.createElement("input");if(u.type="time",u.style.padding="4px",u.style.width="100%",u.style.boxSizing="border-box",n.elementAttributes&&typeof n.elementAttributes=="object")for(let c in n.elementAttributes)c.charAt(0)=="+"?(c=c.slice(1),u.setAttribute(c,u.getAttribute(c)+n.elementAttributes["+"+c])):u.setAttribute(c,n.elementAttributes[c]);h=typeof h<"u"?h:"",s&&(o?(o.isDateTime(h)?l=h:s==="iso"?l=o.fromISO(String(h)):l=o.fromFormat(String(h),s),h=l.toFormat("HH:mm")):console.error("Editor Error - 'date' editor 'format' param is dependant on luxon.js")),u.value=h,e(function(){r.getType()=="cell"&&(u.focus({preventScroll:!0}),u.style.height="100%",n.selectContents&&u.select())});function d(){var c=u.value,f;if((h===null||typeof h>"u")&&c!==""||c!==h){if(c&&s)switch(f=o.fromFormat(String(c),"hh:mm"),s){case!0:c=f;break;case"iso":c=f.toISO();break;default:c=f.toFormat(s)}t(c)&&(h=u.value)}else i()}return u.addEventListener("blur",function(c){(c.relatedTarget||c.rangeParent||c.explicitOriginalTarget!==u)&&d()}),u.addEventListener("keydown",function(c){switch(c.keyCode){case 13:d();break;case 27:i();break;case 35:case 36:c.stopPropagation();break;case 38:case 40:a=="editor"&&(c.stopImmediatePropagation(),c.stopPropagation());break}}),u}function Bb(r,e,t,i,n){var s=n.format,a=n.verticalNavigation||"editor",o=s?this.table.dependencyRegistry.lookup(["luxon","DateTime"],"DateTime"):null,l,h=r.getValue(),u=document.createElement("input");if(u.type="datetime-local",u.style.padding="4px",u.style.width="100%",u.style.boxSizing="border-box",n.elementAttributes&&typeof n.elementAttributes=="object")for(let c in n.elementAttributes)c.charAt(0)=="+"?(c=c.slice(1),u.setAttribute(c,u.getAttribute(c)+n.elementAttributes["+"+c])):u.setAttribute(c,n.elementAttributes[c]);h=typeof h<"u"?h:"",s&&(o?(o.isDateTime(h)?l=h:s==="iso"?l=o.fromISO(String(h)):l=o.fromFormat(String(h),s),h=l.toFormat("yyyy-MM-dd")+"T"+l.toFormat("HH:mm")):console.error("Editor Error - 'date' editor 'format' param is dependant on luxon.js")),u.value=h,e(function(){r.getType()==="cell"&&(u.focus({preventScroll:!0}),u.style.height="100%",n.selectContents&&u.select())});function d(){var c=u.value,f;if((h===null||typeof h>"u")&&c!==""||c!==h){if(c&&s)switch(f=o.fromISO(String(c)),s){case!0:c=f;break;case"iso":c=f.toISO();break;default:c=f.toFormat(s)}t(c)&&(h=u.value)}else i()}return u.addEventListener("blur",function(c){(c.relatedTarget||c.rangeParent||c.explicitOriginalTarget!==u)&&d()}),u.addEventListener("keydown",function(c){switch(c.keyCode){case 13:d();break;case 27:i();break;case 35:case 36:c.stopPropagation();break;case 38:case 40:a=="editor"&&(c.stopImmediatePropagation(),c.stopPropagation());break}}),u}let Hb=class{constructor(e,t,i,n,s,a){this.edit=e,this.table=e.table,this.cell=t,this.params=this._initializeParams(a),this.data=[],this.displayItems=[],this.currentItems=[],this.focusedItem=null,this.input=this._createInputElement(),this.listEl=this._createListElement(),this.initialValues=null,this.isFilter=t.getType()==="header",this.filterTimeout=null,this.filtered=!1,this.typing=!1,this.values=[],this.popup=null,this.listIteration=0,this.lastAction="",this.filterTerm="",this.blurable=!0,this.actions={success:n,cancel:s},this._deprecatedOptionsCheck(),this._initializeValue(),i(this._onRendered.bind(this))}_deprecatedOptionsCheck(){}_initializeValue(){var e=this.cell.getValue();typeof e>"u"&&typeof this.params.defaultValue<"u"&&(e=this.params.defaultValue),this.initialValues=this.params.multiselect?e:[e],this.isFilter&&(this.input.value=this.initialValues?this.initialValues.join(","):"",this.headerFilterInitialListGen())}_onRendered(){var e=this.cell.getElement();function t(i){i.stopPropagation()}this.isFilter||(this.input.style.height="100%",this.input.focus({preventScroll:!0})),e.addEventListener("click",t),setTimeout(()=>{e.removeEventListener("click",t)},1e3),this.input.addEventListener("mousedown",this._preventPopupBlur.bind(this))}_createListElement(){var e=document.createElement("div");return e.classList.add("tabulator-edit-list"),e.addEventListener("mousedown",this._preventBlur.bind(this)),e.addEventListener("keydown",this._inputKeyDown.bind(this)),e}_setListWidth(){var e=this.isFilter?this.input:this.cell.getElement();this.listEl.style.minWidth=e.offsetWidth+"px",this.params.maxWidth&&(this.params.maxWidth===!0?this.listEl.style.maxWidth=e.offsetWidth+"px":typeof this.params.maxWidth=="number"?this.listEl.style.maxWidth=this.params.maxWidth+"px":this.listEl.style.maxWidth=this.params.maxWidth)}_createInputElement(){var e=this.params.elementAttributes,t=document.createElement("input");if(t.setAttribute("type",this.params.clearable?"search":"text"),t.style.padding="4px",t.style.width="100%",t.style.boxSizing="border-box",this.params.autocomplete||(t.style.cursor="default",t.style.caretColor="transparent"),e&&typeof e=="object")for(let i in e)i.charAt(0)=="+"?(i=i.slice(1),t.setAttribute(i,t.getAttribute(i)+e["+"+i])):t.setAttribute(i,e[i]);return this.params.mask&&La(t,this.params),this._bindInputEvents(t),t}_initializeParams(e){var t=["values","valuesURL","valuesLookup"],i;return e=Object.assign({},e),e.verticalNavigation=e.verticalNavigation||"editor",e.placeholderLoading=typeof e.placeholderLoading>"u"?"Searching ...":e.placeholderLoading,e.placeholderEmpty=typeof e.placeholderEmpty>"u"?"No Results Found":e.placeholderEmpty,e.filterDelay=typeof e.filterDelay>"u"?300:e.filterDelay,e.emptyValue=Object.keys(e).includes("emptyValue")?e.emptyValue:"",i=Object.keys(e).filter(n=>t.includes(n)).length,i?i>1&&console.warn("list editor config error - only one of the values, valuesURL, or valuesLookup options can be set on the same editor"):console.warn("list editor config error - either the values, valuesURL, or valuesLookup option must be set"),e.autocomplete?e.multiselect&&(e.multiselect=!1,console.warn("list editor config error - multiselect option is not available when autocomplete is enabled")):(e.freetext&&(e.freetext=!1,console.warn("list editor config error - freetext option is only available when autocomplete is enabled")),e.filterFunc&&(e.filterFunc=!1,console.warn("list editor config error - filterFunc option is only available when autocomplete is enabled")),e.filterRemote&&(e.filterRemote=!1,console.warn("list editor config error - filterRemote option is only available when autocomplete is enabled")),e.mask&&(e.mask=!1,console.warn("list editor config error - mask option is only available when autocomplete is enabled")),e.allowEmpty&&(e.allowEmpty=!1,console.warn("list editor config error - allowEmpty option is only available when autocomplete is enabled")),e.listOnEmpty&&(e.listOnEmpty=!1,console.warn("list editor config error - listOnEmpty option is only available when autocomplete is enabled"))),e.filterRemote&&!(typeof e.valuesLookup=="function"||e.valuesURL)&&(e.filterRemote=!1,console.warn("list editor config error - filterRemote option should only be used when values list is populated from a remote source")),e}_bindInputEvents(e){e.addEventListener("focus",this._inputFocus.bind(this)),e.addEventListener("click",this._inputClick.bind(this)),e.addEventListener("blur",this._inputBlur.bind(this)),e.addEventListener("keydown",this._inputKeyDown.bind(this)),e.addEventListener("search",this._inputSearch.bind(this)),this.params.autocomplete&&e.addEventListener("keyup",this._inputKeyUp.bind(this))}_inputFocus(e){this.rebuildOptionsList()}_filter(){this.params.filterRemote?(clearTimeout(this.filterTimeout),this.filterTimeout=setTimeout(()=>{this.rebuildOptionsList()},this.params.filterDelay)):this._filterList()}_inputClick(e){e.stopPropagation()}_inputBlur(e){this.blurable&&(this.popup?this.popup.hide():this._resolveValue(!0))}_inputSearch(){this._clearChoices()}_inputKeyDown(e){switch(e.keyCode){case 38:this._keyUp(e);break;case 40:this._keyDown(e);break;case 37:case 39:this._keySide(e);break;case 13:this._keyEnter();break;case 27:this._keyEsc();break;case 36:case 35:this._keyHomeEnd(e);break;case 9:this._keyTab(e);break;default:this._keySelectLetter(e)}}_inputKeyUp(e){switch(e.keyCode){case 38:case 37:case 39:case 40:case 13:case 27:break;default:this._keyAutoCompLetter(e)}}_preventPopupBlur(){this.popup&&this.popup.blockHide(),setTimeout(()=>{this.popup&&this.popup.restoreHide()},10)}_preventBlur(){this.blurable=!1,setTimeout(()=>{this.blurable=!0},10)}_keyTab(e){this.params.autocomplete&&this.lastAction==="typing"?this._resolveValue(!0):this.focusedItem&&this._chooseItem(this.focusedItem,!0)}_keyUp(e){var t=this.displayItems.indexOf(this.focusedItem);(this.params.verticalNavigation=="editor"||this.params.verticalNavigation=="hybrid"&&t)&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),t>0&&this._focusItem(this.displayItems[t-1]))}_keyDown(e){var t=this.displayItems.indexOf(this.focusedItem);(this.params.verticalNavigation=="editor"||this.params.verticalNavigation=="hybrid"&&t<this.displayItems.length-1)&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),t<this.displayItems.length-1&&(t==-1?this._focusItem(this.displayItems[0]):this._focusItem(this.displayItems[t+1])))}_keySide(e){this.params.autocomplete||(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault())}_keyEnter(e){this.params.autocomplete&&this.lastAction==="typing"?this._resolveValue(!0):this.focusedItem&&this._chooseItem(this.focusedItem)}_keyEsc(e){this._cancel()}_keyHomeEnd(e){this.params.autocomplete&&e.stopImmediatePropagation()}_keySelectLetter(e){this.params.autocomplete||(e.preventDefault(),e.keyCode>=38&&e.keyCode<=90&&this._scrollToValue(e.keyCode))}_keyAutoCompLetter(e){this._filter(),this.lastAction="typing",this.typing=!0}_scrollToValue(e){clearTimeout(this.filterTimeout);var t=String.fromCharCode(e).toLowerCase();this.filterTerm+=t.toLowerCase();var i=this.displayItems.find(n=>typeof n.label<"u"&&n.label.toLowerCase().startsWith(this.filterTerm));i&&this._focusItem(i),this.filterTimeout=setTimeout(()=>{this.filterTerm=""},800)}_focusItem(e){this.lastAction="focus",this.focusedItem&&this.focusedItem.element&&this.focusedItem.element.classList.remove("focused"),this.focusedItem=e,e&&e.element&&(e.element.classList.add("focused"),e.element.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}))}headerFilterInitialListGen(){this._generateOptions(!0)}rebuildOptionsList(){this._generateOptions().then(this._sortOptions.bind(this)).then(this._buildList.bind(this)).then(this._showList.bind(this)).catch(e=>{Number.isInteger(e)||console.error("List generation error",e)})}_filterList(){this._buildList(this._filterOptions()),this._showList()}_generateOptions(e){var t=[],i=++this.listIteration;return this.filtered=!1,this.params.values?t=this.params.values:this.params.valuesURL?t=this._ajaxRequest(this.params.valuesURL,this.input.value):typeof this.params.valuesLookup=="function"?t=this.params.valuesLookup(this.cell,this.input.value):this.params.valuesLookup&&(t=this._uniqueColumnValues(this.params.valuesLookupField)),t instanceof Promise?(e||this._addPlaceholder(this.params.placeholderLoading),t.then().then(n=>this.listIteration===i?this._parseList(n):Promise.reject(i))):Promise.resolve(this._parseList(t))}_addPlaceholder(e){var t=document.createElement("div");typeof e=="function"&&(e=e(this.cell.getComponent(),this.listEl)),e&&(this._clearList(),e instanceof HTMLElement?t=e:(t.classList.add("tabulator-edit-list-placeholder"),t.innerHTML=e),this.listEl.appendChild(t),this._showList())}_ajaxRequest(e,t){var i=this.params.filterRemote?{term:t}:{};return e=fc(e,{},i),fetch(e).then(n=>n.ok?n.json().catch(s=>(console.warn("List Ajax Load Error - Invalid JSON returned",s),Promise.reject(s))):(console.error("List Ajax Load Error - Connection Error: "+n.status,n.statusText),Promise.reject(n))).catch(n=>(console.error("List Ajax Load Error - Connection Error: ",n),Promise.reject(n)))}_uniqueColumnValues(e){var t={},i=this.table.getData(this.params.valuesLookup),n;return e?n=this.table.columnManager.getColumnByField(e):n=this.cell.getColumn()._getSelf(),n?i.forEach(s=>{var a=n.getFieldValue(s);this._emptyValueCheck(a)||(this.params.multiselect&&Array.isArray(a)?a.forEach(o=>{this._emptyValueCheck(o)||(t[o]=!0)}):t[a]=!0)}):(console.warn("unable to find matching column to create select lookup list:",e),t=[]),Object.keys(t)}_emptyValueCheck(e){return e===null||typeof e>"u"||e===""}_parseList(e){var t=[];return Array.isArray(e)||(e=Object.entries(e).map(([i,n])=>({label:n,value:i}))),e.forEach(i=>{typeof i!="object"&&(i={label:i,value:i}),this._parseListItem(i,t,0)}),!this.currentItems.length&&this.params.freetext&&(this.input.value=this.initialValues,this.typing=!0,this.lastAction="typing"),this.data=t,t}_parseListItem(e,t,i){var n={};e.options?n=this._parseListGroup(e,i+1):(n={label:e.label,value:e.value,itemParams:e.itemParams,elementAttributes:e.elementAttributes,element:!1,selected:!1,visible:!0,level:i,original:e},this.initialValues&&this.initialValues.indexOf(e.value)>-1&&this._chooseItem(n,!0)),t.push(n)}_parseListGroup(e,t){var i={label:e.label,group:!0,itemParams:e.itemParams,elementAttributes:e.elementAttributes,element:!1,visible:!0,level:t,options:[],original:e};return e.options.forEach(n=>{this._parseListItem(n,i.options,t)}),i}_sortOptions(e){var t;return this.params.sort&&(t=typeof this.params.sort=="function"?this.params.sort:this._defaultSortFunction.bind(this),this._sortGroup(t,e)),e}_sortGroup(e,t){t.sort((i,n)=>e(i.label,n.label,i.value,n.value,i.original,n.original)),t.forEach(i=>{i.group&&this._sortGroup(e,i.options)})}_defaultSortFunction(e,t){var i,n,s,a,o=0,l,h=/(\d+)|(\D+)/g,u=/\d/,d=0;if(this.params.sort==="desc"&&([e,t]=[t,e]),!e&&e!==0)d=!t&&t!==0?0:-1;else if(!t&&t!==0)d=1;else{if(isFinite(e)&&isFinite(t))return e-t;if(i=String(e).toLowerCase(),n=String(t).toLowerCase(),i===n)return 0;if(!(u.test(i)&&u.test(n)))return i>n?1:-1;for(i=i.match(h),n=n.match(h),l=i.length>n.length?n.length:i.length;o<l;)if(s=i[o],a=n[o++],s!==a)return isFinite(s)&&isFinite(a)?(s.charAt(0)==="0"&&(s="."+s),a.charAt(0)==="0"&&(a="."+a),s-a):s>a?1:-1;return i.length>n.length}return d}_filterOptions(){var e=this.params.filterFunc||this._defaultFilterFunc,t=this.input.value;return t?(this.filtered=!0,this.data.forEach(i=>{this._filterItem(e,t,i)})):this.filtered=!1,this.data}_filterItem(e,t,i){var n=!1;return i.group?(i.options.forEach(s=>{this._filterItem(e,t,s)&&(n=!0)}),i.visible=n):i.visible=e(t,i.label,i.value,i.original),i.visible}_defaultFilterFunc(e,t,i,n){return e=String(e).toLowerCase(),t!==null&&typeof t<"u"&&(String(t).toLowerCase().indexOf(e)>-1||String(i).toLowerCase().indexOf(e)>-1)}_clearList(){for(;this.listEl.firstChild;)this.listEl.removeChild(this.listEl.firstChild);this.displayItems=[]}_buildList(e){this._clearList(),e.forEach(t=>{this._buildItem(t)}),this.displayItems.length||this._addPlaceholder(this.params.placeholderEmpty)}_buildItem(e){var t=e.element,i;if(!this.filtered||e.visible){if(!t){if(t=document.createElement("div"),t.tabIndex=0,i=this.params.itemFormatter?this.params.itemFormatter(e.label,e.value,e.original,t):e.label,i instanceof HTMLElement?t.appendChild(i):t.innerHTML=i,e.group?t.classList.add("tabulator-edit-list-group"):t.classList.add("tabulator-edit-list-item"),t.classList.add("tabulator-edit-list-group-level-"+e.level),e.elementAttributes&&typeof e.elementAttributes=="object")for(let n in e.elementAttributes)n.charAt(0)=="+"?(n=n.slice(1),t.setAttribute(n,this.input.getAttribute(n)+e.elementAttributes["+"+n])):t.setAttribute(n,e.elementAttributes[n]);e.group?t.addEventListener("click",this._groupClick.bind(this,e)):t.addEventListener("click",this._itemClick.bind(this,e)),t.addEventListener("mousedown",this._preventBlur.bind(this)),e.element=t}this._styleItem(e),this.listEl.appendChild(t),e.group?e.options.forEach(n=>{this._buildItem(n)}):this.displayItems.push(e)}}_showList(){var e=this.popup&&this.popup.isVisible();if(this.input.parentNode){if(this.params.autocomplete&&this.input.value===""&&!this.params.listOnEmpty){this.popup&&this.popup.hide(!0);return}this._setListWidth(),this.popup||(this.popup=this.edit.popup(this.listEl)),this.popup.show(this.cell.getElement(),"bottom"),e||setTimeout(()=>{this.popup.hideOnBlur(this._resolveValue.bind(this,!0))},10)}}_styleItem(e){e&&e.element&&(e.selected?e.element.classList.add("active"):e.element.classList.remove("active"))}_itemClick(e,t){t.stopPropagation(),this._chooseItem(e)}_groupClick(e,t){t.stopPropagation()}_cancel(){this.popup.hide(!0),this.actions.cancel()}_clearChoices(){this.typing=!0,this.currentItems.forEach(e=>{e.selected=!1,this._styleItem(e)}),this.currentItems=[],this.focusedItem=null}_chooseItem(e,t){var i;this.typing=!1,this.params.multiselect?(i=this.currentItems.indexOf(e),i>-1?(this.currentItems.splice(i,1),e.selected=!1):(this.currentItems.push(e),e.selected=!0),this.input.value=this.currentItems.map(n=>n.label).join(","),this._styleItem(e)):(this.currentItems=[e],e.selected=!0,this.input.value=e.label,this._styleItem(e),t||this._resolveValue()),this._focusItem(e)}_resolveValue(e){var t,i;if(this.popup&&this.popup.hide(!0),this.params.multiselect)t=this.currentItems.map(n=>n.value);else if(e&&this.params.autocomplete&&this.typing)if(this.params.freetext||this.params.allowEmpty&&this.input.value==="")t=this.input.value;else{this.actions.cancel();return}else this.currentItems[0]?t=this.currentItems[0].value:(i=Array.isArray(this.initialValues)?this.initialValues[0]:this.initialValues,i===null||typeof i>"u"||i===""?t=i:t=this.params.emptyValue);t===""&&(t=this.params.emptyValue),this.actions.success(t),this.isFilter&&(this.initialValues=t&&!Array.isArray(t)?[t]:t,this.currentItems=[])}};function zb(r,e,t,i,n){var s=new Hb(this,r,e,t,i,n);return s.input}function Wb(r,e,t,i,n){var s=this,a=r.getElement(),o=r.getValue(),l=a.getElementsByTagName("svg").length||5,h=a.getElementsByTagName("svg")[0]?a.getElementsByTagName("svg")[0].getAttribute("width"):14,u=[],d=document.createElement("div"),c=document.createElementNS("http://www.w3.org/2000/svg","svg");function f(g){u.forEach(function(x,b){b<g?(s.table.browser=="ie"?x.setAttribute("class","tabulator-star-active"):x.classList.replace("tabulator-star-inactive","tabulator-star-active"),x.innerHTML='<polygon fill="#488CE9" stroke="#014AAE" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>'):(s.table.browser=="ie"?x.setAttribute("class","tabulator-star-inactive"):x.classList.replace("tabulator-star-active","tabulator-star-inactive"),x.innerHTML='<polygon fill="#010155" stroke="#686868" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>')})}function p(g){var x=document.createElement("span"),b=c.cloneNode(!0);u.push(b),x.addEventListener("mouseenter",function(F){F.stopPropagation(),F.stopImmediatePropagation(),f(g)}),x.addEventListener("mousemove",function(F){F.stopPropagation(),F.stopImmediatePropagation()}),x.addEventListener("click",function(F){F.stopPropagation(),F.stopImmediatePropagation(),t(g),a.blur()}),x.appendChild(b),d.appendChild(x)}function v(g){o=g,f(g)}if(a.style.whiteSpace="nowrap",a.style.overflow="hidden",a.style.textOverflow="ellipsis",d.style.verticalAlign="middle",d.style.display="inline-block",d.style.padding="4px",c.setAttribute("width",h),c.setAttribute("height",h),c.setAttribute("viewBox","0 0 512 512"),c.setAttribute("xml:space","preserve"),c.style.padding="0 1px",n.elementAttributes&&typeof n.elementAttributes=="object")for(let g in n.elementAttributes)g.charAt(0)=="+"?(g=g.slice(1),d.setAttribute(g,d.getAttribute(g)+n.elementAttributes["+"+g])):d.setAttribute(g,n.elementAttributes[g]);for(var m=1;m<=l;m++)p(m);return o=Math.min(parseInt(o),l),f(o),d.addEventListener("mousemove",function(g){f(0)}),d.addEventListener("click",function(g){t(0)}),a.addEventListener("blur",function(g){i()}),a.addEventListener("keydown",function(g){switch(g.keyCode){case 39:v(o+1);break;case 37:v(o-1);break;case 13:t(o);break;case 27:i();break}}),d}function Vb(r,e,t,i,n){var s=r.getElement(),a=typeof n.max>"u"?s.getElementsByTagName("div")[0]&&s.getElementsByTagName("div")[0].getAttribute("max")||100:n.max,o=typeof n.min>"u"?s.getElementsByTagName("div")[0]&&s.getElementsByTagName("div")[0].getAttribute("min")||0:n.min,l=(a-o)/100,h=r.getValue()||0,u=document.createElement("div"),d=document.createElement("div"),c,f;function p(){var v=window.getComputedStyle(s,null),m=l*Math.round(d.offsetWidth/((s.clientWidth-parseInt(v.getPropertyValue("padding-left"))-parseInt(v.getPropertyValue("padding-right")))/100))+o;t(m),s.setAttribute("aria-valuenow",m),s.setAttribute("aria-label",h)}if(u.style.position="absolute",u.style.right="0",u.style.top="0",u.style.bottom="0",u.style.width="5px",u.classList.add("tabulator-progress-handle"),d.style.display="inline-block",d.style.position="relative",d.style.height="100%",d.style.backgroundColor="#488CE9",d.style.maxWidth="100%",d.style.minWidth="0%",n.elementAttributes&&typeof n.elementAttributes=="object")for(let v in n.elementAttributes)v.charAt(0)=="+"?(v=v.slice(1),d.setAttribute(v,d.getAttribute(v)+n.elementAttributes["+"+v])):d.setAttribute(v,n.elementAttributes[v]);return s.style.padding="4px 4px",h=Math.min(parseFloat(h),a),h=Math.max(parseFloat(h),o),h=Math.round((h-o)/l),d.style.width=h+"%",s.setAttribute("aria-valuemin",o),s.setAttribute("aria-valuemax",a),d.appendChild(u),u.addEventListener("mousedown",function(v){c=v.screenX,f=d.offsetWidth}),u.addEventListener("mouseover",function(){u.style.cursor="ew-resize"}),s.addEventListener("mousemove",function(v){c&&(d.style.width=f+v.screenX-c+"px")}),s.addEventListener("mouseup",function(v){c&&(v.stopPropagation(),v.stopImmediatePropagation(),c=!1,f=!1,p())}),s.addEventListener("keydown",function(v){switch(v.keyCode){case 39:v.preventDefault(),d.style.width=d.clientWidth+s.clientWidth/100+"px";break;case 37:v.preventDefault(),d.style.width=d.clientWidth-s.clientWidth/100+"px";break;case 9:case 13:p();break;case 27:i();break}}),s.addEventListener("blur",function(){i()}),d}function Ub(r,e,t,i,n){var s=r.getValue(),a=document.createElement("input"),o=n.tristate,l=typeof n.indeterminateValue>"u"?null:n.indeterminateValue,h=!1,u=Object.keys(n).includes("trueValue"),d=Object.keys(n).includes("falseValue");if(a.setAttribute("type","checkbox"),a.style.marginTop="5px",a.style.boxSizing="border-box",n.elementAttributes&&typeof n.elementAttributes=="object")for(let f in n.elementAttributes)f.charAt(0)=="+"?(f=f.slice(1),a.setAttribute(f,a.getAttribute(f)+n.elementAttributes["+"+f])):a.setAttribute(f,n.elementAttributes[f]);a.value=s,o&&(typeof s>"u"||s===l||s==="")&&(h=!0,a.indeterminate=!0),this.table.browser!="firefox"&&this.table.browser!="safari"&&e(function(){r.getType()==="cell"&&a.focus({preventScroll:!0})}),a.checked=u?s===n.trueValue:s===!0||s==="true"||s==="True"||s===1;function c(f){var p=a.checked;return u&&p?p=n.trueValue:d&&!p&&(p=n.falseValue),o?f?h?l:p:a.checked&&!h?(a.checked=!1,a.indeterminate=!0,h=!0,l):(h=!1,p):p}return a.addEventListener("change",function(f){t(c())}),a.addEventListener("blur",function(f){t(c(!0))}),a.addEventListener("keydown",function(f){f.keyCode==13&&t(c()),f.keyCode==27&&i()}),a}function Gb(r,e,t,i,n){var s=r._getSelf().column,a,o,l;function h(u){var d=u.getValue(),c="input";switch(typeof d){case"number":c="number";break;case"boolean":c="tickCross";break;case"string":d.includes(`
`)&&(c="textarea");break}return c}return a=n.editorLookup?n.editorLookup(r):h(r),n.paramsLookup&&(l=typeof n.paramsLookup=="function"?n.paramsLookup(a,r):n.paramsLookup[a]),o=this.table.modules.edit.lookupEditor(a,s),o.call(this,r,e,t,i,l||{})}var Yb={input:Ab,textarea:Ob,number:Lb,range:Pb,date:Nb,time:Ib,datetime:Bb,list:zb,star:Wb,progress:Vb,tickCross:Ub,adaptable:Gb};const Qn=class Qn extends ke{constructor(e){super(e),this.currentCell=!1,this.mouseClick=!1,this.recursionBlock=!1,this.invalidEdit=!1,this.editedCells=[],this.convertEmptyValues=!1,this.editors=Qn.editors,this.registerTableOption("editTriggerEvent","focus"),this.registerTableOption("editorEmptyValue"),this.registerTableOption("editorEmptyValueFunc",this.emptyValueCheck.bind(this)),this.registerColumnOption("editable"),this.registerColumnOption("editor"),this.registerColumnOption("editorParams"),this.registerColumnOption("editorEmptyValue"),this.registerColumnOption("editorEmptyValueFunc"),this.registerColumnOption("cellEditing"),this.registerColumnOption("cellEdited"),this.registerColumnOption("cellEditCancelled"),this.registerTableFunction("getEditedCells",this.getEditedCells.bind(this)),this.registerTableFunction("clearCellEdited",this.clearCellEdited.bind(this)),this.registerTableFunction("navigatePrev",this.navigatePrev.bind(this)),this.registerTableFunction("navigateNext",this.navigateNext.bind(this)),this.registerTableFunction("navigateLeft",this.navigateLeft.bind(this)),this.registerTableFunction("navigateRight",this.navigateRight.bind(this)),this.registerTableFunction("navigateUp",this.navigateUp.bind(this)),this.registerTableFunction("navigateDown",this.navigateDown.bind(this)),this.registerComponentFunction("cell","isEdited",this.cellIsEdited.bind(this)),this.registerComponentFunction("cell","clearEdited",this.clearEdited.bind(this)),this.registerComponentFunction("cell","edit",this.editCell.bind(this)),this.registerComponentFunction("cell","cancelEdit",this.cellCancelEdit.bind(this)),this.registerComponentFunction("cell","navigatePrev",this.navigatePrev.bind(this)),this.registerComponentFunction("cell","navigateNext",this.navigateNext.bind(this)),this.registerComponentFunction("cell","navigateLeft",this.navigateLeft.bind(this)),this.registerComponentFunction("cell","navigateRight",this.navigateRight.bind(this)),this.registerComponentFunction("cell","navigateUp",this.navigateUp.bind(this)),this.registerComponentFunction("cell","navigateDown",this.navigateDown.bind(this))}initialize(){this.subscribe("cell-init",this.bindEditor.bind(this)),this.subscribe("cell-delete",this.clearEdited.bind(this)),this.subscribe("cell-value-changed",this.updateCellClass.bind(this)),this.subscribe("column-layout",this.initializeColumnCheck.bind(this)),this.subscribe("column-delete",this.columnDeleteCheck.bind(this)),this.subscribe("row-deleting",this.rowDeleteCheck.bind(this)),this.subscribe("row-layout",this.rowEditableCheck.bind(this)),this.subscribe("data-refreshing",this.cancelEdit.bind(this)),this.subscribe("clipboard-paste",this.pasteBlocker.bind(this)),this.subscribe("keybinding-nav-prev",this.navigatePrev.bind(this,void 0)),this.subscribe("keybinding-nav-next",this.keybindingNavigateNext.bind(this)),this.subscribe("keybinding-nav-up",this.navigateUp.bind(this,void 0)),this.subscribe("keybinding-nav-down",this.navigateDown.bind(this,void 0)),Object.keys(this.table.options).includes("editorEmptyValue")&&(this.convertEmptyValues=!0)}pasteBlocker(e){if(this.currentCell)return!0}keybindingNavigateNext(e){var t=this.currentCell,i=this.options("tabEndNewRow");t&&(this.navigateNext(t,e)||i&&(t.getElement().firstChild.blur(),this.invalidEdit||(i===!0?i=this.table.addRow({}):typeof i=="function"?i=this.table.addRow(i(t.row.getComponent())):i=this.table.addRow(Object.assign({},i)),i.then(()=>{setTimeout(()=>{t.getComponent().navigateNext()})}))))}cellIsEdited(e){return!!e.modules.edit&&e.modules.edit.edited}cellCancelEdit(e){e===this.currentCell?this.table.modules.edit.cancelEdit():console.warn("Cancel Editor Error - This cell is not currently being edited ")}updateCellClass(e){this.allowEdit(e)?e.getElement().classList.add("tabulator-editable"):e.getElement().classList.remove("tabulator-editable")}clearCellEdited(e){e||(e=this.table.modules.edit.getEditedCells()),Array.isArray(e)||(e=[e]),e.forEach(t=>{this.table.modules.edit.clearEdited(t._getSelf())})}navigatePrev(e=this.currentCell,t){var i,n;if(e){if(t&&t.preventDefault(),i=this.navigateLeft(),i)return!0;if(n=this.table.rowManager.prevDisplayRow(e.row,!0),n&&(i=this.findPrevEditableCell(n,n.cells.length),i))return i.getComponent().edit(),!0}return!1}navigateNext(e=this.currentCell,t){var i,n;if(e){if(t&&t.preventDefault(),i=this.navigateRight(),i)return!0;if(n=this.table.rowManager.nextDisplayRow(e.row,!0),n&&(i=this.findNextEditableCell(n,-1),i))return i.getComponent().edit(),!0}return!1}navigateLeft(e=this.currentCell,t){var i,n;return e&&(t&&t.preventDefault(),i=e.getIndex(),n=this.findPrevEditableCell(e.row,i),n)?(n.getComponent().edit(),!0):!1}navigateRight(e=this.currentCell,t){var i,n;return e&&(t&&t.preventDefault(),i=e.getIndex(),n=this.findNextEditableCell(e.row,i),n)?(n.getComponent().edit(),!0):!1}navigateUp(e=this.currentCell,t){var i,n;return e&&(t&&t.preventDefault(),i=e.getIndex(),n=this.table.rowManager.prevDisplayRow(e.row,!0),n)?(n.cells[i].getComponent().edit(),!0):!1}navigateDown(e=this.currentCell,t){var i,n;return e&&(t&&t.preventDefault(),i=e.getIndex(),n=this.table.rowManager.nextDisplayRow(e.row,!0),n)?(n.cells[i].getComponent().edit(),!0):!1}findNextEditableCell(e,t){var i=!1;if(t<e.cells.length-1)for(var n=t+1;n<e.cells.length;n++){let s=e.cells[n];if(s.column.modules.edit&&et.elVisible(s.getElement())&&this.allowEdit(s)){i=s;break}}return i}findPrevEditableCell(e,t){var i=!1;if(t>0)for(var n=t-1;n>=0;n--){let s=e.cells[n];if(s.column.modules.edit&&et.elVisible(s.getElement())&&this.allowEdit(s)){i=s;break}}return i}initializeColumnCheck(e){typeof e.definition.editor<"u"&&this.initializeColumn(e)}columnDeleteCheck(e){this.currentCell&&this.currentCell.column===e&&this.cancelEdit()}rowDeleteCheck(e){this.currentCell&&this.currentCell.row===e&&this.cancelEdit()}rowEditableCheck(e){e.getCells().forEach(t=>{t.column.modules.edit&&typeof t.column.modules.edit.check=="function"&&this.updateCellClass(t)})}initializeColumn(e){var t=Object.keys(e.definition).includes("editorEmptyValue"),i={editor:!1,blocked:!1,check:e.definition.editable,params:e.definition.editorParams||{},convertEmptyValues:t,editorEmptyValue:e.definition.editorEmptyValue,editorEmptyValueFunc:e.definition.editorEmptyValueFunc};i.editor=this.lookupEditor(e.definition.editor,e),i.editor&&(e.modules.edit=i)}lookupEditor(e,t){var i;switch(typeof e){case"string":this.editors[e]?i=this.editors[e]:console.warn("Editor Error - No such editor found: ",e);break;case"function":i=e;break;case"boolean":e===!0&&(typeof t.definition.formatter!="function"?this.editors[t.definition.formatter]?i=this.editors[t.definition.formatter]:i=this.editors.input:console.warn("Editor Error - Cannot auto lookup editor for a custom formatter: ",t.definition.formatter));break}return i}getCurrentCell(){return this.currentCell?this.currentCell.getComponent():!1}clearEditor(e){var t=this.currentCell,i;if(this.invalidEdit=!1,t){for(this.currentCell=!1,i=t.getElement(),this.dispatch("edit-editor-clear",t,e),i.classList.remove("tabulator-editing");i.firstChild;)i.removeChild(i.firstChild);t.row.getElement().classList.remove("tabulator-editing"),t.table.element.classList.remove("tabulator-editing")}}cancelEdit(){if(this.currentCell){var e=this.currentCell,t=this.currentCell.getComponent();this.clearEditor(!0),e.setValueActual(e.getValue()),e.cellRendered(),(e.column.definition.editor=="textarea"||e.column.definition.variableHeight)&&e.row.normalizeHeight(!0),e.column.definition.cellEditCancelled&&e.column.definition.cellEditCancelled.call(this.table,t),this.dispatch("edit-cancelled",e),this.dispatchExternal("cellEditCancelled",t)}}bindEditor(e){if(e.column.modules.edit){var t=this,i=e.getElement(!0);this.updateCellClass(e),i.setAttribute("tabindex",0),i.addEventListener("mousedown",function(n){n.button===2?n.preventDefault():t.mouseClick=!0}),this.options("editTriggerEvent")==="dblclick"&&i.addEventListener("dblclick",function(n){i.classList.contains("tabulator-editing")||(i.focus({preventScroll:!0}),t.edit(e,n,!1))}),(this.options("editTriggerEvent")==="focus"||this.options("editTriggerEvent")==="click")&&i.addEventListener("click",function(n){i.classList.contains("tabulator-editing")||(i.focus({preventScroll:!0}),t.edit(e,n,!1))}),this.options("editTriggerEvent")==="focus"&&i.addEventListener("focus",function(n){t.recursionBlock||t.edit(e,n,!1)})}}focusCellNoEvent(e,t){this.recursionBlock=!0,t&&this.table.browser==="ie"||e.getElement().focus({preventScroll:!0}),this.recursionBlock=!1}editCell(e,t){this.focusCellNoEvent(e),this.edit(e,!1,t)}focusScrollAdjust(e){if(this.table.rowManager.getRenderMode()=="virtual"){var t=this.table.rowManager.element.scrollTop,i=this.table.rowManager.element.clientHeight+this.table.rowManager.element.scrollTop,n=e.row.getElement();n.offsetTop<t?this.table.rowManager.element.scrollTop-=t-n.offsetTop:n.offsetTop+n.offsetHeight>i&&(this.table.rowManager.element.scrollTop+=n.offsetTop+n.offsetHeight-i);var s=this.table.rowManager.element.scrollLeft,a=this.table.rowManager.element.clientWidth+this.table.rowManager.element.scrollLeft,o=e.getElement();this.table.modExists("frozenColumns")&&(s+=parseInt(this.table.modules.frozenColumns.leftMargin||0),a-=parseInt(this.table.modules.frozenColumns.rightMargin||0)),this.table.options.renderHorizontal==="virtual"&&(s-=parseInt(this.table.columnManager.renderer.vDomPadLeft),a-=parseInt(this.table.columnManager.renderer.vDomPadLeft)),o.offsetLeft<s?this.table.rowManager.element.scrollLeft-=s-o.offsetLeft:o.offsetLeft+o.offsetWidth>a&&(this.table.rowManager.element.scrollLeft+=o.offsetLeft+o.offsetWidth-a)}}allowEdit(e){var t=!!e.column.modules.edit;if(e.column.modules.edit)switch(typeof e.column.modules.edit.check){case"function":e.row.initialized&&(t=e.column.modules.edit.check(e.getComponent()));break;case"string":t=!!e.row.data[e.column.modules.edit.check];break;case"boolean":t=e.column.modules.edit.check;break}return t}edit(e,t,i){var n=this,s=!0,a=function(){},o=e.getElement(),l=!1,h,u,d;if(this.currentCell){!this.invalidEdit&&this.currentCell!==e&&this.cancelEdit();return}function c(g){if(n.currentCell===e&&!l){var x=n.chain("edit-success",[e,g],!0,!0);return x===!0||n.table.options.validationMode==="highlight"?(l=!0,n.clearEditor(),e.modules.edit||(e.modules.edit={}),e.modules.edit.edited=!0,n.editedCells.indexOf(e)==-1&&n.editedCells.push(e),g=n.transformEmptyValues(g,e),e.setValue(g,!0),x===!0):(l=!0,n.invalidEdit=!0,n.focusCellNoEvent(e,!0),a(),setTimeout(()=>{l=!1},10),!1)}}function f(){n.currentCell===e&&!l&&n.cancelEdit()}function p(g){a=g}if(e.column.modules.edit.blocked)return this.mouseClick=!1,this.blur(o),!1;if(t&&t.stopPropagation(),s=this.allowEdit(e),s||i){if(n.cancelEdit(),n.currentCell=e,this.focusScrollAdjust(e),u=e.getComponent(),this.mouseClick&&(this.mouseClick=!1,e.column.definition.cellClick&&e.column.definition.cellClick.call(this.table,t,u)),e.column.definition.cellEditing&&e.column.definition.cellEditing.call(this.table,u),this.dispatch("cell-editing",e),this.dispatchExternal("cellEditing",u),d=typeof e.column.modules.edit.params=="function"?e.column.modules.edit.params(u):e.column.modules.edit.params,h=e.column.modules.edit.editor.call(n,u,p,c,f,d),this.currentCell&&h!==!1)if(h instanceof Node){for(o.classList.add("tabulator-editing"),e.row.getElement().classList.add("tabulator-editing"),e.table.element.classList.add("tabulator-editing");o.firstChild;)o.removeChild(o.firstChild);o.appendChild(h),a();for(var v=o.children,m=0;m<v.length;m++)v[m].addEventListener("click",function(g){g.stopPropagation()})}else return console.warn("Edit Error - Editor should return an instance of Node, the editor returned:",h),this.blur(o),!1;else return this.blur(o),!1;return!0}else return this.mouseClick=!1,this.blur(o),!1}emptyValueCheck(e){return e===""||e===null||typeof e>"u"}transformEmptyValues(e,t){var i=t.column.modules.edit,n=i.convertEmptyValues||this.convertEmptyValues,s;return n&&(s=i.editorEmptyValueFunc||this.options("editorEmptyValueFunc"),s&&s(e)&&(e=i.convertEmptyValues?i.editorEmptyValue:this.options("editorEmptyValue"))),e}blur(e){this.confirm("edit-blur",[e])||e.blur()}getEditedCells(){var e=[];return this.editedCells.forEach(t=>{e.push(t.getComponent())}),e}clearEdited(e){var t;e.modules.edit&&e.modules.edit.edited&&(e.modules.edit.edited=!1,this.dispatch("edit-edited-clear",e)),t=this.editedCells.indexOf(e),t>-1&&this.editedCells.splice(t,1)}};G(Qn,"moduleName","edit"),G(Qn,"editors",Yb);let Io=Qn;class Ah{constructor(e,t,i,n){this.type=e,this.columns=t,this.component=i||!1,this.indent=n||0}}class no{constructor(e,t,i,n,s){this.value=e,this.component=t||!1,this.width=i,this.height=n,this.depth=s}}var jb={},Xb={visible:function(){return this.rowManager.getVisibleRows(!1,!0)},all:function(){return this.rowManager.rows},selected:function(){return this.modules.selectRow.selectedRows},active:function(){return this.options.pagination?this.rowManager.getDisplayRows(this.rowManager.displayRows.length-2):this.rowManager.getDisplayRows()}};const hr=class hr extends ke{constructor(e){super(e),this.config={},this.cloneTableStyle=!0,this.colVisProp="",this.colVisPropAttach="",this.registerTableOption("htmlOutputConfig",!1),this.registerColumnOption("htmlOutput"),this.registerColumnOption("titleHtmlOutput")}initialize(){this.registerTableFunction("getHtml",this.getHtml.bind(this))}generateExportList(e,t,i,n){var s,a,o,l;return this.cloneTableStyle=t,this.config=e||{},this.colVisProp=n,this.colVisPropAttach=this.colVisProp.charAt(0).toUpperCase()+this.colVisProp.slice(1),l=hr.columnLookups[i],l&&(o=l.call(this.table),o=o.filter(h=>this.columnVisCheck(h))),s=this.config.columnHeaders!==!1?this.headersToExportRows(this.generateColumnGroupHeaders(o)):[],o&&(o=o.map(h=>h.getComponent())),a=this.bodyToExportRows(this.rowLookup(i),o),s.concat(a)}generateTable(e,t,i,n){var s=this.generateExportList(e,t,i,n);return this.generateTableElement(s)}rowLookup(e){var t=[],i;return typeof e=="function"?e.call(this.table).forEach(n=>{n=this.table.rowManager.findRow(n),n&&t.push(n)}):(i=hr.rowLookups[e]||hr.rowLookups.active,t=i.call(this.table)),Object.assign([],t)}generateColumnGroupHeaders(e){var t=[];return e||(e=this.config.columnGroups!==!1?this.table.columnManager.columns:this.table.columnManager.columnsByIndex),e.forEach(i=>{var n=this.processColumnGroup(i);n&&t.push(n)}),t}processColumnGroup(e){var t=e.columns,i=0,n=e.definition["title"+this.colVisPropAttach]||e.definition.title,s={title:n,column:e,depth:1};if(t.length){if(s.subGroups=[],s.width=0,t.forEach(a=>{var o=this.processColumnGroup(a);o&&(s.width+=o.width,s.subGroups.push(o),o.depth>i&&(i=o.depth))}),s.depth+=i,!s.width)return!1}else if(this.columnVisCheck(e))s.width=1;else return!1;return s}columnVisCheck(e){var t=e.definition[this.colVisProp];return this.config.rowHeaders===!1&&e.isRowHeader?!1:(typeof t=="function"&&(t=t.call(this.table,e.getComponent())),t===!1||t===!0?t:e.visible&&e.field)}headersToExportRows(e){var t=[],i=0,n=[];function s(a,o){var l=i-o;if(typeof t[o]>"u"&&(t[o]=[]),a.height=a.subGroups?1:l-a.depth+1,t[o].push(a),a.height>1)for(let h=1;h<a.height;h++)typeof t[o+h]>"u"&&(t[o+h]=[]),t[o+h].push(!1);if(a.width>1)for(let h=1;h<a.width;h++)t[o].push(!1);a.subGroups&&a.subGroups.forEach(function(h){s(h,o+1)})}return e.forEach(function(a){a.depth>i&&(i=a.depth)}),e.forEach(function(a){s(a,0)}),t.forEach(a=>{var o=[];a.forEach(l=>{if(l){let h=typeof l.title>"u"?"":l.title;o.push(new no(h,l.column.getComponent(),l.width,l.height,l.depth))}else o.push(null)}),n.push(new Ah("header",o))}),n}bodyToExportRows(e,t=[]){var i=[];return t.length===0&&this.table.columnManager.columnsByIndex.forEach(n=>{this.columnVisCheck(n)&&t.push(n.getComponent())}),this.config.columnCalcs!==!1&&this.table.modExists("columnCalcs")&&(this.table.modules.columnCalcs.topInitialized&&e.unshift(this.table.modules.columnCalcs.topRow),this.table.modules.columnCalcs.botInitialized&&e.push(this.table.modules.columnCalcs.botRow)),e=e.filter(n=>{switch(n.type){case"group":return this.config.rowGroups!==!1;case"calc":return this.config.columnCalcs!==!1;case"row":return!(this.table.options.dataTree&&this.config.dataTree===!1&&n.modules.dataTree.parent)}return!0}),e.forEach((n,s)=>{var a=n.getData(this.colVisProp),o=[],l=0;switch(n.type){case"group":l=n.level,o.push(new no(n.key,n.getComponent(),t.length,1));break;case"calc":case"row":t.forEach(h=>{o.push(new no(h._column.getFieldValue(a),h,1,1))}),this.table.options.dataTree&&this.config.dataTree!==!1&&(l=n.modules.dataTree.index);break}i.push(new Ah(n.type,o,n.getComponent(),l))}),i}generateTableElement(e){var t=document.createElement("table"),i=document.createElement("thead"),n=document.createElement("tbody"),s=this.lookupTableStyles(),a=this.table.options["rowFormatter"+this.colVisPropAttach],o={};return o.rowFormatter=a!==null?a:this.table.options.rowFormatter,this.table.options.dataTree&&this.config.dataTree!==!1&&this.table.modExists("columnCalcs")&&(o.treeElementField=this.table.modules.dataTree.elementField),o.groupHeader=this.table.options["groupHeader"+this.colVisPropAttach],o.groupHeader&&!Array.isArray(o.groupHeader)&&(o.groupHeader=[o.groupHeader]),t.classList.add("tabulator-print-table"),this.mapElementStyles(this.table.columnManager.getHeadersElement(),i,["border-top","border-left","border-right","border-bottom","background-color","color","font-weight","font-family","font-size"]),e.length>1e3&&console.warn("It may take a long time to render an HTML table with more than 1000 rows"),e.forEach((l,h)=>{let u;switch(l.type){case"header":i.appendChild(this.generateHeaderElement(l,o,s));break;case"group":n.appendChild(this.generateGroupElement(l,o,s));break;case"calc":n.appendChild(this.generateCalcElement(l,o,s));break;case"row":u=this.generateRowElement(l,o,s),this.mapElementStyles(h%2&&s.evenRow?s.evenRow:s.oddRow,u,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),n.appendChild(u);break}}),i.innerHTML&&t.appendChild(i),t.appendChild(n),this.mapElementStyles(this.table.element,t,["border-top","border-left","border-right","border-bottom"]),t}lookupTableStyles(){var e={};return this.cloneTableStyle&&window.getComputedStyle&&(e.oddRow=this.table.element.querySelector(".tabulator-row-odd:not(.tabulator-group):not(.tabulator-calcs)"),e.evenRow=this.table.element.querySelector(".tabulator-row-even:not(.tabulator-group):not(.tabulator-calcs)"),e.calcRow=this.table.element.querySelector(".tabulator-row.tabulator-calcs"),e.firstRow=this.table.element.querySelector(".tabulator-row:not(.tabulator-group):not(.tabulator-calcs)"),e.firstGroup=this.table.element.getElementsByClassName("tabulator-group")[0],e.firstRow&&(e.styleCells=e.firstRow.getElementsByClassName("tabulator-cell"),e.styleRowHeader=e.firstRow.getElementsByClassName("tabulator-row-header")[0],e.firstCell=e.styleCells[0],e.lastCell=e.styleCells[e.styleCells.length-1])),e}generateHeaderElement(e,t,i){var n=document.createElement("tr");return e.columns.forEach(s=>{if(s){var a=document.createElement("th"),o=s.component._column.definition.cssClass?s.component._column.definition.cssClass.split(" "):[];a.colSpan=s.width,a.rowSpan=s.height,a.innerHTML=s.value,this.cloneTableStyle&&(a.style.boxSizing="border-box"),o.forEach(function(l){a.classList.add(l)}),this.mapElementStyles(s.component.getElement(),a,["text-align","border-left","border-right","background-color","color","font-weight","font-family","font-size"]),this.mapElementStyles(s.component._column.contentElement,a,["padding-top","padding-left","padding-right","padding-bottom"]),s.component._column.visible?this.mapElementStyles(s.component.getElement(),a,["width"]):s.component._column.definition.width&&(a.style.width=s.component._column.definition.width+"px"),s.component._column.parent&&s.component._column.parent.isGroup?this.mapElementStyles(s.component._column.parent.groupElement,a,["border-top"]):this.mapElementStyles(s.component.getElement(),a,["border-top"]),s.component._column.isGroup?this.mapElementStyles(s.component.getElement(),a,["border-bottom"]):this.mapElementStyles(this.table.columnManager.getElement(),a,["border-bottom"]),n.appendChild(a)}}),n}generateGroupElement(e,t,i){var n=document.createElement("tr"),s=document.createElement("td"),a=e.columns[0];return n.classList.add("tabulator-print-table-row"),t.groupHeader&&t.groupHeader[e.indent]?a.value=t.groupHeader[e.indent](a.value,e.component._group.getRowCount(),e.component._group.getData(),e.component):t.groupHeader!==!1&&(a.value=e.component._group.generator(a.value,e.component._group.getRowCount(),e.component._group.getData(),e.component)),s.colSpan=a.width,s.innerHTML=a.value,n.classList.add("tabulator-print-table-group"),n.classList.add("tabulator-group-level-"+e.indent),a.component.isVisible()&&n.classList.add("tabulator-group-visible"),this.mapElementStyles(i.firstGroup,n,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),this.mapElementStyles(i.firstGroup,s,["padding-top","padding-left","padding-right","padding-bottom"]),n.appendChild(s),n}generateCalcElement(e,t,i){var n=this.generateRowElement(e,t,i);return n.classList.add("tabulator-print-table-calcs"),this.mapElementStyles(i.calcRow,n,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),n}generateRowElement(e,t,i){var n=document.createElement("tr");if(n.classList.add("tabulator-print-table-row"),e.columns.forEach((s,a)=>{if(s){var o=document.createElement("td"),l=s.component._column,h=this.table,u=h.columnManager.findColumnIndex(l),d=s.value,c,f,p={modules:{},getValue:function(){return d},getField:function(){return l.definition.field},getElement:function(){return o},getType:function(){return"cell"},getColumn:function(){return l.getComponent()},getData:function(){return e.component.getData()},getRow:function(){return e.component},getTable:function(){return h},getComponent:function(){return p},column:l},v=l.definition.cssClass?l.definition.cssClass.split(" "):[];if(v.forEach(function(m){o.classList.add(m)}),this.table.modExists("format")&&this.config.formatCells!==!1)d=this.table.modules.format.formatExportValue(p,this.colVisProp);else switch(typeof d){case"object":d=d!==null?JSON.stringify(d):"";break;case"undefined":d="";break}d instanceof Node?o.appendChild(d):o.innerHTML=d,f=["padding-top","padding-left","padding-right","padding-bottom","border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","text-align"],l.isRowHeader?(c=i.styleRowHeader,f.push("background-color")):c=i.styleCells&&i.styleCells[u]?i.styleCells[u]:i.firstCell,c&&(this.mapElementStyles(c,o,f),l.definition.align&&(o.style.textAlign=l.definition.align)),this.table.options.dataTree&&this.config.dataTree!==!1&&(t.treeElementField&&t.treeElementField==l.field||!t.treeElementField&&a==0)&&(e.component._row.modules.dataTree.controlEl&&o.insertBefore(e.component._row.modules.dataTree.controlEl.cloneNode(!0),o.firstChild),e.component._row.modules.dataTree.branchEl&&o.insertBefore(e.component._row.modules.dataTree.branchEl.cloneNode(!0),o.firstChild)),n.appendChild(o),p.modules.format&&p.modules.format.renderedCallback&&p.modules.format.renderedCallback()}}),t.rowFormatter&&e.type==="row"&&this.config.formatCells!==!1){let s=Object.assign(e.component);s.getElement=function(){return n},t.rowFormatter(e.component)}return n}generateHTMLTable(e){var t=document.createElement("div");return t.appendChild(this.generateTableElement(e)),t.innerHTML}getHtml(e,t,i,n){var s=this.generateExportList(i||this.table.options.htmlOutputConfig,t,e,n||"htmlOutput");return this.generateHTMLTable(s)}mapElementStyles(e,t,i){if(this.cloneTableStyle&&e&&t){var n={"background-color":"backgroundColor",color:"fontColor",width:"width","font-weight":"fontWeight","font-family":"fontFamily","font-size":"fontSize","text-align":"textAlign","border-top":"borderTop","border-left":"borderLeft","border-right":"borderRight","border-bottom":"borderBottom","padding-top":"paddingTop","padding-left":"paddingLeft","padding-right":"paddingRight","padding-bottom":"paddingBottom"};if(window.getComputedStyle){var s=window.getComputedStyle(e);i.forEach(function(a){t.style[n[a]]||(t.style[n[a]]=s.getPropertyValue(a))})}}}};G(hr,"moduleName","export"),G(hr,"columnLookups",jb),G(hr,"rowLookups",Xb);let Bo=hr;var $b={"=":function(r,e,t,i){return e==r},"<":function(r,e,t,i){return e<r},"<=":function(r,e,t,i){return e<=r},">":function(r,e,t,i){return e>r},">=":function(r,e,t,i){return e>=r},"!=":function(r,e,t,i){return e!=r},regex:function(r,e,t,i){return typeof r=="string"&&(r=new RegExp(r)),r.test(e)},like:function(r,e,t,i){return r===null||typeof r>"u"?e===r:typeof e<"u"&&e!==null?String(e).toLowerCase().indexOf(r.toLowerCase())>-1:!1},keywords:function(r,e,t,i){var n=r.toLowerCase().split(typeof i.separator>"u"?" ":i.separator),s=String(e===null||typeof e>"u"?"":e).toLowerCase(),a=[];return n.forEach(o=>{s.includes(o)&&a.push(!0)}),i.matchAll?a.length===n.length:!!a.length},starts:function(r,e,t,i){return r===null||typeof r>"u"?e===r:typeof e<"u"&&e!==null?String(e).toLowerCase().startsWith(r.toLowerCase()):!1},ends:function(r,e,t,i){return r===null||typeof r>"u"?e===r:typeof e<"u"&&e!==null?String(e).toLowerCase().endsWith(r.toLowerCase()):!1},in:function(r,e,t,i){return Array.isArray(r)?r.length?r.indexOf(e)>-1:!0:(console.warn("Filter Error - filter value is not an array:",r),!1)}};const Ui=class Ui extends ke{constructor(e){super(e),this.filterList=[],this.headerFilters={},this.headerFilterColumns=[],this.prevHeaderFilterChangeCheck="",this.prevHeaderFilterChangeCheck="{}",this.changed=!1,this.tableInitialized=!1,this.registerTableOption("filterMode","local"),this.registerTableOption("initialFilter",!1),this.registerTableOption("initialHeaderFilter",!1),this.registerTableOption("headerFilterLiveFilterDelay",300),this.registerTableOption("placeholderHeaderFilter",!1),this.registerColumnOption("headerFilter"),this.registerColumnOption("headerFilterPlaceholder"),this.registerColumnOption("headerFilterParams"),this.registerColumnOption("headerFilterEmptyCheck"),this.registerColumnOption("headerFilterFunc"),this.registerColumnOption("headerFilterFuncParams"),this.registerColumnOption("headerFilterLiveFilter"),this.registerTableFunction("searchRows",this.searchRows.bind(this)),this.registerTableFunction("searchData",this.searchData.bind(this)),this.registerTableFunction("setFilter",this.userSetFilter.bind(this)),this.registerTableFunction("refreshFilter",this.userRefreshFilter.bind(this)),this.registerTableFunction("addFilter",this.userAddFilter.bind(this)),this.registerTableFunction("getFilters",this.getFilters.bind(this)),this.registerTableFunction("setHeaderFilterFocus",this.userSetHeaderFilterFocus.bind(this)),this.registerTableFunction("getHeaderFilterValue",this.userGetHeaderFilterValue.bind(this)),this.registerTableFunction("setHeaderFilterValue",this.userSetHeaderFilterValue.bind(this)),this.registerTableFunction("getHeaderFilters",this.getHeaderFilters.bind(this)),this.registerTableFunction("removeFilter",this.userRemoveFilter.bind(this)),this.registerTableFunction("clearFilter",this.userClearFilter.bind(this)),this.registerTableFunction("clearHeaderFilter",this.userClearHeaderFilter.bind(this)),this.registerComponentFunction("column","headerFilterFocus",this.setHeaderFilterFocus.bind(this)),this.registerComponentFunction("column","reloadHeaderFilter",this.reloadHeaderFilter.bind(this)),this.registerComponentFunction("column","getHeaderFilterValue",this.getHeaderFilterValue.bind(this)),this.registerComponentFunction("column","setHeaderFilterValue",this.setHeaderFilterValue.bind(this))}initialize(){this.subscribe("column-init",this.initializeColumnHeaderFilter.bind(this)),this.subscribe("column-width-fit-before",this.hideHeaderFilterElements.bind(this)),this.subscribe("column-width-fit-after",this.showHeaderFilterElements.bind(this)),this.subscribe("table-built",this.tableBuilt.bind(this)),this.subscribe("placeholder",this.generatePlaceholder.bind(this)),this.table.options.filterMode==="remote"&&this.subscribe("data-params",this.remoteFilterParams.bind(this)),this.registerDataHandler(this.filter.bind(this),10)}tableBuilt(){this.table.options.initialFilter&&this.setFilter(this.table.options.initialFilter),this.table.options.initialHeaderFilter&&this.table.options.initialHeaderFilter.forEach(e=>{var t=this.table.columnManager.findColumn(e.field);if(t)this.setHeaderFilterValue(t,e.value);else return console.warn("Column Filter Error - No matching column found:",e.field),!1}),this.tableInitialized=!0}remoteFilterParams(e,t,i,n){return n.filter=this.getFilters(!0,!0),n}generatePlaceholder(e){if(this.table.options.placeholderHeaderFilter&&Object.keys(this.headerFilters).length)return this.table.options.placeholderHeaderFilter}userSetFilter(e,t,i,n){this.setFilter(e,t,i,n),this.refreshFilter()}userRefreshFilter(){this.refreshFilter()}userAddFilter(e,t,i,n){this.addFilter(e,t,i,n),this.refreshFilter()}userSetHeaderFilterFocus(e){var t=this.table.columnManager.findColumn(e);if(t)this.setHeaderFilterFocus(t);else return console.warn("Column Filter Focus Error - No matching column found:",e),!1}userGetHeaderFilterValue(e){var t=this.table.columnManager.findColumn(e);if(t)return this.getHeaderFilterValue(t);console.warn("Column Filter Error - No matching column found:",e)}userSetHeaderFilterValue(e,t){var i=this.table.columnManager.findColumn(e);if(i)this.setHeaderFilterValue(i,t);else return console.warn("Column Filter Error - No matching column found:",e),!1}userRemoveFilter(e,t,i){this.removeFilter(e,t,i),this.refreshFilter()}userClearFilter(e){this.clearFilter(e),this.refreshFilter()}userClearHeaderFilter(){this.clearHeaderFilter(),this.refreshFilter()}searchRows(e,t,i){return this.search("rows",e,t,i)}searchData(e,t,i){return this.search("data",e,t,i)}initializeColumnHeaderFilter(e){var t=e.definition;t.headerFilter&&this.initializeColumn(e)}initializeColumn(e,t){var i=this,n=e.getField();function s(a){var o=e.modules.filter.tagType=="input"&&e.modules.filter.attrType=="text"||e.modules.filter.tagType=="textarea"?"partial":"match",l="",h="",u;if(typeof e.modules.filter.prevSuccess>"u"||e.modules.filter.prevSuccess!==a){if(e.modules.filter.prevSuccess=a,e.modules.filter.emptyFunc(a))delete i.headerFilters[n];else{switch(e.modules.filter.value=a,typeof e.definition.headerFilterFunc){case"string":Ui.filters[e.definition.headerFilterFunc]?(l=e.definition.headerFilterFunc,u=function(d){var c=e.definition.headerFilterFuncParams||{},f=e.getFieldValue(d);return c=typeof c=="function"?c(a,f,d):c,Ui.filters[e.definition.headerFilterFunc](a,f,d,c)}):console.warn("Header Filter Error - Matching filter function not found: ",e.definition.headerFilterFunc);break;case"function":u=function(d){var c=e.definition.headerFilterFuncParams||{},f=e.getFieldValue(d);return c=typeof c=="function"?c(a,f,d):c,e.definition.headerFilterFunc(a,f,d,c)},l=u;break}if(!u)switch(o){case"partial":u=function(d){var c=e.getFieldValue(d);return typeof c<"u"&&c!==null?String(c).toLowerCase().indexOf(String(a).toLowerCase())>-1:!1},l="like";break;default:u=function(d){return e.getFieldValue(d)==a},l="="}i.headerFilters[n]={value:a,func:u,type:l}}e.modules.filter.value=a,h=JSON.stringify(i.headerFilters),i.prevHeaderFilterChangeCheck!==h&&(i.prevHeaderFilterChangeCheck=h,i.trackChanges(),i.refreshFilter())}return!0}e.modules.filter={success:s,attrType:!1,tagType:!1,emptyFunc:!1},this.generateHeaderFilterElement(e)}generateHeaderFilterElement(e,t,i){var n=this,s=e.modules.filter.success,a=e.getField(),o,l,h,u,d,c,f,p;e.modules.filter.value=t;function v(){}function m(g){p=g}if(e.modules.filter.headerElement&&e.modules.filter.headerElement.parentNode&&e.contentElement.removeChild(e.modules.filter.headerElement.parentNode),a){switch(e.modules.filter.emptyFunc=e.definition.headerFilterEmptyCheck||function(g){return!g&&g!==0},o=document.createElement("div"),o.classList.add("tabulator-header-filter"),typeof e.definition.headerFilter){case"string":n.table.modules.edit.editors[e.definition.headerFilter]?(l=n.table.modules.edit.editors[e.definition.headerFilter],(e.definition.headerFilter==="tick"||e.definition.headerFilter==="tickCross")&&!e.definition.headerFilterEmptyCheck&&(e.modules.filter.emptyFunc=function(g){return g!==!0&&g!==!1})):console.warn("Filter Error - Cannot build header filter, No such editor found: ",e.definition.editor);break;case"function":l=e.definition.headerFilter;break;case"boolean":e.modules.edit&&e.modules.edit.editor?l=e.modules.edit.editor:e.definition.formatter&&n.table.modules.edit.editors[e.definition.formatter]?(l=n.table.modules.edit.editors[e.definition.formatter],(e.definition.formatter==="tick"||e.definition.formatter==="tickCross")&&!e.definition.headerFilterEmptyCheck&&(e.modules.filter.emptyFunc=function(g){return g!==!0&&g!==!1})):l=n.table.modules.edit.editors.input;break}if(l){if(u={getValue:function(){return typeof t<"u"?t:""},getField:function(){return e.definition.field},getElement:function(){return o},getColumn:function(){return e.getComponent()},getTable:()=>this.table,getType:()=>"header",getRow:function(){return{normalizeHeight:function(){}}}},f=e.definition.headerFilterParams||{},f=typeof f=="function"?f.call(n.table,u):f,h=l.call(this.table.modules.edit,u,m,s,v,f),!h){console.warn("Filter Error - Cannot add filter to "+a+" column, editor returned a value of false");return}if(!(h instanceof Node)){console.warn("Filter Error - Cannot add filter to "+a+" column, editor should return an instance of Node, the editor returned:",h);return}n.langBind("headerFilters|columns|"+e.definition.field,function(g){h.setAttribute("placeholder",typeof g<"u"&&g?g:e.definition.headerFilterPlaceholder||n.langText("headerFilters|default"))}),h.addEventListener("click",function(g){g.stopPropagation(),h.focus()}),h.addEventListener("focus",g=>{var x=this.table.columnManager.contentsElement.scrollLeft,b=this.table.rowManager.element.scrollLeft;x!==b&&(this.table.rowManager.scrollHorizontal(x),this.table.columnManager.scrollHorizontal(x))}),d=!1,c=function(g){d&&clearTimeout(d),d=setTimeout(function(){s(h.value)},n.table.options.headerFilterLiveFilterDelay)},e.modules.filter.headerElement=h,e.modules.filter.attrType=h.hasAttribute("type")?h.getAttribute("type").toLowerCase():"",e.modules.filter.tagType=h.tagName.toLowerCase(),e.definition.headerFilterLiveFilter!==!1&&(e.definition.headerFilter==="autocomplete"||e.definition.headerFilter==="tickCross"||(e.definition.editor==="autocomplete"||e.definition.editor==="tickCross")&&e.definition.headerFilter===!0||(h.addEventListener("keyup",c),h.addEventListener("search",c),e.modules.filter.attrType=="number"&&h.addEventListener("change",function(g){s(h.value)}),e.modules.filter.attrType=="text"&&this.table.browser!=="ie"&&h.setAttribute("type","search")),(e.modules.filter.tagType=="input"||e.modules.filter.tagType=="select"||e.modules.filter.tagType=="textarea")&&h.addEventListener("mousedown",function(g){g.stopPropagation()})),o.appendChild(h),e.contentElement.appendChild(o),i||n.headerFilterColumns.push(e),p&&p()}}else console.warn("Filter Error - Cannot add header filter, column has no field set:",e.definition.title)}hideHeaderFilterElements(){this.headerFilterColumns.forEach(function(e){e.modules.filter&&e.modules.filter.headerElement&&(e.modules.filter.headerElement.style.display="none")})}showHeaderFilterElements(){this.headerFilterColumns.forEach(function(e){e.modules.filter&&e.modules.filter.headerElement&&(e.modules.filter.headerElement.style.display="")})}setHeaderFilterFocus(e){e.modules.filter&&e.modules.filter.headerElement?e.modules.filter.headerElement.focus():console.warn("Column Filter Focus Error - No header filter set on column:",e.getField())}getHeaderFilterValue(e){if(e.modules.filter&&e.modules.filter.headerElement)return e.modules.filter.value;console.warn("Column Filter Error - No header filter set on column:",e.getField())}setHeaderFilterValue(e,t){e&&(e.modules.filter&&e.modules.filter.headerElement?(this.generateHeaderFilterElement(e,t,!0),e.modules.filter.success(t)):console.warn("Column Filter Error - No header filter set on column:",e.getField()))}reloadHeaderFilter(e){e&&(e.modules.filter&&e.modules.filter.headerElement?this.generateHeaderFilterElement(e,e.modules.filter.value,!0):console.warn("Column Filter Error - No header filter set on column:",e.getField()))}refreshFilter(){this.tableInitialized&&(this.table.options.filterMode==="remote"?this.reloadData(null,!1,!1):this.refreshData(!0))}trackChanges(){this.changed=!0,this.dispatch("filter-changed")}hasChanged(){var e=this.changed;return this.changed=!1,e}setFilter(e,t,i,n){this.filterList=[],Array.isArray(e)||(e=[{field:e,type:t,value:i,params:n}]),this.addFilter(e)}addFilter(e,t,i,n){var s=!1;Array.isArray(e)||(e=[{field:e,type:t,value:i,params:n}]),e.forEach(a=>{a=this.findFilter(a),a&&(this.filterList.push(a),s=!0)}),s&&this.trackChanges()}findFilter(e){var t;if(Array.isArray(e))return this.findSubFilters(e);var i=!1;return typeof e.field=="function"?i=function(n){return e.field(n,e.type||{})}:Ui.filters[e.type]?(t=this.table.columnManager.getColumnByField(e.field),t?i=function(n){return Ui.filters[e.type](e.value,t.getFieldValue(n),n,e.params||{})}:i=function(n){return Ui.filters[e.type](e.value,n[e.field],n,e.params||{})}):console.warn("Filter Error - No such filter type found, ignoring: ",e.type),e.func=i,e.func?e:!1}findSubFilters(e){var t=[];return e.forEach(i=>{i=this.findFilter(i),i&&t.push(i)}),t.length?t:!1}getFilters(e,t){var i=[];return e&&(i=this.getHeaderFilters()),t&&i.forEach(function(n){typeof n.type=="function"&&(n.type="function")}),i=i.concat(this.filtersToArray(this.filterList,t)),i}filtersToArray(e,t){var i=[];return e.forEach(n=>{var s;Array.isArray(n)?i.push(this.filtersToArray(n,t)):(s={field:n.field,type:n.type,value:n.value},t&&typeof s.type=="function"&&(s.type="function"),i.push(s))}),i}getHeaderFilters(){var e=[];for(var t in this.headerFilters)e.push({field:t,type:this.headerFilters[t].type,value:this.headerFilters[t].value});return e}removeFilter(e,t,i){Array.isArray(e)||(e=[{field:e,type:t,value:i}]),e.forEach(n=>{var s=-1;typeof n.field=="object"?s=this.filterList.findIndex(a=>n===a):s=this.filterList.findIndex(a=>n.field===a.field&&n.type===a.type&&n.value===a.value),s>-1?this.filterList.splice(s,1):console.warn("Filter Error - No matching filter type found, ignoring: ",n.type)}),this.trackChanges()}clearFilter(e){this.filterList=[],e&&this.clearHeaderFilter(),this.trackChanges()}clearHeaderFilter(){this.headerFilters={},this.prevHeaderFilterChangeCheck="{}",this.headerFilterColumns.forEach(e=>{typeof e.modules.filter.value<"u"&&delete e.modules.filter.value,e.modules.filter.prevSuccess=void 0,this.reloadHeaderFilter(e)}),this.trackChanges()}search(e,t,i,n){var s=[],a=[];return Array.isArray(t)||(t=[{field:t,type:i,value:n}]),t.forEach(o=>{o=this.findFilter(o),o&&a.push(o)}),this.table.rowManager.rows.forEach(o=>{var l=!0;a.forEach(h=>{this.filterRecurse(h,o.getData())||(l=!1)}),l&&s.push(e==="data"?o.getData("data"):o.getComponent())}),s}filter(e,t){var i=[],n=[];return this.subscribedExternal("dataFiltering")&&this.dispatchExternal("dataFiltering",this.getFilters(!0)),this.table.options.filterMode!=="remote"&&(this.filterList.length||Object.keys(this.headerFilters).length)?e.forEach(s=>{this.filterRow(s)&&i.push(s)}):i=e.slice(0),this.subscribedExternal("dataFiltered")&&(i.forEach(s=>{n.push(s.getComponent())}),this.dispatchExternal("dataFiltered",this.getFilters(!0),n)),i}filterRow(e,t){var i=!0,n=e.getData();this.filterList.forEach(a=>{this.filterRecurse(a,n)||(i=!1)});for(var s in this.headerFilters)this.headerFilters[s].func(n)||(i=!1);return i}filterRecurse(e,t){var i=!1;return Array.isArray(e)?e.forEach(n=>{this.filterRecurse(n,t)&&(i=!0)}):i=e.func(t),i}};G(Ui,"moduleName","filter"),G(Ui,"filters",$b);let Ho=Ui;function Kb(r,e,t){return this.emptyToSpace(this.sanitizeHTML(r.getValue()))}function Qb(r,e,t){return r.getValue()}function qb(r,e,t){return r.getElement().style.whiteSpace="pre-wrap",this.emptyToSpace(this.sanitizeHTML(r.getValue()))}function Jb(r,e,t){var i=parseFloat(r.getValue()),n="",s,a,o,l,h,u=e.decimal||".",d=e.thousand||",",c=e.negativeSign||"-",f=e.symbol||"",p=!!e.symbolAfter,v=typeof e.precision<"u"?e.precision:2;if(isNaN(i))return this.emptyToSpace(this.sanitizeHTML(r.getValue()));if(i<0&&(i=Math.abs(i),n=c),s=v!==!1?i.toFixed(v):i,s=String(s).split("."),a=s[0],o=s.length>1?u+s[1]:"",e.thousand!==!1)for(l=/(\d+)(\d{3})/;l.test(a);)a=a.replace(l,"$1"+d+"$2");return h=a+o,n===!0?(h="("+h+")",p?h+f:f+h):p?n+h+f:n+f+h}function Zb(r,e,t){var i=r.getValue(),n=e.urlPrefix||"",s=e.download,a=i,o=document.createElement("a"),l;function h(u,d){var c=u.shift(),f=d[c];return u.length&&typeof f=="object"?h(u,f):f}if(e.labelField&&(l=r.getData(),a=h(e.labelField.split(this.table.options.nestedFieldSeparator),l)),e.label)switch(typeof e.label){case"string":a=e.label;break;case"function":a=e.label(r);break}if(a){if(e.urlField&&(l=r.getData(),i=et.retrieveNestedData(this.table.options.nestedFieldSeparator,e.urlField,l)),e.url)switch(typeof e.url){case"string":i=e.url;break;case"function":i=e.url(r);break}return o.setAttribute("href",n+i),e.target&&o.setAttribute("target",e.target),e.download&&(typeof s=="function"?s=s(r):s=s===!0?"":s,o.setAttribute("download",s)),o.innerHTML=this.emptyToSpace(this.sanitizeHTML(a)),o}else return"&nbsp;"}function e1(r,e,t){var i=document.createElement("img"),n=r.getValue();switch(e.urlPrefix&&(n=e.urlPrefix+r.getValue()),e.urlSuffix&&(n=n+e.urlSuffix),i.setAttribute("src",n),typeof e.height){case"number":i.style.height=e.height+"px";break;case"string":i.style.height=e.height;break}switch(typeof e.width){case"number":i.style.width=e.width+"px";break;case"string":i.style.width=e.width;break}return i.addEventListener("load",function(){r.getRow().normalizeHeight()}),i}function t1(r,e,t){var i=r.getValue(),n=r.getElement(),s=e.allowEmpty,a=e.allowTruthy,o=Object.keys(e).includes("trueValue"),l=typeof e.tickElement<"u"?e.tickElement:'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#2DC214" clip-rule="evenodd" d="M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z" fill-rule="evenodd"/></svg>',h=typeof e.crossElement<"u"?e.crossElement:'<svg enable-background="new 0 0 24 24" height="14" width="14"  viewBox="0 0 24 24" xml:space="preserve" ><path fill="#CE1515" d="M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z"/></svg>';return o&&i===e.trueValue||!o&&(a&&i||i===!0||i==="true"||i==="True"||i===1||i==="1")?(n.setAttribute("aria-checked",!0),l||""):s&&(i==="null"||i===""||i===null||typeof i>"u")?(n.setAttribute("aria-checked","mixed"),""):(n.setAttribute("aria-checked",!1),h||"")}function i1(r,e,t){var i=this.table.dependencyRegistry.lookup(["luxon","DateTime"],"DateTime"),n=e.inputFormat||"yyyy-MM-dd HH:mm:ss",s=e.outputFormat||"dd/MM/yyyy HH:mm:ss",a=typeof e.invalidPlaceholder<"u"?e.invalidPlaceholder:"",o=r.getValue();if(typeof i<"u"){var l;return i.isDateTime(o)?l=o:n==="iso"?l=i.fromISO(String(o)):l=i.fromFormat(String(o),n),l.isValid?(e.timezone&&(l=l.setZone(e.timezone)),l.toFormat(s)):a===!0||!o?o:typeof a=="function"?a(o):a}else console.error("Format Error - 'datetime' formatter is dependant on luxon.js")}function r1(r,e,t){var i=this.table.dependencyRegistry.lookup(["luxon","DateTime"],"DateTime"),n=e.inputFormat||"yyyy-MM-dd HH:mm:ss",s=typeof e.invalidPlaceholder<"u"?e.invalidPlaceholder:"",a=typeof e.suffix<"u"?e.suffix:!1,o=typeof e.unit<"u"?e.unit:"days",l=typeof e.humanize<"u"?e.humanize:!1,h=typeof e.date<"u"?e.date:i.now(),u=r.getValue();if(typeof i<"u"){var d;return i.isDateTime(u)?d=u:n==="iso"?d=i.fromISO(String(u)):d=i.fromFormat(String(u),n),d.isValid?l?d.diff(h,o).toHuman()+(a?" "+a:""):parseInt(d.diff(h,o)[o])+(a?" "+a:""):s===!0?u:typeof s=="function"?s(u):s}else console.error("Format Error - 'datetimediff' formatter is dependant on luxon.js")}function n1(r,e,t){var i=r.getValue();return typeof e[i]>"u"?(console.warn("Missing display value for "+i),i):e[i]}function s1(r,e,t){var i=r.getValue(),n=r.getElement(),s=e&&e.stars?e.stars:5,a=document.createElement("span"),o=document.createElementNS("http://www.w3.org/2000/svg","svg"),l='<polygon fill="#FFEA00" stroke="#C1AB60" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>',h='<polygon fill="#D2D2D2" stroke="#686868" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>';a.style.verticalAlign="middle",o.setAttribute("width","14"),o.setAttribute("height","14"),o.setAttribute("viewBox","0 0 512 512"),o.setAttribute("xml:space","preserve"),o.style.padding="0 1px",i=i&&!isNaN(i)?parseInt(i):0,i=Math.max(0,Math.min(i,s));for(var u=1;u<=s;u++){var d=o.cloneNode(!0);d.innerHTML=u<=i?l:h,a.appendChild(d)}return n.style.whiteSpace="nowrap",n.style.overflow="hidden",n.style.textOverflow="ellipsis",n.setAttribute("aria-label",i),a}function a1(r,e,t){var i=this.sanitizeHTML(r.getValue())||0,n=document.createElement("span"),s=e&&e.max?e.max:100,a=e&&e.min?e.min:0,o=e&&typeof e.color<"u"?e.color:["red","orange","green"],l="#666666",h,u;if(!(isNaN(i)||typeof r.getValue()>"u")){switch(n.classList.add("tabulator-traffic-light"),u=parseFloat(i)<=s?parseFloat(i):s,u=parseFloat(u)>=a?parseFloat(u):a,h=(s-a)/100,u=Math.round((u-a)/h),typeof o){case"string":l=o;break;case"function":l=o(i);break;case"object":if(Array.isArray(o)){var d=100/o.length,c=Math.floor(u/d);c=Math.min(c,o.length-1),c=Math.max(c,0),l=o[c];break}}return n.style.backgroundColor=l,n}}function o1(r,e={},t){var i=this.sanitizeHTML(r.getValue())||0,n=r.getElement(),s=e.max?e.max:100,a=e.min?e.min:0,o=e.legendAlign?e.legendAlign:"center",l,h,u,d,c;switch(h=parseFloat(i)<=s?parseFloat(i):s,h=parseFloat(h)>=a?parseFloat(h):a,l=(s-a)/100,h=Math.round((h-a)/l),typeof e.color){case"string":u=e.color;break;case"function":u=e.color(i);break;case"object":if(Array.isArray(e.color)){let m=100/e.color.length,g=Math.floor(h/m);g=Math.min(g,e.color.length-1),g=Math.max(g,0),u=e.color[g];break}default:u="#2DC214"}switch(typeof e.legend){case"string":d=e.legend;break;case"function":d=e.legend(i);break;case"boolean":d=i;break;default:d=!1}switch(typeof e.legendColor){case"string":c=e.legendColor;break;case"function":c=e.legendColor(i);break;case"object":if(Array.isArray(e.legendColor)){let m=100/e.legendColor.length,g=Math.floor(h/m);g=Math.min(g,e.legendColor.length-1),g=Math.max(g,0),c=e.legendColor[g]}break;default:c="#000"}n.style.minWidth="30px",n.style.position="relative",n.setAttribute("aria-label",h);var f=document.createElement("div");f.style.display="inline-block",f.style.width=h+"%",f.style.backgroundColor=u,f.style.height="100%",f.setAttribute("data-max",s),f.setAttribute("data-min",a);var p=document.createElement("div");if(p.style.position="relative",p.style.width="100%",p.style.height="100%",d){var v=document.createElement("div");v.style.position="absolute",v.style.top=0,v.style.left=0,v.style.textAlign=o,v.style.width="100%",v.style.color=c,v.innerHTML=d}return t(function(){if(!(r instanceof pc)){var m=document.createElement("div");m.style.position="absolute",m.style.top="4px",m.style.bottom="4px",m.style.left="4px",m.style.right="4px",n.appendChild(m),n=m}n.appendChild(p),p.appendChild(f),d&&p.appendChild(v)}),""}function l1(r,e,t){return r.getElement().style.backgroundColor=this.sanitizeHTML(r.getValue()),""}function h1(r,e,t){return'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#2DC214" clip-rule="evenodd" d="M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z" fill-rule="evenodd"/></svg>'}function u1(r,e,t){return'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#CE1515" d="M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z"/></svg>'}function c1(r,e,t){var i=r.getValue(),n=e.size||15,s=n+"px",a,o,l=e.hasOwnProperty("onValue")?e.onValue:!0,h=e.hasOwnProperty("offValue")?e.offValue:!1,u=e.onTruthy?i:i===l;return a=document.createElement("div"),a.classList.add("tabulator-toggle"),u?(a.classList.add("tabulator-toggle-on"),a.style.flexDirection="row-reverse",e.onColor&&(a.style.background=e.onColor)):e.offColor&&(a.style.background=e.offColor),a.style.width=2.5*n+"px",a.style.borderRadius=s,e.clickable&&a.addEventListener("click",d=>{r.setValue(u?h:l)}),o=document.createElement("div"),o.classList.add("tabulator-toggle-switch"),o.style.height=s,o.style.width=s,o.style.borderRadius=s,a.appendChild(o),a}function d1(r,e,t){var i=document.createElement("span"),n=r.getRow(),s=r.getTable();return n.watchPosition(a=>{e.relativeToPage&&(a+=s.modules.page.getPageSize()*(s.modules.page.getPage()-1)),i.innerText=a}),i}function f1(r,e,t){return r.getElement().classList.add("tabulator-row-handle"),"<div class='tabulator-row-handle-box'><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div></div>"}function p1(r,e,t){var i,n,s;function a(o){var l=o.getValue(),h="plaintext";switch(typeof l){case"boolean":h="tickCross";break;case"string":l.includes(`
`)&&(h="textarea");break}return h}return i=e.formatterLookup?e.formatterLookup(r):a(r),e.paramsLookup&&(s=typeof e.paramsLookup=="function"?e.paramsLookup(i,r):e.paramsLookup[i]),n=this.table.modules.format.lookupFormatter(i),n.call(this,r,s||{},t)}function m1(r,e,t){var i=e.delimiter||",",n=r.getValue(),s=this.table,a;return e.valueMap&&(typeof e.valueMap=="string"?a=function(o){return o.map(l=>et.retrieveNestedData(s.options.nestedFieldSeparator,e.valueMap,l))}:a=e.valueMap),Array.isArray(n)?(a&&(n=a(n)),n.join(i)):n}function g1(r,e,t){var i=e.indent||"	",n=typeof e.multiline>"u"?!0:e.multiline,s=e.replacer||null,a=r.getValue();return n&&(r.getElement().style.whiteSpace="pre-wrap"),JSON.stringify(a,s,i)}var v1={plaintext:Kb,html:Qb,textarea:qb,money:Jb,link:Zb,image:e1,tickCross:t1,datetime:i1,datetimediff:r1,lookup:n1,star:s1,traffic:a1,progress:o1,color:l1,buttonTick:h1,buttonCross:u1,toggle:c1,rownum:d1,handle:f1,adaptable:p1,array:m1,json:g1};const ur=class ur extends ke{constructor(e){super(e),this.registerColumnOption("formatter"),this.registerColumnOption("formatterParams"),this.registerColumnOption("formatterPrint"),this.registerColumnOption("formatterPrintParams"),this.registerColumnOption("formatterClipboard"),this.registerColumnOption("formatterClipboardParams"),this.registerColumnOption("formatterHtmlOutput"),this.registerColumnOption("formatterHtmlOutputParams"),this.registerColumnOption("titleFormatter"),this.registerColumnOption("titleFormatterParams")}initialize(){this.subscribe("cell-format",this.formatValue.bind(this)),this.subscribe("cell-rendered",this.cellRendered.bind(this)),this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("column-format",this.formatHeader.bind(this))}initializeColumn(e){e.modules.format=this.lookupTypeFormatter(e,""),typeof e.definition.formatterPrint<"u"&&(e.modules.format.print=this.lookupTypeFormatter(e,"Print")),typeof e.definition.formatterClipboard<"u"&&(e.modules.format.clipboard=this.lookupTypeFormatter(e,"Clipboard")),typeof e.definition.formatterHtmlOutput<"u"&&(e.modules.format.htmlOutput=this.lookupTypeFormatter(e,"HtmlOutput"))}lookupTypeFormatter(e,t){var i={params:e.definition["formatter"+t+"Params"]||{}},n=e.definition["formatter"+t];return i.formatter=this.lookupFormatter(n),i}lookupFormatter(e){var t;switch(typeof e){case"string":ur.formatters[e]?t=ur.formatters[e]:(console.warn("Formatter Error - No such formatter found: ",e),t=ur.formatters.plaintext);break;case"function":t=e;break;default:t=ur.formatters.plaintext;break}return t}cellRendered(e){e.modules.format&&e.modules.format.renderedCallback&&!e.modules.format.rendered&&(e.modules.format.renderedCallback(),e.modules.format.rendered=!0)}formatHeader(e,t,i){var n,s,a,o;return e.definition.titleFormatter?(n=this.lookupFormatter(e.definition.titleFormatter),a=l=>{e.titleFormatterRendered=l},o={getValue:function(){return t},getElement:function(){return i},getType:function(){return"header"},getColumn:function(){return e.getComponent()},getTable:()=>this.table},s=e.definition.titleFormatterParams||{},s=typeof s=="function"?s():s,n.call(this,o,s,a)):t}formatValue(e){var t=e.getComponent(),i=typeof e.column.modules.format.params=="function"?e.column.modules.format.params(t):e.column.modules.format.params;function n(s){e.modules.format||(e.modules.format={}),e.modules.format.renderedCallback=s,e.modules.format.rendered=!1}return e.column.modules.format.formatter.call(this,t,i,n)}formatExportValue(e,t){var i=e.column.modules.format[t],n;if(i){let s=function(a){e.modules.format||(e.modules.format={}),e.modules.format.renderedCallback=a,e.modules.format.rendered=!1};return n=typeof i.params=="function"?i.params(e.getComponent()):i.params,i.formatter.call(this,e.getComponent(),n,s)}else return this.formatValue(e)}sanitizeHTML(e){if(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return String(e).replace(/[&<>"'`=/]/g,function(i){return t[i]})}else return e}emptyToSpace(e){return e===null||typeof e>"u"||e===""?"&nbsp;":e}};G(ur,"moduleName","format"),G(ur,"formatters",v1);let zo=ur;class bc extends ke{constructor(e){super(e),this.leftColumns=[],this.rightColumns=[],this.initializationMode="left",this.active=!1,this.blocked=!0,this.registerColumnOption("frozen")}reset(){this.initializationMode="left",this.leftColumns=[],this.rightColumns=[],this.active=!1}initialize(){this.subscribe("cell-layout",this.layoutCell.bind(this)),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("column-width",this.layout.bind(this)),this.subscribe("row-layout-after",this.layoutRow.bind(this)),this.subscribe("table-layout",this.layout.bind(this)),this.subscribe("columns-loading",this.reset.bind(this)),this.subscribe("column-add",this.reinitializeColumns.bind(this)),this.subscribe("column-deleted",this.reinitializeColumns.bind(this)),this.subscribe("column-hide",this.reinitializeColumns.bind(this)),this.subscribe("column-show",this.reinitializeColumns.bind(this)),this.subscribe("columns-loaded",this.reinitializeColumns.bind(this)),this.subscribe("table-redraw",this.layout.bind(this)),this.subscribe("layout-refreshing",this.blockLayout.bind(this)),this.subscribe("layout-refreshed",this.unblockLayout.bind(this)),this.subscribe("scrollbar-vertical",this.adjustForScrollbar.bind(this))}blockLayout(){this.blocked=!0}unblockLayout(){this.blocked=!1}layoutCell(e){this.layoutElement(e.element,e.column)}reinitializeColumns(){this.reset(),this.table.columnManager.columnsByIndex.forEach(e=>{this.initializeColumn(e)}),this.layout()}initializeColumn(e){var t={margin:0,edge:!1};e.isGroup||(this.frozenCheck(e)?(t.position=this.initializationMode,this.initializationMode=="left"?this.leftColumns.push(e):this.rightColumns.unshift(e),this.active=!0,e.modules.frozen=t):this.initializationMode="right")}frozenCheck(e){return e.parent.isGroup&&e.definition.frozen&&console.warn("Frozen Column Error - Parent column group must be frozen, not individual columns or sub column groups"),e.parent.isGroup?this.frozenCheck(e.parent):e.definition.frozen}layoutCalcRows(){this.table.modExists("columnCalcs")&&(this.table.modules.columnCalcs.topInitialized&&this.table.modules.columnCalcs.topRow&&this.layoutRow(this.table.modules.columnCalcs.topRow),this.table.modules.columnCalcs.botInitialized&&this.table.modules.columnCalcs.botRow&&this.layoutRow(this.table.modules.columnCalcs.botRow),this.table.modExists("groupRows")&&this.layoutGroupCalcs(this.table.modules.groupRows.getGroups()))}layoutGroupCalcs(e){e.forEach(t=>{t.calcs.top&&this.layoutRow(t.calcs.top),t.calcs.bottom&&this.layoutRow(t.calcs.bottom),t.groupList&&t.groupList.length&&this.layoutGroupCalcs(t.groupList)})}layoutColumnPosition(e){var t=[],i=0,n=0;this.leftColumns.forEach((s,a)=>{if(s.modules.frozen.marginValue=i,s.modules.frozen.margin=s.modules.frozen.marginValue+"px",s.visible&&(i+=s.getWidth()),a==this.leftColumns.length-1?s.modules.frozen.edge=!0:s.modules.frozen.edge=!1,s.parent.isGroup){var o=this.getColGroupParentElement(s);t.includes(o)||(this.layoutElement(o,s),t.push(o)),o.classList.toggle("tabulator-frozen-left",s.modules.frozen.edge&&s.modules.frozen.position==="left"),o.classList.toggle("tabulator-frozen-right",s.modules.frozen.edge&&s.modules.frozen.position==="right")}else this.layoutElement(s.getElement(),s);e&&s.cells.forEach(l=>{this.layoutElement(l.getElement(!0),s)})}),this.rightColumns.forEach((s,a)=>{s.modules.frozen.marginValue=n,s.modules.frozen.margin=s.modules.frozen.marginValue+"px",s.visible&&(n+=s.getWidth()),a==this.rightColumns.length-1?s.modules.frozen.edge=!0:s.modules.frozen.edge=!1,s.parent.isGroup?this.layoutElement(this.getColGroupParentElement(s),s):this.layoutElement(s.getElement(),s),e&&s.cells.forEach(o=>{this.layoutElement(o.getElement(!0),s)})})}getColGroupParentElement(e){return e.parent.isGroup?this.getColGroupParentElement(e.parent):e.getElement()}layout(){this.active&&!this.blocked&&(this.layoutColumnPosition(),this.reinitializeRows(),this.layoutCalcRows())}reinitializeRows(){var e=this.table.rowManager.getVisibleRows(!0),t=this.table.rowManager.getRows().filter(i=>!e.includes(i));t.forEach(i=>{i.deinitialize()}),e.forEach(i=>{i.type==="row"&&this.layoutRow(i)})}layoutRow(e){this.table.options.layout==="fitDataFill"&&this.rightColumns.length&&(this.table.rowManager.getTableElement().style.minWidth="calc(100% - "+this.rightMargin+")"),this.leftColumns.forEach(t=>{var i=e.getCell(t);i&&this.layoutElement(i.getElement(!0),t)}),this.rightColumns.forEach(t=>{var i=e.getCell(t);i&&this.layoutElement(i.getElement(!0),t)})}layoutElement(e,t){var i;t.modules.frozen&&e&&(e.style.position="sticky",this.table.rtl?i=t.modules.frozen.position==="left"?"right":"left":i=t.modules.frozen.position,e.style[i]=t.modules.frozen.margin,e.classList.add("tabulator-frozen"),e.classList.toggle("tabulator-frozen-left",t.modules.frozen.edge&&t.modules.frozen.position==="left"),e.classList.toggle("tabulator-frozen-right",t.modules.frozen.edge&&t.modules.frozen.position==="right"))}adjustForScrollbar(e){this.rightColumns.length&&(this.table.columnManager.getContentsElement().style.width="calc(100% - "+e+"px)")}getFrozenColumns(){return this.leftColumns.concat(this.rightColumns)}_calcSpace(e,t){var i=0;for(let n=0;n<t;n++)e[n].visible&&(i+=e[n].getWidth());return i}}G(bc,"moduleName","frozenColumns");class wc extends ke{constructor(e){super(e),this.topElement=document.createElement("div"),this.rows=[],this.registerComponentFunction("row","freeze",this.freezeRow.bind(this)),this.registerComponentFunction("row","unfreeze",this.unfreezeRow.bind(this)),this.registerComponentFunction("row","isFrozen",this.isRowFrozen.bind(this)),this.registerTableOption("frozenRowsField","id"),this.registerTableOption("frozenRows",!1)}initialize(){var e=document.createDocumentFragment();this.rows=[],this.topElement.classList.add("tabulator-frozen-rows-holder"),e.appendChild(document.createElement("br")),e.appendChild(this.topElement),this.table.columnManager.getContentsElement().insertBefore(e,this.table.columnManager.headersElement.nextSibling),this.subscribe("row-deleting",this.detachRow.bind(this)),this.subscribe("rows-visible",this.visibleRows.bind(this)),this.registerDisplayHandler(this.getRows.bind(this),10),this.table.options.frozenRows&&(this.subscribe("data-processed",this.initializeRows.bind(this)),this.subscribe("row-added",this.initializeRow.bind(this)),this.subscribe("table-redrawing",this.resizeHolderWidth.bind(this)),this.subscribe("column-resized",this.resizeHolderWidth.bind(this)),this.subscribe("column-show",this.resizeHolderWidth.bind(this)),this.subscribe("column-hide",this.resizeHolderWidth.bind(this))),this.resizeHolderWidth()}resizeHolderWidth(){this.topElement.style.minWidth=this.table.columnManager.headersElement.offsetWidth+"px"}initializeRows(){this.table.rowManager.getRows().forEach(e=>{this.initializeRow(e)})}initializeRow(e){var t=this.table.options.frozenRows,i=typeof t;i==="number"?e.getPosition()&&e.getPosition()+this.rows.length<=t&&this.freezeRow(e):i==="function"?t.call(this.table,e.getComponent())&&this.freezeRow(e):Array.isArray(t)&&t.includes(e.data[this.options("frozenRowsField")])&&this.freezeRow(e)}isRowFrozen(e){var t=this.rows.indexOf(e);return t>-1}isFrozen(){return!!this.rows.length}visibleRows(e,t){return this.rows.forEach(i=>{t.push(i)}),t}getRows(e){var t=e.slice(0);return this.rows.forEach(function(i){var n=t.indexOf(i);n>-1&&t.splice(n,1)}),t}freezeRow(e){e.modules.frozen?console.warn("Freeze Error - Row is already frozen"):(e.modules.frozen=!0,this.topElement.appendChild(e.getElement()),e.initialize(),e.normalizeHeight(),this.rows.push(e),this.refreshData(!1,"display"),this.table.rowManager.adjustTableSize(),this.styleRows())}unfreezeRow(e){e.modules.frozen?(e.modules.frozen=!1,this.detachRow(e),this.table.rowManager.adjustTableSize(),this.refreshData(!1,"display"),this.rows.length&&this.styleRows()):console.warn("Freeze Error - Row is already unfrozen")}detachRow(e){var t=this.rows.indexOf(e);if(t>-1){var i=e.getElement();i.parentNode&&i.parentNode.removeChild(i),this.rows.splice(t,1)}}styleRows(e){this.rows.forEach((t,i)=>{this.table.rowManager.styleRow(t,i)})}}G(wc,"moduleName","frozenRows");class b1{constructor(e){return this._group=e,this.type="GroupComponent",new Proxy(this,{get:function(t,i,n){return typeof t[i]<"u"?t[i]:t._group.groupManager.table.componentFunctionBinder.handle("group",t._group,i)}})}getKey(){return this._group.key}getField(){return this._group.field}getElement(){return this._group.element}getRows(){return this._group.getRows(!0)}getSubGroups(){return this._group.getSubGroups(!0)}getParentGroup(){return this._group.parent?this._group.parent.getComponent():!1}isVisible(){return this._group.visible}show(){this._group.show()}hide(){this._group.hide()}toggle(){this._group.toggleVisibility()}scrollTo(e,t){return this._group.groupManager.table.rowManager.scrollToRow(this._group,e,t)}_getSelf(){return this._group}getTable(){return this._group.groupManager.table}}class nn{constructor(e,t,i,n,s,a,o){this.groupManager=e,this.parent=t,this.key=n,this.level=i,this.field=s,this.hasSubGroups=i<e.groupIDLookups.length-1,this.addRow=this.hasSubGroups?this._addRowToGroup:this._addRow,this.type="group",this.old=o,this.rows=[],this.groups=[],this.groupList=[],this.generator=a,this.element=!1,this.elementContents=!1,this.height=0,this.outerHeight=0,this.initialized=!1,this.calcs={},this.initialized=!1,this.modules={},this.arrowElement=!1,this.visible=o?o.visible:typeof e.startOpen[i]<"u"?e.startOpen[i]:e.startOpen[0],this.component=null,this.createElements(),this.addBindings(),this.createValueGroups()}wipe(e){e||(this.groupList.length?this.groupList.forEach(function(t){t.wipe()}):this.rows.forEach(t=>{t.modules&&delete t.modules.group})),this.element=!1,this.arrowElement=!1,this.elementContents=!1}createElements(){var e=document.createElement("div");e.classList.add("tabulator-arrow"),this.element=document.createElement("div"),this.element.classList.add("tabulator-row"),this.element.classList.add("tabulator-group"),this.element.classList.add("tabulator-group-level-"+this.level),this.element.setAttribute("role","rowgroup"),this.arrowElement=document.createElement("div"),this.arrowElement.classList.add("tabulator-group-toggle"),this.arrowElement.appendChild(e),this.groupManager.table.options.movableRows!==!1&&this.groupManager.table.modExists("moveRow")&&this.groupManager.table.modules.moveRow.initializeGroupHeader(this)}createValueGroups(){var e=this.level+1;this.groupManager.allowedValues&&this.groupManager.allowedValues[e]&&this.groupManager.allowedValues[e].forEach(t=>{this._createGroup(t,e)})}addBindings(){var e;this.groupManager.table.options.groupToggleElement&&(e=this.groupManager.table.options.groupToggleElement=="arrow"?this.arrowElement:this.element,e.addEventListener("click",t=>{this.groupManager.table.options.groupToggleElement==="arrow"&&(t.stopPropagation(),t.stopImmediatePropagation()),setTimeout(()=>{this.toggleVisibility()})}))}_createGroup(e,t){var i=t+"_"+e,n=new nn(this.groupManager,this,t,e,this.groupManager.groupIDLookups[t].field,this.groupManager.headerGenerator[t]||this.groupManager.headerGenerator[0],this.old?this.old.groups[i]:!1);this.groups[i]=n,this.groupList.push(n)}_addRowToGroup(e){var t=this.level+1;if(this.hasSubGroups){var i=this.groupManager.groupIDLookups[t].func(e.getData()),n=t+"_"+i;this.groupManager.allowedValues&&this.groupManager.allowedValues[t]?this.groups[n]&&this.groups[n].addRow(e):(this.groups[n]||this._createGroup(i,t),this.groups[n].addRow(e))}}_addRow(e){this.rows.push(e),e.modules.group=this}insertRow(e,t,i){var n=this.conformRowData({});e.updateData(n);var s=this.rows.indexOf(t);s>-1?i?this.rows.splice(s+1,0,e):this.rows.splice(s,0,e):i?this.rows.push(e):this.rows.unshift(e),e.modules.group=this,this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.options.columnCalcs!="table"&&this.groupManager.table.modules.columnCalcs.recalcGroup(this),this.groupManager.updateGroupRows(!0)}scrollHeader(e){this.arrowElement&&(this.arrowElement.style.marginLeft=e,this.groupList.forEach(function(t){t.scrollHeader(e)}))}getRowIndex(e){}conformRowData(e){return this.field?e[this.field]=this.key:console.warn("Data Conforming Error - Cannot conform row data to match new group as groupBy is a function"),this.parent&&(e=this.parent.conformRowData(e)),e}removeRow(e){var t=this.rows.indexOf(e),i=e.getElement();t>-1&&this.rows.splice(t,1),!this.groupManager.table.options.groupValues&&!this.rows.length?(this.parent?this.parent.removeGroup(this):this.groupManager.removeGroup(this),this.groupManager.updateGroupRows(!0)):(i.parentNode&&i.parentNode.removeChild(i),this.groupManager.blockRedraw||(this.generateGroupHeaderContents(),this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.options.columnCalcs!="table"&&this.groupManager.table.modules.columnCalcs.recalcGroup(this)))}removeGroup(e){var t=e.level+"_"+e.key,i;this.groups[t]&&(delete this.groups[t],i=this.groupList.indexOf(e),i>-1&&this.groupList.splice(i,1),this.groupList.length||(this.parent?this.parent.removeGroup(this):this.groupManager.removeGroup(this)))}getHeadersAndRows(){var e=[];return e.push(this),this._visSet(),this.calcs.top&&(this.calcs.top.detachElement(),this.calcs.top.deleteCells()),this.calcs.bottom&&(this.calcs.bottom.detachElement(),this.calcs.bottom.deleteCells()),this.visible?this.groupList.length?this.groupList.forEach(function(t){e=e.concat(t.getHeadersAndRows())}):(this.groupManager.table.options.columnCalcs!="table"&&this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.modules.columnCalcs.hasTopCalcs()&&(this.calcs.top=this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows),e.push(this.calcs.top)),e=e.concat(this.rows),this.groupManager.table.options.columnCalcs!="table"&&this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.modules.columnCalcs.hasBottomCalcs()&&(this.calcs.bottom=this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows),e.push(this.calcs.bottom))):!this.groupList.length&&this.groupManager.table.options.columnCalcs!="table"&&this.groupManager.table.modExists("columnCalcs")&&(this.groupManager.table.modules.columnCalcs.hasTopCalcs()&&this.groupManager.table.options.groupClosedShowCalcs&&(this.calcs.top=this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows),e.push(this.calcs.top)),this.groupManager.table.modules.columnCalcs.hasBottomCalcs()&&this.groupManager.table.options.groupClosedShowCalcs&&(this.calcs.bottom=this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows),e.push(this.calcs.bottom))),e}getData(e,t){var i=[];return this._visSet(),(!e||e&&this.visible)&&this.rows.forEach(n=>{i.push(n.getData(t||"data"))}),i}getRowCount(){var e=0;return this.groupList.length?this.groupList.forEach(t=>{e+=t.getRowCount()}):e=this.rows.length,e}toggleVisibility(){this.visible?this.hide():this.show()}hide(){this.visible=!1,this.groupManager.table.rowManager.getRenderMode()=="basic"&&!this.groupManager.table.options.pagination?(this.element.classList.remove("tabulator-group-visible"),this.groupList.length?this.groupList.forEach(e=>{var t=e.getHeadersAndRows();t.forEach(i=>{i.detachElement()})}):this.rows.forEach(e=>{var t=e.getElement();t.parentNode.removeChild(t)}),this.groupManager.updateGroupRows(!0)):this.groupManager.updateGroupRows(!0),this.groupManager.table.externalEvents.dispatch("groupVisibilityChanged",this.getComponent(),!1)}show(){if(this.visible=!0,this.groupManager.table.rowManager.getRenderMode()=="basic"&&!this.groupManager.table.options.pagination){this.element.classList.add("tabulator-group-visible");var e=this.generateElement();this.groupList.length?this.groupList.forEach(t=>{var i=t.getHeadersAndRows();i.forEach(n=>{var s=n.getElement();e.parentNode.insertBefore(s,e.nextSibling),n.initialize(),e=s})}):this.rows.forEach(t=>{var i=t.getElement();e.parentNode.insertBefore(i,e.nextSibling),t.initialize(),e=i}),this.groupManager.updateGroupRows(!0)}else this.groupManager.updateGroupRows(!0);this.groupManager.table.externalEvents.dispatch("groupVisibilityChanged",this.getComponent(),!0)}_visSet(){var e=[];typeof this.visible=="function"&&(this.rows.forEach(function(t){e.push(t.getData())}),this.visible=this.visible(this.key,this.getRowCount(),e,this.getComponent()))}getRowGroup(e){var t=!1;return this.groupList.length?this.groupList.forEach(function(i){var n=i.getRowGroup(e);n&&(t=n)}):this.rows.find(function(i){return i===e})&&(t=this),t}getSubGroups(e){var t=[];return this.groupList.forEach(function(i){t.push(e?i.getComponent():i)}),t}getRows(e,t){var i=[];return t&&this.groupList.length?this.groupList.forEach(n=>{i=i.concat(n.getRows(e,t))}):this.rows.forEach(function(n){i.push(e?n.getComponent():n)}),i}generateGroupHeaderContents(){var e=[],t=this.getRows(!1,!0);for(t.forEach(function(i){e.push(i.getData())}),this.elementContents=this.generator(this.key,this.getRowCount(),e,this.getComponent());this.element.firstChild;)this.element.removeChild(this.element.firstChild);typeof this.elementContents=="string"?this.element.innerHTML=this.elementContents:this.element.appendChild(this.elementContents),this.element.insertBefore(this.arrowElement,this.element.firstChild)}getPath(e=[]){return e.unshift(this.key),this.parent&&this.parent.getPath(e),e}getElement(){return this.elementContents?this.element:this.generateElement()}generateElement(){this.addBindings=!1,this._visSet(),this.visible?this.element.classList.add("tabulator-group-visible"):this.element.classList.remove("tabulator-group-visible");for(var e=0;e<this.element.childNodes.length;++e)this.element.childNodes[e].parentNode.removeChild(this.element.childNodes[e]);return this.generateGroupHeaderContents(),this.element}detachElement(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}normalizeHeight(){this.setHeight(this.element.clientHeight)}initialize(e){(!this.initialized||e)&&(this.normalizeHeight(),this.initialized=!0)}reinitialize(){this.initialized=!1,this.height=0,et.elVisible(this.element)&&this.initialize(!0)}setHeight(e){this.height!=e&&(this.height=e,this.outerHeight=this.element.offsetHeight)}getHeight(){return this.outerHeight}getGroup(){return this}reinitializeHeight(){}calcHeight(){}setCellHeight(){}clearCellHeight(){}deinitializeHeight(){}rendered(){}getComponent(){return this.component||(this.component=new b1(this)),this.component}}class xc extends ke{constructor(e){super(e),this.groupIDLookups=!1,this.startOpen=[function(){return!1}],this.headerGenerator=[function(){return""}],this.groupList=[],this.allowedValues=!1,this.groups={},this.displayHandler=this.getRows.bind(this),this.blockRedraw=!1,this.registerTableOption("groupBy",!1),this.registerTableOption("groupStartOpen",!0),this.registerTableOption("groupValues",!1),this.registerTableOption("groupUpdateOnCellEdit",!1),this.registerTableOption("groupHeader",!1),this.registerTableOption("groupHeaderPrint",null),this.registerTableOption("groupHeaderClipboard",null),this.registerTableOption("groupHeaderHtmlOutput",null),this.registerTableOption("groupHeaderDownload",null),this.registerTableOption("groupToggleElement","arrow"),this.registerTableOption("groupClosedShowCalcs",!1),this.registerTableFunction("setGroupBy",this.setGroupBy.bind(this)),this.registerTableFunction("setGroupValues",this.setGroupValues.bind(this)),this.registerTableFunction("setGroupStartOpen",this.setGroupStartOpen.bind(this)),this.registerTableFunction("setGroupHeader",this.setGroupHeader.bind(this)),this.registerTableFunction("getGroups",this.userGetGroups.bind(this)),this.registerTableFunction("getGroupedData",this.userGetGroupedData.bind(this)),this.registerComponentFunction("row","getGroup",this.rowGetGroup.bind(this))}initialize(){this.subscribe("table-destroy",this._blockRedrawing.bind(this)),this.subscribe("rows-wipe",this._blockRedrawing.bind(this)),this.subscribe("rows-wiped",this._restore_redrawing.bind(this)),this.table.options.groupBy&&(this.table.options.groupUpdateOnCellEdit&&(this.subscribe("cell-value-updated",this.cellUpdated.bind(this)),this.subscribe("row-data-changed",this.reassignRowToGroup.bind(this),0)),this.subscribe("table-built",this.configureGroupSetup.bind(this)),this.subscribe("row-deleting",this.rowDeleting.bind(this)),this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("scroll-horizontal",this.scrollHeaders.bind(this)),this.subscribe("rows-wipe",this.wipe.bind(this)),this.subscribe("rows-added",this.rowsUpdated.bind(this)),this.subscribe("row-moving",this.rowMoving.bind(this)),this.subscribe("row-adding-index",this.rowAddingIndex.bind(this)),this.subscribe("rows-sample",this.rowSample.bind(this)),this.subscribe("render-virtual-fill",this.virtualRenderFill.bind(this)),this.registerDisplayHandler(this.displayHandler,20),this.initialized=!0)}_blockRedrawing(){this.blockRedraw=!0}_restore_redrawing(){this.blockRedraw=!1}configureGroupSetup(){if(this.table.options.groupBy){var e=this.table.options.groupBy,t=this.table.options.groupStartOpen,i=this.table.options.groupHeader;if(this.allowedValues=this.table.options.groupValues,Array.isArray(e)&&Array.isArray(i)&&e.length>i.length&&console.warn("Error creating group headers, groupHeader array is shorter than groupBy array"),this.headerGenerator=[function(){return""}],this.startOpen=[function(){return!1}],this.langBind("groups|item",(s,a)=>{this.headerGenerator[0]=(o,l,h)=>(typeof o>"u"?"":o)+"<span>("+l+" "+(l===1?s:a.groups.items)+")</span>"}),this.groupIDLookups=[],e)this.table.modExists("columnCalcs")&&this.table.options.columnCalcs!="table"&&this.table.options.columnCalcs!="both"&&this.table.modules.columnCalcs.removeCalcs();else if(this.table.modExists("columnCalcs")&&this.table.options.columnCalcs!="group"){var n=this.table.columnManager.getRealColumns();n.forEach(s=>{s.definition.topCalc&&this.table.modules.columnCalcs.initializeTopRow(),s.definition.bottomCalc&&this.table.modules.columnCalcs.initializeBottomRow()})}Array.isArray(e)||(e=[e]),e.forEach((s,a)=>{var o,l;typeof s=="function"?o=s:(l=this.table.columnManager.getColumnByField(s),l?o=function(h){return l.getFieldValue(h)}:o=function(h){return h[s]}),this.groupIDLookups.push({field:typeof s=="function"?!1:s,func:o,values:this.allowedValues?this.allowedValues[a]:!1})}),t&&(Array.isArray(t)||(t=[t]),t.forEach(s=>{}),this.startOpen=t),i&&(this.headerGenerator=Array.isArray(i)?i:[i])}else this.groupList=[],this.groups={}}rowSample(e,t){if(this.table.options.groupBy){var i=this.getGroups(!1)[0];t.push(i.getRows(!1)[0])}return t}virtualRenderFill(){var e=this.table.rowManager.tableElement,t=this.table.rowManager.getVisibleRows();if(this.table.options.groupBy)t=t.filter(i=>i.type!=="group"),e.style.minWidth=t.length?"":this.table.columnManager.getWidth()+"px";else return t}rowAddingIndex(e,t,i){if(this.table.options.groupBy){this.assignRowToGroup(e);var n=e.modules.group.rows;return n.length>1&&(!t||t&&n.indexOf(t)==-1?i?n[0]!==e&&(t=n[0],this.table.rowManager.moveRowInArray(e.modules.group.rows,e,t,!i)):n[n.length-1]!==e&&(t=n[n.length-1],this.table.rowManager.moveRowInArray(e.modules.group.rows,e,t,!i)):this.table.rowManager.moveRowInArray(e.modules.group.rows,e,t,!i)),t}}trackChanges(){this.dispatch("group-changed")}setGroupBy(e){this.table.options.groupBy=e,this.initialized||this.initialize(),this.configureGroupSetup(),!e&&this.table.modExists("columnCalcs")&&this.table.options.columnCalcs===!0&&this.table.modules.columnCalcs.reinitializeCalcs(),this.refreshData(),this.trackChanges()}setGroupValues(e){this.table.options.groupValues=e,this.configureGroupSetup(),this.refreshData(),this.trackChanges()}setGroupStartOpen(e){this.table.options.groupStartOpen=e,this.configureGroupSetup(),this.table.options.groupBy?(this.refreshData(),this.trackChanges()):console.warn("Grouping Update - cant refresh view, no groups have been set")}setGroupHeader(e){this.table.options.groupHeader=e,this.configureGroupSetup(),this.table.options.groupBy?(this.refreshData(),this.trackChanges()):console.warn("Grouping Update - cant refresh view, no groups have been set")}userGetGroups(e){return this.getGroups(!0)}userGetGroupedData(){return this.table.options.groupBy?this.getGroupedData():this.getData()}rowGetGroup(e){return e.modules.group?e.modules.group.getComponent():!1}rowMoving(e,t,i){if(this.table.options.groupBy){!i&&t instanceof nn&&(t=this.table.rowManager.prevDisplayRow(e)||t);var n=t instanceof nn?t:t.modules.group,s=e instanceof nn?e:e.modules.group;n===s?this.table.rowManager.moveRowInArray(n.rows,e,t,i):(s&&s.removeRow(e),n.insertRow(e,t,i))}}rowDeleting(e){this.table.options.groupBy&&e.modules.group&&e.modules.group.removeRow(e)}rowsUpdated(e){this.table.options.groupBy&&this.updateGroupRows(!0)}cellUpdated(e){this.table.options.groupBy&&this.reassignRowToGroup(e.row)}getRows(e){return this.table.options.groupBy&&this.groupIDLookups.length?(this.dispatchExternal("dataGrouping"),this.generateGroups(e),this.subscribedExternal("dataGrouped")&&this.dispatchExternal("dataGrouped",this.getGroups(!0)),this.updateGroupRows()):e.slice(0)}getGroups(e){var t=[];return this.groupList.forEach(function(i){t.push(e?i.getComponent():i)}),t}getChildGroups(e){var t=[];return e||(e=this),e.groupList.forEach(i=>{i.groupList.length?t=t.concat(this.getChildGroups(i)):t.push(i)}),t}wipe(){this.table.options.groupBy&&(this.groupList.forEach(function(e){e.wipe()}),this.groupList=[],this.groups={})}pullGroupListData(e){var t=[];return e.forEach(i=>{var n={};n.level=0,n.rowCount=0,n.headerContent="";var s=[];i.hasSubGroups?(s=this.pullGroupListData(i.groupList),n.level=i.level,n.rowCount=s.length-i.groupList.length,n.headerContent=i.generator(i.key,n.rowCount,i.rows,i),t.push(n),t=t.concat(s)):(n.level=i.level,n.headerContent=i.generator(i.key,i.rows.length,i.rows,i),n.rowCount=i.getRows().length,t.push(n),i.getRows().forEach(a=>{t.push(a.getData("data"))}))}),t}getGroupedData(){return this.pullGroupListData(this.groupList)}getRowGroup(e){var t=!1;return this.options("dataTree")&&(e=this.table.modules.dataTree.getTreeParentRoot(e)),this.groupList.forEach(i=>{var n=i.getRowGroup(e);n&&(t=n)}),t}countGroups(){return this.groupList.length}generateGroups(e){var t=this.groups;this.groups={},this.groupList=[],this.allowedValues&&this.allowedValues[0]?(this.allowedValues[0].forEach(i=>{this.createGroup(i,0,t)}),e.forEach(i=>{this.assignRowToExistingGroup(i,t)})):e.forEach(i=>{this.assignRowToGroup(i,t)}),Object.values(t).forEach(i=>{i.wipe(!0)})}createGroup(e,t,i){var n=t+"_"+e,s;i=i||[],s=new nn(this,!1,t,e,this.groupIDLookups[0].field,this.headerGenerator[0],i[n]),this.groups[n]=s,this.groupList.push(s)}assignRowToExistingGroup(e,t){var i=this.groupIDLookups[0].func(e.getData()),n="0_"+i;this.groups[n]&&this.groups[n].addRow(e)}assignRowToGroup(e,t){var i=this.groupIDLookups[0].func(e.getData()),n=!this.groups["0_"+i];return n&&this.createGroup(i,0,t),this.groups["0_"+i].addRow(e),!n}reassignRowToGroup(e){if(e.type==="row"){var t=e.modules.group,i=t.getPath(),n=this.getExpectedPath(e),s;s=i.length==n.length&&i.every((a,o)=>a===n[o]),s||(t.removeRow(e),this.assignRowToGroup(e,this.groups),this.refreshData(!0))}}getExpectedPath(e){var t=[],i=e.getData();return this.groupIDLookups.forEach(n=>{t.push(n.func(i))}),t}updateGroupRows(e){var t=[];return this.blockRedraw||(this.groupList.forEach(i=>{t=t.concat(i.getHeadersAndRows())}),e&&this.refreshData(!0)),t}scrollHeaders(e){this.table.options.groupBy&&(this.table.options.renderHorizontal==="virtual"&&(e-=this.table.columnManager.renderer.vDomPadLeft),e=e+"px",this.groupList.forEach(t=>{t.scrollHeader(e)}))}removeGroup(e){var t=e.level+"_"+e.key,i;this.groups[t]&&(delete this.groups[t],i=this.groupList.indexOf(e),i>-1&&this.groupList.splice(i,1))}checkBasicModeGroupHeaderWidth(){var e=this.table.rowManager.tableElement,t=!0;this.table.rowManager.getDisplayRows().forEach((i,n)=>{this.table.rowManager.styleRow(i,n),e.appendChild(i.getElement()),i.initialize(!0),i.type!=="group"&&(t=!1)}),t?e.style.minWidth=this.table.columnManager.getWidth()+"px":e.style.minWidth=""}}G(xc,"moduleName","groupRows");var w1={cellEdit:function(r){r.component.setValueProcessData(r.data.oldValue),r.component.cellRendered()},rowAdd:function(r){r.component.deleteActual(),this.table.rowManager.checkPlaceholder()},rowDelete:function(r){var e=this.table.rowManager.addRowActual(r.data.data,r.data.pos,r.data.index);this.table.options.groupBy&&this.table.modExists("groupRows")&&this.table.modules.groupRows.updateGroupRows(!0),this._rebindRow(r.component,e),this.table.rowManager.checkPlaceholder()},rowMove:function(r){var e=r.data.posFrom-r.data.posTo>0;this.table.rowManager.moveRowActual(r.component,this.table.rowManager.getRowFromPosition(r.data.posFrom),e),this.table.rowManager.regenerateRowPositions(),this.table.rowManager.reRenderInPosition()}},x1={cellEdit:function(r){r.component.setValueProcessData(r.data.newValue),r.component.cellRendered()},rowAdd:function(r){var e=this.table.rowManager.addRowActual(r.data.data,r.data.pos,r.data.index);this.table.options.groupBy&&this.table.modExists("groupRows")&&this.table.modules.groupRows.updateGroupRows(!0),this._rebindRow(r.component,e),this.table.rowManager.checkPlaceholder()},rowDelete:function(r){r.component.deleteActual(),this.table.rowManager.checkPlaceholder()},rowMove:function(r){this.table.rowManager.moveRowActual(r.component,this.table.rowManager.getRowFromPosition(r.data.posTo),r.data.after),this.table.rowManager.regenerateRowPositions(),this.table.rowManager.reRenderInPosition()}},y1={undo:["ctrl + 90","meta + 90"],redo:["ctrl + 89","meta + 89"]},E1={undo:function(r){var e=!1;this.table.options.history&&this.table.modExists("history")&&this.table.modExists("edit")&&(e=this.table.modules.edit.currentCell,e||(r.preventDefault(),this.table.modules.history.undo()))},redo:function(r){var e=!1;this.table.options.history&&this.table.modExists("history")&&this.table.modExists("edit")&&(e=this.table.modules.edit.currentCell,e||(r.preventDefault(),this.table.modules.history.redo()))}},C1={keybindings:{bindings:y1,actions:E1}};const cr=class cr extends ke{constructor(e){super(e),this.history=[],this.index=-1,this.registerTableOption("history",!1)}initialize(){this.table.options.history&&(this.subscribe("cell-value-updated",this.cellUpdated.bind(this)),this.subscribe("cell-delete",this.clearComponentHistory.bind(this)),this.subscribe("row-delete",this.rowDeleted.bind(this)),this.subscribe("rows-wipe",this.clear.bind(this)),this.subscribe("row-added",this.rowAdded.bind(this)),this.subscribe("row-move",this.rowMoved.bind(this))),this.registerTableFunction("undo",this.undo.bind(this)),this.registerTableFunction("redo",this.redo.bind(this)),this.registerTableFunction("getHistoryUndoSize",this.getHistoryUndoSize.bind(this)),this.registerTableFunction("getHistoryRedoSize",this.getHistoryRedoSize.bind(this)),this.registerTableFunction("clearHistory",this.clear.bind(this))}rowMoved(e,t,i){this.action("rowMove",e,{posFrom:e.getPosition(),posTo:t.getPosition(),to:t,after:i})}rowAdded(e,t,i,n){this.action("rowAdd",e,{data:t,pos:i,index:n})}rowDeleted(e){var t,i;this.table.options.groupBy?(i=e.getComponent().getGroup()._getSelf().rows,t=i.indexOf(e),t&&(t=i[t-1])):(t=e.table.rowManager.getRowIndex(e),t&&(t=e.table.rowManager.rows[t-1])),this.action("rowDelete",e,{data:e.getData(),pos:!t,index:t})}cellUpdated(e){this.action("cellEdit",e,{oldValue:e.oldValue,newValue:e.value})}clear(){this.history=[],this.index=-1}action(e,t,i){this.history=this.history.slice(0,this.index+1),this.history.push({type:e,component:t,data:i}),this.index++}getHistoryUndoSize(){return this.index+1}getHistoryRedoSize(){return this.history.length-(this.index+1)}clearComponentHistory(e){var t=this.history.findIndex(function(i){return i.component===e});t>-1&&(this.history.splice(t,1),t<=this.index&&this.index--,this.clearComponentHistory(e))}undo(){if(this.index>-1){let e=this.history[this.index];return cr.undoers[e.type].call(this,e),this.index--,this.dispatchExternal("historyUndo",e.type,e.component.getComponent(),e.data),!0}else return console.warn(this.options("history")?"History Undo Error - No more history to undo":"History module not enabled"),!1}redo(){if(this.history.length-1>this.index){this.index++;let e=this.history[this.index];return cr.redoers[e.type].call(this,e),this.dispatchExternal("historyRedo",e.type,e.component.getComponent(),e.data),!0}else return console.warn(this.options("history")?"History Redo Error - No more history to redo":"History module not enabled"),!1}_rebindRow(e,t){this.history.forEach(function(i){if(i.component instanceof It)i.component===e&&(i.component=t);else if(i.component instanceof ms&&i.component.row===e){var n=i.component.column.getField();n&&(i.component=t.getCell(n))}})}};G(cr,"moduleName","history"),G(cr,"moduleExtensions",C1),G(cr,"undoers",w1),G(cr,"redoers",x1);let Wo=cr;class yc extends ke{constructor(e){super(e),this.fieldIndex=[],this.hasIndex=!1}initialize(){this.tableElementCheck()}tableElementCheck(){this.table.originalElement&&this.table.originalElement.tagName==="TABLE"&&(this.table.originalElement.childNodes.length?this.parseTable():console.warn("Unable to parse data from empty table tag, Tabulator should be initialized on a div tag unless importing data from a table element."))}parseTable(){var e=this.table.originalElement,t=this.table.options,i=e.getElementsByTagName("th"),n=e.getElementsByTagName("tbody")[0],s=[];this.hasIndex=!1,this.dispatchExternal("htmlImporting"),n=n?n.getElementsByTagName("tr"):[],this._extractOptions(e,t),i.length?this._extractHeaders(i,n):this._generateBlankHeaders(i,n);for(var a=0;a<n.length;a++){var o=n[a],l=o.getElementsByTagName("td"),h={};this.hasIndex||(h[t.index]=a);for(var u=0;u<l.length;u++){var d=l[u];typeof this.fieldIndex[u]<"u"&&(h[this.fieldIndex[u]]=d.innerHTML)}s.push(h)}t.data=s,this.dispatchExternal("htmlImported")}_extractOptions(e,t,i){var n=e.attributes,s=Object.keys(i||t),a={};s.forEach(u=>{a[u.toLowerCase()]=u});for(var o in n){var l=n[o],h;l&&typeof l=="object"&&l.name&&l.name.indexOf("tabulator-")===0&&(h=l.name.replace("tabulator-",""),typeof a[h]<"u"&&(t[a[h]]=this._attribValue(l.value)))}}_attribValue(e){return e==="true"?!0:e==="false"?!1:e}_findCol(e){var t=this.table.options.columns.find(i=>i.title===e);return t||!1}_extractHeaders(e,t){for(var i=0;i<e.length;i++){var n=e[i],s=!1,a=this._findCol(n.textContent),o;a?s=!0:a={title:n.textContent.trim()},a.field||(a.field=n.textContent.trim().toLowerCase().replaceAll(" ","_")),o=n.getAttribute("width"),o&&!a.width&&(a.width=o),this._extractOptions(n,a,this.table.columnManager.optionsList.registeredDefaults),this.fieldIndex[i]=a.field,a.field==this.table.options.index&&(this.hasIndex=!0),s||this.table.options.columns.push(a)}}_generateBlankHeaders(e,t){for(var i=0;i<e.length;i++){var n=e[i],s={title:"",field:"col"+i};this.fieldIndex[i]=s.field;var a=n.getAttribute("width");a&&(s.width=a),this.table.options.columns.push(s)}}}G(yc,"moduleName","htmlTableImport");function _1(r){var e=[],t=0,i=0,n=!1;for(let s=0;s<r.length;s++){let a=r[s],o=r[s+1];if(e[t]||(e[t]=[]),e[t][i]||(e[t][i]=""),a=='"'&&n&&o=='"'){e[t][i]+=a,s++;continue}if(a=='"'){n=!n;continue}if(a==","&&!n){i++;continue}if(a=="\r"&&o==`
`&&!n){i=0,t++,s++;continue}if((a=="\r"||a==`
`)&&!n){i=0,t++;continue}e[t][i]+=a}return e}function T1(r){try{return JSON.parse(r)}catch(e){return console.warn("JSON Import Error - File contents is invalid JSON",e),Promise.reject()}}function S1(r){return r}function D1(r){var e=this.dependencyRegistry.lookup("XLSX"),t=e.read(r),i=t.Sheets[t.SheetNames[0]];return e.utils.sheet_to_json(i,{header:1})}var k1={csv:_1,json:T1,array:S1,xlsx:D1};const qn=class qn extends ke{constructor(e){super(e),this.registerTableOption("importFormat"),this.registerTableOption("importReader","text"),this.registerTableOption("importHeaderTransform"),this.registerTableOption("importValueTransform"),this.registerTableOption("importDataValidator"),this.registerTableOption("importFileValidator")}initialize(){this.registerTableFunction("import",this.importFromFile.bind(this)),this.table.options.importFormat&&(this.subscribe("data-loading",this.loadDataCheck.bind(this),10),this.subscribe("data-load",this.loadData.bind(this),10))}loadDataCheck(e){return this.table.options.importFormat&&(typeof e=="string"||Array.isArray(e)&&e.length&&Array.isArray(e))}loadData(e,t,i,n,s){return this.importData(this.lookupImporter(),e).then(this.structureData.bind(this)).catch(a=>(console.error("Import Error:",a||"Unable to import data"),Promise.reject(a)))}lookupImporter(e){var t;return e||(e=this.table.options.importFormat),typeof e=="string"?t=qn.importers[e]:t=e,t||console.error("Import Error - Importer not found:",e),t}importFromFile(e,t,i){var n=this.lookupImporter(e);if(n)return this.pickFile(t,i).then(this.importData.bind(this,n)).then(this.structureData.bind(this)).then(this.mutateData.bind(this)).then(this.validateData.bind(this)).then(this.setData.bind(this)).catch(s=>(this.dispatch("import-error",s),this.dispatchExternal("importError",s),console.error("Import Error:",s||"Unable to import file"),this.table.dataLoader.alertError(),setTimeout(()=>{this.table.dataLoader.clearAlert()},3e3),Promise.reject(s)))}pickFile(e,t){return new Promise((i,n)=>{var s=document.createElement("input");s.type="file",s.accept=e,s.addEventListener("change",a=>{var o=s.files[0],l=new FileReader,h=this.validateFile(o);if(h===!0){switch(this.dispatch("import-importing",s.files),this.dispatchExternal("importImporting",s.files),t||this.table.options.importReader){case"buffer":l.readAsArrayBuffer(o);break;case"binary":l.readAsBinaryString(o);break;case"url":l.readAsDataURL(o);break;case"text":default:l.readAsText(o)}l.onload=u=>{i(l.result)},l.onerror=u=>{console.warn("File Load Error - Unable to read file"),n(u)}}else n(h)}),this.dispatch("import-choose"),this.dispatchExternal("importChoose"),s.click()})}importData(e,t){var i;return this.table.dataLoader.alertLoader(),new Promise((n,s)=>{setTimeout(()=>{i=e.call(this.table,t),i instanceof Promise||i?n(i):s()},10)})}structureData(e){var t=[];return Array.isArray(e)&&e.length&&Array.isArray(e[0])?(this.table.options.autoColumns?t=this.structureArrayToObject(e):t=this.structureArrayToColumns(e),t):e}mutateData(e){var t=[];return Array.isArray(e)?e.forEach(i=>{t.push(this.table.modules.mutator.transformRow(i,"import"))}):t=e,t}transformHeader(e){var t=[];if(this.table.options.importHeaderTransform)e.forEach(i=>{t.push(this.table.options.importHeaderTransform.call(this.table,i,e))});else return e;return t}transformData(e){var t=[];if(this.table.options.importValueTransform)e.forEach(i=>{t.push(this.table.options.importValueTransform.call(this.table,i,e))});else return e;return t}structureArrayToObject(e){var t=this.transformHeader(e.shift()),i=e.map(n=>{var s={};return n=this.transformData(n),t.forEach((a,o)=>{s[a]=n[o]}),s});return i}structureArrayToColumns(e){var t=[],i=this.transformHeader(e[0]),n=this.table.getColumns();return n[0]&&i[0]&&n[0].getDefinition().title===i[0]&&e.shift(),e.forEach(s=>{var a={};s=this.transformData(s),s.forEach((o,l)=>{var h=n[l];h&&(a[h.getField()]=o)}),t.push(a)}),t}validateFile(e){return this.table.options.importFileValidator?this.table.options.importFileValidator.call(this.table,e):!0}validateData(e){var t;return this.table.options.importDataValidator?(t=this.table.options.importDataValidator.call(this.table,e),t===!0?e:Promise.reject(t)):e}setData(e){return this.dispatch("import-imported",e),this.dispatchExternal("importImported",e),this.table.dataLoader.clearAlert(),this.table.setData(e)}};G(qn,"moduleName","import"),G(qn,"importers",k1);let Vo=qn;class Ec extends ke{constructor(e){super(e),this.eventMap={rowClick:"row-click",rowDblClick:"row-dblclick",rowContext:"row-contextmenu",rowMouseEnter:"row-mouseenter",rowMouseLeave:"row-mouseleave",rowMouseOver:"row-mouseover",rowMouseOut:"row-mouseout",rowMouseMove:"row-mousemove",rowMouseDown:"row-mousedown",rowMouseUp:"row-mouseup",rowTap:"row",rowDblTap:"row",rowTapHold:"row",cellClick:"cell-click",cellDblClick:"cell-dblclick",cellContext:"cell-contextmenu",cellMouseEnter:"cell-mouseenter",cellMouseLeave:"cell-mouseleave",cellMouseOver:"cell-mouseover",cellMouseOut:"cell-mouseout",cellMouseMove:"cell-mousemove",cellMouseDown:"cell-mousedown",cellMouseUp:"cell-mouseup",cellTap:"cell",cellDblTap:"cell",cellTapHold:"cell",headerClick:"column-click",headerDblClick:"column-dblclick",headerContext:"column-contextmenu",headerMouseEnter:"column-mouseenter",headerMouseLeave:"column-mouseleave",headerMouseOver:"column-mouseover",headerMouseOut:"column-mouseout",headerMouseMove:"column-mousemove",headerMouseDown:"column-mousedown",headerMouseUp:"column-mouseup",headerTap:"column",headerDblTap:"column",headerTapHold:"column",groupClick:"group-click",groupDblClick:"group-dblclick",groupContext:"group-contextmenu",groupMouseEnter:"group-mouseenter",groupMouseLeave:"group-mouseleave",groupMouseOver:"group-mouseover",groupMouseOut:"group-mouseout",groupMouseMove:"group-mousemove",groupMouseDown:"group-mousedown",groupMouseUp:"group-mouseup",groupTap:"group",groupDblTap:"group",groupTapHold:"group"},this.subscribers={},this.touchSubscribers={},this.columnSubscribers={},this.touchWatchers={row:{tap:null,tapDbl:null,tapHold:null},cell:{tap:null,tapDbl:null,tapHold:null},column:{tap:null,tapDbl:null,tapHold:null},group:{tap:null,tapDbl:null,tapHold:null}},this.registerColumnOption("headerClick"),this.registerColumnOption("headerDblClick"),this.registerColumnOption("headerContext"),this.registerColumnOption("headerMouseEnter"),this.registerColumnOption("headerMouseLeave"),this.registerColumnOption("headerMouseOver"),this.registerColumnOption("headerMouseOut"),this.registerColumnOption("headerMouseMove"),this.registerColumnOption("headerMouseDown"),this.registerColumnOption("headerMouseUp"),this.registerColumnOption("headerTap"),this.registerColumnOption("headerDblTap"),this.registerColumnOption("headerTapHold"),this.registerColumnOption("cellClick"),this.registerColumnOption("cellDblClick"),this.registerColumnOption("cellContext"),this.registerColumnOption("cellMouseEnter"),this.registerColumnOption("cellMouseLeave"),this.registerColumnOption("cellMouseOver"),this.registerColumnOption("cellMouseOut"),this.registerColumnOption("cellMouseMove"),this.registerColumnOption("cellMouseDown"),this.registerColumnOption("cellMouseUp"),this.registerColumnOption("cellTap"),this.registerColumnOption("cellDblTap"),this.registerColumnOption("cellTapHold")}initialize(){this.initializeExternalEvents(),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("cell-dblclick",this.cellContentsSelectionFixer.bind(this)),this.subscribe("scroll-horizontal",this.clearTouchWatchers.bind(this)),this.subscribe("scroll-vertical",this.clearTouchWatchers.bind(this))}clearTouchWatchers(){var e=Object.values(this.touchWatchers);e.forEach(t=>{for(let i in t)t[i]=null})}cellContentsSelectionFixer(e,t){var i;if(!(this.table.modExists("edit")&&this.table.modules.edit.currentCell===t)){e.preventDefault();try{document.selection?(i=document.body.createTextRange(),i.moveToElementText(t.getElement()),i.select()):window.getSelection&&(i=document.createRange(),i.selectNode(t.getElement()),window.getSelection().removeAllRanges(),window.getSelection().addRange(i))}catch{}}}initializeExternalEvents(){for(let e in this.eventMap)this.subscriptionChangeExternal(e,this.subscriptionChanged.bind(this,e))}subscriptionChanged(e,t){t?this.subscribers[e]||(this.eventMap[e].includes("-")?(this.subscribers[e]=this.handle.bind(this,e),this.subscribe(this.eventMap[e],this.subscribers[e])):this.subscribeTouchEvents(e)):this.eventMap[e].includes("-")?this.subscribers[e]&&!this.columnSubscribers[e]&&!this.subscribedExternal(e)&&(this.unsubscribe(this.eventMap[e],this.subscribers[e]),delete this.subscribers[e]):this.unsubscribeTouchEvents(e)}subscribeTouchEvents(e){var t=this.eventMap[e];this.touchSubscribers[t+"-touchstart"]||(this.touchSubscribers[t+"-touchstart"]=this.handleTouch.bind(this,t,"start"),this.touchSubscribers[t+"-touchend"]=this.handleTouch.bind(this,t,"end"),this.subscribe(t+"-touchstart",this.touchSubscribers[t+"-touchstart"]),this.subscribe(t+"-touchend",this.touchSubscribers[t+"-touchend"])),this.subscribers[e]=!0}unsubscribeTouchEvents(e){var t=!0,i=this.eventMap[e];if(this.subscribers[e]&&!this.subscribedExternal(e)){delete this.subscribers[e];for(let n in this.eventMap)this.eventMap[n]===i&&this.subscribers[n]&&(t=!1);t&&(this.unsubscribe(i+"-touchstart",this.touchSubscribers[i+"-touchstart"]),this.unsubscribe(i+"-touchend",this.touchSubscribers[i+"-touchend"]),delete this.touchSubscribers[i+"-touchstart"],delete this.touchSubscribers[i+"-touchend"])}}initializeColumn(e){var t=e.definition;for(let i in this.eventMap)t[i]&&(this.subscriptionChanged(i,!0),this.columnSubscribers[i]||(this.columnSubscribers[i]=[]),this.columnSubscribers[i].push(e))}handle(e,t,i){this.dispatchEvent(e,t,i)}handleTouch(e,t,i,n){var s=this.touchWatchers[e];switch(e==="column"&&(e="header"),t){case"start":s.tap=!0,clearTimeout(s.tapHold),s.tapHold=setTimeout(()=>{clearTimeout(s.tapHold),s.tapHold=null,s.tap=null,clearTimeout(s.tapDbl),s.tapDbl=null,this.dispatchEvent(e+"TapHold",i,n)},1e3);break;case"end":s.tap&&(s.tap=null,this.dispatchEvent(e+"Tap",i,n)),s.tapDbl?(clearTimeout(s.tapDbl),s.tapDbl=null,this.dispatchEvent(e+"DblTap",i,n)):s.tapDbl=setTimeout(()=>{clearTimeout(s.tapDbl),s.tapDbl=null},300),clearTimeout(s.tapHold),s.tapHold=null;break}}dispatchEvent(e,t,i){var n=i.getComponent(),s;this.columnSubscribers[e]&&(i instanceof ms?s=i.column.definition[e]:i instanceof Ir&&(s=i.definition[e]),s&&s(t,n)),this.dispatchExternal(e,t,n)}}G(Ec,"moduleName","interaction");var R1={navPrev:"shift + 9",navNext:9,navUp:38,navDown:40,navLeft:37,navRight:39,scrollPageUp:33,scrollPageDown:34,scrollToStart:36,scrollToEnd:35},F1={keyBlock:function(r){r.stopPropagation(),r.preventDefault()},scrollPageUp:function(r){var e=this.table.rowManager,t=e.scrollTop-e.element.clientHeight;r.preventDefault(),e.displayRowsCount&&(t>=0?e.element.scrollTop=t:e.scrollToRow(e.getDisplayRows()[0])),this.table.element.focus()},scrollPageDown:function(r){var e=this.table.rowManager,t=e.scrollTop+e.element.clientHeight,i=e.element.scrollHeight;r.preventDefault(),e.displayRowsCount&&(t<=i?e.element.scrollTop=t:e.scrollToRow(e.getDisplayRows()[e.displayRowsCount-1])),this.table.element.focus()},scrollToStart:function(r){var e=this.table.rowManager;r.preventDefault(),e.displayRowsCount&&e.scrollToRow(e.getDisplayRows()[0]),this.table.element.focus()},scrollToEnd:function(r){var e=this.table.rowManager;r.preventDefault(),e.displayRowsCount&&e.scrollToRow(e.getDisplayRows()[e.displayRowsCount-1]),this.table.element.focus()},navPrev:function(r){this.dispatch("keybinding-nav-prev",r)},navNext:function(r){this.dispatch("keybinding-nav-next",r)},navLeft:function(r){this.dispatch("keybinding-nav-left",r)},navRight:function(r){this.dispatch("keybinding-nav-right",r)},navUp:function(r){this.dispatch("keybinding-nav-up",r)},navDown:function(r){this.dispatch("keybinding-nav-down",r)}};const dr=class dr extends ke{constructor(e){super(e),this.watchKeys=null,this.pressedKeys=null,this.keyupBinding=!1,this.keydownBinding=!1,this.registerTableOption("keybindings",{}),this.registerTableOption("tabEndNewRow",!1)}initialize(){var e=this.table.options.keybindings,t={};this.watchKeys={},this.pressedKeys=[],e!==!1&&(Object.assign(t,dr.bindings),Object.assign(t,e),this.mapBindings(t),this.bindEvents()),this.subscribe("table-destroy",this.clearBindings.bind(this))}mapBindings(e){for(let t in e)dr.actions[t]?e[t]&&(typeof e[t]!="object"&&(e[t]=[e[t]]),e[t].forEach(i=>{var n=Array.isArray(i)?i:[i];n.forEach(s=>{this.mapBinding(t,s)})})):console.warn("Key Binding Error - no such action:",t)}mapBinding(e,t){var i={action:dr.actions[e],keys:[],ctrl:!1,shift:!1,meta:!1},n=t.toString().toLowerCase().split(" ").join("").split("+");n.forEach(s=>{switch(s){case"ctrl":i.ctrl=!0;break;case"shift":i.shift=!0;break;case"meta":i.meta=!0;break;default:s=isNaN(s)?s.toUpperCase().charCodeAt(0):parseInt(s),i.keys.push(s),this.watchKeys[s]||(this.watchKeys[s]=[]),this.watchKeys[s].push(i)}})}bindEvents(){var e=this;this.keyupBinding=function(t){var i=t.keyCode,n=e.watchKeys[i];n&&(e.pressedKeys.push(i),n.forEach(function(s){e.checkBinding(t,s)}))},this.keydownBinding=function(t){var i=t.keyCode,n=e.watchKeys[i];if(n){var s=e.pressedKeys.indexOf(i);s>-1&&e.pressedKeys.splice(s,1)}},this.table.element.addEventListener("keydown",this.keyupBinding),this.table.element.addEventListener("keyup",this.keydownBinding)}clearBindings(){this.keyupBinding&&this.table.element.removeEventListener("keydown",this.keyupBinding),this.keydownBinding&&this.table.element.removeEventListener("keyup",this.keydownBinding)}checkBinding(e,t){var i=!0;return e.ctrlKey==t.ctrl&&e.shiftKey==t.shift&&e.metaKey==t.meta?(t.keys.forEach(n=>{var s=this.pressedKeys.indexOf(n);s==-1&&(i=!1)}),i&&t.action.call(this,e),!0):!1}};G(dr,"moduleName","keybindings"),G(dr,"bindings",R1),G(dr,"actions",F1);let Uo=dr;class Cc extends ke{constructor(e){super(e),this.menuContainer=null,this.nestedMenuBlock=!1,this.currentComponent=null,this.rootPopup=null,this.columnSubscribers={},this.registerTableOption("rowContextMenu",!1),this.registerTableOption("rowClickMenu",!1),this.registerTableOption("rowDblClickMenu",!1),this.registerTableOption("groupContextMenu",!1),this.registerTableOption("groupClickMenu",!1),this.registerTableOption("groupDblClickMenu",!1),this.registerColumnOption("headerContextMenu"),this.registerColumnOption("headerClickMenu"),this.registerColumnOption("headerDblClickMenu"),this.registerColumnOption("headerMenu"),this.registerColumnOption("headerMenuIcon"),this.registerColumnOption("contextMenu"),this.registerColumnOption("clickMenu"),this.registerColumnOption("dblClickMenu")}initialize(){this.deprecatedOptionsCheck(),this.initializeRowWatchers(),this.initializeGroupWatchers(),this.subscribe("column-init",this.initializeColumn.bind(this))}deprecatedOptionsCheck(){}initializeRowWatchers(){this.table.options.rowContextMenu&&(this.subscribe("row-contextmenu",this.loadMenuEvent.bind(this,this.table.options.rowContextMenu)),this.table.on("rowTapHold",this.loadMenuEvent.bind(this,this.table.options.rowContextMenu))),this.table.options.rowClickMenu&&this.subscribe("row-click",this.loadMenuEvent.bind(this,this.table.options.rowClickMenu)),this.table.options.rowDblClickMenu&&this.subscribe("row-dblclick",this.loadMenuEvent.bind(this,this.table.options.rowDblClickMenu))}initializeGroupWatchers(){this.table.options.groupContextMenu&&(this.subscribe("group-contextmenu",this.loadMenuEvent.bind(this,this.table.options.groupContextMenu)),this.table.on("groupTapHold",this.loadMenuEvent.bind(this,this.table.options.groupContextMenu))),this.table.options.groupClickMenu&&this.subscribe("group-click",this.loadMenuEvent.bind(this,this.table.options.groupClickMenu)),this.table.options.groupDblClickMenu&&this.subscribe("group-dblclick",this.loadMenuEvent.bind(this,this.table.options.groupDblClickMenu))}initializeColumn(e){var t=e.definition;t.headerContextMenu&&!this.columnSubscribers.headerContextMenu&&(this.columnSubscribers.headerContextMenu=this.loadMenuTableColumnEvent.bind(this,"headerContextMenu"),this.subscribe("column-contextmenu",this.columnSubscribers.headerContextMenu),this.table.on("headerTapHold",this.loadMenuTableColumnEvent.bind(this,"headerContextMenu"))),t.headerClickMenu&&!this.columnSubscribers.headerClickMenu&&(this.columnSubscribers.headerClickMenu=this.loadMenuTableColumnEvent.bind(this,"headerClickMenu"),this.subscribe("column-click",this.columnSubscribers.headerClickMenu)),t.headerDblClickMenu&&!this.columnSubscribers.headerDblClickMenu&&(this.columnSubscribers.headerDblClickMenu=this.loadMenuTableColumnEvent.bind(this,"headerDblClickMenu"),this.subscribe("column-dblclick",this.columnSubscribers.headerDblClickMenu)),t.headerMenu&&this.initializeColumnHeaderMenu(e),t.contextMenu&&!this.columnSubscribers.contextMenu&&(this.columnSubscribers.contextMenu=this.loadMenuTableCellEvent.bind(this,"contextMenu"),this.subscribe("cell-contextmenu",this.columnSubscribers.contextMenu),this.table.on("cellTapHold",this.loadMenuTableCellEvent.bind(this,"contextMenu"))),t.clickMenu&&!this.columnSubscribers.clickMenu&&(this.columnSubscribers.clickMenu=this.loadMenuTableCellEvent.bind(this,"clickMenu"),this.subscribe("cell-click",this.columnSubscribers.clickMenu)),t.dblClickMenu&&!this.columnSubscribers.dblClickMenu&&(this.columnSubscribers.dblClickMenu=this.loadMenuTableCellEvent.bind(this,"dblClickMenu"),this.subscribe("cell-dblclick",this.columnSubscribers.dblClickMenu))}initializeColumnHeaderMenu(e){var t=e.definition.headerMenuIcon,i;i=document.createElement("span"),i.classList.add("tabulator-header-popup-button"),t?(typeof t=="function"&&(t=t(e.getComponent())),t instanceof HTMLElement?i.appendChild(t):i.innerHTML=t):i.innerHTML="&vellip;",i.addEventListener("click",n=>{n.stopPropagation(),n.preventDefault(),this.loadMenuEvent(e.definition.headerMenu,n,e)}),e.titleElement.insertBefore(i,e.titleElement.firstChild)}loadMenuTableCellEvent(e,t,i){i._cell&&(i=i._cell),i.column.definition[e]&&this.loadMenuEvent(i.column.definition[e],t,i)}loadMenuTableColumnEvent(e,t,i){i._column&&(i=i._column),i.definition[e]&&this.loadMenuEvent(i.definition[e],t,i)}loadMenuEvent(e,t,i){i._group?i=i._group:i._row&&(i=i._row),e=typeof e=="function"?e.call(this.table,t,i.getComponent()):e,this.loadMenu(t,i,e)}loadMenu(e,t,i,n,s){var a=!(e instanceof MouseEvent),o=document.createElement("div"),l;if(o.classList.add("tabulator-menu"),a||e.preventDefault(),!(!i||!i.length)){if(n)l=s.child(o);else{if(this.nestedMenuBlock){if(this.rootPopup)return}else this.nestedMenuBlock=setTimeout(()=>{this.nestedMenuBlock=!1},100);this.rootPopup&&this.rootPopup.hide(),this.rootPopup=l=this.popup(o)}i.forEach(h=>{var u=document.createElement("div"),d=h.label,c=h.disabled;h.separator?u.classList.add("tabulator-menu-separator"):(u.classList.add("tabulator-menu-item"),typeof d=="function"&&(d=d.call(this.table,t.getComponent())),d instanceof Node?u.appendChild(d):u.innerHTML=d,typeof c=="function"&&(c=c.call(this.table,t.getComponent())),c?(u.classList.add("tabulator-menu-item-disabled"),u.addEventListener("click",f=>{f.stopPropagation()})):h.menu&&h.menu.length?u.addEventListener("click",f=>{f.stopPropagation(),this.loadMenu(f,t,h.menu,u,l)}):h.action&&u.addEventListener("click",f=>{h.action(f,t.getComponent())}),h.menu&&h.menu.length&&u.classList.add("tabulator-menu-item-submenu")),o.appendChild(u)}),o.addEventListener("click",h=>{this.rootPopup&&this.rootPopup.hide()}),l.show(n||e),l===this.rootPopup&&(this.rootPopup.hideOnBlur(()=>{this.rootPopup=null,this.currentComponent&&(this.dispatch("menu-closed",i,l),this.dispatchExternal("menuClosed",this.currentComponent.getComponent()),this.currentComponent=null)}),this.currentComponent=t,this.dispatch("menu-opened",i,l),this.dispatchExternal("menuOpened",t.getComponent()))}}}G(Cc,"moduleName","menu");class _c extends ke{constructor(e){super(e),this.placeholderElement=this.createPlaceholderElement(),this.hoverElement=!1,this.checkTimeout=!1,this.checkPeriod=250,this.moving=!1,this.toCol=!1,this.toColAfter=!1,this.startX=0,this.autoScrollMargin=40,this.autoScrollStep=5,this.autoScrollTimeout=!1,this.touchMove=!1,this.moveHover=this.moveHover.bind(this),this.endMove=this.endMove.bind(this),this.registerTableOption("movableColumns",!1)}createPlaceholderElement(){var e=document.createElement("div");return e.classList.add("tabulator-col"),e.classList.add("tabulator-col-placeholder"),e}initialize(){this.table.options.movableColumns&&(this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("alert-show",this.abortMove.bind(this)))}abortMove(){clearTimeout(this.checkTimeout)}initializeColumn(e){var t=this,i={},n;!e.modules.frozen&&!e.isGroup&&!e.isRowHeader&&(n=e.getElement(),i.mousemove=(function(s){e.parent===t.moving.parent&&((t.touchMove?s.touches[0].pageX:s.pageX)-et.elOffset(n).left+t.table.columnManager.contentsElement.scrollLeft>e.getWidth()/2?(t.toCol!==e||!t.toColAfter)&&(n.parentNode.insertBefore(t.placeholderElement,n.nextSibling),t.moveColumn(e,!0)):(t.toCol!==e||t.toColAfter)&&(n.parentNode.insertBefore(t.placeholderElement,n),t.moveColumn(e,!1)))}).bind(t),n.addEventListener("mousedown",function(s){t.touchMove=!1,s.which===1&&(t.checkTimeout=setTimeout(function(){t.startMove(s,e)},t.checkPeriod))}),n.addEventListener("mouseup",function(s){s.which===1&&t.checkTimeout&&clearTimeout(t.checkTimeout)}),t.bindTouchEvents(e)),e.modules.moveColumn=i}bindTouchEvents(e){var t=e.getElement(),i=!1,n,s,a,o,l,h;t.addEventListener("touchstart",u=>{this.checkTimeout=setTimeout(()=>{this.touchMove=!0,n=e.nextColumn(),a=n?n.getWidth()/2:0,s=e.prevColumn(),o=s?s.getWidth()/2:0,l=0,h=0,i=!1,this.startMove(u,e)},this.checkPeriod)},{passive:!0}),t.addEventListener("touchmove",u=>{var d,c;this.moving&&(this.moveHover(u),i||(i=u.touches[0].pageX),d=u.touches[0].pageX-i,d>0?n&&d-l>a&&(c=n,c!==e&&(i=u.touches[0].pageX,c.getElement().parentNode.insertBefore(this.placeholderElement,c.getElement().nextSibling),this.moveColumn(c,!0))):s&&-d-h>o&&(c=s,c!==e&&(i=u.touches[0].pageX,c.getElement().parentNode.insertBefore(this.placeholderElement,c.getElement()),this.moveColumn(c,!1))),c&&(n=c.nextColumn(),l=a,a=n?n.getWidth()/2:0,s=c.prevColumn(),h=o,o=s?s.getWidth()/2:0))},{passive:!0}),t.addEventListener("touchend",u=>{this.checkTimeout&&clearTimeout(this.checkTimeout),this.moving&&this.endMove(u)})}startMove(e,t){var i=t.getElement(),n=this.table.columnManager.getContentsElement(),s=this.table.columnManager.getHeadersElement();this.table.modules.selectRange&&this.table.modules.selectRange.columnSelection&&this.table.modules.selectRange.mousedown&&this.table.modules.selectRange.selecting==="column"||(this.moving=t,this.startX=(this.touchMove?e.touches[0].pageX:e.pageX)-et.elOffset(i).left,this.table.element.classList.add("tabulator-block-select"),this.placeholderElement.style.width=t.getWidth()+"px",this.placeholderElement.style.height=t.getHeight()+"px",i.parentNode.insertBefore(this.placeholderElement,i),i.parentNode.removeChild(i),this.hoverElement=i.cloneNode(!0),this.hoverElement.classList.add("tabulator-moving"),n.appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.bottom=n.clientHeight-s.offsetHeight+"px",this.touchMove||(this._bindMouseMove(),document.body.addEventListener("mousemove",this.moveHover),document.body.addEventListener("mouseup",this.endMove)),this.moveHover(e),this.dispatch("column-moving",e,this.moving))}_bindMouseMove(){this.table.columnManager.columnsByIndex.forEach(function(e){e.modules.moveColumn.mousemove&&e.getElement().addEventListener("mousemove",e.modules.moveColumn.mousemove)})}_unbindMouseMove(){this.table.columnManager.columnsByIndex.forEach(function(e){e.modules.moveColumn.mousemove&&e.getElement().removeEventListener("mousemove",e.modules.moveColumn.mousemove)})}moveColumn(e,t){var i=this.moving.getCells();this.toCol=e,this.toColAfter=t,t?e.getCells().forEach(function(n,s){var a=n.getElement(!0);a.parentNode&&i[s]&&a.parentNode.insertBefore(i[s].getElement(),a.nextSibling)}):e.getCells().forEach(function(n,s){var a=n.getElement(!0);a.parentNode&&i[s]&&a.parentNode.insertBefore(i[s].getElement(),a)})}endMove(e){(e.which===1||this.touchMove)&&(this._unbindMouseMove(),this.placeholderElement.parentNode.insertBefore(this.moving.getElement(),this.placeholderElement.nextSibling),this.placeholderElement.parentNode.removeChild(this.placeholderElement),this.hoverElement.parentNode.removeChild(this.hoverElement),this.table.element.classList.remove("tabulator-block-select"),this.toCol&&this.table.columnManager.moveColumnActual(this.moving,this.toCol,this.toColAfter),this.moving=!1,this.toCol=!1,this.toColAfter=!1,this.touchMove||(document.body.removeEventListener("mousemove",this.moveHover),document.body.removeEventListener("mouseup",this.endMove)))}moveHover(e){var t=this.table.columnManager.getContentsElement(),i=t.scrollLeft,n=(this.touchMove?e.touches[0].pageX:e.pageX)-et.elOffset(t).left+i,s;this.hoverElement.style.left=n-this.startX+"px",n-i<this.autoScrollMargin&&(this.autoScrollTimeout||(this.autoScrollTimeout=setTimeout(()=>{s=Math.max(0,i-5),this.table.rowManager.getElement().scrollLeft=s,this.autoScrollTimeout=!1},1))),i+t.clientWidth-n<this.autoScrollMargin&&(this.autoScrollTimeout||(this.autoScrollTimeout=setTimeout(()=>{s=Math.min(t.clientWidth,i+5),this.table.rowManager.getElement().scrollLeft=s,this.autoScrollTimeout=!1},1)))}}G(_c,"moduleName","moveColumn");var M1={delete:function(r,e,t){r.delete()}},A1={insert:function(r,e,t){return this.table.addRow(r.getData(),void 0,e),!0},add:function(r,e,t){return this.table.addRow(r.getData()),!0},update:function(r,e,t){return e?(e.update(r.getData()),!0):!1},replace:function(r,e,t){return e?(this.table.addRow(r.getData(),void 0,e),e.delete(),!0):!1}};const Fr=class Fr extends ke{constructor(e){super(e),this.placeholderElement=this.createPlaceholderElement(),this.hoverElement=!1,this.checkTimeout=!1,this.checkPeriod=150,this.moving=!1,this.toRow=!1,this.toRowAfter=!1,this.hasHandle=!1,this.startY=0,this.startX=0,this.moveHover=this.moveHover.bind(this),this.endMove=this.endMove.bind(this),this.tableRowDropEvent=!1,this.touchMove=!1,this.connection=!1,this.connectionSelectorsTables=!1,this.connectionSelectorsElements=!1,this.connectionElements=[],this.connections=[],this.connectedTable=!1,this.connectedRow=!1,this.registerTableOption("movableRows",!1),this.registerTableOption("movableRowsConnectedTables",!1),this.registerTableOption("movableRowsConnectedElements",!1),this.registerTableOption("movableRowsSender",!1),this.registerTableOption("movableRowsReceiver","insert"),this.registerColumnOption("rowHandle")}createPlaceholderElement(){var e=document.createElement("div");return e.classList.add("tabulator-row"),e.classList.add("tabulator-row-placeholder"),e}initialize(){this.table.options.movableRows&&(this.connectionSelectorsTables=this.table.options.movableRowsConnectedTables,this.connectionSelectorsElements=this.table.options.movableRowsConnectedElements,this.connection=this.connectionSelectorsTables||this.connectionSelectorsElements,this.subscribe("cell-init",this.initializeCell.bind(this)),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("row-init",this.initializeRow.bind(this)))}initializeGroupHeader(e){var t=this,i={};i.mouseup=(function(n){t.tableRowDrop(n,e)}).bind(t),i.mousemove=(function(n){var s;n.pageY-et.elOffset(e.element).top+t.table.rowManager.element.scrollTop>e.getHeight()/2?(t.toRow!==e||!t.toRowAfter)&&(s=e.getElement(),s.parentNode.insertBefore(t.placeholderElement,s.nextSibling),t.moveRow(e,!0)):(t.toRow!==e||t.toRowAfter)&&(s=e.getElement(),s.previousSibling&&(s.parentNode.insertBefore(t.placeholderElement,s),t.moveRow(e,!1)))}).bind(t),e.modules.moveRow=i}initializeRow(e){var t=this,i={},n;i.mouseup=(function(s){t.tableRowDrop(s,e)}).bind(t),i.mousemove=(function(s){var a=e.getElement();s.pageY-et.elOffset(a).top+t.table.rowManager.element.scrollTop>e.getHeight()/2?(t.toRow!==e||!t.toRowAfter)&&(a.parentNode.insertBefore(t.placeholderElement,a.nextSibling),t.moveRow(e,!0)):(t.toRow!==e||t.toRowAfter)&&(a.parentNode.insertBefore(t.placeholderElement,a),t.moveRow(e,!1))}).bind(t),this.hasHandle||(n=e.getElement(),n.addEventListener("mousedown",function(s){s.which===1&&(t.checkTimeout=setTimeout(function(){t.startMove(s,e)},t.checkPeriod))}),n.addEventListener("mouseup",function(s){s.which===1&&t.checkTimeout&&clearTimeout(t.checkTimeout)}),this.bindTouchEvents(e,e.getElement())),e.modules.moveRow=i}initializeColumn(e){e.definition.rowHandle&&this.table.options.movableRows!==!1&&(this.hasHandle=!0)}initializeCell(e){if(e.column.definition.rowHandle&&this.table.options.movableRows!==!1){var t=this,i=e.getElement(!0);i.addEventListener("mousedown",function(n){n.which===1&&(t.checkTimeout=setTimeout(function(){t.startMove(n,e.row)},t.checkPeriod))}),i.addEventListener("mouseup",function(n){n.which===1&&t.checkTimeout&&clearTimeout(t.checkTimeout)}),this.bindTouchEvents(e.row,i)}}bindTouchEvents(e,t){var i=!1,n,s,a,o,l,h;t.addEventListener("touchstart",u=>{this.checkTimeout=setTimeout(()=>{this.touchMove=!0,n=e.nextRow(),a=n?n.getHeight()/2:0,s=e.prevRow(),o=s?s.getHeight()/2:0,l=0,h=0,i=!1,this.startMove(u,e)},this.checkPeriod)},{passive:!0}),this.moving,this.toRow,this.toRowAfter,t.addEventListener("touchmove",u=>{var d,c;this.moving&&(u.preventDefault(),this.moveHover(u),i||(i=u.touches[0].pageY),d=u.touches[0].pageY-i,d>0?n&&d-l>a&&(c=n,c!==e&&(i=u.touches[0].pageY,c.getElement().parentNode.insertBefore(this.placeholderElement,c.getElement().nextSibling),this.moveRow(c,!0))):s&&-d-h>o&&(c=s,c!==e&&(i=u.touches[0].pageY,c.getElement().parentNode.insertBefore(this.placeholderElement,c.getElement()),this.moveRow(c,!1))),c&&(n=c.nextRow(),l=a,a=n?n.getHeight()/2:0,s=c.prevRow(),h=o,o=s?s.getHeight()/2:0))}),t.addEventListener("touchend",u=>{this.checkTimeout&&clearTimeout(this.checkTimeout),this.moving&&(this.endMove(u),this.touchMove=!1)})}_bindMouseMove(){this.table.rowManager.getDisplayRows().forEach(e=>{(e.type==="row"||e.type==="group")&&e.modules.moveRow&&e.modules.moveRow.mousemove&&e.getElement().addEventListener("mousemove",e.modules.moveRow.mousemove)})}_unbindMouseMove(){this.table.rowManager.getDisplayRows().forEach(e=>{(e.type==="row"||e.type==="group")&&e.modules.moveRow&&e.modules.moveRow.mousemove&&e.getElement().removeEventListener("mousemove",e.modules.moveRow.mousemove)})}startMove(e,t){var i=t.getElement();this.setStartPosition(e,t),this.moving=t,this.table.element.classList.add("tabulator-block-select"),this.placeholderElement.style.width=t.getWidth()+"px",this.placeholderElement.style.height=t.getHeight()+"px",this.connection?(this.table.element.classList.add("tabulator-movingrow-sending"),this.connectToTables(t)):(i.parentNode.insertBefore(this.placeholderElement,i),i.parentNode.removeChild(i)),this.hoverElement=i.cloneNode(!0),this.hoverElement.classList.add("tabulator-moving"),this.connection?(document.body.appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.top="0",this.hoverElement.style.width=this.table.element.clientWidth+"px",this.hoverElement.style.whiteSpace="nowrap",this.hoverElement.style.overflow="hidden",this.hoverElement.style.pointerEvents="none"):(this.table.rowManager.getTableElement().appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.top="0",this._bindMouseMove()),document.body.addEventListener("mousemove",this.moveHover),document.body.addEventListener("mouseup",this.endMove),this.dispatchExternal("rowMoving",t.getComponent()),this.moveHover(e)}setStartPosition(e,t){var i=this.touchMove?e.touches[0].pageX:e.pageX,n=this.touchMove?e.touches[0].pageY:e.pageY,s,a;s=t.getElement(),this.connection?(a=s.getBoundingClientRect(),this.startX=a.left-i+window.pageXOffset,this.startY=a.top-n+window.pageYOffset):this.startY=n-s.getBoundingClientRect().top}endMove(e){(!e||e.which===1||this.touchMove)&&(this._unbindMouseMove(),this.connection||(this.placeholderElement.parentNode.insertBefore(this.moving.getElement(),this.placeholderElement.nextSibling),this.placeholderElement.parentNode.removeChild(this.placeholderElement)),this.hoverElement.parentNode.removeChild(this.hoverElement),this.table.element.classList.remove("tabulator-block-select"),this.toRow?this.table.rowManager.moveRow(this.moving,this.toRow,this.toRowAfter):this.dispatchExternal("rowMoveCancelled",this.moving.getComponent()),this.moving=!1,this.toRow=!1,this.toRowAfter=!1,document.body.removeEventListener("mousemove",this.moveHover),document.body.removeEventListener("mouseup",this.endMove),this.connection&&(this.table.element.classList.remove("tabulator-movingrow-sending"),this.disconnectFromTables()))}moveRow(e,t){this.toRow=e,this.toRowAfter=t}moveHover(e){this.connection?this.moveHoverConnections.call(this,e):this.moveHoverTable.call(this,e)}moveHoverTable(e){var t=this.table.rowManager.getElement(),i=t.scrollTop,n=(this.touchMove?e.touches[0].pageY:e.pageY)-t.getBoundingClientRect().top+i;this.hoverElement.style.top=Math.min(n-this.startY,this.table.rowManager.element.scrollHeight-this.hoverElement.offsetHeight)+"px"}moveHoverConnections(e){this.hoverElement.style.left=this.startX+(this.touchMove?e.touches[0].pageX:e.pageX)+"px",this.hoverElement.style.top=this.startY+(this.touchMove?e.touches[0].pageY:e.pageY)+"px"}elementRowDrop(e,t,i){this.dispatchExternal("movableRowsElementDrop",e,t,i?i.getComponent():!1)}connectToTables(e){var t;this.connectionSelectorsTables&&(t=this.commsConnections(this.connectionSelectorsTables),this.dispatchExternal("movableRowsSendingStart",t),this.commsSend(this.connectionSelectorsTables,"moveRow","connect",{row:e})),this.connectionSelectorsElements&&(this.connectionElements=[],Array.isArray(this.connectionSelectorsElements)||(this.connectionSelectorsElements=[this.connectionSelectorsElements]),this.connectionSelectorsElements.forEach(i=>{typeof i=="string"?this.connectionElements=this.connectionElements.concat(Array.prototype.slice.call(document.querySelectorAll(i))):this.connectionElements.push(i)}),this.connectionElements.forEach(i=>{var n=s=>{this.elementRowDrop(s,i,this.moving)};i.addEventListener("mouseup",n),i.tabulatorElementDropEvent=n,i.classList.add("tabulator-movingrow-receiving")}))}disconnectFromTables(){var e;this.connectionSelectorsTables&&(e=this.commsConnections(this.connectionSelectorsTables),this.dispatchExternal("movableRowsSendingStop",e),this.commsSend(this.connectionSelectorsTables,"moveRow","disconnect")),this.connectionElements.forEach(t=>{t.classList.remove("tabulator-movingrow-receiving"),t.removeEventListener("mouseup",t.tabulatorElementDropEvent),delete t.tabulatorElementDropEvent})}connect(e,t){return this.connectedTable?(console.warn("Move Row Error - Table cannot accept connection, already connected to table:",this.connectedTable),!1):(this.connectedTable=e,this.connectedRow=t,this.table.element.classList.add("tabulator-movingrow-receiving"),this.table.rowManager.getDisplayRows().forEach(i=>{i.type==="row"&&i.modules.moveRow&&i.modules.moveRow.mouseup&&i.getElement().addEventListener("mouseup",i.modules.moveRow.mouseup)}),this.tableRowDropEvent=this.tableRowDrop.bind(this),this.table.element.addEventListener("mouseup",this.tableRowDropEvent),this.dispatchExternal("movableRowsReceivingStart",t,e),!0)}disconnect(e){e===this.connectedTable?(this.connectedTable=!1,this.connectedRow=!1,this.table.element.classList.remove("tabulator-movingrow-receiving"),this.table.rowManager.getDisplayRows().forEach(t=>{t.type==="row"&&t.modules.moveRow&&t.modules.moveRow.mouseup&&t.getElement().removeEventListener("mouseup",t.modules.moveRow.mouseup)}),this.table.element.removeEventListener("mouseup",this.tableRowDropEvent),this.dispatchExternal("movableRowsReceivingStop",e)):console.warn("Move Row Error - trying to disconnect from non connected table")}dropComplete(e,t,i){var n=!1;if(i){switch(typeof this.table.options.movableRowsSender){case"string":n=Fr.senders[this.table.options.movableRowsSender];break;case"function":n=this.table.options.movableRowsSender;break}n?n.call(this,this.moving?this.moving.getComponent():void 0,t?t.getComponent():void 0,e):this.table.options.movableRowsSender&&console.warn("Mover Row Error - no matching sender found:",this.table.options.movableRowsSender),this.dispatchExternal("movableRowsSent",this.moving.getComponent(),t?t.getComponent():void 0,e)}else this.dispatchExternal("movableRowsSentFailed",this.moving.getComponent(),t?t.getComponent():void 0,e);this.endMove()}tableRowDrop(e,t){var i=!1,n=!1;switch(e.stopImmediatePropagation(),typeof this.table.options.movableRowsReceiver){case"string":i=Fr.receivers[this.table.options.movableRowsReceiver];break;case"function":i=this.table.options.movableRowsReceiver;break}i?n=i.call(this,this.connectedRow.getComponent(),t?t.getComponent():void 0,this.connectedTable):console.warn("Mover Row Error - no matching receiver found:",this.table.options.movableRowsReceiver),n?this.dispatchExternal("movableRowsReceived",this.connectedRow.getComponent(),t?t.getComponent():void 0,this.connectedTable):this.dispatchExternal("movableRowsReceivedFailed",this.connectedRow.getComponent(),t?t.getComponent():void 0,this.connectedTable),this.commsSend(this.connectedTable,"moveRow","dropcomplete",{row:t,success:n})}commsReceived(e,t,i){switch(t){case"connect":return this.connect(e,i.row);case"disconnect":return this.disconnect(e);case"dropcomplete":return this.dropComplete(e,i.row,i.success)}}};G(Fr,"moduleName","moveRow"),G(Fr,"senders",M1),G(Fr,"receivers",A1);let Go=Fr;var O1={};const on=class on extends ke{constructor(e){super(e),this.allowedTypes=["","data","edit","clipboard","import"],this.enabled=!0,this.registerColumnOption("mutator"),this.registerColumnOption("mutatorParams"),this.registerColumnOption("mutatorData"),this.registerColumnOption("mutatorDataParams"),this.registerColumnOption("mutatorEdit"),this.registerColumnOption("mutatorEditParams"),this.registerColumnOption("mutatorClipboard"),this.registerColumnOption("mutatorClipboardParams"),this.registerColumnOption("mutatorImport"),this.registerColumnOption("mutatorImportParams"),this.registerColumnOption("mutateLink")}initialize(){this.subscribe("cell-value-changing",this.transformCell.bind(this)),this.subscribe("cell-value-changed",this.mutateLink.bind(this)),this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("row-data-init-before",this.rowDataChanged.bind(this)),this.subscribe("row-data-changing",this.rowDataChanged.bind(this))}rowDataChanged(e,t,i){return this.transformRow(t,"data",i)}initializeColumn(e){var t=!1,i={};this.allowedTypes.forEach(n=>{var s="mutator"+(n.charAt(0).toUpperCase()+n.slice(1)),a;e.definition[s]&&(a=this.lookupMutator(e.definition[s]),a&&(t=!0,i[s]={mutator:a,params:e.definition[s+"Params"]||{}}))}),t&&(e.modules.mutate=i)}lookupMutator(e){var t=!1;switch(typeof e){case"string":on.mutators[e]?t=on.mutators[e]:console.warn("Mutator Error - No such mutator found, ignoring: ",e);break;case"function":t=e;break}return t}transformRow(e,t,i){var n="mutator"+(t.charAt(0).toUpperCase()+t.slice(1)),s;return this.enabled&&this.table.columnManager.traverse(a=>{var o,l,h;a.modules.mutate&&(o=a.modules.mutate[n]||a.modules.mutate.mutator||!1,o&&(s=a.getFieldValue(typeof i<"u"?i:e),(t=="data"&&!i||typeof s<"u")&&(h=a.getComponent(),l=typeof o.params=="function"?o.params(s,e,t,h):o.params,a.setFieldValue(e,o.mutator(s,e,t,l,h)))))}),e}transformCell(e,t){if(e.column.modules.mutate){var i=e.column.modules.mutate.mutatorEdit||e.column.modules.mutate.mutator||!1,n={};if(i)return n=Object.assign(n,e.row.getData()),e.column.setFieldValue(n,t),i.mutator(t,n,"edit",i.params,e.getComponent())}return t}mutateLink(e){var t=e.column.definition.mutateLink;t&&(Array.isArray(t)||(t=[t]),t.forEach(i=>{var n=e.row.getCell(i);n&&n.setValue(n.getValue(),!0,!0)}))}enable(){this.enabled=!0}disable(){this.enabled=!1}};G(on,"moduleName","mutator"),G(on,"mutators",O1);let Yo=on;function L1(r,e,t,i,n){var s=document.createElement("span"),a=document.createElement("span"),o=document.createElement("span"),l=document.createElement("span"),h=document.createElement("span"),u=document.createElement("span");return this.table.modules.localize.langBind("pagination|counter|showing",d=>{a.innerHTML=d}),this.table.modules.localize.langBind("pagination|counter|of",d=>{l.innerHTML=d}),this.table.modules.localize.langBind("pagination|counter|rows",d=>{u.innerHTML=d}),i?(o.innerHTML=" "+e+"-"+Math.min(e+r-1,i)+" ",h.innerHTML=" "+i+" ",s.appendChild(a),s.appendChild(o),s.appendChild(l),s.appendChild(h),s.appendChild(u)):(o.innerHTML=" 0 ",s.appendChild(a),s.appendChild(o),s.appendChild(u)),s}function P1(r,e,t,i,n){var s=document.createElement("span"),a=document.createElement("span"),o=document.createElement("span"),l=document.createElement("span"),h=document.createElement("span"),u=document.createElement("span");return this.table.modules.localize.langBind("pagination|counter|showing",d=>{a.innerHTML=d}),o.innerHTML=" "+t+" ",this.table.modules.localize.langBind("pagination|counter|of",d=>{l.innerHTML=d}),h.innerHTML=" "+n+" ",this.table.modules.localize.langBind("pagination|counter|pages",d=>{u.innerHTML=d}),s.appendChild(a),s.appendChild(o),s.appendChild(l),s.appendChild(h),s.appendChild(u),s}var N1={rows:L1,pages:P1};const Jn=class Jn extends ke{constructor(e){super(e),this.mode="local",this.progressiveLoad=!1,this.element=null,this.pageCounterElement=null,this.pageCounter=null,this.size=0,this.page=1,this.count=5,this.max=1,this.remoteRowCountEstimate=null,this.initialLoad=!0,this.dataChanging=!1,this.pageSizes=[],this.registerTableOption("pagination",!1),this.registerTableOption("paginationMode","local"),this.registerTableOption("paginationSize",!1),this.registerTableOption("paginationInitialPage",1),this.registerTableOption("paginationCounter",!1),this.registerTableOption("paginationCounterElement",!1),this.registerTableOption("paginationButtonCount",5),this.registerTableOption("paginationSizeSelector",!1),this.registerTableOption("paginationElement",!1),this.registerTableOption("paginationAddRow","page"),this.registerTableOption("paginationOutOfRange",!1),this.registerTableOption("progressiveLoad",!1),this.registerTableOption("progressiveLoadDelay",0),this.registerTableOption("progressiveLoadScrollMargin",0),this.registerTableFunction("setMaxPage",this.setMaxPage.bind(this)),this.registerTableFunction("setPage",this.setPage.bind(this)),this.registerTableFunction("setPageToRow",this.userSetPageToRow.bind(this)),this.registerTableFunction("setPageSize",this.userSetPageSize.bind(this)),this.registerTableFunction("getPageSize",this.getPageSize.bind(this)),this.registerTableFunction("previousPage",this.previousPage.bind(this)),this.registerTableFunction("nextPage",this.nextPage.bind(this)),this.registerTableFunction("getPage",this.getPage.bind(this)),this.registerTableFunction("getPageMax",this.getPageMax.bind(this)),this.registerComponentFunction("row","pageTo",this.setPageToRow.bind(this))}initialize(){this.table.options.pagination?(this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("row-added",this.rowsUpdated.bind(this)),this.subscribe("data-processed",this.initialLoadComplete.bind(this)),this.subscribe("table-built",this.calculatePageSizes.bind(this)),this.subscribe("footer-redraw",this.footerRedraw.bind(this)),this.table.options.paginationAddRow=="page"&&this.subscribe("row-adding-position",this.rowAddingPosition.bind(this)),this.table.options.paginationMode==="remote"&&(this.subscribe("data-params",this.remotePageParams.bind(this)),this.subscribe("data-loaded",this._parseRemoteData.bind(this))),this.table.options.progressiveLoad&&console.error("Progressive Load Error - Pagination and progressive load cannot be used at the same time"),this.registerDisplayHandler(this.restOnRenderBefore.bind(this),40),this.registerDisplayHandler(this.getRows.bind(this),50),this.createElements(),this.initializePageCounter(),this.initializePaginator()):this.table.options.progressiveLoad&&(this.subscribe("data-params",this.remotePageParams.bind(this)),this.subscribe("data-loaded",this._parseRemoteData.bind(this)),this.subscribe("table-built",this.calculatePageSizes.bind(this)),this.subscribe("data-processed",this.initialLoadComplete.bind(this)),this.initializeProgressive(this.table.options.progressiveLoad),this.table.options.progressiveLoad==="scroll"&&this.subscribe("scroll-vertical",this.scrollVertical.bind(this)))}rowAddingPosition(e,t){var i=this.table.rowManager,n=i.getDisplayRows(),s;return t?n.length?s=n[0]:i.activeRows.length&&(s=i.activeRows[i.activeRows.length-1],t=!1):n.length&&(s=n[n.length-1],t=!(n.length<this.size)),{index:s,top:t}}calculatePageSizes(){var e,t;this.table.options.paginationSize?this.size=this.table.options.paginationSize:(e=document.createElement("div"),e.classList.add("tabulator-row"),e.style.visibility="hidden",t=document.createElement("div"),t.classList.add("tabulator-cell"),t.innerHTML="Page Row Test",e.appendChild(t),this.table.rowManager.getTableElement().appendChild(e),this.size=Math.floor(this.table.rowManager.getElement().clientHeight/e.offsetHeight),this.table.rowManager.getTableElement().removeChild(e)),this.dispatchExternal("pageSizeChanged",this.size),this.generatePageSizeSelectList()}initialLoadComplete(){this.initialLoad=!1}remotePageParams(e,t,i,n){return this.initialLoad||(this.progressiveLoad&&!i||!this.progressiveLoad&&!this.dataChanging)&&this.reset(!0),n.page=this.page,this.size&&(n.size=this.size),n}userSetPageToRow(e){return this.table.options.pagination&&(e=this.table.rowManager.findRow(e),e)?this.setPageToRow(e):Promise.reject()}userSetPageSize(e){return this.table.options.pagination?(this.setPageSize(e),this.setPage(1)):!1}scrollVertical(e,t){var i,n,s;!t&&!this.table.dataLoader.loading&&(i=this.table.rowManager.getElement(),n=i.scrollHeight-i.clientHeight-e,s=this.table.options.progressiveLoadScrollMargin||i.clientHeight*2,n<s&&this.nextPage().catch(()=>{}))}restOnRenderBefore(e,t){return t||this.mode==="local"&&this.reset(),e}rowsUpdated(){this.refreshData(!0,"all")}createElements(){var e;this.element=document.createElement("span"),this.element.classList.add("tabulator-paginator"),this.pagesElement=document.createElement("span"),this.pagesElement.classList.add("tabulator-pages"),e=document.createElement("button"),e.classList.add("tabulator-page"),e.setAttribute("type","button"),e.setAttribute("role","button"),e.setAttribute("aria-label",""),e.setAttribute("title",""),this.firstBut=e.cloneNode(!0),this.firstBut.setAttribute("data-page","first"),this.prevBut=e.cloneNode(!0),this.prevBut.setAttribute("data-page","prev"),this.nextBut=e.cloneNode(!0),this.nextBut.setAttribute("data-page","next"),this.lastBut=e.cloneNode(!0),this.lastBut.setAttribute("data-page","last"),this.table.options.paginationSizeSelector&&(this.pageSizeSelect=document.createElement("select"),this.pageSizeSelect.classList.add("tabulator-page-size"))}generatePageSizeSelectList(){var e=[];if(this.pageSizeSelect){if(Array.isArray(this.table.options.paginationSizeSelector))e=this.table.options.paginationSizeSelector,this.pageSizes=e,this.pageSizes.indexOf(this.size)==-1&&e.unshift(this.size);else if(this.pageSizes.indexOf(this.size)==-1){e=[];for(let t=1;t<5;t++)e.push(this.size*t);this.pageSizes=e}else e=this.pageSizes;for(;this.pageSizeSelect.firstChild;)this.pageSizeSelect.removeChild(this.pageSizeSelect.firstChild);e.forEach(t=>{var i=document.createElement("option");i.value=t,t===!0?this.langBind("pagination|all",function(n){i.innerHTML=n}):i.innerHTML=t,this.pageSizeSelect.appendChild(i)}),this.pageSizeSelect.value=this.size}}initializePageCounter(){var e=this.table.options.paginationCounter,t=null;e&&(typeof e=="function"?t=e:t=Jn.pageCounters[e],t?(this.pageCounter=t,this.pageCounterElement=document.createElement("span"),this.pageCounterElement.classList.add("tabulator-page-counter")):console.warn("Pagination Error - No such page counter found: ",e))}initializePaginator(e){var t,i;e||(this.langBind("pagination|first",n=>{this.firstBut.innerHTML=n}),this.langBind("pagination|first_title",n=>{this.firstBut.setAttribute("aria-label",n),this.firstBut.setAttribute("title",n)}),this.langBind("pagination|prev",n=>{this.prevBut.innerHTML=n}),this.langBind("pagination|prev_title",n=>{this.prevBut.setAttribute("aria-label",n),this.prevBut.setAttribute("title",n)}),this.langBind("pagination|next",n=>{this.nextBut.innerHTML=n}),this.langBind("pagination|next_title",n=>{this.nextBut.setAttribute("aria-label",n),this.nextBut.setAttribute("title",n)}),this.langBind("pagination|last",n=>{this.lastBut.innerHTML=n}),this.langBind("pagination|last_title",n=>{this.lastBut.setAttribute("aria-label",n),this.lastBut.setAttribute("title",n)}),this.firstBut.addEventListener("click",()=>{this.setPage(1)}),this.prevBut.addEventListener("click",()=>{this.previousPage()}),this.nextBut.addEventListener("click",()=>{this.nextPage()}),this.lastBut.addEventListener("click",()=>{this.setPage(this.max)}),this.table.options.paginationElement&&(this.element=this.table.options.paginationElement),this.pageSizeSelect&&(t=document.createElement("label"),this.langBind("pagination|page_size",n=>{this.pageSizeSelect.setAttribute("aria-label",n),this.pageSizeSelect.setAttribute("title",n),t.innerHTML=n}),this.element.appendChild(t),this.element.appendChild(this.pageSizeSelect),this.pageSizeSelect.addEventListener("change",n=>{this.setPageSize(this.pageSizeSelect.value=="true"?!0:this.pageSizeSelect.value),this.setPage(1)})),this.element.appendChild(this.firstBut),this.element.appendChild(this.prevBut),this.element.appendChild(this.pagesElement),this.element.appendChild(this.nextBut),this.element.appendChild(this.lastBut),this.table.options.paginationElement||(this.table.options.paginationCounter&&(this.table.options.paginationCounterElement?this.table.options.paginationCounterElement instanceof HTMLElement?this.table.options.paginationCounterElement.appendChild(this.pageCounterElement):typeof this.table.options.paginationCounterElement=="string"&&(i=document.querySelector(this.table.options.paginationCounterElement),i?i.appendChild(this.pageCounterElement):console.warn("Pagination Error - Unable to find element matching paginationCounterElement selector:",this.table.options.paginationCounterElement)):this.footerAppend(this.pageCounterElement)),this.footerAppend(this.element)),this.page=this.table.options.paginationInitialPage,this.count=this.table.options.paginationButtonCount),this.mode=this.table.options.paginationMode}initializeProgressive(e){this.initializePaginator(!0),this.mode="progressive_"+e,this.progressiveLoad=!0}trackChanges(){this.dispatch("page-changed")}setMaxRows(e){e?this.max=this.size===!0?1:Math.ceil(e/this.size):this.max=1,this.page>this.max&&(this.page=this.max)}reset(e){this.initialLoad||(this.mode=="local"||e)&&(this.page=1,this.trackChanges())}setMaxPage(e){e=parseInt(e),this.max=e||1,this.page>this.max&&(this.page=this.max,this.trigger())}setPage(e){switch(e){case"first":return this.setPage(1);case"prev":return this.previousPage();case"next":return this.nextPage();case"last":return this.setPage(this.max)}return e=parseInt(e),e>0&&e<=this.max||this.mode!=="local"?(this.page=e,this.trackChanges(),this.trigger()):(console.warn("Pagination Error - Requested page is out of range of 1 - "+this.max+":",e),Promise.reject())}setPageToRow(e){var t=this.displayRows(-1),i=t.indexOf(e);if(i>-1){var n=this.size===!0?1:Math.ceil((i+1)/this.size);return this.setPage(n)}else return console.warn("Pagination Error - Requested row is not visible"),Promise.reject()}setPageSize(e){e!==!0&&(e=parseInt(e)),e>0&&(this.size=e,this.dispatchExternal("pageSizeChanged",e)),this.pageSizeSelect&&this.generatePageSizeSelectList(),this.trackChanges()}_setPageCounter(e,t,i){var n;if(this.pageCounter)switch(this.mode==="remote"&&(t=this.size,i=(this.page-1)*this.size+1,e=this.remoteRowCountEstimate),n=this.pageCounter.call(this,t,i,this.page,e,this.max),typeof n){case"object":if(n instanceof Node){for(;this.pageCounterElement.firstChild;)this.pageCounterElement.removeChild(this.pageCounterElement.firstChild);this.pageCounterElement.appendChild(n)}else this.pageCounterElement.innerHTML="",n!=null&&console.warn("Page Counter Error - Page Counter has returned a type of object, the only valid page counter object return is an instance of Node, the page counter returned:",n);break;case"undefined":this.pageCounterElement.innerHTML="";break;default:this.pageCounterElement.innerHTML=n}}_setPageButtons(){let e=Math.floor((this.count-1)/2),t=Math.ceil((this.count-1)/2),i=this.max-this.page+e+1<this.count?this.max-this.count+1:Math.max(this.page-e,1),n=this.page<=t?Math.min(this.count,this.max):Math.min(this.page+t,this.max);for(;this.pagesElement.firstChild;)this.pagesElement.removeChild(this.pagesElement.firstChild);this.page==1?(this.firstBut.disabled=!0,this.prevBut.disabled=!0):(this.firstBut.disabled=!1,this.prevBut.disabled=!1),this.page==this.max?(this.lastBut.disabled=!0,this.nextBut.disabled=!0):(this.lastBut.disabled=!1,this.nextBut.disabled=!1);for(let s=i;s<=n;s++)s>0&&s<=this.max&&this.pagesElement.appendChild(this._generatePageButton(s));this.footerRedraw()}_generatePageButton(e){var t=document.createElement("button");return t.classList.add("tabulator-page"),e==this.page&&t.classList.add("active"),t.setAttribute("type","button"),t.setAttribute("role","button"),this.langBind("pagination|page_title",i=>{t.setAttribute("aria-label",i+" "+e),t.setAttribute("title",i+" "+e)}),t.setAttribute("data-page",e),t.textContent=e,t.addEventListener("click",i=>{this.setPage(e)}),t}previousPage(){return this.page>1?(this.page--,this.trackChanges(),this.trigger()):(console.warn("Pagination Error - Previous page would be less than page 1:",0),Promise.reject())}nextPage(){return this.page<this.max?(this.page++,this.trackChanges(),this.trigger()):(this.progressiveLoad||console.warn("Pagination Error - Next page would be greater than maximum page of "+this.max+":",this.max+1),Promise.reject())}getPage(){return this.page}getPageMax(){return this.max}getPageSize(e){return this.size}getMode(){return this.mode}getRows(e){var t=0,i,n,s,a,o=e.filter(l=>l.type==="row");if(this.mode=="local"){i=[],this.setMaxRows(e.length),this.size===!0?(n=0,s=e.length):(n=this.size*(this.page-1),s=n+parseInt(this.size)),this._setPageButtons();for(let l=n;l<s;l++){let h=e[l];h&&(i.push(h),h.type==="row"&&(a||(a=h),t++))}return this._setPageCounter(o.length,t,a?o.indexOf(a)+1:0),i}else return this._setPageButtons(),this._setPageCounter(o.length),e.slice(0)}trigger(){var e;switch(this.mode){case"local":return e=this.table.rowManager.scrollLeft,this.refreshData(),this.table.rowManager.scrollHorizontal(e),this.dispatchExternal("pageLoaded",this.getPage()),Promise.resolve();case"remote":return this.dataChanging=!0,this.reloadData(null).finally(()=>{this.dataChanging=!1});case"progressive_load":case"progressive_scroll":return this.reloadData(null,!0);default:return console.warn("Pagination Error - no such pagination mode:",this.mode),Promise.reject()}}_parseRemoteData(e){var t,i;if(typeof e.last_page>"u"&&console.warn("Remote Pagination Error - Server response missing '"+(this.options("dataReceiveParams").last_page||"last_page")+"' property"),e.data)if(this.max=parseInt(e.last_page)||1,this.remoteRowCountEstimate=typeof e.last_row<"u"?e.last_row:e.last_page*this.size-(this.page==e.last_page?this.size-e.data.length:0),this.progressiveLoad){switch(this.mode){case"progressive_load":this.page==1?this.table.rowManager.setData(e.data,!1,this.page==1):this.table.rowManager.addRows(e.data),this.page<this.max&&setTimeout(()=>{this.nextPage()},this.table.options.progressiveLoadDelay);break;case"progressive_scroll":e=this.page===1?e.data:this.table.rowManager.getData().concat(e.data),this.table.rowManager.setData(e,this.page!==1,this.page==1),t=this.table.options.progressiveLoadScrollMargin||this.table.rowManager.element.clientHeight*2,this.table.rowManager.element.scrollHeight<=this.table.rowManager.element.clientHeight+t&&this.page<this.max&&setTimeout(()=>{this.nextPage()});break}return!1}else{if(this.page>this.max&&(console.warn("Remote Pagination Error - Server returned last page value lower than the current page"),i=this.options("paginationOutOfRange"),i))return this.setPage(typeof i=="function"?i.call(this,this.page,this.max):i);this.dispatchExternal("pageLoaded",this.getPage())}else console.warn("Remote Pagination Error - Server response missing '"+(this.options("dataReceiveParams").data||"data")+"' property");return e.data}footerRedraw(){var e=this.table.footerManager.containerElement;Math.ceil(e.clientWidth)-e.scrollWidth<0?this.pagesElement.style.display="none":(this.pagesElement.style.display="",Math.ceil(e.clientWidth)-e.scrollWidth<0&&(this.pagesElement.style.display="none"))}};G(Jn,"moduleName","page"),G(Jn,"pageCounters",N1);let jo=Jn;var I1={local:function(r,e){var t=localStorage.getItem(r+"-"+e);return t?JSON.parse(t):!1},cookie:function(r,e){var t=document.cookie,i=r+"-"+e,n=t.indexOf(i+"="),s,a;return n>-1&&(t=t.slice(n),s=t.indexOf(";"),s>-1&&(t=t.slice(0,s)),a=t.replace(i+"=","")),a?JSON.parse(a):!1}},B1={local:function(r,e,t){localStorage.setItem(r+"-"+e,JSON.stringify(t))},cookie:function(r,e,t){var i=new Date;i.setDate(i.getDate()+1e4),document.cookie=r+"-"+e+"="+JSON.stringify(t)+"; expires="+i.toUTCString()}};const qt=class qt extends ke{constructor(e){super(e),this.mode="",this.id="",this.defWatcherBlock=!1,this.config={},this.readFunc=!1,this.writeFunc=!1,this.registerTableOption("persistence",!1),this.registerTableOption("persistenceID",""),this.registerTableOption("persistenceMode",!0),this.registerTableOption("persistenceReaderFunc",!1),this.registerTableOption("persistenceWriterFunc",!1)}localStorageTest(){var e="_tabulator_test";try{return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),!0}catch{return!1}}initialize(){if(this.table.options.persistence){var e=this.table.options.persistenceMode,t=this.table.options.persistenceID,i;this.mode=e!==!0?e:this.localStorageTest()?"local":"cookie",this.table.options.persistenceReaderFunc?typeof this.table.options.persistenceReaderFunc=="function"?this.readFunc=this.table.options.persistenceReaderFunc:qt.readers[this.table.options.persistenceReaderFunc]?this.readFunc=qt.readers[this.table.options.persistenceReaderFunc]:console.warn("Persistence Read Error - invalid reader set",this.table.options.persistenceReaderFunc):qt.readers[this.mode]?this.readFunc=qt.readers[this.mode]:console.warn("Persistence Read Error - invalid reader set",this.mode),this.table.options.persistenceWriterFunc?typeof this.table.options.persistenceWriterFunc=="function"?this.writeFunc=this.table.options.persistenceWriterFunc:qt.writers[this.table.options.persistenceWriterFunc]?this.writeFunc=qt.writers[this.table.options.persistenceWriterFunc]:console.warn("Persistence Write Error - invalid reader set",this.table.options.persistenceWriterFunc):qt.writers[this.mode]?this.writeFunc=qt.writers[this.mode]:console.warn("Persistence Write Error - invalid writer set",this.mode),this.id="tabulator-"+(t||this.table.element.getAttribute("id")||""),this.config={sort:this.table.options.persistence===!0||this.table.options.persistence.sort,filter:this.table.options.persistence===!0||this.table.options.persistence.filter,headerFilter:this.table.options.persistence===!0||this.table.options.persistence.headerFilter,group:this.table.options.persistence===!0||this.table.options.persistence.group,page:this.table.options.persistence===!0||this.table.options.persistence.page,columns:this.table.options.persistence===!0?["title","width","visible"]:this.table.options.persistence.columns},this.config.page&&(i=this.retrieveData("page"),i&&(typeof i.paginationSize<"u"&&(this.config.page===!0||this.config.page.size)&&(this.table.options.paginationSize=i.paginationSize),typeof i.paginationInitialPage<"u"&&(this.config.page===!0||this.config.page.page)&&(this.table.options.paginationInitialPage=i.paginationInitialPage))),this.config.group&&(i=this.retrieveData("group"),i&&(typeof i.groupBy<"u"&&(this.config.group===!0||this.config.group.groupBy)&&(this.table.options.groupBy=i.groupBy),typeof i.groupStartOpen<"u"&&(this.config.group===!0||this.config.group.groupStartOpen)&&(this.table.options.groupStartOpen=i.groupStartOpen),typeof i.groupHeader<"u"&&(this.config.group===!0||this.config.group.groupHeader)&&(this.table.options.groupHeader=i.groupHeader))),this.config.columns&&(this.table.options.columns=this.load("columns",this.table.options.columns),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("column-show",this.save.bind(this,"columns")),this.subscribe("column-hide",this.save.bind(this,"columns")),this.subscribe("column-moved",this.save.bind(this,"columns"))),this.subscribe("table-built",this.tableBuilt.bind(this),0),this.subscribe("table-redraw",this.tableRedraw.bind(this)),this.subscribe("filter-changed",this.eventSave.bind(this,"filter")),this.subscribe("filter-changed",this.eventSave.bind(this,"headerFilter")),this.subscribe("sort-changed",this.eventSave.bind(this,"sort")),this.subscribe("group-changed",this.eventSave.bind(this,"group")),this.subscribe("page-changed",this.eventSave.bind(this,"page")),this.subscribe("column-resized",this.eventSave.bind(this,"columns")),this.subscribe("column-width",this.eventSave.bind(this,"columns")),this.subscribe("layout-refreshed",this.eventSave.bind(this,"columns"))}this.registerTableFunction("getColumnLayout",this.getColumnLayout.bind(this)),this.registerTableFunction("setColumnLayout",this.setColumnLayout.bind(this))}eventSave(e){this.config[e]&&this.save(e)}tableBuilt(){var e,t,i;this.config.sort&&(e=this.load("sort"),e&&(this.table.options.initialSort=e)),this.config.filter&&(t=this.load("filter"),t&&(this.table.options.initialFilter=t)),this.config.headerFilter&&(i=this.load("headerFilter"),i&&(this.table.options.initialHeaderFilter=i))}tableRedraw(e){e&&this.config.columns&&this.save("columns")}getColumnLayout(){return this.parseColumns(this.table.columnManager.getColumns())}setColumnLayout(e){return this.table.columnManager.setColumns(this.mergeDefinition(this.table.options.columns,e,!0)),!0}initializeColumn(e){var t,i;this.config.columns&&(this.defWatcherBlock=!0,t=e.getDefinition(),i=this.config.columns===!0?Object.keys(t):this.config.columns,i.forEach(n=>{var s=Object.getOwnPropertyDescriptor(t,n),a=t[n];s&&Object.defineProperty(t,n,{set:o=>{a=o,this.defWatcherBlock||this.save("columns"),s.set&&s.set(o)},get:()=>(s.get&&s.get(),a)})}),this.defWatcherBlock=!1)}load(e,t){var i=this.retrieveData(e);return t&&(i=i?this.mergeDefinition(t,i):t),i}retrieveData(e){return this.readFunc?this.readFunc(this.id,e):!1}mergeDefinition(e,t,i){var n=[];return t=t||[],t.forEach((s,a)=>{var o=this._findColumn(e,s),l;o&&(i?l=Object.keys(s):this.config.columns===!0||this.config.columns==null?(l=Object.keys(o),l.push("width")):l=this.config.columns,l.forEach(h=>{h!=="columns"&&typeof s[h]<"u"&&(o[h]=s[h])}),o.columns&&(o.columns=this.mergeDefinition(o.columns,s.columns)),n.push(o))}),e.forEach((s,a)=>{var o=this._findColumn(t,s);o||(n.length>a?n.splice(a,0,s):n.push(s))}),n}_findColumn(e,t){var i=t.columns?"group":t.field?"field":"object";return e.find(function(n){switch(i){case"group":return n.title===t.title&&n.columns.length===t.columns.length;case"field":return n.field===t.field;case"object":return n===t}})}save(e){var t={};switch(e){case"columns":t=this.parseColumns(this.table.columnManager.getColumns());break;case"filter":t=this.table.modules.filter.getFilters();break;case"headerFilter":t=this.table.modules.filter.getHeaderFilters();break;case"sort":t=this.validateSorters(this.table.modules.sort.getSort());break;case"group":t=this.getGroupConfig();break;case"page":t=this.getPageConfig();break}this.writeFunc&&this.writeFunc(this.id,e,t)}validateSorters(e){return e.forEach(function(t){t.column=t.field,delete t.field}),e}getGroupConfig(){var e={};return this.config.group&&((this.config.group===!0||this.config.group.groupBy)&&(e.groupBy=this.table.options.groupBy),(this.config.group===!0||this.config.group.groupStartOpen)&&(e.groupStartOpen=this.table.options.groupStartOpen),(this.config.group===!0||this.config.group.groupHeader)&&(e.groupHeader=this.table.options.groupHeader)),e}getPageConfig(){var e={};return this.config.page&&((this.config.page===!0||this.config.page.size)&&(e.paginationSize=this.table.modules.page.getPageSize()),(this.config.page===!0||this.config.page.page)&&(e.paginationInitialPage=this.table.modules.page.getPage())),e}parseColumns(e){var t=[],i=["headerContextMenu","headerMenu","contextMenu","clickMenu"];return e.forEach(n=>{var s={},a=n.getDefinition(),o;n.isGroup?(s.title=a.title,s.columns=this.parseColumns(n.getColumns())):(s.field=n.getField(),this.config.columns===!0||this.config.columns==null?(o=Object.keys(a),o.push("width"),o.push("visible")):o=this.config.columns,o.forEach(l=>{switch(l){case"width":s.width=n.getWidth();break;case"visible":s.visible=n.visible;break;default:typeof a[l]!="function"&&i.indexOf(l)===-1&&(s[l]=a[l])}})),t.push(s)}),t}};G(qt,"moduleName","persistence"),G(qt,"moduleInitOrder",-10),G(qt,"readers",I1),G(qt,"writers",B1);let Xo=qt;class Tc extends ke{constructor(e){super(e),this.columnSubscribers={},this.registerTableOption("rowContextPopup",!1),this.registerTableOption("rowClickPopup",!1),this.registerTableOption("rowDblClickPopup",!1),this.registerTableOption("groupContextPopup",!1),this.registerTableOption("groupClickPopup",!1),this.registerTableOption("groupDblClickPopup",!1),this.registerColumnOption("headerContextPopup"),this.registerColumnOption("headerClickPopup"),this.registerColumnOption("headerDblClickPopup"),this.registerColumnOption("headerPopup"),this.registerColumnOption("headerPopupIcon"),this.registerColumnOption("contextPopup"),this.registerColumnOption("clickPopup"),this.registerColumnOption("dblClickPopup"),this.registerComponentFunction("cell","popup",this._componentPopupCall.bind(this)),this.registerComponentFunction("column","popup",this._componentPopupCall.bind(this)),this.registerComponentFunction("row","popup",this._componentPopupCall.bind(this)),this.registerComponentFunction("group","popup",this._componentPopupCall.bind(this))}initialize(){this.initializeRowWatchers(),this.initializeGroupWatchers(),this.subscribe("column-init",this.initializeColumn.bind(this))}_componentPopupCall(e,t,i){this.loadPopupEvent(t,null,e,i)}initializeRowWatchers(){this.table.options.rowContextPopup&&(this.subscribe("row-contextmenu",this.loadPopupEvent.bind(this,this.table.options.rowContextPopup)),this.table.on("rowTapHold",this.loadPopupEvent.bind(this,this.table.options.rowContextPopup))),this.table.options.rowClickPopup&&this.subscribe("row-click",this.loadPopupEvent.bind(this,this.table.options.rowClickPopup)),this.table.options.rowDblClickPopup&&this.subscribe("row-dblclick",this.loadPopupEvent.bind(this,this.table.options.rowDblClickPopup))}initializeGroupWatchers(){this.table.options.groupContextPopup&&(this.subscribe("group-contextmenu",this.loadPopupEvent.bind(this,this.table.options.groupContextPopup)),this.table.on("groupTapHold",this.loadPopupEvent.bind(this,this.table.options.groupContextPopup))),this.table.options.groupClickPopup&&this.subscribe("group-click",this.loadPopupEvent.bind(this,this.table.options.groupClickPopup)),this.table.options.groupDblClickPopup&&this.subscribe("group-dblclick",this.loadPopupEvent.bind(this,this.table.options.groupDblClickPopup))}initializeColumn(e){var t=e.definition;t.headerContextPopup&&!this.columnSubscribers.headerContextPopup&&(this.columnSubscribers.headerContextPopup=this.loadPopupTableColumnEvent.bind(this,"headerContextPopup"),this.subscribe("column-contextmenu",this.columnSubscribers.headerContextPopup),this.table.on("headerTapHold",this.loadPopupTableColumnEvent.bind(this,"headerContextPopup"))),t.headerClickPopup&&!this.columnSubscribers.headerClickPopup&&(this.columnSubscribers.headerClickPopup=this.loadPopupTableColumnEvent.bind(this,"headerClickPopup"),this.subscribe("column-click",this.columnSubscribers.headerClickPopup)),t.headerDblClickPopup&&!this.columnSubscribers.headerDblClickPopup&&(this.columnSubscribers.headerDblClickPopup=this.loadPopupTableColumnEvent.bind(this,"headerDblClickPopup"),this.subscribe("column-dblclick",this.columnSubscribers.headerDblClickPopup)),t.headerPopup&&this.initializeColumnHeaderPopup(e),t.contextPopup&&!this.columnSubscribers.contextPopup&&(this.columnSubscribers.contextPopup=this.loadPopupTableCellEvent.bind(this,"contextPopup"),this.subscribe("cell-contextmenu",this.columnSubscribers.contextPopup),this.table.on("cellTapHold",this.loadPopupTableCellEvent.bind(this,"contextPopup"))),t.clickPopup&&!this.columnSubscribers.clickPopup&&(this.columnSubscribers.clickPopup=this.loadPopupTableCellEvent.bind(this,"clickPopup"),this.subscribe("cell-click",this.columnSubscribers.clickPopup)),t.dblClickPopup&&!this.columnSubscribers.dblClickPopup&&(this.columnSubscribers.dblClickPopup=this.loadPopupTableCellEvent.bind(this,"dblClickPopup"),this.subscribe("cell-click",this.columnSubscribers.dblClickPopup))}initializeColumnHeaderPopup(e){var t=e.definition.headerPopupIcon,i;i=document.createElement("span"),i.classList.add("tabulator-header-popup-button"),t?(typeof t=="function"&&(t=t(e.getComponent())),t instanceof HTMLElement?i.appendChild(t):i.innerHTML=t):i.innerHTML="&vellip;",i.addEventListener("click",n=>{n.stopPropagation(),n.preventDefault(),this.loadPopupEvent(e.definition.headerPopup,n,e)}),e.titleElement.insertBefore(i,e.titleElement.firstChild)}loadPopupTableCellEvent(e,t,i){i._cell&&(i=i._cell),i.column.definition[e]&&this.loadPopupEvent(i.column.definition[e],t,i)}loadPopupTableColumnEvent(e,t,i){i._column&&(i=i._column),i.definition[e]&&this.loadPopupEvent(i.definition[e],t,i)}loadPopupEvent(e,t,i,n){var s;function a(o){s=o}i._group?i=i._group:i._row&&(i=i._row),e=typeof e=="function"?e.call(this.table,t,i.getComponent(),a):e,this.loadPopup(t,i,e,s,n)}loadPopup(e,t,i,n,s){var a=!(e instanceof MouseEvent),o,l;i instanceof HTMLElement?o=i:(o=document.createElement("div"),o.innerHTML=i),o.classList.add("tabulator-popup"),o.addEventListener("click",h=>{h.stopPropagation()}),a||e.preventDefault(),l=this.popup(o),typeof n=="function"&&l.renderCallback(n),e?l.show(e):l.show(t.getElement(),s||"center"),l.hideOnBlur(()=>{this.dispatchExternal("popupClosed",t.getComponent())}),this.dispatchExternal("popupOpened",t.getComponent())}}G(Tc,"moduleName","popup");class Sc extends ke{constructor(e){super(e),this.element=!1,this.manualBlock=!1,this.beforeprintEventHandler=null,this.afterprintEventHandler=null,this.registerTableOption("printAsHtml",!1),this.registerTableOption("printFormatter",!1),this.registerTableOption("printHeader",!1),this.registerTableOption("printFooter",!1),this.registerTableOption("printStyled",!0),this.registerTableOption("printRowRange","visible"),this.registerTableOption("printConfig",{}),this.registerColumnOption("print"),this.registerColumnOption("titlePrint")}initialize(){this.table.options.printAsHtml&&(this.beforeprintEventHandler=this.replaceTable.bind(this),this.afterprintEventHandler=this.cleanup.bind(this),window.addEventListener("beforeprint",this.beforeprintEventHandler),window.addEventListener("afterprint",this.afterprintEventHandler),this.subscribe("table-destroy",this.destroy.bind(this))),this.registerTableFunction("print",this.printFullscreen.bind(this))}destroy(){this.table.options.printAsHtml&&(window.removeEventListener("beforeprint",this.beforeprintEventHandler),window.removeEventListener("afterprint",this.afterprintEventHandler))}replaceTable(){this.manualBlock||(this.element=document.createElement("div"),this.element.classList.add("tabulator-print-table"),this.element.appendChild(this.table.modules.export.generateTable(this.table.options.printConfig,this.table.options.printStyled,this.table.options.printRowRange,"print")),this.table.element.style.display="none",this.table.element.parentNode.insertBefore(this.element,this.table.element))}cleanup(){document.body.classList.remove("tabulator-print-fullscreen-hide"),this.element&&this.element.parentNode&&(this.element.parentNode.removeChild(this.element),this.table.element.style.display="")}printFullscreen(e,t,i){var n=window.scrollX,s=window.scrollY,a=document.createElement("div"),o=document.createElement("div"),l=this.table.modules.export.generateTable(typeof i<"u"?i:this.table.options.printConfig,typeof t<"u"?t:this.table.options.printStyled,e||this.table.options.printRowRange,"print"),h,u;this.manualBlock=!0,this.element=document.createElement("div"),this.element.classList.add("tabulator-print-fullscreen"),this.table.options.printHeader&&(a.classList.add("tabulator-print-header"),h=typeof this.table.options.printHeader=="function"?this.table.options.printHeader.call(this.table):this.table.options.printHeader,typeof h=="string"?a.innerHTML=h:a.appendChild(h),this.element.appendChild(a)),this.element.appendChild(l),this.table.options.printFooter&&(o.classList.add("tabulator-print-footer"),u=typeof this.table.options.printFooter=="function"?this.table.options.printFooter.call(this.table):this.table.options.printFooter,typeof u=="string"?o.innerHTML=u:o.appendChild(u),this.element.appendChild(o)),document.body.classList.add("tabulator-print-fullscreen-hide"),document.body.appendChild(this.element),this.table.options.printFormatter&&this.table.options.printFormatter(this.element,l),window.print(),this.cleanup(),window.scrollTo(n,s),this.manualBlock=!1}}G(Sc,"moduleName","print");class Dc extends ke{constructor(e){super(e),this.data=!1,this.blocked=!1,this.origFuncs={},this.currentVersion=0,this.registerTableOption("reactiveData",!1)}initialize(){this.table.options.reactiveData&&(this.subscribe("cell-value-save-before",this.block.bind(this,"cellsave")),this.subscribe("cell-value-save-after",this.unblock.bind(this,"cellsave")),this.subscribe("row-data-save-before",this.block.bind(this,"rowsave")),this.subscribe("row-data-save-after",this.unblock.bind(this,"rowsave")),this.subscribe("row-data-init-after",this.watchRow.bind(this)),this.subscribe("data-processing",this.watchData.bind(this)),this.subscribe("table-destroy",this.unwatchData.bind(this)))}watchData(e){var t=this,i;this.currentVersion++,i=this.currentVersion,this.unwatchData(),this.data=e,this.origFuncs.push=e.push,Object.defineProperty(this.data,"push",{enumerable:!1,configurable:!0,value:function(){var n=Array.from(arguments),s;return!t.blocked&&i===t.currentVersion&&(t.block("data-push"),n.forEach(a=>{t.table.rowManager.addRowActual(a,!1)}),s=t.origFuncs.push.apply(e,arguments),t.unblock("data-push")),s}}),this.origFuncs.unshift=e.unshift,Object.defineProperty(this.data,"unshift",{enumerable:!1,configurable:!0,value:function(){var n=Array.from(arguments),s;return!t.blocked&&i===t.currentVersion&&(t.block("data-unshift"),n.forEach(a=>{t.table.rowManager.addRowActual(a,!0)}),s=t.origFuncs.unshift.apply(e,arguments),t.unblock("data-unshift")),s}}),this.origFuncs.shift=e.shift,Object.defineProperty(this.data,"shift",{enumerable:!1,configurable:!0,value:function(){var n,s;return!t.blocked&&i===t.currentVersion&&(t.block("data-shift"),t.data.length&&(n=t.table.rowManager.getRowFromDataObject(t.data[0]),n&&n.deleteActual()),s=t.origFuncs.shift.call(e),t.unblock("data-shift")),s}}),this.origFuncs.pop=e.pop,Object.defineProperty(this.data,"pop",{enumerable:!1,configurable:!0,value:function(){var n,s;return!t.blocked&&i===t.currentVersion&&(t.block("data-pop"),t.data.length&&(n=t.table.rowManager.getRowFromDataObject(t.data[t.data.length-1]),n&&n.deleteActual()),s=t.origFuncs.pop.call(e),t.unblock("data-pop")),s}}),this.origFuncs.splice=e.splice,Object.defineProperty(this.data,"splice",{enumerable:!1,configurable:!0,value:function(){var n=Array.from(arguments),s=n[0]<0?e.length+n[0]:n[0],a=n[1],o=n[2]?n.slice(2):!1,l,h;if(!t.blocked&&i===t.currentVersion){if(t.block("data-splice"),o&&(l=e[s]?t.table.rowManager.getRowFromDataObject(e[s]):!1,l?o.forEach(d=>{t.table.rowManager.addRowActual(d,!0,l,!0)}):(o=o.slice().reverse(),o.forEach(d=>{t.table.rowManager.addRowActual(d,!0,!1,!0)}))),a!==0){var u=e.slice(s,typeof n[1]>"u"?n[1]:s+a);u.forEach((d,c)=>{var f=t.table.rowManager.getRowFromDataObject(d);f&&f.deleteActual(c!==u.length-1)})}(o||a!==0)&&t.table.rowManager.reRenderInPosition(),h=t.origFuncs.splice.apply(e,arguments),t.unblock("data-splice")}return h}})}unwatchData(){if(this.data!==!1)for(var e in this.origFuncs)Object.defineProperty(this.data,e,{enumerable:!0,configurable:!0,writable:!0,value:this.origFuncs.key})}watchRow(e){var t=e.getData();for(var i in t)this.watchKey(e,t,i);this.table.options.dataTree&&this.watchTreeChildren(e)}watchTreeChildren(e){var t=this,i=e.getData()[this.table.options.dataTreeChildField],n={};i&&(n.push=i.push,Object.defineProperty(i,"push",{enumerable:!1,configurable:!0,value:()=>{if(!t.blocked){t.block("tree-push");var s=n.push.apply(i,arguments);this.rebuildTree(e),t.unblock("tree-push")}return s}}),n.unshift=i.unshift,Object.defineProperty(i,"unshift",{enumerable:!1,configurable:!0,value:()=>{if(!t.blocked){t.block("tree-unshift");var s=n.unshift.apply(i,arguments);this.rebuildTree(e),t.unblock("tree-unshift")}return s}}),n.shift=i.shift,Object.defineProperty(i,"shift",{enumerable:!1,configurable:!0,value:()=>{if(!t.blocked){t.block("tree-shift");var s=n.shift.call(i);this.rebuildTree(e),t.unblock("tree-shift")}return s}}),n.pop=i.pop,Object.defineProperty(i,"pop",{enumerable:!1,configurable:!0,value:()=>{if(!t.blocked){t.block("tree-pop");var s=n.pop.call(i);this.rebuildTree(e),t.unblock("tree-pop")}return s}}),n.splice=i.splice,Object.defineProperty(i,"splice",{enumerable:!1,configurable:!0,value:()=>{if(!t.blocked){t.block("tree-splice");var s=n.splice.apply(i,arguments);this.rebuildTree(e),t.unblock("tree-splice")}return s}}))}rebuildTree(e){this.table.modules.dataTree.initializeRow(e),this.table.modules.dataTree.layoutRow(e),this.table.rowManager.refreshActiveData("tree",!1,!0)}watchKey(e,t,i){var n=this,s=Object.getOwnPropertyDescriptor(t,i),a=t[i],o=this.currentVersion;Object.defineProperty(t,i,{set:l=>{if(a=l,!n.blocked&&o===n.currentVersion){n.block("key");var h={};h[i]=l,e.updateData(h),n.unblock("key")}s.set&&s.set(l)},get:()=>(s.get&&s.get(),a)})}unwatchRow(e){var t=e.getData();for(var i in t)Object.defineProperty(t,i,{value:t[i]})}block(e){this.blocked||(this.blocked=e)}unblock(e){this.blocked===e&&(this.blocked=!1)}}G(Dc,"moduleName","reactiveData");class kc extends ke{constructor(e){super(e),this.startColumn=!1,this.startX=!1,this.startWidth=!1,this.latestX=!1,this.handle=null,this.initialNextColumn=null,this.nextColumn=null,this.initialized=!1,this.registerColumnOption("resizable",!0),this.registerTableOption("resizableColumnFit",!1),this.registerTableOption("resizableColumnGuide",!1)}initialize(){this.subscribe("column-rendered",this.layoutColumnHeader.bind(this))}initializeEventWatchers(){this.initialized||(this.subscribe("cell-rendered",this.layoutCellHandles.bind(this)),this.subscribe("cell-delete",this.deInitializeComponent.bind(this)),this.subscribe("cell-height",this.resizeHandle.bind(this)),this.subscribe("column-moved",this.columnLayoutUpdated.bind(this)),this.subscribe("column-hide",this.deInitializeColumn.bind(this)),this.subscribe("column-show",this.columnLayoutUpdated.bind(this)),this.subscribe("column-width",this.columnWidthUpdated.bind(this)),this.subscribe("column-delete",this.deInitializeComponent.bind(this)),this.subscribe("column-height",this.resizeHandle.bind(this)),this.initialized=!0)}layoutCellHandles(e){e.row.type==="row"&&(this.deInitializeComponent(e),this.initializeColumn("cell",e,e.column,e.element))}layoutColumnHeader(e){e.definition.resizable&&(this.initializeEventWatchers(),this.deInitializeComponent(e),this.initializeColumn("header",e,e,e.element))}columnLayoutUpdated(e){var t=e.prevColumn();this.reinitializeColumn(e),t&&this.reinitializeColumn(t)}columnWidthUpdated(e){e.modules.frozen&&(this.table.modules.frozenColumns.leftColumns.includes(e)?this.table.modules.frozenColumns.leftColumns.forEach(t=>{this.reinitializeColumn(t)}):this.table.modules.frozenColumns.rightColumns.includes(e)&&this.table.modules.frozenColumns.rightColumns.forEach(t=>{this.reinitializeColumn(t)}))}frozenColumnOffset(e){var t=!1;return e.modules.frozen&&(t=e.modules.frozen.marginValue,e.modules.frozen.position==="left"?t+=e.getWidth()-3:t&&(t-=3)),t!==!1?t+"px":!1}reinitializeColumn(e){var t=this.frozenColumnOffset(e);e.cells.forEach(i=>{i.modules.resize&&i.modules.resize.handleEl&&(t&&(i.modules.resize.handleEl.style[e.modules.frozen.position]=t,i.modules.resize.handleEl.style["z-index"]=11),i.element.after(i.modules.resize.handleEl))}),e.modules.resize&&e.modules.resize.handleEl&&(t&&(e.modules.resize.handleEl.style[e.modules.frozen.position]=t),e.element.after(e.modules.resize.handleEl))}initializeColumn(e,t,i,n){var s=this,a=!1,o=i.definition.resizable,l={},h=i.getLastColumn();if(e==="header"&&(a=i.definition.formatter=="textarea"||i.definition.variableHeight,l={variableHeight:a}),(o===!0||o==e)&&this._checkResizability(h)){var u=document.createElement("span");u.className="tabulator-col-resize-handle",u.addEventListener("click",function(c){c.stopPropagation()});var d=function(c){s.startColumn=i,s.initialNextColumn=s.nextColumn=h.nextColumn(),s._mouseDown(c,h,u)};u.addEventListener("mousedown",d),u.addEventListener("touchstart",d,{passive:!0}),u.addEventListener("dblclick",c=>{var f=h.getWidth();c.stopPropagation(),h.reinitializeWidth(!0),f!==h.getWidth()&&(s.dispatch("column-resized",h),s.dispatchExternal("columnResized",h.getComponent()))}),i.modules.frozen&&(u.style.position="sticky",u.style[i.modules.frozen.position]=this.frozenColumnOffset(i)),l.handleEl=u,n.parentNode&&i.visible&&n.after(u)}t.modules.resize=l}deInitializeColumn(e){this.deInitializeComponent(e),e.cells.forEach(t=>{this.deInitializeComponent(t)})}deInitializeComponent(e){var t;e.modules.resize&&(t=e.modules.resize.handleEl,t&&t.parentElement&&t.parentElement.removeChild(t))}resizeHandle(e,t){e.modules.resize&&e.modules.resize.handleEl&&(e.modules.resize.handleEl.style.height=t)}resize(e,t){var i=typeof e.clientX>"u"?e.touches[0].clientX:e.clientX,n=i-this.startX,s=i-this.latestX,a,o;if(this.latestX=i,this.table.rtl&&(n=-n,s=-s),a=t.width==t.minWidth||t.width==t.maxWidth,t.setWidth(this.startWidth+n),o=t.width==t.minWidth||t.width==t.maxWidth,s<0&&(this.nextColumn=this.initialNextColumn),this.table.options.resizableColumnFit&&this.nextColumn&&!(a&&o)){let l=this.nextColumn.getWidth();s>0&&l<=this.nextColumn.minWidth&&(this.nextColumn=this.nextColumn.nextColumn()),this.nextColumn&&this.nextColumn.setWidth(this.nextColumn.getWidth()-s)}this.table.columnManager.rerenderColumns(!0),!this.table.browserSlow&&t.modules.resize&&t.modules.resize.variableHeight&&t.checkCellHeights()}calcGuidePosition(e,t,i){var n=typeof e.clientX>"u"?e.touches[0].clientX:e.clientX,s=i.getBoundingClientRect().x-this.table.element.getBoundingClientRect().x,a=this.table.element.getBoundingClientRect().x,o=t.element.getBoundingClientRect().left-a,l=n-this.startX,h=Math.max(s+l,o+t.minWidth);return t.maxWidth&&(h=Math.min(h,o+t.maxWidth)),h}_checkResizability(e){return e.definition.resizable}_mouseDown(e,t,i){var n=this,s;this.dispatchExternal("columnResizing",t.getComponent()),n.table.options.resizableColumnGuide&&(s=document.createElement("span"),s.classList.add("tabulator-col-resize-guide"),n.table.element.appendChild(s),setTimeout(()=>{s.style.left=n.calcGuidePosition(e,t,i)+"px"})),n.table.element.classList.add("tabulator-block-select");function a(l){n.table.options.resizableColumnGuide?s.style.left=n.calcGuidePosition(l,t,i)+"px":n.resize(l,t)}function o(l){n.table.options.resizableColumnGuide&&(n.resize(l,t),s.remove()),n.startColumn.modules.edit&&(n.startColumn.modules.edit.blocked=!1),n.table.browserSlow&&t.modules.resize&&t.modules.resize.variableHeight&&t.checkCellHeights(),document.body.removeEventListener("mouseup",o),document.body.removeEventListener("mousemove",a),i.removeEventListener("touchmove",a),i.removeEventListener("touchend",o),n.table.element.classList.remove("tabulator-block-select"),n.startWidth!==t.getWidth()&&(n.table.columnManager.verticalAlignHeaders(),n.dispatch("column-resized",t),n.dispatchExternal("columnResized",t.getComponent()))}e.stopPropagation(),n.startColumn.modules.edit&&(n.startColumn.modules.edit.blocked=!0),n.startX=typeof e.clientX>"u"?e.touches[0].clientX:e.clientX,n.latestX=n.startX,n.startWidth=t.getWidth(),document.body.addEventListener("mousemove",a),document.body.addEventListener("mouseup",o),i.addEventListener("touchmove",a,{passive:!0}),i.addEventListener("touchend",o)}}G(kc,"moduleName","resizeColumns");class Rc extends ke{constructor(e){super(e),this.startColumn=!1,this.startY=!1,this.startHeight=!1,this.handle=null,this.prevHandle=null,this.registerTableOption("resizableRows",!1),this.registerTableOption("resizableRowGuide",!1)}initialize(){this.table.options.resizableRows&&this.subscribe("row-layout-after",this.initializeRow.bind(this))}initializeRow(e){var t=this,i=e.getElement(),n=document.createElement("div");n.className="tabulator-row-resize-handle";var s=document.createElement("div");s.className="tabulator-row-resize-handle prev",n.addEventListener("click",function(l){l.stopPropagation()});var a=function(l){t.startRow=e,t._mouseDown(l,e,n)};n.addEventListener("mousedown",a),n.addEventListener("touchstart",a,{passive:!0}),s.addEventListener("click",function(l){l.stopPropagation()});var o=function(l){var h=t.table.rowManager.prevDisplayRow(e);h&&(t.startRow=h,t._mouseDown(l,h,s))};s.addEventListener("mousedown",o),s.addEventListener("touchstart",o,{passive:!0}),i.appendChild(n),i.appendChild(s)}resize(e,t){t.setHeight(this.startHeight+((typeof e.screenY>"u"?e.touches[0].screenY:e.screenY)-this.startY))}calcGuidePosition(e,t,i){var n=typeof e.screenY>"u"?e.touches[0].screenY:e.screenY,s=i.getBoundingClientRect().y-this.table.element.getBoundingClientRect().y,a=this.table.element.getBoundingClientRect().y,o=t.element.getBoundingClientRect().top-a,l=n-this.startY;return Math.max(s+l,o)}_mouseDown(e,t,i){var n=this,s;n.dispatchExternal("rowResizing",t.getComponent()),n.table.options.resizableRowGuide&&(s=document.createElement("span"),s.classList.add("tabulator-row-resize-guide"),n.table.element.appendChild(s),setTimeout(()=>{s.style.top=n.calcGuidePosition(e,t,i)+"px"})),n.table.element.classList.add("tabulator-block-select");function a(l){n.table.options.resizableRowGuide?s.style.top=n.calcGuidePosition(l,t,i)+"px":n.resize(l,t)}function o(l){n.table.options.resizableRowGuide&&(n.resize(l,t),s.remove()),document.body.removeEventListener("mouseup",a),document.body.removeEventListener("mousemove",a),i.removeEventListener("touchmove",a),i.removeEventListener("touchend",o),n.table.element.classList.remove("tabulator-block-select"),n.dispatchExternal("rowResized",t.getComponent())}e.stopPropagation(),n.startY=typeof e.screenY>"u"?e.touches[0].screenY:e.screenY,n.startHeight=t.getHeight(),document.body.addEventListener("mousemove",a),document.body.addEventListener("mouseup",o),i.addEventListener("touchmove",a,{passive:!0}),i.addEventListener("touchend",o)}}G(Rc,"moduleName","resizeRows");class Fc extends ke{constructor(e){super(e),this.binding=!1,this.visibilityObserver=!1,this.resizeObserver=!1,this.containerObserver=!1,this.tableHeight=0,this.tableWidth=0,this.containerHeight=0,this.containerWidth=0,this.autoResize=!1,this.visible=!1,this.initialized=!1,this.initialRedraw=!1,this.registerTableOption("autoResize",!0)}initialize(){if(this.table.options.autoResize){var e=this.table,t;this.tableHeight=e.element.clientHeight,this.tableWidth=e.element.clientWidth,e.element.parentNode&&(this.containerHeight=e.element.parentNode.clientHeight,this.containerWidth=e.element.parentNode.clientWidth),typeof IntersectionObserver<"u"&&typeof ResizeObserver<"u"&&e.rowManager.getRenderMode()==="virtual"?(this.initializeVisibilityObserver(),this.autoResize=!0,this.resizeObserver=new ResizeObserver(i=>{if(!e.browserMobile||e.browserMobile&&(!e.modules.edit||e.modules.edit&&!e.modules.edit.currentCell)){var n=Math.floor(i[0].contentRect.height),s=Math.floor(i[0].contentRect.width);(this.tableHeight!=n||this.tableWidth!=s)&&(this.tableHeight=n,this.tableWidth=s,e.element.parentNode&&(this.containerHeight=e.element.parentNode.clientHeight,this.containerWidth=e.element.parentNode.clientWidth),this.redrawTable())}}),this.resizeObserver.observe(e.element),t=window.getComputedStyle(e.element),this.table.element.parentNode&&!this.table.rowManager.fixedHeight&&(t.getPropertyValue("max-height")||t.getPropertyValue("min-height"))&&(this.containerObserver=new ResizeObserver(i=>{if(!e.browserMobile||e.browserMobile&&(!e.modules.edit||e.modules.edit&&!e.modules.edit.currentCell)){var n=Math.floor(i[0].contentRect.height),s=Math.floor(i[0].contentRect.width);(this.containerHeight!=n||this.containerWidth!=s)&&(this.containerHeight=n,this.containerWidth=s,this.tableHeight=e.element.clientHeight,this.tableWidth=e.element.clientWidth),this.redrawTable()}}),this.containerObserver.observe(this.table.element.parentNode)),this.subscribe("table-resize",this.tableResized.bind(this))):(this.binding=function(){(!e.browserMobile||e.browserMobile&&(!e.modules.edit||e.modules.edit&&!e.modules.edit.currentCell))&&(e.columnManager.rerenderColumns(!0),e.redraw())},window.addEventListener("resize",this.binding)),this.subscribe("table-destroy",this.clearBindings.bind(this))}}initializeVisibilityObserver(){this.visibilityObserver=new IntersectionObserver(e=>{this.visible=e[0].isIntersecting,this.initialized?this.visible&&(this.redrawTable(this.initialRedraw),this.initialRedraw=!1):(this.initialized=!0,this.initialRedraw=!this.visible)}),this.visibilityObserver.observe(this.table.element)}redrawTable(e){this.initialized&&this.visible&&(this.table.columnManager.rerenderColumns(!0),this.table.redraw(e))}tableResized(){this.table.rowManager.redraw()}clearBindings(){this.binding&&window.removeEventListener("resize",this.binding),this.resizeObserver&&this.resizeObserver.unobserve(this.table.element),this.visibilityObserver&&this.visibilityObserver.unobserve(this.table.element),this.containerObserver&&this.containerObserver.unobserve(this.table.element.parentNode)}}G(Fc,"moduleName","resizeTable");function H1(r,e,t){var i=document.createElement("div"),n=r.getRow()._row.modules.responsiveLayout;i.classList.add("tabulator-responsive-collapse-toggle"),i.innerHTML=`<svg class='tabulator-responsive-collapse-toggle-open' viewbox="0 0 24 24">
  <line x1="7" y1="12" x2="17" y2="12" fill="none" stroke-width="3" stroke-linecap="round" />
  <line y1="7" x1="12" y2="17" x2="12" fill="none" stroke-width="3" stroke-linecap="round" />
</svg>

<svg class='tabulator-responsive-collapse-toggle-close' viewbox="0 0 24 24">
  <line x1="7" y1="12" x2="17" y2="12"  fill="none" stroke-width="3" stroke-linecap="round" />
</svg>`,r.getElement().classList.add("tabulator-row-handle");function s(a){var o=n.element;n.open=a,o&&(n.open?(i.classList.add("open"),o.style.display=""):(i.classList.remove("open"),o.style.display="none"))}return i.addEventListener("click",function(a){a.stopImmediatePropagation(),s(!n.open),r.getTable().rowManager.adjustTableSize()}),s(n.open),i}var z1={format:{formatters:{responsiveCollapse:H1}}};class $o extends ke{constructor(e){super(e),this.columns=[],this.hiddenColumns=[],this.mode="",this.index=0,this.collapseFormatter=[],this.collapseStartOpen=!0,this.collapseHandleColumn=!1,this.registerTableOption("responsiveLayout",!1),this.registerTableOption("responsiveLayoutCollapseStartOpen",!0),this.registerTableOption("responsiveLayoutCollapseUseFormatters",!0),this.registerTableOption("responsiveLayoutCollapseFormatter",!1),this.registerColumnOption("responsive")}initialize(){this.table.options.responsiveLayout&&(this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("column-show",this.updateColumnVisibility.bind(this)),this.subscribe("column-hide",this.updateColumnVisibility.bind(this)),this.subscribe("columns-loaded",this.initializeResponsivity.bind(this)),this.subscribe("column-moved",this.initializeResponsivity.bind(this)),this.subscribe("column-add",this.initializeResponsivity.bind(this)),this.subscribe("column-delete",this.initializeResponsivity.bind(this)),this.subscribe("table-redrawing",this.tableRedraw.bind(this)),this.table.options.responsiveLayout==="collapse"&&(this.subscribe("row-data-changed",this.generateCollapsedRowContent.bind(this)),this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-layout",this.layoutRow.bind(this))))}tableRedraw(e){["fitColumns","fitDataStretch"].indexOf(this.layoutMode())===-1&&(e||this.update())}initializeResponsivity(){var e=[];this.mode=this.table.options.responsiveLayout,this.collapseFormatter=this.table.options.responsiveLayoutCollapseFormatter||this.formatCollapsedData,this.collapseStartOpen=this.table.options.responsiveLayoutCollapseStartOpen,this.hiddenColumns=[],this.collapseFormatter&&(this.collapseFormatter=this.collapseFormatter.bind(this.table)),this.table.columnManager.columnsByIndex.forEach((t,i)=>{t.modules.responsive&&t.modules.responsive.order&&t.modules.responsive.visible&&(t.modules.responsive.index=i,e.push(t),!t.visible&&this.mode==="collapse"&&this.hiddenColumns.push(t))}),e=e.reverse(),e=e.sort((t,i)=>{var n=i.modules.responsive.order-t.modules.responsive.order;return n||i.modules.responsive.index-t.modules.responsive.index}),this.columns=e,this.mode==="collapse"&&this.generateCollapsedContent();for(let t of this.table.columnManager.columnsByIndex)if(t.definition.formatter=="responsiveCollapse"){this.collapseHandleColumn=t;break}this.collapseHandleColumn&&(this.hiddenColumns.length?this.collapseHandleColumn.show():this.collapseHandleColumn.hide())}initializeColumn(e){var t=e.getDefinition();e.modules.responsive={order:typeof t.responsive>"u"?1:t.responsive,visible:t.visible!==!1}}initializeRow(e){var t;e.type!=="calc"&&(t=document.createElement("div"),t.classList.add("tabulator-responsive-collapse"),e.modules.responsiveLayout={element:t,open:this.collapseStartOpen},this.collapseStartOpen||(t.style.display="none"))}layoutRow(e){var t=e.getElement();e.modules.responsiveLayout&&(t.appendChild(e.modules.responsiveLayout.element),this.generateCollapsedRowContent(e))}updateColumnVisibility(e,t){!t&&e.modules.responsive&&(e.modules.responsive.visible=e.visible,this.initializeResponsivity())}hideColumn(e){var t=this.hiddenColumns.length;e.hide(!1,!0),this.mode==="collapse"&&(this.hiddenColumns.unshift(e),this.generateCollapsedContent(),this.collapseHandleColumn&&!t&&this.collapseHandleColumn.show())}showColumn(e){var t;e.show(!1,!0),e.setWidth(e.getWidth()),this.mode==="collapse"&&(t=this.hiddenColumns.indexOf(e),t>-1&&this.hiddenColumns.splice(t,1),this.generateCollapsedContent(),this.collapseHandleColumn&&!this.hiddenColumns.length&&this.collapseHandleColumn.hide())}update(){for(var e=!0;e;){let t=this.table.modules.layout.getMode()=="fitColumns"?this.table.columnManager.getFlexBaseWidth():this.table.columnManager.getWidth(),i=(this.table.options.headerVisible?this.table.columnManager.element.clientWidth:this.table.element.clientWidth)-t;if(i<0){let n=this.columns[this.index];n?(this.hideColumn(n),this.index++):e=!1}else{let n=this.columns[this.index-1];n&&i>0&&i>=n.getWidth()?(this.showColumn(n),this.index--):e=!1}this.table.rowManager.activeRowsCount||this.table.rowManager.renderEmptyScroll()}}generateCollapsedContent(){var e=this.table.rowManager.getDisplayRows();e.forEach(t=>{this.generateCollapsedRowContent(t)})}generateCollapsedRowContent(e){var t,i;if(e.modules.responsiveLayout){for(t=e.modules.responsiveLayout.element;t.firstChild;)t.removeChild(t.firstChild);i=this.collapseFormatter(this.generateCollapsedRowData(e)),i&&t.appendChild(i),e.calcHeight(!0)}}generateCollapsedRowData(e){var t=e.getData(),i=[],n;return this.hiddenColumns.forEach(s=>{var a=s.getFieldValue(t);if(s.definition.title&&s.field)if(s.modules.format&&this.table.options.responsiveLayoutCollapseUseFormatters){let o=function(l){l()};n={value:!1,data:{},getValue:function(){return a},getData:function(){return t},getType:function(){return"cell"},getElement:function(){return document.createElement("div")},getRow:function(){return e.getComponent()},getColumn:function(){return s.getComponent()},getTable:()=>this.table},i.push({field:s.field,title:s.definition.title,value:s.modules.format.formatter.call(this.table.modules.format,n,s.modules.format.params,o)})}else i.push({field:s.field,title:s.definition.title,value:a})}),i}formatCollapsedData(e){var t=document.createElement("table");return e.forEach(i=>{var n=document.createElement("tr"),s=document.createElement("td"),a=document.createElement("td"),o,l=document.createElement("strong");s.appendChild(l),this.modules.localize.bind("columns|"+i.field,function(h){l.innerHTML=h||i.title}),i.value instanceof Node?(o=document.createElement("div"),o.appendChild(i.value),a.appendChild(o)):a.innerHTML=i.value,n.appendChild(s),n.appendChild(a),t.appendChild(n)}),Object.keys(e).length?t:""}}G($o,"moduleName","responsiveLayout"),G($o,"moduleExtensions",z1);function W1(r,e,t){var i=document.createElement("input"),n=!1;if(i.type="checkbox",i.setAttribute("aria-label","Select Row"),this.table.modExists("selectRow",!0))if(i.addEventListener("click",a=>{a.stopPropagation()}),typeof r.getRow=="function"){var s=r.getRow();s instanceof Oa?(i.addEventListener("change",a=>{this.table.options.selectableRowsRangeMode==="click"&&n?n=!1:s.toggleSelect()}),this.table.options.selectableRowsRangeMode==="click"&&i.addEventListener("click",a=>{n=!0,this.table.modules.selectRow.handleComplexRowClick(s._row,a)}),i.checked=s.isSelected&&s.isSelected(),this.table.modules.selectRow.registerRowSelectCheckbox(s,i)):i=""}else i.addEventListener("change",a=>{this.table.modules.selectRow.selectedRows.length?this.table.deselectRow():this.table.selectRow(e.rowRange)}),this.table.modules.selectRow.registerHeaderSelectCheckbox(i);return i}var V1={format:{formatters:{rowSelection:W1}}};class Ko extends ke{constructor(e){super(e),this.selecting=!1,this.lastClickedRow=!1,this.selectPrev=[],this.selectedRows=[],this.headerCheckboxElement=null,this.registerTableOption("selectableRows","highlight"),this.registerTableOption("selectableRowsRangeMode","drag"),this.registerTableOption("selectableRowsRollingSelection",!0),this.registerTableOption("selectableRowsPersistence",!0),this.registerTableOption("selectableRowsCheck",function(t,i){return!0}),this.registerTableFunction("selectRow",this.selectRows.bind(this)),this.registerTableFunction("deselectRow",this.deselectRows.bind(this)),this.registerTableFunction("toggleSelectRow",this.toggleRow.bind(this)),this.registerTableFunction("getSelectedRows",this.getSelectedRows.bind(this)),this.registerTableFunction("getSelectedData",this.getSelectedData.bind(this)),this.registerComponentFunction("row","select",this.selectRows.bind(this)),this.registerComponentFunction("row","deselect",this.deselectRows.bind(this)),this.registerComponentFunction("row","toggleSelect",this.toggleRow.bind(this)),this.registerComponentFunction("row","isSelected",this.isRowSelected.bind(this))}initialize(){this.deprecatedOptionsCheck(),this.table.options.selectableRows==="highlight"&&this.table.options.selectableRange&&(this.table.options.selectableRows=!1),this.table.options.selectableRows!==!1&&(this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-deleting",this.rowDeleted.bind(this)),this.subscribe("rows-wipe",this.clearSelectionData.bind(this)),this.subscribe("rows-retrieve",this.rowRetrieve.bind(this)),this.table.options.selectableRows&&!this.table.options.selectableRowsPersistence&&this.subscribe("data-refreshing",this.deselectRows.bind(this)))}deprecatedOptionsCheck(){}rowRetrieve(e,t){return e==="selected"?this.selectedRows:t}rowDeleted(e){this._deselectRow(e,!0)}clearSelectionData(e){var t=this.selectedRows.length;this.selecting=!1,this.lastClickedRow=!1,this.selectPrev=[],this.selectedRows=[],t&&e!==!0&&this._rowSelectionChanged()}initializeRow(e){var t=this,i=t.checkRowSelectability(e),n=e.getElement(),s=function(){setTimeout(function(){t.selecting=!1},50),document.body.removeEventListener("mouseup",s)};e.modules.select={selected:!1},n.classList.toggle("tabulator-selectable",i),n.classList.toggle("tabulator-unselectable",!i),t.checkRowSelectability(e)&&t.table.options.selectableRows&&t.table.options.selectableRows!="highlight"&&(t.table.options.selectableRowsRangeMode==="click"?n.addEventListener("click",this.handleComplexRowClick.bind(this,e)):(n.addEventListener("click",function(a){(!t.table.modExists("edit")||!t.table.modules.edit.getCurrentCell())&&t.table._clearSelection(),t.selecting||t.toggleRow(e)}),n.addEventListener("mousedown",function(a){if(a.shiftKey)return t.table._clearSelection(),t.selecting=!0,t.selectPrev=[],document.body.addEventListener("mouseup",s),document.body.addEventListener("keyup",s),t.toggleRow(e),!1}),n.addEventListener("mouseenter",function(a){t.selecting&&(t.table._clearSelection(),t.toggleRow(e),t.selectPrev[1]==e&&t.toggleRow(t.selectPrev[0]))}),n.addEventListener("mouseout",function(a){t.selecting&&(t.table._clearSelection(),t.selectPrev.unshift(e))})))}handleComplexRowClick(e,t){if(t.shiftKey){this.table._clearSelection(),this.lastClickedRow=this.lastClickedRow||e;var i=this.table.rowManager.getDisplayRowIndex(this.lastClickedRow),n=this.table.rowManager.getDisplayRowIndex(e),s=i<=n?i:n,a=i>=n?i:n,o=this.table.rowManager.getDisplayRows().slice(0),l=o.splice(s,a-s+1);t.ctrlKey||t.metaKey?(l.forEach(h=>{h!==this.lastClickedRow&&(this.table.options.selectableRows!==!0&&!this.isRowSelected(e)?this.selectedRows.length<this.table.options.selectableRows&&this.toggleRow(h):this.toggleRow(h))}),this.lastClickedRow=e):(this.deselectRows(void 0,!0),this.table.options.selectableRows!==!0&&l.length>this.table.options.selectableRows&&(l=l.slice(0,this.table.options.selectableRows)),this.selectRows(l)),this.table._clearSelection()}else t.ctrlKey||t.metaKey?(this.toggleRow(e),this.lastClickedRow=e):(this.deselectRows(void 0,!0),this.selectRows(e),this.lastClickedRow=e)}checkRowSelectability(e){return e&&e.type==="row"?this.table.options.selectableRowsCheck.call(this.table,e.getComponent()):!1}toggleRow(e){this.checkRowSelectability(e)&&(e.modules.select&&e.modules.select.selected?this._deselectRow(e):this._selectRow(e))}selectRows(e){var t=[],i,n;switch(typeof e){case"undefined":i=this.table.rowManager.rows;break;case"number":i=this.table.rowManager.findRow(e);break;case"string":i=this.table.rowManager.findRow(e),i||(i=this.table.rowManager.getRows(e));break;default:i=e;break}Array.isArray(i)?i.length&&(i.forEach(s=>{n=this._selectRow(s,!0,!0),n&&t.push(n)}),this._rowSelectionChanged(!1,t)):i&&this._selectRow(i,!1,!0)}_selectRow(e,t,i){if(!isNaN(this.table.options.selectableRows)&&this.table.options.selectableRows!==!0&&!i&&this.selectedRows.length>=this.table.options.selectableRows)if(this.table.options.selectableRowsRollingSelection)this._deselectRow(this.selectedRows[0]);else return!1;var n=this.table.rowManager.findRow(e);if(n){if(this.selectedRows.indexOf(n)==-1)return n.getElement().classList.add("tabulator-selected"),n.modules.select||(n.modules.select={}),n.modules.select.selected=!0,n.modules.select.checkboxEl&&(n.modules.select.checkboxEl.checked=!0),this.selectedRows.push(n),this.table.options.dataTreeSelectPropagate&&this.childRowSelection(n,!0),this.dispatchExternal("rowSelected",n.getComponent()),this._rowSelectionChanged(t,n),n}else t||console.warn("Selection Error - No such row found, ignoring selection:"+e)}isRowSelected(e){return this.selectedRows.indexOf(e)!==-1}deselectRows(e,t){var i=[],n,s;switch(typeof e){case"undefined":n=Object.assign([],this.selectedRows);break;case"number":n=this.table.rowManager.findRow(e);break;case"string":n=this.table.rowManager.findRow(e),n||(n=this.table.rowManager.getRows(e));break;default:n=e;break}Array.isArray(n)?n.length&&(n.forEach(a=>{s=this._deselectRow(a,!0,!0),s&&i.push(s)}),this._rowSelectionChanged(t,[],i)):n&&this._deselectRow(n,t,!0)}_deselectRow(e,t){var i=this,n=i.table.rowManager.findRow(e),s,a;if(n){if(s=i.selectedRows.findIndex(function(o){return o==n}),s>-1)return a=n.getElement(),a&&a.classList.remove("tabulator-selected"),n.modules.select||(n.modules.select={}),n.modules.select.selected=!1,n.modules.select.checkboxEl&&(n.modules.select.checkboxEl.checked=!1),i.selectedRows.splice(s,1),this.table.options.dataTreeSelectPropagate&&this.childRowSelection(n,!1),this.dispatchExternal("rowDeselected",n.getComponent()),i._rowSelectionChanged(t,void 0,n),n}else t||console.warn("Deselection Error - No such row found, ignoring selection:"+e)}getSelectedData(){var e=[];return this.selectedRows.forEach(function(t){e.push(t.getData())}),e}getSelectedRows(){var e=[];return this.selectedRows.forEach(function(t){e.push(t.getComponent())}),e}_rowSelectionChanged(e,t=[],i=[]){this.headerCheckboxElement&&(this.selectedRows.length===0?(this.headerCheckboxElement.checked=!1,this.headerCheckboxElement.indeterminate=!1):this.table.rowManager.rows.length===this.selectedRows.length?(this.headerCheckboxElement.checked=!0,this.headerCheckboxElement.indeterminate=!1):(this.headerCheckboxElement.indeterminate=!0,this.headerCheckboxElement.checked=!1)),e||(Array.isArray(t)||(t=[t]),t=t.map(n=>n.getComponent()),Array.isArray(i)||(i=[i]),i=i.map(n=>n.getComponent()),this.dispatchExternal("rowSelectionChanged",this.getSelectedData(),this.getSelectedRows(),t,i))}registerRowSelectCheckbox(e,t){e._row.modules.select||(e._row.modules.select={}),e._row.modules.select.checkboxEl=t}registerHeaderSelectCheckbox(e){this.headerCheckboxElement=e}childRowSelection(e,t){var i=this.table.modules.dataTree.getChildren(e,!0,!0);if(t)for(let n of i)this._selectRow(n,!0);else for(let n of i)this._deselectRow(n,!0)}}G(Ko,"moduleName","selectRow"),G(Ko,"moduleExtensions",V1);class U1{constructor(e){return this._range=e,new Proxy(this,{get:function(t,i,n){return typeof t[i]<"u"?t[i]:t._range.table.componentFunctionBinder.handle("range",t._range,i)}})}getElement(){return this._range.element}getData(){return this._range.getData()}getCells(){return this._range.getCells(!0,!0)}getStructuredCells(){return this._range.getStructuredCells()}getRows(){return this._range.getRows().map(e=>e.getComponent())}getColumns(){return this._range.getColumns().map(e=>e.getComponent())}getBounds(){return this._range.getBounds()}getTopEdge(){return this._range.top}getBottomEdge(){return this._range.bottom}getLeftEdge(){return this._range.left}getRightEdge(){return this._range.right}setBounds(e,t){this._range.destroyedGuard("setBounds")&&this._range.setBounds(e&&e._cell,t&&t._cell)}setStartBound(e){this._range.destroyedGuard("setStartBound")&&(this._range.setEndBound(e&&e._cell),this._range.rangeManager.layoutElement())}setEndBound(e){this._range.destroyedGuard("setEndBound")&&(this._range.setEndBound(e&&e._cell),this._range.rangeManager.layoutElement())}clearValues(){this._range.destroyedGuard("clearValues")&&this._range.clearValues()}remove(){this._range.destroyedGuard("remove")&&this._range.destroy(!0)}}class G1 extends At{constructor(e,t,i,n){super(e),this.rangeManager=t,this.element=null,this.initialized=!1,this.initializing={start:!1,end:!1},this.destroyed=!1,this.top=0,this.bottom=0,this.left=0,this.right=0,this.table=e,this.start={row:0,col:0},this.end={row:0,col:0},this.rangeManager.rowHeader&&(this.left=1,this.right=1,this.start.col=1,this.end.col=1),this.initElement(),setTimeout(()=>{this.initBounds(i,n)})}initElement(){this.element=document.createElement("div"),this.element.classList.add("tabulator-range")}initBounds(e,t){this._updateMinMax(),e&&this.setBounds(e,t||e)}setStart(e,t){(this.start.row!==e||this.start.col!==t)&&(this.start.row=e,this.start.col=t,this.initializing.start=!0,this._updateMinMax())}setEnd(e,t){(this.end.row!==e||this.end.col!==t)&&(this.end.row=e,this.end.col=t,this.initializing.end=!0,this._updateMinMax())}setBounds(e,t,i){e&&this.setStartBound(e),this.setEndBound(t||e),this.rangeManager.layoutElement(i)}setStartBound(e){var t,i;e.type==="column"?this.rangeManager.columnSelection&&this.setStart(0,e.getPosition()-1):(t=e.row.position-1,i=e.column.getPosition()-1,e.column===this.rangeManager.rowHeader?this.setStart(t,1):this.setStart(t,i))}setEndBound(e){var t=this._getTableRows().length,i,n,s;e.type==="column"?this.rangeManager.columnSelection&&(this.rangeManager.selecting==="column"?this.setEnd(t-1,e.getPosition()-1):this.rangeManager.selecting==="cell"&&this.setEnd(0,e.getPosition()-1)):(i=e.row.position-1,n=e.column.getPosition()-1,s=e.column===this.rangeManager.rowHeader,this.rangeManager.selecting==="row"?this.setEnd(i,this._getTableColumns().length-1):this.rangeManager.selecting!=="row"&&s?this.setEnd(i,0):this.rangeManager.selecting==="column"?this.setEnd(t-1,n):this.setEnd(i,n))}_updateMinMax(){this.top=Math.min(this.start.row,this.end.row),this.bottom=Math.max(this.start.row,this.end.row),this.left=Math.min(this.start.col,this.end.col),this.right=Math.max(this.start.col,this.end.col),this.initialized?this.dispatchExternal("rangeChanged",this.getComponent()):this.initializing.start&&this.initializing.end&&(this.initialized=!0,this.dispatchExternal("rangeAdded",this.getComponent()))}_getTableColumns(){return this.table.columnManager.getVisibleColumnsByIndex()}_getTableRows(){return this.table.rowManager.getDisplayRows().filter(e=>e.type==="row")}layout(){var e=this.table.rowManager.renderer.vDomTop,t=this.table.rowManager.renderer.vDomBottom,i=this.table.columnManager.renderer.leftCol,n=this.table.columnManager.renderer.rightCol,s,a,o,l,h,u,d,c,f,p;this.table.options.renderHorizontal==="virtual"&&this.rangeManager.rowHeader&&(n+=1),e==null&&(e=0),t==null&&(t=1/0),i==null&&(i=0),n==null&&(n=1/0),this.overlaps(i,e,n,t)&&(s=Math.max(this.top,e),a=Math.min(this.bottom,t),o=Math.max(this.left,i),l=Math.min(this.right,n),h=this.rangeManager.getCell(s,o),u=this.rangeManager.getCell(a,l),d=h.getElement(),c=u.getElement(),f=h.row.getElement(),p=u.row.getElement(),this.element.classList.add("tabulator-range-active"),this.table.rtl?(this.element.style.right=f.offsetWidth-d.offsetLeft-d.offsetWidth+"px",this.element.style.width=d.offsetLeft+d.offsetWidth-c.offsetLeft+"px"):(this.element.style.left=f.offsetLeft+d.offsetLeft+"px",this.element.style.width=c.offsetLeft+c.offsetWidth-d.offsetLeft+"px"),this.element.style.top=f.offsetTop+"px",this.element.style.height=p.offsetTop+p.offsetHeight-f.offsetTop+"px")}atTopLeft(e){return e.row.position-1===this.top&&e.column.getPosition()-1===this.left}atBottomRight(e){return e.row.position-1===this.bottom&&e.column.getPosition()-1===this.right}occupies(e){return this.occupiesRow(e.row)&&this.occupiesColumn(e.column)}occupiesRow(e){return this.top<=e.position-1&&e.position-1<=this.bottom}occupiesColumn(e){return this.left<=e.getPosition()-1&&e.getPosition()-1<=this.right}overlaps(e,t,i,n){return!(this.left>i||e>this.right||this.top>n||t>this.bottom)}getData(){var e=[],t=this.getRows(),i=this.getColumns();return t.forEach(n=>{var s=n.getData(),a={};i.forEach(o=>{a[o.field]=s[o.field]}),e.push(a)}),e}getCells(e,t){var i=[],n=this.getRows(),s=this.getColumns();return e?i=n.map(a=>{var o=[];return a.getCells().forEach(l=>{s.includes(l.column)&&o.push(t?l.getComponent():l)}),o}):n.forEach(a=>{a.getCells().forEach(o=>{s.includes(o.column)&&i.push(t?o.getComponent():o)})}),i}getStructuredCells(){return this.getCells(!0,!0)}getRows(){return this._getTableRows().slice(this.top,this.bottom+1)}getColumns(){return this._getTableColumns().slice(this.left,this.right+1)}clearValues(){var e=this.getCells(),t=this.table.options.selectableRangeClearCellsValue;this.table.blockRedraw(),e.forEach(i=>{i.setValue(t)}),this.table.restoreRedraw()}getBounds(e){var t=this.getCells(!1,e),i={start:null,end:null};return t.length?(i.start=t[0],i.end=t[t.length-1]):console.warn("No bounds defined on range"),i}getComponent(){return this.component||(this.component=new U1(this)),this.component}destroy(e){this.destroyed=!0,this.element.remove(),e&&this.rangeManager.rangeRemoved(this),this.initialized&&this.dispatchExternal("rangeRemoved",this.getComponent())}destroyedGuard(e){return this.destroyed&&console.warn("You cannot call the "+e+" function on a destroyed range"),!this.destroyed}}var Y1={rangeJumpUp:["ctrl + 38","meta + 38"],rangeJumpDown:["ctrl + 40","meta + 40"],rangeJumpLeft:["ctrl + 37","meta + 37"],rangeJumpRight:["ctrl + 39","meta + 39"],rangeExpandUp:"shift + 38",rangeExpandDown:"shift + 40",rangeExpandLeft:"shift + 37",rangeExpandRight:"shift + 39",rangeExpandJumpUp:["ctrl + shift + 38","meta + shift + 38"],rangeExpandJumpDown:["ctrl + shift + 40","meta + shift + 40"],rangeExpandJumpLeft:["ctrl + shift + 37","meta + shift + 37"],rangeExpandJumpRight:["ctrl + shift + 39","meta + shift + 39"]},j1={rangeJumpLeft:function(r){this.dispatch("keybinding-nav-range",r,"left",!0,!1)},rangeJumpRight:function(r){this.dispatch("keybinding-nav-range",r,"right",!0,!1)},rangeJumpUp:function(r){this.dispatch("keybinding-nav-range",r,"up",!0,!1)},rangeJumpDown:function(r){this.dispatch("keybinding-nav-range",r,"down",!0,!1)},rangeExpandLeft:function(r){this.dispatch("keybinding-nav-range",r,"left",!1,!0)},rangeExpandRight:function(r){this.dispatch("keybinding-nav-range",r,"right",!1,!0)},rangeExpandUp:function(r){this.dispatch("keybinding-nav-range",r,"up",!1,!0)},rangeExpandDown:function(r){this.dispatch("keybinding-nav-range",r,"down",!1,!0)},rangeExpandJumpLeft:function(r){this.dispatch("keybinding-nav-range",r,"left",!0,!0)},rangeExpandJumpRight:function(r){this.dispatch("keybinding-nav-range",r,"right",!0,!0)},rangeExpandJumpUp:function(r){this.dispatch("keybinding-nav-range",r,"up",!0,!0)},rangeExpandJumpDown:function(r){this.dispatch("keybinding-nav-range",r,"down",!0,!0)}},X1={range:function(r){var e=[],t=this.table.modules.selectRange.activeRange,i=!1,n,s,a,o,l;return l=r.length,t&&(n=t.getBounds(),s=n.start,n.start===n.end&&(i=!0),s&&(e=this.table.rowManager.activeRows.slice(),a=e.indexOf(s.row),i?o=r.length:o=e.indexOf(n.end.row)-a+1,a>-1&&(this.table.blockRedraw(),e=e.slice(a,a+o),e.forEach((h,u)=>{h.updateData(r[u%l])}),this.table.restoreRedraw()))),e}},$1={range:function(r){var e=[],t=[],i=this.table.modules.selectRange.activeRange,n=!1,s,a,o,l,h;return i&&(s=i.getBounds(),a=s.start,s.start===s.end&&(n=!0),a&&(r=r.split(`
`),r.forEach(function(u){e.push(u.split("	"))}),e.length&&(l=this.table.columnManager.getVisibleColumnsByIndex(),h=l.indexOf(a.column),h>-1)))?(n?o=e[0].length:o=l.indexOf(s.end.column)-h+1,l=l.slice(h,h+o),e.forEach(u=>{var d={},c=u.length;l.forEach(function(f,p){d[f.field]=u[p%c]}),t.push(d)}),t):!1}},K1={range:function(){var r=this.modules.selectRange.selectedColumns();return this.columnManager.rowHeader&&r.unshift(this.columnManager.rowHeader),r}},Q1={range:function(){return this.modules.selectRange.selectedRows()}},q1={keybindings:{bindings:Y1,actions:j1},clipboard:{pasteActions:X1,pasteParsers:$1},export:{columnLookups:K1,rowLookups:Q1}};class Gs extends ke{constructor(e){super(e),this.selecting="cell",this.mousedown=!1,this.ranges=[],this.overlay=null,this.rowHeader=null,this.layoutChangeTimeout=null,this.columnSelection=!1,this.rowSelection=!1,this.maxRanges=0,this.activeRange=!1,this.blockKeydown=!1,this.keyDownEvent=this._handleKeyDown.bind(this),this.mouseUpEvent=this._handleMouseUp.bind(this),this.registerTableOption("selectableRange",!1),this.registerTableOption("selectableRangeColumns",!1),this.registerTableOption("selectableRangeRows",!1),this.registerTableOption("selectableRangeClearCells",!1),this.registerTableOption("selectableRangeClearCellsValue",void 0),this.registerTableOption("selectableRangeAutoFocus",!0),this.registerTableFunction("getRangesData",this.getRangesData.bind(this)),this.registerTableFunction("getRanges",this.getRanges.bind(this)),this.registerTableFunction("addRange",this.addRangeFromComponent.bind(this)),this.registerComponentFunction("cell","getRanges",this.cellGetRanges.bind(this)),this.registerComponentFunction("row","getRanges",this.rowGetRanges.bind(this)),this.registerComponentFunction("column","getRanges",this.colGetRanges.bind(this))}initialize(){this.options("selectableRange")&&(this.options("selectableRows")?console.warn("SelectRange functionality cannot be used in conjunction with row selection"):(this.maxRanges=this.options("selectableRange"),this.initializeTable(),this.initializeWatchers()),this.options("columns").findIndex(e=>e.frozen)>0&&console.warn("Having frozen column in arbitrary position with selectRange option may result in unpredictable behavior."),this.options("columns").filter(e=>e.frozen)>1&&console.warn("Having multiple frozen columns with selectRange option may result in unpredictable behavior."))}initializeTable(){this.overlay=document.createElement("div"),this.overlay.classList.add("tabulator-range-overlay"),this.rangeContainer=document.createElement("div"),this.rangeContainer.classList.add("tabulator-range-container"),this.activeRangeCellElement=document.createElement("div"),this.activeRangeCellElement.classList.add("tabulator-range-cell-active"),this.overlay.appendChild(this.rangeContainer),this.overlay.appendChild(this.activeRangeCellElement),this.table.rowManager.element.addEventListener("keydown",this.keyDownEvent),this.resetRanges(),this.table.rowManager.element.appendChild(this.overlay),this.table.columnManager.element.setAttribute("tabindex",0),this.table.element.classList.add("tabulator-ranges")}initializeWatchers(){this.columnSelection=this.options("selectableRangeColumns"),this.rowSelection=this.options("selectableRangeRows"),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("column-mousedown",this.handleColumnMouseDown.bind(this)),this.subscribe("column-mousemove",this.handleColumnMouseMove.bind(this)),this.subscribe("column-resized",this.handleColumnResized.bind(this)),this.subscribe("column-moving",this.handleColumnMoving.bind(this)),this.subscribe("column-moved",this.handleColumnMoved.bind(this)),this.subscribe("column-width",this.layoutChange.bind(this)),this.subscribe("column-height",this.layoutChange.bind(this)),this.subscribe("column-resized",this.layoutChange.bind(this)),this.subscribe("columns-loaded",this.updateHeaderColumn.bind(this)),this.subscribe("cell-height",this.layoutChange.bind(this)),this.subscribe("cell-rendered",this.renderCell.bind(this)),this.subscribe("cell-mousedown",this.handleCellMouseDown.bind(this)),this.subscribe("cell-mousemove",this.handleCellMouseMove.bind(this)),this.subscribe("cell-click",this.handleCellClick.bind(this)),this.subscribe("cell-editing",this.handleEditingCell.bind(this)),this.subscribe("page-changed",this.redraw.bind(this)),this.subscribe("scroll-vertical",this.layoutChange.bind(this)),this.subscribe("scroll-horizontal",this.layoutChange.bind(this)),this.subscribe("data-destroy",this.tableDestroyed.bind(this)),this.subscribe("data-processed",this.resetRanges.bind(this)),this.subscribe("table-layout",this.layoutElement.bind(this)),this.subscribe("table-redraw",this.redraw.bind(this)),this.subscribe("table-destroy",this.tableDestroyed.bind(this)),this.subscribe("edit-editor-clear",this.finishEditingCell.bind(this)),this.subscribe("edit-blur",this.restoreFocus.bind(this)),this.subscribe("keybinding-nav-prev",this.keyNavigate.bind(this,"left")),this.subscribe("keybinding-nav-next",this.keyNavigate.bind(this,"right")),this.subscribe("keybinding-nav-left",this.keyNavigate.bind(this,"left")),this.subscribe("keybinding-nav-right",this.keyNavigate.bind(this,"right")),this.subscribe("keybinding-nav-up",this.keyNavigate.bind(this,"up")),this.subscribe("keybinding-nav-down",this.keyNavigate.bind(this,"down")),this.subscribe("keybinding-nav-range",this.keyNavigateRange.bind(this))}initializeColumn(e){this.columnSelection&&e.definition.headerSort&&this.options("headerSortClickElement")!=="icon"&&console.warn("Using column headerSort with selectableRangeColumns option may result in unpredictable behavior. Consider using headerSortClickElement: 'icon'."),e.modules.edit}updateHeaderColumn(){var e;this.rowSelection&&(this.rowHeader=this.table.columnManager.getVisibleColumnsByIndex()[0],this.rowHeader&&(this.rowHeader.definition.cssClass=this.rowHeader.definition.cssClass+" tabulator-range-row-header",this.rowHeader.definition.headerSort&&console.warn("Using column headerSort with selectableRangeRows option may result in unpredictable behavior"),this.rowHeader.definition.editor&&console.warn("Using column editor with selectableRangeRows option may result in unpredictable behavior"))),this.table.modules.frozenColumns&&this.table.modules.frozenColumns.active&&(e=this.table.modules.frozenColumns.getFrozenColumns(),(e.length>1||e.length===1&&e[0]!==this.rowHeader)&&console.warn("Using frozen columns that are not the range header in combination with the selectRange option may result in unpredictable behavior"))}getRanges(){return this.ranges.map(e=>e.getComponent())}getRangesData(){return this.ranges.map(e=>e.getData())}addRangeFromComponent(e,t){return e=e?e._cell:null,t=t?t._cell:null,this.addRange(e,t)}cellGetRanges(e){var t=[];return e.column===this.rowHeader?t=this.ranges.filter(i=>i.occupiesRow(e.row)):t=this.ranges.filter(i=>i.occupies(e)),t.map(i=>i.getComponent())}rowGetRanges(e){var t=this.ranges.filter(i=>i.occupiesRow(e));return t.map(i=>i.getComponent())}colGetRanges(e){var t=this.ranges.filter(i=>i.occupiesColumn(e));return t.map(i=>i.getComponent())}_handleMouseUp(e){this.mousedown=!1,document.removeEventListener("mouseup",this.mouseUpEvent)}_handleKeyDown(e){if(!this.blockKeydown&&(!this.table.modules.edit||this.table.modules.edit&&!this.table.modules.edit.currentCell)){if(e.key==="Enter"){if(this.table.modules.edit&&this.table.modules.edit.currentCell)return;this.table.modules.edit.editCell(this.getActiveCell()),e.preventDefault()}(e.key==="Backspace"||e.key==="Delete")&&this.options("selectableRangeClearCells")&&this.activeRange&&this.activeRange.clearValues()}}initializeFocus(e){var t;this.restoreFocus();try{document.selection?(t=document.body.createTextRange(),t.moveToElementText(e.getElement()),t.select()):window.getSelection&&(t=document.createRange(),t.selectNode(e.getElement()),window.getSelection().removeAllRanges(),window.getSelection().addRange(t))}catch{}}restoreFocus(e){return this.table.rowManager.element.focus(),!0}handleColumnResized(e){var t;this.selecting!=="column"&&this.selecting!=="all"||(t=this.ranges.some(i=>i.occupiesColumn(e)),t&&this.ranges.forEach(i=>{var n=i.getColumns(!0);n.forEach(s=>{s!==e&&s.setWidth(e.width)})}))}handleColumnMoving(e,t){this.resetRanges().setBounds(t),this.overlay.style.visibility="hidden"}handleColumnMoved(e,t,i){this.activeRange.setBounds(e),this.layoutElement()}handleColumnMouseDown(e,t){e.button===2&&(this.selecting==="column"||this.selecting==="all")&&this.activeRange.occupiesColumn(t)||this.table.options.movableColumns&&this.selecting==="column"&&this.activeRange.occupiesColumn(t)||(this.mousedown=!0,document.addEventListener("mouseup",this.mouseUpEvent),this.newSelection(e,t))}handleColumnMouseMove(e,t){t===this.rowHeader||!this.mousedown||this.selecting==="all"||this.activeRange.setBounds(!1,t,!0)}renderCell(e){var t=e.getElement(),i=this.ranges.findIndex(n=>n.occupies(e));t.classList.toggle("tabulator-range-selected",i!==-1),t.classList.toggle("tabulator-range-only-cell-selected",this.ranges.length===1&&this.ranges[0].atTopLeft(e)&&this.ranges[0].atBottomRight(e)),t.dataset.range=i}handleCellMouseDown(e,t){e.button===2&&(this.activeRange.occupies(t)||(this.selecting==="row"||this.selecting==="all")&&this.activeRange.occupiesRow(t.row))||(this.mousedown=!0,document.addEventListener("mouseup",this.mouseUpEvent),this.newSelection(e,t))}handleCellMouseMove(e,t){!this.mousedown||this.selecting==="all"||this.activeRange.setBounds(!1,t,!0)}handleCellClick(e,t){this.initializeFocus(t)}handleEditingCell(e){this.activeRange&&this.activeRange.setBounds(e)}finishEditingCell(){this.blockKeydown=!0,this.table.rowManager.element.focus(),setTimeout(()=>{this.blockKeydown=!1},10)}keyNavigate(e,t){this.navigate(!1,!1,e),t.preventDefault()}keyNavigateRange(e,t,i,n){this.navigate(i,n,t),e.preventDefault()}navigate(e,t,i){var n=!1,s,a,o,l,h,u,d,c,f,p,v;if(this.table.modules.edit&&this.table.modules.edit.currentCell)return!1;if(this.ranges.length>1&&(this.ranges=this.ranges.filter(m=>m===this.activeRange?(m.setEnd(m.start.row,m.start.col),!0):(m.destroy(),!1))),s=this.activeRange,o={top:s.top,bottom:s.bottom,left:s.left,right:s.right},a=t?s.end:s.start,l=a.row,h=a.col,e)switch(i){case"left":h=this.findJumpCellLeft(s.start.row,a.col);break;case"right":h=this.findJumpCellRight(s.start.row,a.col);break;case"up":l=this.findJumpCellUp(a.row,s.start.col);break;case"down":l=this.findJumpCellDown(a.row,s.start.col);break}else{if(t&&(this.selecting==="row"&&(i==="left"||i==="right")||this.selecting==="column"&&(i==="up"||i==="down")))return;switch(i){case"left":h=Math.max(h-1,0);break;case"right":h=Math.min(h+1,this.getTableColumns().length-1);break;case"up":l=Math.max(l-1,0);break;case"down":l=Math.min(l+1,this.getTableRows().length-1);break}}if(this.rowHeader&&h===0&&(h=1),t||s.setStart(l,h),s.setEnd(l,h),t||(this.selecting="cell"),n=o.top!==s.top||o.bottom!==s.bottom||o.left!==s.left||o.right!==s.right,n)return u=this.getRowByRangePos(s.end.row),d=this.getColumnByRangePos(s.end.col),c=u.getElement().getBoundingClientRect(),p=d.getElement().getBoundingClientRect(),f=this.table.rowManager.getElement().getBoundingClientRect(),v=this.table.columnManager.getElement().getBoundingClientRect(),c.top>=f.top&&c.bottom<=f.bottom||(u.getElement().parentNode&&d.getElement().parentNode?this.autoScroll(s,u.getElement(),d.getElement()):u.getComponent().scrollTo(void 0,!1)),p.left>=v.left+this.getRowHeaderWidth()&&p.right<=v.right||(u.getElement().parentNode&&d.getElement().parentNode?this.autoScroll(s,u.getElement(),d.getElement()):d.getComponent().scrollTo(void 0,!1)),this.layoutElement(),!0}rangeRemoved(e){this.ranges=this.ranges.filter(t=>t!==e),this.activeRange===e&&(this.ranges.length?this.activeRange=this.ranges[this.ranges.length-1]:this.addRange()),this.layoutElement()}findJumpRow(e,t,i,n,s){return i&&(t=t.reverse()),this.findJumpItem(n,s,t,function(a){return a.getData()[e.getField()]})}findJumpCol(e,t,i,n,s){return i&&(t=t.reverse()),this.findJumpItem(n,s,t,function(a){return e.getData()[a.getField()]})}findJumpItem(e,t,i,n){var s;for(let a of i){let o=n(a);if(e){if(s=a,o)break}else if(t){if(s=a,o)break}else if(o)s=a;else break}return s}findJumpCellLeft(e,t){var i=this.getRowByRangePos(e),n=this.getTableColumns(),s=this.isEmpty(i.getData()[n[t].getField()]),a=n[t-1]?this.isEmpty(i.getData()[n[t-1].getField()]):!1,o=this.rowHeader?n.slice(1,t):n.slice(0,t),l=this.findJumpCol(i,o,!0,s,a);return l?l.getPosition()-1:t}findJumpCellRight(e,t){var i=this.getRowByRangePos(e),n=this.getTableColumns(),s=this.isEmpty(i.getData()[n[t].getField()]),a=n[t+1]?this.isEmpty(i.getData()[n[t+1].getField()]):!1,o=this.findJumpCol(i,n.slice(t+1,n.length),!1,s,a);return o?o.getPosition()-1:t}findJumpCellUp(e,t){var i=this.getColumnByRangePos(t),n=this.getTableRows(),s=this.isEmpty(n[e].getData()[i.getField()]),a=n[e-1]?this.isEmpty(n[e-1].getData()[i.getField()]):!1,o=this.findJumpRow(i,n.slice(0,e),!0,s,a);return o?o.position-1:e}findJumpCellDown(e,t){var i=this.getColumnByRangePos(t),n=this.getTableRows(),s=this.isEmpty(n[e].getData()[i.getField()]),a=n[e+1]?this.isEmpty(n[e+1].getData()[i.getField()]):!1,o=this.findJumpRow(i,n.slice(e+1,n.length),!1,s,a);return o?o.position-1:e}newSelection(e,t){var i;if(t.type==="column"){if(!this.columnSelection)return;if(t===this.rowHeader){i=this.resetRanges(),this.selecting="all";var n,s=this.getCell(-1,-1);this.rowHeader?n=this.getCell(0,1):n=this.getCell(0,0),i.setBounds(n,s);return}else this.selecting="column"}else t.column===this.rowHeader?this.selecting="row":this.selecting="cell";e.shiftKey?this.activeRange.setBounds(!1,t):e.ctrlKey?this.addRange().setBounds(t):this.resetRanges().setBounds(t)}autoScroll(e,t,i){var n=this.table.rowManager.element,s,a,o,l;typeof t>"u"&&(t=this.getRowByRangePos(e.end.row).getElement()),typeof i>"u"&&(i=this.getColumnByRangePos(e.end.col).getElement()),s={left:i.offsetLeft,right:i.offsetLeft+i.offsetWidth,top:t.offsetTop,bottom:t.offsetTop+t.offsetHeight},a={left:n.scrollLeft+this.getRowHeaderWidth(),right:Math.ceil(n.scrollLeft+n.clientWidth),top:n.scrollTop,bottom:n.scrollTop+n.offsetHeight-this.table.rowManager.scrollbarWidth},o=a.left<s.left&&s.left<a.right&&a.left<s.right&&s.right<a.right,l=a.top<s.top&&s.top<a.bottom&&a.top<s.bottom&&s.bottom<a.bottom,o||(s.left<a.left?n.scrollLeft=s.left-this.getRowHeaderWidth():s.right>a.right&&(n.scrollLeft=Math.min(s.right-n.clientWidth,s.left-this.getRowHeaderWidth()))),l||(s.top<a.top?n.scrollTop=s.top:s.bottom>a.bottom&&(n.scrollTop=s.bottom-n.clientHeight))}layoutChange(){this.overlay.style.visibility="hidden",clearTimeout(this.layoutChangeTimeout),this.layoutChangeTimeout=setTimeout(this.layoutRanges.bind(this),200)}redraw(e){e&&(this.selecting="cell",this.resetRanges(),this.layoutElement())}layoutElement(e){var t;e?t=this.table.rowManager.getVisibleRows(!0):t=this.table.rowManager.getRows(),t.forEach(i=>{i.type==="row"&&(this.layoutRow(i),i.cells.forEach(n=>this.renderCell(n)))}),this.getTableColumns().forEach(i=>{this.layoutColumn(i)}),this.layoutRanges()}layoutRow(e){var t=e.getElement(),i=!1,n=this.ranges.some(s=>s.occupiesRow(e));this.selecting==="row"?i=n:this.selecting==="all"&&(i=!0),t.classList.toggle("tabulator-range-selected",i),t.classList.toggle("tabulator-range-highlight",n)}layoutColumn(e){var t=e.getElement(),i=!1,n=this.ranges.some(s=>s.occupiesColumn(e));this.selecting==="column"?i=n:this.selecting==="all"&&(i=!0),t.classList.toggle("tabulator-range-selected",i),t.classList.toggle("tabulator-range-highlight",n)}layoutRanges(){var e,t,i;this.table.initialized&&(e=this.getActiveCell(),e&&(t=e.getElement(),i=e.row.getElement(),this.table.rtl?this.activeRangeCellElement.style.right=i.offsetWidth-t.offsetLeft-t.offsetWidth+"px":this.activeRangeCellElement.style.left=i.offsetLeft+t.offsetLeft+"px",this.activeRangeCellElement.style.top=i.offsetTop+"px",this.activeRangeCellElement.style.width=t.offsetWidth+"px",this.activeRangeCellElement.style.height=i.offsetHeight+"px",this.ranges.forEach(n=>n.layout()),this.overlay.style.visibility="visible"))}getCell(e,t){var i;return t<0&&(t=this.getTableColumns().length+t,t<0)?null:(e<0&&(e=this.getTableRows().length+e),i=this.table.rowManager.getRowFromPosition(e+1),i?i.getCells(!1,!0).filter(n=>n.column.visible)[t]:null)}getActiveCell(){return this.getCell(this.activeRange.start.row,this.activeRange.start.col)}getRowByRangePos(e){return this.getTableRows()[e]}getColumnByRangePos(e){return this.getTableColumns()[e]}getTableRows(){return this.table.rowManager.getDisplayRows().filter(e=>e.type==="row")}getTableColumns(){return this.table.columnManager.getVisibleColumnsByIndex()}addRange(e,t){var i;return this.maxRanges!==!0&&this.ranges.length>=this.maxRanges&&this.ranges.shift().destroy(),i=new G1(this.table,this,e,t),this.activeRange=i,this.ranges.push(i),this.rangeContainer.appendChild(i.element),i}resetRanges(){var e,t,i;return this.ranges.forEach(n=>n.destroy()),this.ranges=[],e=this.addRange(),this.table.rowManager.activeRows.length&&(i=this.table.rowManager.activeRows[0].cells.filter(n=>n.column.visible),t=i[this.rowHeader?1:0],t&&(e.setBounds(t),this.options("selectableRangeAutoFocus")&&this.initializeFocus(t))),e}tableDestroyed(){document.removeEventListener("mouseup",this.mouseUpEvent),this.table.rowManager.element.removeEventListener("keydown",this.keyDownEvent)}selectedRows(e){return e?this.activeRange.getRows().map(t=>t.getComponent()):this.activeRange.getRows()}selectedColumns(e){return e?this.activeRange.getColumns().map(t=>t.getComponent()):this.activeRange.getColumns()}getRowHeaderWidth(){return this.rowHeader?this.rowHeader.getElement().offsetWidth:0}isEmpty(e){return e==null||e===""}}G(Gs,"moduleName","selectRange"),G(Gs,"moduleInitOrder",1),G(Gs,"moduleExtensions",q1);function J1(r,e,t,i,n,s,a){var o=a.alignEmptyValues,l=a.decimalSeparator,h=a.thousandSeparator,u=0;if(r=String(r),e=String(e),h&&(r=r.split(h).join(""),e=e.split(h).join("")),l&&(r=r.split(l).join("."),e=e.split(l).join(".")),r=parseFloat(r),e=parseFloat(e),isNaN(r))u=isNaN(e)?0:-1;else if(isNaN(e))u=1;else return r-e;return(o==="top"&&s==="desc"||o==="bottom"&&s==="asc")&&(u*=-1),u}function Z1(r,e,t,i,n,s,a){var o=a.alignEmptyValues,l=0,h;if(!r)l=e?-1:0;else if(!e)l=1;else{switch(typeof a.locale){case"boolean":a.locale&&(h=this.langLocale());break;case"string":h=a.locale;break}return String(r).toLowerCase().localeCompare(String(e).toLowerCase(),h)}return(o==="top"&&s==="desc"||o==="bottom"&&s==="asc")&&(l*=-1),l}function _l(r,e,t,i,n,s,a){var o=this.table.dependencyRegistry.lookup(["luxon","DateTime"],"DateTime"),l=a.format||"dd/MM/yyyy HH:mm:ss",h=a.alignEmptyValues,u=0;if(typeof o<"u"){if(o.isDateTime(r)||(l==="iso"?r=o.fromISO(String(r)):r=o.fromFormat(String(r),l)),o.isDateTime(e)||(l==="iso"?e=o.fromISO(String(e)):e=o.fromFormat(String(e),l)),!r.isValid)u=e.isValid?-1:0;else if(!e.isValid)u=1;else return r-e;return(h==="top"&&s==="desc"||h==="bottom"&&s==="asc")&&(u*=-1),u}else console.error("Sort Error - 'datetime' sorter is dependant on luxon.js")}function ew(r,e,t,i,n,s,a){return a.format||(a.format="dd/MM/yyyy"),_l.call(this,r,e,t,i,n,s,a)}function tw(r,e,t,i,n,s,a){return a.format||(a.format="HH:mm"),_l.call(this,r,e,t,i,n,s,a)}function iw(r,e,t,i,n,s,a){var o=r===!0||r==="true"||r==="True"||r===1?1:0,l=e===!0||e==="true"||e==="True"||e===1?1:0;return o-l}function rw(r,e,t,i,n,s,a){var o=a.type||"length",l=a.alignEmptyValues,h=0,u=this.table,d;a.valueMap&&(typeof a.valueMap=="string"?d=function(f){return f.map(p=>et.retrieveNestedData(u.options.nestedFieldSeparator,a.valueMap,p))}:d=a.valueMap);function c(f){var p;switch(d&&(f=d(f)),o){case"length":p=f.length;break;case"sum":p=f.reduce(function(v,m){return v+m});break;case"max":p=Math.max.apply(null,f);break;case"min":p=Math.min.apply(null,f);break;case"avg":p=f.reduce(function(v,m){return v+m})/f.length;break;case"string":p=f.join("");break}return p}if(!Array.isArray(r))h=Array.isArray(e)?-1:0;else if(!Array.isArray(e))h=1;else return o==="string"?String(c(r)).toLowerCase().localeCompare(String(c(e)).toLowerCase()):c(e)-c(r);return(l==="top"&&s==="desc"||l==="bottom"&&s==="asc")&&(h*=-1),h}function nw(r,e,t,i,n,s,a){var o=typeof r>"u"?0:1,l=typeof e>"u"?0:1;return o-l}function sw(r,e,t,i,n,s,a){var o,l,h,u,d=0,c,f=/(\d+)|(\D+)/g,p=/\d/,v=a.alignEmptyValues,m=0;if(!r&&r!==0)m=!e&&e!==0?0:-1;else if(!e&&e!==0)m=1;else{if(isFinite(r)&&isFinite(e))return r-e;if(o=String(r).toLowerCase(),l=String(e).toLowerCase(),o===l)return 0;if(!(p.test(o)&&p.test(l)))return o>l?1:-1;for(o=o.match(f),l=l.match(f),c=o.length>l.length?l.length:o.length;d<c;)if(h=o[d],u=l[d++],h!==u)return isFinite(h)&&isFinite(u)?(h.charAt(0)==="0"&&(h="."+h),u.charAt(0)==="0"&&(u="."+u),h-u):h>u?1:-1;return o.length>l.length}return(v==="top"&&s==="desc"||v==="bottom"&&s==="asc")&&(m*=-1),m}var aw={number:J1,string:Z1,date:ew,time:tw,datetime:_l,boolean:iw,array:rw,exists:nw,alphanum:sw};const Mr=class Mr extends ke{constructor(e){super(e),this.sortList=[],this.changed=!1,this.registerTableOption("sortMode","local"),this.registerTableOption("initialSort",!1),this.registerTableOption("columnHeaderSortMulti",!0),this.registerTableOption("sortOrderReverse",!1),this.registerTableOption("headerSortElement","<div class='tabulator-arrow'></div>"),this.registerTableOption("headerSortClickElement","header"),this.registerColumnOption("sorter"),this.registerColumnOption("sorterParams"),this.registerColumnOption("headerSort",!0),this.registerColumnOption("headerSortStartingDir"),this.registerColumnOption("headerSortTristate")}initialize(){this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("table-built",this.tableBuilt.bind(this)),this.registerDataHandler(this.sort.bind(this),20),this.registerTableFunction("setSort",this.userSetSort.bind(this)),this.registerTableFunction("getSorters",this.getSort.bind(this)),this.registerTableFunction("clearSort",this.clearSort.bind(this)),this.table.options.sortMode==="remote"&&this.subscribe("data-params",this.remoteSortParams.bind(this))}tableBuilt(){this.table.options.initialSort&&this.setSort(this.table.options.initialSort)}remoteSortParams(e,t,i,n){var s=this.getSort();return s.forEach(a=>{delete a.column}),n.sort=s,n}userSetSort(e,t){this.setSort(e,t),this.refreshSort()}clearSort(){this.clear(),this.refreshSort()}initializeColumn(e){var t=!1,i,n;switch(typeof e.definition.sorter){case"string":Mr.sorters[e.definition.sorter]?t=Mr.sorters[e.definition.sorter]:console.warn("Sort Error - No such sorter found: ",e.definition.sorter);break;case"function":t=e.definition.sorter;break}if(e.modules.sort={sorter:t,dir:"none",params:e.definition.sorterParams||{},startingDir:e.definition.headerSortStartingDir||"asc",tristate:e.definition.headerSortTristate},e.definition.headerSort!==!1){switch(i=e.getElement(),i.classList.add("tabulator-sortable"),n=document.createElement("div"),n.classList.add("tabulator-col-sorter"),this.table.options.headerSortClickElement){case"icon":n.classList.add("tabulator-col-sorter-element");break;case"header":i.classList.add("tabulator-col-sorter-element");break;default:i.classList.add("tabulator-col-sorter-element");break}switch(this.table.options.headerSortElement){case"function":break;case"object":n.appendChild(this.table.options.headerSortElement);break;default:n.innerHTML=this.table.options.headerSortElement}e.titleHolderElement.appendChild(n),e.modules.sort.element=n,this.setColumnHeaderSortIcon(e,"none"),this.table.options.headerSortClickElement==="icon"&&n.addEventListener("mousedown",s=>{s.stopPropagation()}),(this.table.options.headerSortClickElement==="icon"?n:i).addEventListener("click",s=>{var a="",o=[],l=!1;if(e.modules.sort){if(e.modules.sort.tristate)e.modules.sort.dir=="none"?a=e.modules.sort.startingDir:e.modules.sort.dir==e.modules.sort.startingDir?a=e.modules.sort.dir=="asc"?"desc":"asc":a="none";else switch(e.modules.sort.dir){case"asc":a="desc";break;case"desc":a="asc";break;default:a=e.modules.sort.startingDir}this.table.options.columnHeaderSortMulti&&(s.shiftKey||s.ctrlKey)?(o=this.getSort(),l=o.findIndex(h=>h.field===e.getField()),l>-1?(o[l].dir=a,l=o.splice(l,1)[0],a!="none"&&o.push(l)):a!="none"&&o.push({column:e,dir:a}),this.setSort(o)):a=="none"?this.clear():this.setSort(e,a),this.refreshSort()}})}}refreshSort(){this.table.options.sortMode==="remote"?this.reloadData(null,!1,!1):this.refreshData(!0)}hasChanged(){var e=this.changed;return this.changed=!1,e}getSort(){var e=this,t=[];return e.sortList.forEach(function(i){i.column&&t.push({column:i.column.getComponent(),field:i.column.getField(),dir:i.dir})}),t}setSort(e,t){var i=this,n=[];Array.isArray(e)||(e=[{column:e,dir:t}]),e.forEach(function(s){var a;a=i.table.columnManager.findColumn(s.column),a?(s.column=a,n.push(s),i.changed=!0):console.warn("Sort Warning - Sort field does not exist and is being ignored: ",s.column)}),i.sortList=n,this.dispatch("sort-changed")}clear(){this.setSort([])}findSorter(e){var t=this.table.rowManager.activeRows[0],i="string",n,s;if(t&&(t=t.getData(),n=e.getField(),n))switch(s=e.getFieldValue(t),typeof s){case"undefined":i="string";break;case"boolean":i="boolean";break;default:!isNaN(s)&&s!==""?i="number":s.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)&&(i="alphanum");break}return Mr.sorters[i]}sort(e,t){var i=this,n=this.table.options.sortOrderReverse?i.sortList.slice().reverse():i.sortList,s=[],a=[];return this.subscribedExternal("dataSorting")&&this.dispatchExternal("dataSorting",i.getSort()),t||i.clearColumnHeaders(),this.table.options.sortMode!=="remote"?(n.forEach(function(o,l){var h;o.column&&(h=o.column.modules.sort,h&&(h.sorter||(h.sorter=i.findSorter(o.column)),o.params=typeof h.params=="function"?h.params(o.column.getComponent(),o.dir):h.params,s.push(o)),t||i.setColumnHeader(o.column,o.dir))}),s.length&&i._sortItems(e,s)):t||n.forEach(function(o,l){i.setColumnHeader(o.column,o.dir)}),this.subscribedExternal("dataSorted")&&(e.forEach(o=>{a.push(o.getComponent())}),this.dispatchExternal("dataSorted",i.getSort(),a)),e}clearColumnHeaders(){this.table.columnManager.getRealColumns().forEach(e=>{e.modules.sort&&(e.modules.sort.dir="none",e.getElement().setAttribute("aria-sort","none"),this.setColumnHeaderSortIcon(e,"none"))})}setColumnHeader(e,t){e.modules.sort.dir=t,e.getElement().setAttribute("aria-sort",t==="asc"?"ascending":"descending"),this.setColumnHeaderSortIcon(e,t)}setColumnHeaderSortIcon(e,t){var i=e.modules.sort.element,n;if(e.definition.headerSort&&typeof this.table.options.headerSortElement=="function"){for(;i.firstChild;)i.removeChild(i.firstChild);n=this.table.options.headerSortElement.call(this.table,e.getComponent(),t),typeof n=="object"?i.appendChild(n):i.innerHTML=n}}_sortItems(e,t){var i=t.length-1;e.sort((n,s)=>{for(var a,o=i;o>=0;o--){let l=t[o];if(a=this._sortRow(n,s,l.column,l.dir,l.params),a!==0)break}return a})}_sortRow(e,t,i,n,s){var a,o,l=n=="asc"?e:t,h=n=="asc"?t:e;return e=i.getFieldValue(l.getData()),t=i.getFieldValue(h.getData()),e=typeof e<"u"?e:"",t=typeof t<"u"?t:"",a=l.getComponent(),o=h.getComponent(),i.modules.sort.sorter.call(this,e,t,a,o,i.getComponent(),n,s)}};G(Mr,"moduleName","sort"),G(Mr,"sorters",aw);let Qo=Mr;class ow{constructor(e,t){this.columnCount=e,this.rowCount=t,this.columnString=[],this.columns=[],this.rows=[]}genColumns(e){var t=Math.max(this.columnCount,Math.max(...e.map(i=>i.length)));this.columnString=[],this.columns=[];for(let i=1;i<=t;i++)this.incrementChar(this.columnString.length-1),this.columns.push(this.columnString.join(""));return this.columns}genRows(e){var t=Math.max(this.rowCount,e.length);this.rows=[];for(let i=1;i<=t;i++)this.rows.push(i);return this.rows}incrementChar(e){let t=this.columnString[e];t?t!=="Z"?this.columnString[e]=String.fromCharCode(this.columnString[e].charCodeAt(0)+1):(this.columnString[e]="A",e?this.incrementChar(e-1):this.columnString.push("A")):this.columnString.push("A")}setRowCount(e){this.rowCount=e}setColumnCount(e){this.columnCount=e}}class Mc{constructor(e){return this._sheet=e,new Proxy(this,{get:function(t,i,n){return typeof t[i]<"u"?t[i]:t._sheet.table.componentFunctionBinder.handle("sheet",t._sheet,i)}})}getTitle(){return this._sheet.title}getKey(){return this._sheet.key}getDefinition(){return this._sheet.getDefinition()}getData(){return this._sheet.getData()}setData(e){return this._sheet.setData(e)}clear(){return this._sheet.clear()}remove(){return this._sheet.remove()}active(){return this._sheet.active()}setTitle(e){return this._sheet.setTitle(e)}setRows(e){return this._sheet.setRows(e)}setColumns(e){return this._sheet.setColumns(e)}}class Oh extends At{constructor(e,t){super(e.table),this.spreadsheetManager=e,this.definition=t,this.title=this.definition.title||"",this.key=this.definition.key||this.definition.title,this.rowCount=this.definition.rows,this.columnCount=this.definition.columns,this.data=this.definition.data||[],this.element=null,this.isActive=!1,this.grid=new ow(this.columnCount,this.rowCount),this.defaultColumnDefinition={width:100,headerHozAlign:"center",headerSort:!1},this.columnDefinition=Object.assign(this.defaultColumnDefinition,this.options("spreadsheetColumnDefinition")),this.columnDefs=[],this.rowDefs=[],this.columnFields=[],this.columns=[],this.rows=[],this.scrollTop=null,this.scrollLeft=null,this.initialize(),this.dispatchExternal("sheetAdded",this.getComponent())}initialize(){this.initializeElement(),this.initializeColumns(),this.initializeRows()}reinitialize(){this.initializeColumns(),this.initializeRows()}initializeElement(){this.element=document.createElement("div"),this.element.classList.add("tabulator-spreadsheet-tab"),this.element.innerText=this.title,this.element.addEventListener("click",()=>{this.spreadsheetManager.loadSheet(this)})}initializeColumns(){this.grid.setColumnCount(this.columnCount),this.columnFields=this.grid.genColumns(this.data),this.columnDefs=[],this.columnFields.forEach(e=>{var t=Object.assign({},this.columnDefinition);t.field=e,t.title=e,this.columnDefs.push(t)})}initializeRows(){var e;this.grid.setRowCount(this.rowCount),e=this.grid.genRows(this.data),this.rowDefs=[],e.forEach((t,i)=>{var n={_id:t},s=this.data[i];s&&s.forEach((a,o)=>{var l=this.columnFields[o];l&&(n[l]=a)}),this.rowDefs.push(n)})}unload(){this.isActive=!1,this.scrollTop=this.table.rowManager.scrollTop,this.scrollLeft=this.table.rowManager.scrollLeft,this.data=this.getData(!0),this.element.classList.remove("tabulator-spreadsheet-tab-active")}load(){var e=!this.isActive;this.isActive=!0,this.table.blockRedraw(),this.table.setData([]),this.table.setColumns(this.columnDefs),this.table.setData(this.rowDefs),this.table.restoreRedraw(),e&&this.scrollTop!==null&&(this.table.rowManager.element.scrollLeft=this.scrollLeft,this.table.rowManager.element.scrollTop=this.scrollTop),this.element.classList.add("tabulator-spreadsheet-tab-active"),this.dispatchExternal("sheetLoaded",this.getComponent())}getComponent(){return new Mc(this)}getDefinition(){return{title:this.title,key:this.key,rows:this.rowCount,columns:this.columnCount,data:this.getData()}}getData(e){var t=[],i,n,s;return this.rowDefs.forEach(a=>{var o=[];this.columnFields.forEach(l=>{o.push(a[l])}),t.push(o)}),!e&&!this.options("spreadsheetOutputFull")&&(i=t.map(a=>a.findLastIndex(o=>typeof o<"u")+1),n=Math.max(...i),s=i.findLastIndex(a=>a>0)+1,t=t.slice(0,s),t=t.map(a=>a.slice(0,n))),t}setData(e){this.data=e,this.reinitialize(),this.dispatchExternal("sheetUpdated",this.getComponent()),this.isActive&&this.load()}clear(){this.setData([])}setTitle(e){this.title=e,this.element.innerText=e,this.dispatchExternal("sheetUpdated",this.getComponent())}setRows(e){this.rowCount=e,this.initializeRows(),this.dispatchExternal("sheetUpdated",this.getComponent()),this.isActive&&this.load()}setColumns(e){this.columnCount=e,this.reinitialize(),this.dispatchExternal("sheetUpdated",this.getComponent()),this.isActive&&this.load()}remove(){this.spreadsheetManager.removeSheet(this)}destroy(){this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.dispatchExternal("sheetRemoved",this.getComponent())}active(){this.spreadsheetManager.loadSheet(this)}}class Ac extends ke{constructor(e){super(e),this.sheets=[],this.element=null,this.registerTableOption("spreadsheet",!1),this.registerTableOption("spreadsheetRows",50),this.registerTableOption("spreadsheetColumns",50),this.registerTableOption("spreadsheetColumnDefinition",{}),this.registerTableOption("spreadsheetOutputFull",!1),this.registerTableOption("spreadsheetData",!1),this.registerTableOption("spreadsheetSheets",!1),this.registerTableOption("spreadsheetSheetTabs",!1),this.registerTableOption("spreadsheetSheetTabsElement",!1),this.registerTableFunction("setSheets",this.setSheets.bind(this)),this.registerTableFunction("addSheet",this.addSheet.bind(this)),this.registerTableFunction("getSheets",this.getSheets.bind(this)),this.registerTableFunction("getSheetDefinitions",this.getSheetDefinitions.bind(this)),this.registerTableFunction("setSheetData",this.setSheetData.bind(this)),this.registerTableFunction("getSheet",this.getSheet.bind(this)),this.registerTableFunction("getSheetData",this.getSheetData.bind(this)),this.registerTableFunction("clearSheet",this.clearSheet.bind(this)),this.registerTableFunction("removeSheet",this.removeSheetFunc.bind(this)),this.registerTableFunction("activeSheet",this.activeSheetFunc.bind(this))}initialize(){this.options("spreadsheet")&&(this.subscribe("table-initialized",this.tableInitialized.bind(this)),this.subscribe("data-loaded",this.loadRemoteData.bind(this)),this.table.options.index="_id",this.options("spreadsheetData")&&this.options("spreadsheetSheets")&&(console.warn("You cannot use spreadsheetData and spreadsheetSheets at the same time, ignoring spreadsheetData"),this.table.options.spreadsheetData=!1),this.compatibilityCheck(),this.options("spreadsheetSheetTabs")&&this.initializeTabset())}compatibilityCheck(){this.options("data")&&console.warn("Do not use the data option when working with spreadsheets, use either spreadsheetData or spreadsheetSheets to pass data into the table"),this.options("pagination")&&console.warn("The spreadsheet module is not compatible with the pagination module"),this.options("groupBy")&&console.warn("The spreadsheet module is not compatible with the row grouping module"),this.options("responsiveCollapse")&&console.warn("The spreadsheet module is not compatible with the responsive collapse module")}initializeTabset(){this.element=document.createElement("div"),this.element.classList.add("tabulator-spreadsheet-tabs");var e=this.options("spreadsheetSheetTabsElement");e&&!(e instanceof HTMLElement)&&(e=document.querySelector(e),e||console.warn("Unable to find element matching spreadsheetSheetTabsElement selector:",this.options("spreadsheetSheetTabsElement"))),e?e.appendChild(this.element):this.footerAppend(this.element)}tableInitialized(){this.sheets.length?this.loadSheet(this.sheets[0]):this.options("spreadsheetSheets")?this.loadSheets(this.options("spreadsheetSheets")):this.options("spreadsheetData")&&this.loadData(this.options("spreadsheetData"))}loadRemoteData(e,t,i){return console.log("data",e,t,i),Array.isArray(e)?(this.table.dataLoader.clearAlert(),this.dispatchExternal("dataLoaded",e),!e.length||Array.isArray(e[0])?this.loadData(e):this.loadSheets(e)):console.error(`Spreadsheet Loading Error - Unable to process remote data due to invalid data type 
Expecting: array 
Received: `,typeof e,`
Data:     `,e),!1}loadData(e){var t={data:e};this.loadSheet(this.newSheet(t))}destroySheets(){this.sheets.forEach(e=>{e.destroy()}),this.sheets=[],this.activeSheet=null}loadSheets(e){Array.isArray(e)||(e=[]),this.destroySheets(),e.forEach(t=>{this.newSheet(t)}),this.loadSheet(this.sheets[0])}loadSheet(e){this.activeSheet!==e&&(this.activeSheet&&this.activeSheet.unload(),this.activeSheet=e,e.load())}newSheet(e={}){var t;return e.rows||(e.rows=this.options("spreadsheetRows")),e.columns||(e.columns=this.options("spreadsheetColumns")),t=new Oh(this,e),this.sheets.push(t),this.element&&this.element.appendChild(t.element),t}removeSheet(e){var t=this.sheets.indexOf(e),i;this.sheets.length>1?t>-1&&(this.sheets.splice(t,1),e.destroy(),this.activeSheet===e&&(i=this.sheets[t-1]||this.sheets[0],i?this.loadSheet(i):this.activeSheet=null)):console.warn("Unable to remove sheet, at least one sheet must be active")}lookupSheet(e){return e?e instanceof Oh?e:e instanceof Mc?e._sheet:this.sheets.find(t=>t.key===e)||!1:this.activeSheet}setSheets(e){return this.loadSheets(e),this.getSheets()}addSheet(e){return this.newSheet(e).getComponent()}getSheetDefinitions(){return this.sheets.map(e=>e.getDefinition())}getSheets(){return this.sheets.map(e=>e.getComponent())}getSheet(e){var t=this.lookupSheet(e);return t?t.getComponent():!1}setSheetData(e,t){e&&!t&&(t=e,e=!1);var i=this.lookupSheet(e);return i?i.setData(t):!1}getSheetData(e){var t=this.lookupSheet(e);return t?t.getData():!1}clearSheet(e){var t=this.lookupSheet(e);return t?t.clear():!1}removeSheetFunc(e){var t=this.lookupSheet(e);t&&this.removeSheet(t)}activeSheetFunc(e){var t=this.lookupSheet(e);return t?this.loadSheet(t):!1}}G(Ac,"moduleName","spreadsheet");class Oc extends ke{constructor(e){super(e),this.tooltipSubscriber=null,this.headerSubscriber=null,this.timeout=null,this.popupInstance=null,this.registerTableOption("tooltipDelay",300),this.registerColumnOption("tooltip"),this.registerColumnOption("headerTooltip")}initialize(){this.deprecatedOptionsCheck(),this.subscribe("column-init",this.initializeColumn.bind(this))}deprecatedOptionsCheck(){}initializeColumn(e){e.definition.headerTooltip&&!this.headerSubscriber&&(this.headerSubscriber=!0,this.subscribe("column-mousemove",this.mousemoveCheck.bind(this,"headerTooltip")),this.subscribe("column-mouseout",this.mouseoutCheck.bind(this,"headerTooltip"))),e.definition.tooltip&&!this.tooltipSubscriber&&(this.tooltipSubscriber=!0,this.subscribe("cell-mousemove",this.mousemoveCheck.bind(this,"tooltip")),this.subscribe("cell-mouseout",this.mouseoutCheck.bind(this,"tooltip")))}mousemoveCheck(e,t,i){var n=e==="tooltip"?i.column.definition.tooltip:i.definition.headerTooltip;n&&(this.clearPopup(),this.timeout=setTimeout(this.loadTooltip.bind(this,t,i,n),this.table.options.tooltipDelay))}mouseoutCheck(e,t,i){this.popupInstance||this.clearPopup()}clearPopup(e,t,i){clearTimeout(this.timeout),this.timeout=null,this.popupInstance&&this.popupInstance.hide()}loadTooltip(e,t,i){var n,s,a;function o(l){s=l}typeof i=="function"&&(i=i(e,t.getComponent(),o)),i instanceof HTMLElement?n=i:(n=document.createElement("div"),i===!0&&(t instanceof ms?i=t.value:t.definition.field?this.langBind("columns|"+t.definition.field,l=>{n.innerHTML=i=l||t.definition.title}):i=t.definition.title),n.innerHTML=i),(i||i===0||i===!1)&&(n.classList.add("tabulator-tooltip"),n.addEventListener("mousemove",l=>l.preventDefault()),this.popupInstance=this.popup(n),typeof s=="function"&&this.popupInstance.renderCallback(s),a=this.popupInstance.containerEventCoords(e),this.popupInstance.show(a.x+15,a.y+15).hideOnBlur(()=>{this.dispatchExternal("TooltipClosed",t.getComponent()),this.popupInstance=null}),this.dispatchExternal("TooltipOpened",t.getComponent()))}}G(Oc,"moduleName","tooltip");var lw={integer:function(r,e,t){return e===""||e===null||typeof e>"u"?!0:(e=Number(e),!isNaN(e)&&isFinite(e)&&Math.floor(e)===e)},float:function(r,e,t){return e===""||e===null||typeof e>"u"?!0:(e=Number(e),!isNaN(e)&&isFinite(e)&&e%1!==0)},numeric:function(r,e,t){return e===""||e===null||typeof e>"u"?!0:!isNaN(e)},string:function(r,e,t){return e===""||e===null||typeof e>"u"?!0:isNaN(e)},alphanumeric:function(r,e,t){if(e===""||e===null||typeof e>"u")return!0;var i=new RegExp(/^[a-z0-9]+$/i);return i.test(e)},max:function(r,e,t){return e===""||e===null||typeof e>"u"?!0:parseFloat(e)<=t},min:function(r,e,t){return e===""||e===null||typeof e>"u"?!0:parseFloat(e)>=t},starts:function(r,e,t){return e===""||e===null||typeof e>"u"?!0:String(e).toLowerCase().startsWith(String(t).toLowerCase())},ends:function(r,e,t){return e===""||e===null||typeof e>"u"?!0:String(e).toLowerCase().endsWith(String(t).toLowerCase())},minLength:function(r,e,t){return e===""||e===null||typeof e>"u"?!0:String(e).length>=t},maxLength:function(r,e,t){return e===""||e===null||typeof e>"u"?!0:String(e).length<=t},in:function(r,e,t){return e===""||e===null||typeof e>"u"?!0:(typeof t=="string"&&(t=t.split("|")),t.indexOf(e)>-1)},regex:function(r,e,t){if(e===""||e===null||typeof e>"u")return!0;var i=new RegExp(t);return i.test(e)},unique:function(r,e,t){if(e===""||e===null||typeof e>"u")return!0;var i=!0,n=r.getData(),s=r.getColumn()._getSelf();return this.table.rowManager.rows.forEach(function(a){var o=a.getData();o!==n&&e==s.getFieldValue(o)&&(i=!1)}),i},required:function(r,e,t){return e!==""&&e!==null&&typeof e<"u"}};const Zn=class Zn extends ke{constructor(e){super(e),this.invalidCells=[],this.registerTableOption("validationMode","blocking"),this.registerColumnOption("validator"),this.registerTableFunction("getInvalidCells",this.getInvalidCells.bind(this)),this.registerTableFunction("clearCellValidation",this.userClearCellValidation.bind(this)),this.registerTableFunction("validate",this.userValidate.bind(this)),this.registerComponentFunction("cell","isValid",this.cellIsValid.bind(this)),this.registerComponentFunction("cell","clearValidation",this.clearValidation.bind(this)),this.registerComponentFunction("cell","validate",this.cellValidate.bind(this)),this.registerComponentFunction("column","validate",this.columnValidate.bind(this)),this.registerComponentFunction("row","validate",this.rowValidate.bind(this))}initialize(){this.subscribe("cell-delete",this.clearValidation.bind(this)),this.subscribe("column-layout",this.initializeColumnCheck.bind(this)),this.subscribe("edit-success",this.editValidate.bind(this)),this.subscribe("edit-editor-clear",this.editorClear.bind(this)),this.subscribe("edit-edited-clear",this.editedClear.bind(this))}editValidate(e,t,i){var n=this.table.options.validationMode!=="manual"?this.validate(e.column.modules.validate,e,t):!0;return n!==!0&&setTimeout(()=>{e.getElement().classList.add("tabulator-validation-fail"),this.dispatchExternal("validationFailed",e.getComponent(),t,n)}),n}editorClear(e,t){t&&e.column.modules.validate&&this.cellValidate(e),e.getElement().classList.remove("tabulator-validation-fail")}editedClear(e){e.modules.validate&&(e.modules.validate.invalid=!1)}cellIsValid(e){return e.modules.validate&&e.modules.validate.invalid||!0}cellValidate(e){return this.validate(e.column.modules.validate,e,e.getValue())}columnValidate(e){var t=[];return e.cells.forEach(i=>{this.cellValidate(i)!==!0&&t.push(i.getComponent())}),t.length?t:!0}rowValidate(e){var t=[];return e.cells.forEach(i=>{this.cellValidate(i)!==!0&&t.push(i.getComponent())}),t.length?t:!0}userClearCellValidation(e){e||(e=this.getInvalidCells()),Array.isArray(e)||(e=[e]),e.forEach(t=>{this.clearValidation(t._getSelf())})}userValidate(e){var t=[];return this.table.rowManager.rows.forEach(i=>{i=i.getComponent();var n=i.validate();n!==!0&&(t=t.concat(n))}),t.length?t:!0}initializeColumnCheck(e){typeof e.definition.validator<"u"&&this.initializeColumn(e)}initializeColumn(e){var t=this,i=[],n;e.definition.validator&&(Array.isArray(e.definition.validator)?e.definition.validator.forEach(s=>{n=t._extractValidator(s),n&&i.push(n)}):(n=this._extractValidator(e.definition.validator),n&&i.push(n)),e.modules.validate=i.length?i:!1)}_extractValidator(e){var t,i,n;switch(typeof e){case"string":return n=e.indexOf(":"),n>-1?(t=e.substring(0,n),i=e.substring(n+1)):t=e,this._buildValidator(t,i);case"function":return this._buildValidator(e);case"object":return this._buildValidator(e.type,e.parameters)}}_buildValidator(e,t){var i=typeof e=="function"?e:Zn.validators[e];return i?{type:typeof e=="function"?"function":e,func:i,params:t}:(console.warn("Validator Setup Error - No matching validator found:",e),!1)}validate(e,t,i){var n=this,s=[],a=this.invalidCells.indexOf(t);return e&&e.forEach(o=>{o.func.call(n,t.getComponent(),i,o.params)||s.push({type:o.type,parameters:o.params})}),t.modules.validate||(t.modules.validate={}),s.length?(t.modules.validate.invalid=s,this.table.options.validationMode!=="manual"&&t.getElement().classList.add("tabulator-validation-fail"),a==-1&&this.invalidCells.push(t)):(t.modules.validate.invalid=!1,t.getElement().classList.remove("tabulator-validation-fail"),a>-1&&this.invalidCells.splice(a,1)),s.length?s:!0}getInvalidCells(){var e=[];return this.invalidCells.forEach(t=>{e.push(t.getComponent())}),e}clearValidation(e){var t;e.modules.validate&&e.modules.validate.invalid&&(e.getElement().classList.remove("tabulator-validation-fail"),e.modules.validate.invalid=!1,t=this.invalidCells.indexOf(e),t>-1&&this.invalidCells.splice(t,1))}};G(Zn,"moduleName","validate"),G(Zn,"validators",lw);let qo=Zn;var so=Object.freeze({__proto__:null,AccessorModule:Fo,AjaxModule:Oo,ClipboardModule:Lo,ColumnCalcsModule:Po,DataTreeModule:vc,DownloadModule:No,EditModule:Io,ExportModule:Bo,FilterModule:Ho,FormatModule:zo,FrozenColumnsModule:bc,FrozenRowsModule:wc,GroupRowsModule:xc,HistoryModule:Wo,HtmlTableImportModule:yc,ImportModule:Vo,InteractionModule:Ec,KeybindingsModule:Uo,MenuModule:Cc,MoveColumnsModule:_c,MoveRowsModule:Go,MutatorModule:Yo,PageModule:jo,PersistenceModule:Xo,PopupModule:Tc,PrintModule:Sc,ReactiveDataModule:Dc,ResizeColumnsModule:kc,ResizeRowsModule:Rc,ResizeTableModule:Fc,ResponsiveLayoutModule:$o,SelectRangeModule:Gs,SelectRowModule:Ko,SortModule:Qo,SpreadsheetModule:Ac,TooltipModule:Oc,ValidateModule:qo}),hw={debugEventsExternal:!1,debugEventsInternal:!1,debugInvalidOptions:!0,debugInvalidComponentFuncs:!0,debugInitialization:!0,debugDeprecation:!0,height:!1,minHeight:!1,maxHeight:!1,columnHeaderVertAlign:"top",popupContainer:!1,columns:[],columnDefaults:{},rowHeader:!1,data:!1,autoColumns:!1,autoColumnsDefinitions:!1,nestedFieldSeparator:".",footerElement:!1,index:"id",textDirection:"auto",addRowPos:"bottom",headerVisible:!0,renderVertical:"virtual",renderHorizontal:"basic",renderVerticalBuffer:0,scrollToRowPosition:"top",scrollToRowIfVisible:!0,scrollToColumnPosition:"left",scrollToColumnIfVisible:!0,rowFormatter:!1,rowFormatterPrint:null,rowFormatterClipboard:null,rowFormatterHtmlOutput:null,rowHeight:null,placeholder:!1,dataLoader:!0,dataLoaderLoading:!1,dataLoaderError:!1,dataLoaderErrorTimeout:3e3,dataSendParams:{},dataReceiveParams:{},dependencies:{}};class Lc{constructor(e,t,i={}){this.table=e,this.msgType=t,this.registeredDefaults=Object.assign({},i)}register(e,t){this.registeredDefaults[e]=t}generate(e,t={}){var i=Object.assign({},this.registeredDefaults),n=this.table.options.debugInvalidOptions||t.debugInvalidOptions===!0;Object.assign(i,e);for(let s in t)i.hasOwnProperty(s)||(n&&console.warn("Invalid "+this.msgType+" option:",s),i[s]=t.key);for(let s in i)s in t?i[s]=t[s]:Array.isArray(i[s])?i[s]=Object.assign([],i[s]):typeof i[s]=="object"&&i[s]!==null?i[s]=Object.assign({},i[s]):typeof i[s]>"u"&&delete i[s];return i}}class Pa extends At{constructor(e){super(e),this.elementVertical=e.rowManager.element,this.elementHorizontal=e.columnManager.element,this.tableElement=e.rowManager.tableElement,this.verticalFillMode="fit"}initialize(){}clearRows(){}clearColumns(){}reinitializeColumnWidths(e){}renderRows(){}renderColumns(){}rerenderRows(e){e&&e()}rerenderColumns(e,t){}renderRowCells(e){}rerenderRowCells(e,t){}scrollColumns(e,t){}scrollRows(e,t){}resize(){}scrollToRow(e){}scrollToRowNearestTop(e){}visibleRows(e){return[]}rows(){return this.table.rowManager.getDisplayRows()}styleRow(e,t){var i=e.getElement();t%2?(i.classList.add("tabulator-row-even"),i.classList.remove("tabulator-row-odd")):(i.classList.add("tabulator-row-odd"),i.classList.remove("tabulator-row-even"))}clear(){this.clearRows(),this.clearColumns()}render(){this.renderRows(),this.renderColumns()}rerender(e){this.rerenderRows(),this.rerenderColumns()}scrollToRowPosition(e,t,i){var n=this.rows().indexOf(e),s=e.getElement(),a=0;return new Promise((o,l)=>{if(n>-1){if(typeof i>"u"&&(i=this.table.options.scrollToRowIfVisible),!i&&et.elVisible(s)&&(a=et.elOffset(s).top-et.elOffset(this.elementVertical).top,a>0&&a<this.elementVertical.clientHeight-s.offsetHeight))return o(),!1;switch(typeof t>"u"&&(t=this.table.options.scrollToRowPosition),t==="nearest"&&(t=this.scrollToRowNearestTop(e)?"top":"bottom"),this.scrollToRow(e),t){case"middle":case"center":this.elementVertical.scrollHeight-this.elementVertical.scrollTop==this.elementVertical.clientHeight?this.elementVertical.scrollTop=this.elementVertical.scrollTop+(s.offsetTop-this.elementVertical.scrollTop)-(this.elementVertical.scrollHeight-s.offsetTop)/2:this.elementVertical.scrollTop=this.elementVertical.scrollTop-this.elementVertical.clientHeight/2;break;case"bottom":this.elementVertical.scrollHeight-this.elementVertical.scrollTop==this.elementVertical.clientHeight?this.elementVertical.scrollTop=this.elementVertical.scrollTop-(this.elementVertical.scrollHeight-s.offsetTop)+s.offsetHeight:this.elementVertical.scrollTop=this.elementVertical.scrollTop-this.elementVertical.clientHeight+s.offsetHeight;break;case"top":this.elementVertical.scrollTop=s.offsetTop;break}o()}else console.warn("Scroll Error - Row not visible"),l("Scroll Error - Row not visible")})}}class uw extends Pa{constructor(e){super(e)}renderRowCells(e,t){const i=document.createDocumentFragment();e.cells.forEach(n=>{i.appendChild(n.getElement())}),e.element.appendChild(i),t||e.cells.forEach(n=>{n.cellRendered()})}reinitializeColumnWidths(e){e.forEach(function(t){t.reinitializeWidth()})}}class cw extends Pa{constructor(e){super(e),this.leftCol=0,this.rightCol=0,this.scrollLeft=0,this.vDomScrollPosLeft=0,this.vDomScrollPosRight=0,this.vDomPadLeft=0,this.vDomPadRight=0,this.fitDataColAvg=0,this.windowBuffer=200,this.visibleRows=null,this.initialized=!1,this.isFitData=!1,this.columns=[]}initialize(){this.compatibilityCheck(),this.layoutCheck(),this.vertScrollListen()}compatibilityCheck(){this.options("layout")=="fitDataTable"&&console.warn("Horizontal Virtual DOM is not compatible with fitDataTable layout mode"),this.options("responsiveLayout")&&console.warn("Horizontal Virtual DOM is not compatible with responsive columns"),this.options("rtl")&&console.warn("Horizontal Virtual DOM is not currently compatible with RTL text direction")}layoutCheck(){this.isFitData=this.options("layout").startsWith("fitData")}vertScrollListen(){this.subscribe("scroll-vertical",this.clearVisRowCache.bind(this)),this.subscribe("data-refreshed",this.clearVisRowCache.bind(this))}clearVisRowCache(){this.visibleRows=null}renderColumns(e,t){this.dataChange()}scrollColumns(e,t){this.scrollLeft!=e&&(this.scrollLeft=e,this.scroll(e-(this.vDomScrollPosLeft+this.windowBuffer)))}calcWindowBuffer(){var e=this.elementVertical.clientWidth;this.table.columnManager.columnsByIndex.forEach(t=>{if(t.visible){var i=t.getWidth();i>e&&(e=i)}}),this.windowBuffer=e*2}rerenderColumns(e,t){var i={cols:this.columns,leftCol:this.leftCol,rightCol:this.rightCol},n=0;e&&!this.initialized||(this.clear(),this.calcWindowBuffer(),this.scrollLeft=this.elementVertical.scrollLeft,this.vDomScrollPosLeft=this.scrollLeft-this.windowBuffer,this.vDomScrollPosRight=this.scrollLeft+this.elementVertical.clientWidth+this.windowBuffer,this.table.columnManager.columnsByIndex.forEach(s=>{var a={},o;s.visible&&(s.modules.frozen||(o=s.getWidth(),a.leftPos=n,a.rightPos=n+o,a.width=o,this.isFitData&&(a.fitDataCheck=s.modules.vdomHoz?s.modules.vdomHoz.fitDataCheck:!0),n+o>this.vDomScrollPosLeft&&n<this.vDomScrollPosRight?(this.leftCol==-1&&(this.leftCol=this.columns.length,this.vDomPadLeft=n),this.rightCol=this.columns.length):this.leftCol!==-1&&(this.vDomPadRight+=o),this.columns.push(s),s.modules.vdomHoz=a,n+=o))}),this.tableElement.style.paddingLeft=this.vDomPadLeft+"px",this.tableElement.style.paddingRight=this.vDomPadRight+"px",this.initialized=!0,t||(!e||this.reinitChanged(i))&&this.reinitializeRows(),this.elementVertical.scrollLeft=this.scrollLeft)}renderRowCells(e){if(this.initialized)this.initializeRow(e);else{const t=document.createDocumentFragment();e.cells.forEach(i=>{t.appendChild(i.getElement())}),e.element.appendChild(t),e.cells.forEach(i=>{i.cellRendered()})}}rerenderRowCells(e,t){this.reinitializeRow(e,t)}reinitializeColumnWidths(e){for(let t=this.leftCol;t<=this.rightCol;t++){let i=this.columns[t];i&&i.reinitializeWidth()}}deinitialize(){this.initialized=!1}clear(){this.columns=[],this.leftCol=-1,this.rightCol=0,this.vDomScrollPosLeft=0,this.vDomScrollPosRight=0,this.vDomPadLeft=0,this.vDomPadRight=0}dataChange(){var e=!1,t,i;if(this.isFitData){if(this.table.columnManager.columnsByIndex.forEach(n=>{!n.definition.width&&n.visible&&(e=!0)}),e&&this.table.rowManager.getDisplayRows().length&&(this.vDomScrollPosRight=this.scrollLeft+this.elementVertical.clientWidth+this.windowBuffer,t=this.chain("rows-sample",[1],[],()=>this.table.rowManager.getDisplayRows())[0],t)){i=t.getElement(),t.generateCells(),this.tableElement.appendChild(i);for(let n=0;n<t.cells.length;n++){let s=t.cells[n];i.appendChild(s.getElement()),s.column.reinitializeWidth()}i.parentNode.removeChild(i),this.rerenderColumns(!1,!0)}}else this.options("layout")==="fitColumns"&&(this.layoutRefresh(),this.rerenderColumns(!1,!0))}reinitChanged(e){var t=!0;return e.cols.length!==this.columns.length||e.leftCol!==this.leftCol||e.rightCol!==this.rightCol?!0:(e.cols.forEach((i,n)=>{i!==this.columns[n]&&(t=!1)}),!t)}reinitializeRows(){var e=this.getVisibleRows(),t=this.table.rowManager.getRows().filter(i=>!e.includes(i));e.forEach(i=>{this.reinitializeRow(i,!0)}),t.forEach(i=>{i.deinitialize()})}getVisibleRows(){return this.visibleRows||(this.visibleRows=this.table.rowManager.getVisibleRows()),this.visibleRows}scroll(e){this.vDomScrollPosLeft+=e,this.vDomScrollPosRight+=e,Math.abs(e)>this.windowBuffer/2?this.rerenderColumns():e>0?(this.addColRight(),this.removeColLeft()):(this.addColLeft(),this.removeColRight())}colPositionAdjust(e,t,i){for(let n=e;n<t;n++){let s=this.columns[n];s.modules.vdomHoz.leftPos+=i,s.modules.vdomHoz.rightPos+=i}}addColRight(){for(var e=!1,t=!0;t;){let i=this.columns[this.rightCol+1];i&&i.modules.vdomHoz.leftPos<=this.vDomScrollPosRight?(e=!0,this.getVisibleRows().forEach(n=>{if(n.type!=="group"){var s=n.getCell(i);n.getElement().insertBefore(s.getElement(),n.getCell(this.columns[this.rightCol]).getElement().nextSibling),s.cellRendered()}}),this.fitDataColActualWidthCheck(i),this.rightCol++,this.getVisibleRows().forEach(n=>{n.type!=="group"&&(n.modules.vdomHoz.rightCol=this.rightCol)}),this.rightCol>=this.columns.length-1?this.vDomPadRight=0:this.vDomPadRight-=i.getWidth()):t=!1}e&&(this.tableElement.style.paddingRight=this.vDomPadRight+"px")}addColLeft(){for(var e=!1,t=!0;t;){let i=this.columns[this.leftCol-1];if(i)if(i.modules.vdomHoz.rightPos>=this.vDomScrollPosLeft){e=!0,this.getVisibleRows().forEach(s=>{if(s.type!=="group"){var a=s.getCell(i);s.getElement().insertBefore(a.getElement(),s.getCell(this.columns[this.leftCol]).getElement()),a.cellRendered()}}),this.leftCol--,this.getVisibleRows().forEach(s=>{s.type!=="group"&&(s.modules.vdomHoz.leftCol=this.leftCol)}),this.leftCol<=0?this.vDomPadLeft=0:this.vDomPadLeft-=i.getWidth();let n=this.fitDataColActualWidthCheck(i);n&&(this.scrollLeft=this.elementVertical.scrollLeft=this.elementVertical.scrollLeft+n,this.vDomPadRight-=n)}else t=!1;else t=!1}e&&(this.tableElement.style.paddingLeft=this.vDomPadLeft+"px")}removeColRight(){for(var e=!1,t=!0;t;){let i=this.columns[this.rightCol];i&&i.modules.vdomHoz.leftPos>this.vDomScrollPosRight?(e=!0,this.getVisibleRows().forEach(n=>{if(n.type!=="group"){var s=n.getCell(i);try{n.getElement().removeChild(s.getElement())}catch(a){console.warn("Could not removeColRight",a.message)}}}),this.vDomPadRight+=i.getWidth(),this.rightCol--,this.getVisibleRows().forEach(n=>{n.type!=="group"&&(n.modules.vdomHoz.rightCol=this.rightCol)})):t=!1}e&&(this.tableElement.style.paddingRight=this.vDomPadRight+"px")}removeColLeft(){for(var e=!1,t=!0;t;){let i=this.columns[this.leftCol];i&&i.modules.vdomHoz.rightPos<this.vDomScrollPosLeft?(e=!0,this.getVisibleRows().forEach(n=>{if(n.type!=="group"){var s=n.getCell(i);try{n.getElement().removeChild(s.getElement())}catch(a){console.warn("Could not removeColLeft",a.message)}}}),this.vDomPadLeft+=i.getWidth(),this.leftCol++,this.getVisibleRows().forEach(n=>{n.type!=="group"&&(n.modules.vdomHoz.leftCol=this.leftCol)})):t=!1}e&&(this.tableElement.style.paddingLeft=this.vDomPadLeft+"px")}fitDataColActualWidthCheck(e){var t,i;return e.modules.vdomHoz.fitDataCheck&&(e.reinitializeWidth(),t=e.getWidth(),i=t-e.modules.vdomHoz.width,i&&(e.modules.vdomHoz.rightPos+=i,e.modules.vdomHoz.width=t,this.colPositionAdjust(this.columns.indexOf(e)+1,this.columns.length,i)),e.modules.vdomHoz.fitDataCheck=!1),i}initializeRow(e){if(e.type!=="group"){e.modules.vdomHoz={leftCol:this.leftCol,rightCol:this.rightCol},this.table.modules.frozenColumns&&this.table.modules.frozenColumns.leftColumns.forEach(t=>{this.appendCell(e,t)});for(let t=this.leftCol;t<=this.rightCol;t++)this.appendCell(e,this.columns[t]);this.table.modules.frozenColumns&&this.table.modules.frozenColumns.rightColumns.forEach(t=>{this.appendCell(e,t)})}}appendCell(e,t){if(t&&t.visible){let i=e.getCell(t);e.getElement().appendChild(i.getElement()),i.cellRendered()}}reinitializeRow(e,t){if(e.type!=="group"&&(t||!e.modules.vdomHoz||e.modules.vdomHoz.leftCol!==this.leftCol||e.modules.vdomHoz.rightCol!==this.rightCol)){for(var i=e.getElement();i.firstChild;)i.removeChild(i.firstChild);this.initializeRow(e)}}}class dw extends At{constructor(e){super(e),this.blockHozScrollEvent=!1,this.headersElement=null,this.contentsElement=null,this.rowHeader=null,this.element=null,this.columns=[],this.columnsByIndex=[],this.columnsByField={},this.scrollLeft=0,this.optionsList=new Lc(this.table,"column definition",gc),this.redrawBlock=!1,this.redrawBlockUpdate=null,this.renderer=null}initialize(){this.initializeRenderer(),this.headersElement=this.createHeadersElement(),this.contentsElement=this.createHeaderContentsElement(),this.element=this.createHeaderElement(),this.contentsElement.insertBefore(this.headersElement,this.contentsElement.firstChild),this.element.insertBefore(this.contentsElement,this.element.firstChild),this.initializeScrollWheelWatcher(),this.subscribe("scroll-horizontal",this.scrollHorizontal.bind(this)),this.subscribe("scrollbar-vertical",this.padVerticalScrollbar.bind(this))}padVerticalScrollbar(e){this.table.rtl?this.headersElement.style.marginLeft=e+"px":this.headersElement.style.marginRight=e+"px"}initializeRenderer(){var e,t={virtual:cw,basic:uw};typeof this.table.options.renderHorizontal=="string"?e=t[this.table.options.renderHorizontal]:e=this.table.options.renderHorizontal,e?(this.renderer=new e(this.table,this.element,this.tableElement),this.renderer.initialize()):console.error("Unable to find matching renderer:",this.table.options.renderHorizontal)}createHeadersElement(){var e=document.createElement("div");return e.classList.add("tabulator-headers"),e.setAttribute("role","row"),e}createHeaderContentsElement(){var e=document.createElement("div");return e.classList.add("tabulator-header-contents"),e.setAttribute("role","rowgroup"),e}createHeaderElement(){var e=document.createElement("div");return e.classList.add("tabulator-header"),e.setAttribute("role","rowgroup"),this.table.options.headerVisible||e.classList.add("tabulator-header-hidden"),e}getElement(){return this.element}getContentsElement(){return this.contentsElement}getHeadersElement(){return this.headersElement}scrollHorizontal(e){this.contentsElement.scrollLeft=e,this.scrollLeft=e,this.renderer.scrollColumns(e)}initializeScrollWheelWatcher(){this.contentsElement.addEventListener("wheel",e=>{var t;e.deltaX&&(t=this.contentsElement.scrollLeft+e.deltaX,this.table.rowManager.scrollHorizontal(t),this.table.columnManager.scrollHorizontal(t))})}generateColumnsFromRowData(e){var t=[],i={},n=this.table.options.autoColumns==="full"?e:[e[0]],s=this.table.options.autoColumnsDefinitions;if(e&&e.length){if(n.forEach(a=>{Object.keys(a).forEach((o,l)=>{let h=a[o],u;i[o]?i[o]!==!0&&typeof h<"u"&&(i[o].sorter=this.calculateSorterFromValue(h),i[o]=!0):(u={field:o,title:o,sorter:this.calculateSorterFromValue(h)},t.splice(l,0,u),i[o]=typeof h>"u"?u:!0)})}),s)switch(typeof s){case"function":this.table.options.columns=s.call(this.table,t);break;case"object":Array.isArray(s)?t.forEach(a=>{var o=s.find(l=>l.field===a.field);o&&Object.assign(a,o)}):t.forEach(a=>{s[a.field]&&Object.assign(a,s[a.field])}),this.table.options.columns=t;break}else this.table.options.columns=t;this.setColumns(this.table.options.columns)}}calculateSorterFromValue(e){var t;switch(typeof e){case"undefined":t="string";break;case"boolean":t="boolean";break;case"number":t="number";break;case"object":Array.isArray(e)?t="array":t="string";break;default:!isNaN(e)&&e!==""?t="number":e.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)?t="alphanum":t="string";break}return t}setColumns(e,t){for(;this.headersElement.firstChild;)this.headersElement.removeChild(this.headersElement.firstChild);this.columns=[],this.columnsByIndex=[],this.columnsByField={},this.dispatch("columns-loading"),this.dispatchExternal("columnsLoading"),this.table.options.rowHeader&&(this.rowHeader=new Ir(this.table.options.rowHeader===!0?{}:this.table.options.rowHeader,this,!0),this.columns.push(this.rowHeader),this.headersElement.appendChild(this.rowHeader.getElement()),this.rowHeader.columnRendered()),e.forEach((i,n)=>{this._addColumn(i)}),this._reIndexColumns(),this.dispatch("columns-loaded"),this.subscribedExternal("columnsLoaded")&&this.dispatchExternal("columnsLoaded",this.getComponents()),this.rerenderColumns(!1,!0),this.redraw(!0)}_addColumn(e,t,i){var n=new Ir(e,this),s=n.getElement(),a=i&&this.findColumnIndex(i);if(t&&this.rowHeader&&(!i||i===this.rowHeader)&&(t=!1,i=this.rowHeader,a=0),i&&a>-1){var o=i.getTopColumn(),l=this.columns.indexOf(o),h=o.getElement();t?(this.columns.splice(l,0,n),h.parentNode.insertBefore(s,h)):(this.columns.splice(l+1,0,n),h.parentNode.insertBefore(s,h.nextSibling))}else t?(this.columns.unshift(n),this.headersElement.insertBefore(n.getElement(),this.headersElement.firstChild)):(this.columns.push(n),this.headersElement.appendChild(n.getElement()));return n.columnRendered(),n}registerColumnField(e){e.definition.field&&(this.columnsByField[e.definition.field]=e)}registerColumnPosition(e){this.columnsByIndex.push(e)}_reIndexColumns(){this.columnsByIndex=[],this.columns.forEach(function(e){e.reRegisterPosition()})}verticalAlignHeaders(){var e=0;this.redrawBlock||(this.headersElement.style.height="",this.columns.forEach(t=>{t.clearVerticalAlign()}),this.columns.forEach(t=>{var i=t.getHeight();i>e&&(e=i)}),this.headersElement.style.height=e+"px",this.columns.forEach(t=>{t.verticalAlign(this.table.options.columnHeaderVertAlign,e)}),this.table.rowManager.adjustTableSize())}findColumn(e){var t;if(typeof e=="object"){if(e instanceof Ir)return e;if(e instanceof mc)return e._getSelf()||!1;if(typeof HTMLElement<"u"&&e instanceof HTMLElement)return t=[],this.columns.forEach(n=>{t.push(n),t=t.concat(n.getColumns(!0))}),t.find(n=>n.element===e)||!1}else return this.columnsByField[e]||!1;return!1}getColumnByField(e){return this.columnsByField[e]}getColumnsByFieldRoot(e){var t=[];return Object.keys(this.columnsByField).forEach(i=>{var n=this.table.options.nestedFieldSeparator?i.split(this.table.options.nestedFieldSeparator)[0]:i;n===e&&t.push(this.columnsByField[i])}),t}getColumnByIndex(e){return this.columnsByIndex[e]}getFirstVisibleColumn(){var e=this.columnsByIndex.findIndex(t=>t.visible);return e>-1?this.columnsByIndex[e]:!1}getVisibleColumnsByIndex(){return this.columnsByIndex.filter(e=>e.visible)}getColumns(){return this.columns}findColumnIndex(e){return this.columnsByIndex.findIndex(t=>e===t)}getRealColumns(){return this.columnsByIndex}traverse(e){this.columnsByIndex.forEach((t,i)=>{e(t,i)})}getDefinitions(e){var t=[];return this.columnsByIndex.forEach(i=>{(!e||e&&i.visible)&&t.push(i.getDefinition())}),t}getDefinitionTree(){var e=[];return this.columns.forEach(t=>{e.push(t.getDefinition(!0))}),e}getComponents(e){var t=[],i=e?this.columns:this.columnsByIndex;return i.forEach(n=>{t.push(n.getComponent())}),t}getWidth(){var e=0;return this.columnsByIndex.forEach(t=>{t.visible&&(e+=t.getWidth())}),e}moveColumn(e,t,i){t.element.parentNode.insertBefore(e.element,t.element),i&&t.element.parentNode.insertBefore(t.element,e.element),this.moveColumnActual(e,t,i),this.verticalAlignHeaders(),this.table.rowManager.reinitialize()}moveColumnActual(e,t,i){e.parent.isGroup?this._moveColumnInArray(e.parent.columns,e,t,i):this._moveColumnInArray(this.columns,e,t,i),this._moveColumnInArray(this.columnsByIndex,e,t,i,!0),this.rerenderColumns(!0),this.dispatch("column-moved",e,t,i),this.subscribedExternal("columnMoved")&&this.dispatchExternal("columnMoved",e.getComponent(),this.table.columnManager.getComponents())}_moveColumnInArray(e,t,i,n,s){var a=e.indexOf(t),o,l=[];a>-1&&(e.splice(a,1),o=e.indexOf(i),o>-1?n&&(o=o+1):o=a,e.splice(o,0,t),s&&(l=this.chain("column-moving-rows",[t,i,n],null,[])||[],l=l.concat(this.table.rowManager.rows),l.forEach(function(h){if(h.cells.length){var u=h.cells.splice(a,1)[0];h.cells.splice(o,0,u)}})))}scrollToColumn(e,t,i){var n=0,s=e.getLeftOffset(),a=0,o=e.getElement();return new Promise((l,h)=>{if(typeof t>"u"&&(t=this.table.options.scrollToColumnPosition),typeof i>"u"&&(i=this.table.options.scrollToColumnIfVisible),e.visible){switch(t){case"middle":case"center":a=-this.element.clientWidth/2;break;case"right":a=o.clientWidth-this.headersElement.clientWidth;break}if(!i&&s>0&&s+o.offsetWidth<this.element.clientWidth)return!1;n=s+a,n=Math.max(Math.min(n,this.table.rowManager.element.scrollWidth-this.table.rowManager.element.clientWidth),0),this.table.rowManager.scrollHorizontal(n),this.scrollHorizontal(n),l()}else console.warn("Scroll Error - Column not visible"),h("Scroll Error - Column not visible")})}generateCells(e){var t=[];return this.columnsByIndex.forEach(i=>{t.push(i.generateCell(e))}),t}getFlexBaseWidth(){var e=this.table.element.clientWidth,t=0;return this.table.rowManager.element.scrollHeight>this.table.rowManager.element.clientHeight&&(e-=this.table.rowManager.element.offsetWidth-this.table.rowManager.element.clientWidth),this.columnsByIndex.forEach(function(i){var n,s,a;i.visible&&(n=i.definition.width||0,s=parseInt(i.minWidth),typeof n=="string"?n.indexOf("%")>-1?a=e/100*parseInt(n):a=parseInt(n):a=n,t+=a>s?a:s)}),t}addColumn(e,t,i){return new Promise((n,s)=>{var a=this._addColumn(e,t,i);this._reIndexColumns(),this.dispatch("column-add",e,t,i),this.layoutMode()!="fitColumns"&&a.reinitializeWidth(),this.redraw(!0),this.table.rowManager.reinitialize(),this.rerenderColumns(),n(a)})}deregisterColumn(e){var t=e.getField(),i;t&&delete this.columnsByField[t],i=this.columnsByIndex.indexOf(e),i>-1&&this.columnsByIndex.splice(i,1),i=this.columns.indexOf(e),i>-1&&this.columns.splice(i,1),this.verticalAlignHeaders(),this.redraw()}rerenderColumns(e,t){this.redrawBlock?(e===!1||e===!0&&this.redrawBlockUpdate===null)&&(this.redrawBlockUpdate=e):this.renderer.rerenderColumns(e,t)}blockRedraw(){this.redrawBlock=!0,this.redrawBlockUpdate=null}restoreRedraw(){this.redrawBlock=!1,this.verticalAlignHeaders(),this.renderer.rerenderColumns(this.redrawBlockUpdate)}redraw(e){et.elVisible(this.element)&&this.verticalAlignHeaders(),e&&(this.table.rowManager.resetScroll(),this.table.rowManager.reinitialize()),this.confirm("table-redrawing",e)||this.layoutRefresh(e),this.dispatch("table-redraw",e),this.table.footerManager.redraw()}}class fw extends Pa{constructor(e){super(e),this.verticalFillMode="fill",this.scrollTop=0,this.scrollLeft=0,this.scrollTop=0,this.scrollLeft=0}clearRows(){for(var e=this.tableElement;e.firstChild;)e.removeChild(e.firstChild);e.scrollTop=0,e.scrollLeft=0,e.style.minWidth="",e.style.minHeight="",e.style.display="",e.style.visibility=""}renderRows(){var e=this.tableElement,t=!0,i=document.createDocumentFragment(),n=this.rows();n.forEach((s,a)=>{this.styleRow(s,a),s.initialize(!1,!0),s.type!=="group"&&(t=!1),i.appendChild(s.getElement())}),e.appendChild(i),n.forEach(s=>{s.rendered(),s.heightInitialized||s.calcHeight(!0)}),n.forEach(s=>{s.heightInitialized||s.setCellHeight()}),t?e.style.minWidth=this.table.columnManager.getWidth()+"px":e.style.minWidth=""}rerenderRows(e){this.clearRows(),e&&e(),this.renderRows(),this.rows().length||this.table.rowManager.tableEmpty()}scrollToRowNearestTop(e){var t=et.elOffset(e.getElement()).top;return!(Math.abs(this.elementVertical.scrollTop-t)>Math.abs(this.elementVertical.scrollTop+this.elementVertical.clientHeight-t))}scrollToRow(e){var t=e.getElement();this.elementVertical.scrollTop=et.elOffset(t).top-et.elOffset(this.elementVertical).top+this.elementVertical.scrollTop}visibleRows(e){return this.rows()}}class pw extends Pa{constructor(e){super(e),this.verticalFillMode="fill",this.scrollTop=0,this.scrollLeft=0,this.vDomRowHeight=20,this.vDomTop=0,this.vDomBottom=0,this.vDomScrollPosTop=0,this.vDomScrollPosBottom=0,this.vDomTopPad=0,this.vDomBottomPad=0,this.vDomMaxRenderChain=90,this.vDomWindowBuffer=0,this.vDomWindowMinTotalRows=20,this.vDomWindowMinMarginRows=5,this.vDomTopNewRows=[],this.vDomBottomNewRows=[]}clearRows(){for(var e=this.tableElement;e.firstChild;)e.removeChild(e.firstChild);e.style.paddingTop="",e.style.paddingBottom="",e.style.minHeight="",e.style.display="",e.style.visibility="",this.elementVertical.scrollTop=0,this.elementVertical.scrollLeft=0,this.scrollTop=0,this.scrollLeft=0,this.vDomTop=0,this.vDomBottom=0,this.vDomTopPad=0,this.vDomBottomPad=0,this.vDomScrollPosTop=0,this.vDomScrollPosBottom=0}renderRows(){this._virtualRenderFill()}rerenderRows(e){for(var t=this.elementVertical.scrollTop,i=!1,n=!1,s=this.table.rowManager.scrollLeft,a=this.rows(),o=this.vDomTop;o<=this.vDomBottom;o++)if(a[o]){var l=t-a[o].getElement().offsetTop;if(n===!1||Math.abs(l)<n)n=l,i=o;else break}a.forEach(h=>{h.deinitializeHeight()}),e&&e(),this.rows().length?this._virtualRenderFill(i===!1?this.rows.length-1:i,!0,n||0):(this.clear(),this.table.rowManager.tableEmpty()),this.scrollColumns(s)}scrollColumns(e){this.table.rowManager.scrollHorizontal(e)}scrollRows(e,t){var i=e-this.vDomScrollPosTop,n=e-this.vDomScrollPosBottom,s=this.vDomWindowBuffer*2,a=this.rows();if(this.scrollTop=e,-i>s||n>s){var o=this.table.rowManager.scrollLeft;this._virtualRenderFill(Math.floor(this.elementVertical.scrollTop/this.elementVertical.scrollHeight*a.length)),this.scrollColumns(o)}else t?(i<0&&this._addTopRow(a,-i),n<0&&(this.vDomScrollHeight-this.scrollTop>this.vDomWindowBuffer?this._removeBottomRow(a,-n):this.vDomScrollPosBottom=this.scrollTop)):(n>=0&&this._addBottomRow(a,n),i>=0&&(this.scrollTop>this.vDomWindowBuffer?this._removeTopRow(a,i):this.vDomScrollPosTop=this.scrollTop))}resize(){this.vDomWindowBuffer=this.table.options.renderVerticalBuffer||this.elementVertical.clientHeight}scrollToRowNearestTop(e){var t=this.rows().indexOf(e);return!(Math.abs(this.vDomTop-t)>Math.abs(this.vDomBottom-t))}scrollToRow(e){var t=this.rows().indexOf(e);t>-1&&this._virtualRenderFill(t,!0)}visibleRows(e){var t=this.elementVertical.scrollTop,i=this.elementVertical.clientHeight+t,n=!1,s=0,a=0,o=this.rows();if(e)s=this.vDomTop,a=this.vDomBottom;else for(var l=this.vDomTop;l<=this.vDomBottom;l++)if(o[l])if(n)if(i-o[l].getElement().offsetTop>=0)a=l;else break;else if(t-o[l].getElement().offsetTop>=0)s=l;else if(n=!0,i-o[l].getElement().offsetTop>=0)a=l;else break;return o.slice(s,a+1)}_virtualRenderFill(e,t,i){var n=this.tableElement,s=this.elementVertical,a=0,o=0,l=0,h=0,u=0,d=0,c=this.rows(),f=c.length,p=0,v,m,g=[],x=0,b=0,F=this.table.rowManager.fixedHeight,A=this.elementVertical.clientHeight,_=this.table.options.rowHeight,y=!0;if(e=e||0,i=i||0,!e)this.clear();else{for(;n.firstChild;)n.removeChild(n.firstChild);h=(f-e+1)*this.vDomRowHeight,h<A&&(e-=Math.ceil((A-h)/this.vDomRowHeight),e<0&&(e=0)),a=Math.min(Math.max(Math.floor(this.vDomWindowBuffer/this.vDomRowHeight),this.vDomWindowMinMarginRows),e),e-=a}if(f&&et.elVisible(this.elementVertical)){for(this.vDomTop=e,this.vDomBottom=e-1,F||this.table.options.maxHeight?(_&&(b=A/_+this.vDomWindowBuffer/_),b=Math.max(this.vDomWindowMinTotalRows,Math.ceil(b))):b=f;(b==f||o<=A+this.vDomWindowBuffer||x<this.vDomWindowMinTotalRows)&&this.vDomBottom<f-1;){for(g=[],m=document.createDocumentFragment(),d=0;d<b&&this.vDomBottom<f-1;)p=this.vDomBottom+1,v=c[p],this.styleRow(v,p),v.initialize(!1,!0),!v.heightInitialized&&!this.table.options.rowHeight&&v.clearCellHeight(),m.appendChild(v.getElement()),g.push(v),this.vDomBottom++,d++;if(!g.length)break;n.appendChild(m),g.forEach(R=>{R.rendered(),R.heightInitialized||R.calcHeight(!0)}),g.forEach(R=>{R.heightInitialized||R.setCellHeight()}),g.forEach(R=>{l=R.getHeight(),x<a?u+=l:o+=l,l>this.vDomWindowBuffer&&(this.vDomWindowBuffer=l*2),x++}),y=this.table.rowManager.adjustTableSize(),A=this.elementVertical.clientHeight,y&&(F||this.table.options.maxHeight)&&(_=o/x,b=Math.max(this.vDomWindowMinTotalRows,Math.ceil(A/_+this.vDomWindowBuffer/_)))}e?(this.vDomTopPad=t?this.vDomRowHeight*this.vDomTop+i:this.scrollTop-u,this.vDomBottomPad=this.vDomBottom==f-1?0:Math.max(this.vDomScrollHeight-this.vDomTopPad-o-u,0)):(this.vDomTopPad=0,this.vDomRowHeight=Math.floor((o+u)/x),this.vDomBottomPad=this.vDomRowHeight*(f-this.vDomBottom-1),this.vDomScrollHeight=u+o+this.vDomBottomPad-A),n.style.paddingTop=this.vDomTopPad+"px",n.style.paddingBottom=this.vDomBottomPad+"px",t&&(this.scrollTop=this.vDomTopPad+u+i-(this.elementVertical.scrollWidth>this.elementVertical.clientWidth?this.elementVertical.offsetHeight-A:0)),this.scrollTop=Math.min(this.scrollTop,this.elementVertical.scrollHeight-A),this.elementVertical.scrollWidth>this.elementVertical.clientWidth&&t&&(this.scrollTop+=this.elementVertical.offsetHeight-A),this.vDomScrollPosTop=this.scrollTop,this.vDomScrollPosBottom=this.scrollTop,s.scrollTop=this.scrollTop,this.dispatch("render-virtual-fill")}}_addTopRow(e,t){for(var i=this.tableElement,n=[],s=0,a=this.vDomTop-1,o=0,l=!0;l;)if(this.vDomTop){let h=e[a],u,d;h&&o<this.vDomMaxRenderChain?(u=h.getHeight()||this.vDomRowHeight,d=h.initialized,t>=u?(this.styleRow(h,a),i.insertBefore(h.getElement(),i.firstChild),(!h.initialized||!h.heightInitialized)&&n.push(h),h.initialize(),d||(u=h.getElement().offsetHeight,u>this.vDomWindowBuffer&&(this.vDomWindowBuffer=u*2)),t-=u,s+=u,this.vDomTop--,a--,o++):l=!1):l=!1}else l=!1;for(let h of n)h.clearCellHeight();this._quickNormalizeRowHeight(n),s&&(this.vDomTopPad-=s,this.vDomTopPad<0&&(this.vDomTopPad=a*this.vDomRowHeight),a<1&&(this.vDomTopPad=0),i.style.paddingTop=this.vDomTopPad+"px",this.vDomScrollPosTop-=s)}_removeTopRow(e,t){for(var i=[],n=0,s=0,a=!0;a;){let o=e[this.vDomTop],l;o&&s<this.vDomMaxRenderChain?(l=o.getHeight()||this.vDomRowHeight,t>=l?(this.vDomTop++,t-=l,n+=l,i.push(o),s++):a=!1):a=!1}for(let o of i){let l=o.getElement();l.parentNode&&l.parentNode.removeChild(l)}n&&(this.vDomTopPad+=n,this.tableElement.style.paddingTop=this.vDomTopPad+"px",this.vDomScrollPosTop+=this.vDomTop?n:n+this.vDomWindowBuffer)}_addBottomRow(e,t){for(var i=this.tableElement,n=[],s=0,a=this.vDomBottom+1,o=0,l=!0;l;){let h=e[a],u,d;h&&o<this.vDomMaxRenderChain?(u=h.getHeight()||this.vDomRowHeight,d=h.initialized,t>=u?(this.styleRow(h,a),i.appendChild(h.getElement()),(!h.initialized||!h.heightInitialized)&&n.push(h),h.initialize(),d||(u=h.getElement().offsetHeight,u>this.vDomWindowBuffer&&(this.vDomWindowBuffer=u*2)),t-=u,s+=u,this.vDomBottom++,a++,o++):l=!1):l=!1}for(let h of n)h.clearCellHeight();this._quickNormalizeRowHeight(n),s&&(this.vDomBottomPad-=s,(this.vDomBottomPad<0||a==e.length-1)&&(this.vDomBottomPad=0),i.style.paddingBottom=this.vDomBottomPad+"px",this.vDomScrollPosBottom+=s)}_removeBottomRow(e,t){for(var i=[],n=0,s=0,a=!0;a;){let o=e[this.vDomBottom],l;o&&s<this.vDomMaxRenderChain?(l=o.getHeight()||this.vDomRowHeight,t>=l?(this.vDomBottom--,t-=l,n+=l,i.push(o),s++):a=!1):a=!1}for(let o of i){let l=o.getElement();l.parentNode&&l.parentNode.removeChild(l)}n&&(this.vDomBottomPad+=n,this.vDomBottomPad<0&&(this.vDomBottomPad=0),this.tableElement.style.paddingBottom=this.vDomBottomPad+"px",this.vDomScrollPosBottom-=n)}_quickNormalizeRowHeight(e){for(let t of e)t.calcHeight();for(let t of e)t.setCellHeight()}}class mw extends At{constructor(e){super(e),this.element=this.createHolderElement(),this.tableElement=this.createTableElement(),this.heightFixer=this.createTableElement(),this.placeholder=null,this.placeholderContents=null,this.firstRender=!1,this.renderMode="virtual",this.fixedHeight=!1,this.rows=[],this.activeRowsPipeline=[],this.activeRows=[],this.activeRowsCount=0,this.displayRows=[],this.displayRowsCount=0,this.scrollTop=0,this.scrollLeft=0,this.redrawBlock=!1,this.redrawBlockRestoreConfig=!1,this.redrawBlockRenderInPosition=!1,this.dataPipeline=[],this.displayPipeline=[],this.scrollbarWidth=0,this.renderer=null}createHolderElement(){var e=document.createElement("div");return e.classList.add("tabulator-tableholder"),e.setAttribute("tabindex",0),e}createTableElement(){var e=document.createElement("div");return e.classList.add("tabulator-table"),e.setAttribute("role","rowgroup"),e}initializePlaceholder(){var e=this.table.options.placeholder;if(typeof e=="function"&&(e=e.call(this.table)),e=this.chain("placeholder",[e],e,e)||e,e){let t=document.createElement("div");if(t.classList.add("tabulator-placeholder"),typeof e=="string"){let i=document.createElement("div");i.classList.add("tabulator-placeholder-contents"),i.innerHTML=e,t.appendChild(i),this.placeholderContents=i}else typeof HTMLElement<"u"&&e instanceof HTMLElement?(t.appendChild(e),this.placeholderContents=e):(console.warn("Invalid placeholder provided, must be string or HTML Element",e),this.el=null);this.placeholder=t}}getElement(){return this.element}getTableElement(){return this.tableElement}initialize(){this.initializePlaceholder(),this.initializeRenderer(),this.element.appendChild(this.tableElement),this.firstRender=!0,this.element.addEventListener("scroll",()=>{var e=this.element.scrollLeft,t=this.scrollLeft>e,i=this.element.scrollTop,n=this.scrollTop>i;this.scrollLeft!=e&&(this.scrollLeft=e,this.dispatch("scroll-horizontal",e,t),this.dispatchExternal("scrollHorizontal",e,t),this._positionPlaceholder()),this.scrollTop!=i&&(this.scrollTop=i,this.renderer.scrollRows(i,n),this.dispatch("scroll-vertical",i,n),this.dispatchExternal("scrollVertical",i,n))})}findRow(e){if(typeof e=="object"){if(e instanceof It)return e;if(e instanceof Oa)return e._getSelf()||!1;if(typeof HTMLElement<"u"&&e instanceof HTMLElement)return this.rows.find(i=>i.getElement()===e)||!1;if(e===null)return!1}else return typeof e>"u"?!1:this.rows.find(i=>i.data[this.table.options.index]==e)||!1;return!1}getRowFromDataObject(e){var t=this.rows.find(i=>i.data===e);return t||!1}getRowFromPosition(e){return this.getDisplayRows().find(t=>t.type==="row"&&t.getPosition()===e&&t.isDisplayed())}scrollToRow(e,t,i){return this.renderer.scrollToRowPosition(e,t,i)}setData(e,t,i){return new Promise((n,s)=>{t&&this.getDisplayRows().length?this.table.options.pagination?this._setDataActual(e,!0):this.reRenderInPosition(()=>{this._setDataActual(e)}):(this.table.options.autoColumns&&i&&this.table.initialized&&this.table.columnManager.generateColumnsFromRowData(e),this.resetScroll(),this._setDataActual(e)),n()})}_setDataActual(e,t){this.dispatchExternal("dataProcessing",e),this._wipeElements(),Array.isArray(e)?(this.dispatch("data-processing",e),e.forEach((i,n)=>{if(i&&typeof i=="object"){var s=new It(i,this);this.rows.push(s)}else console.warn("Data Loading Warning - Invalid row data detected and ignored, expecting object but received:",i)}),this.refreshActiveData(!1,!1,t),this.dispatch("data-processed",e),this.dispatchExternal("dataProcessed",e)):console.error(`Data Loading Error - Unable to process data due to invalid data type 
Expecting: array 
Received: `,typeof e,`
Data:     `,e)}_wipeElements(){this.dispatch("rows-wipe"),this.destroy(),this.adjustTableSize(),this.dispatch("rows-wiped")}destroy(){this.rows.forEach(e=>{e.wipe()}),this.rows=[],this.activeRows=[],this.activeRowsPipeline=[],this.activeRowsCount=0,this.displayRows=[],this.displayRowsCount=0}deleteRow(e,t){var i=this.rows.indexOf(e),n=this.activeRows.indexOf(e);n>-1&&this.activeRows.splice(n,1),i>-1&&this.rows.splice(i,1),this.setActiveRows(this.activeRows),this.displayRowIterator(s=>{var a=s.indexOf(e);a>-1&&s.splice(a,1)}),t||this.reRenderInPosition(),this.regenerateRowPositions(),this.dispatchExternal("rowDeleted",e.getComponent()),this.displayRowsCount||this.tableEmpty(),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.getData())}addRow(e,t,i,n){var s=this.addRowActual(e,t,i,n);return s}addRows(e,t,i,n){var s=[];return new Promise((a,o)=>{t=this.findAddRowPos(t),Array.isArray(e)||(e=[e]),(typeof i>"u"&&t||typeof i<"u"&&!t)&&e.reverse(),e.forEach((l,h)=>{var u=this.addRow(l,t,i,!0);s.push(u),this.dispatch("row-added",u,l,t,i)}),this.refreshActiveData(n?"displayPipeline":!1,!1,!0),this.regenerateRowPositions(),this.displayRowsCount&&this._clearPlaceholder(),a(s)})}findAddRowPos(e){return typeof e>"u"&&(e=this.table.options.addRowPos),e==="pos"&&(e=!0),e==="bottom"&&(e=!1),e}addRowActual(e,t,i,n){var s=e instanceof It?e:new It(e||{},this),a=this.findAddRowPos(t),o=-1,l,h;return i||(h=this.chain("row-adding-position",[s,a],null,{index:i,top:a}),i=h.index,a=h.top),typeof i<"u"&&(i=this.findRow(i)),i=this.chain("row-adding-index",[s,i,a],null,i),i&&(o=this.rows.indexOf(i)),i&&o>-1?(l=this.activeRows.indexOf(i),this.displayRowIterator(function(u){var d=u.indexOf(i);d>-1&&u.splice(a?d:d+1,0,s)}),l>-1&&this.activeRows.splice(a?l:l+1,0,s),this.rows.splice(a?o:o+1,0,s)):a?(this.displayRowIterator(function(u){u.unshift(s)}),this.activeRows.unshift(s),this.rows.unshift(s)):(this.displayRowIterator(function(u){u.push(s)}),this.activeRows.push(s),this.rows.push(s)),this.setActiveRows(this.activeRows),this.dispatchExternal("rowAdded",s.getComponent()),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.table.rowManager.getData()),n||this.reRenderInPosition(),s}moveRow(e,t,i){this.dispatch("row-move",e,t,i),this.moveRowActual(e,t,i),this.regenerateRowPositions(),this.dispatch("row-moved",e,t,i),this.dispatchExternal("rowMoved",e.getComponent())}moveRowActual(e,t,i){this.moveRowInArray(this.rows,e,t,i),this.moveRowInArray(this.activeRows,e,t,i),this.displayRowIterator(n=>{this.moveRowInArray(n,e,t,i)}),this.dispatch("row-moving",e,t,i)}moveRowInArray(e,t,i,n){var s,a,o,l;if(t!==i&&(s=e.indexOf(t),s>-1&&(e.splice(s,1),a=e.indexOf(i),a>-1?n?e.splice(a+1,0,t):e.splice(a,0,t):e.splice(s,0,t)),e===this.getDisplayRows())){o=s<a?s:a,l=a>s?a:s+1;for(let h=o;h<=l;h++)e[h]&&this.styleRow(e[h],h)}}clearData(){this.setData([])}getRowIndex(e){return this.findRowIndex(e,this.rows)}getDisplayRowIndex(e){var t=this.getDisplayRows().indexOf(e);return t>-1?t:!1}nextDisplayRow(e,t){var i=this.getDisplayRowIndex(e),n=!1;return i!==!1&&i<this.displayRowsCount-1&&(n=this.getDisplayRows()[i+1]),n&&(!(n instanceof It)||n.type!="row")?this.nextDisplayRow(n,t):n}prevDisplayRow(e,t){var i=this.getDisplayRowIndex(e),n=!1;return i&&(n=this.getDisplayRows()[i-1]),t&&n&&(!(n instanceof It)||n.type!="row")?this.prevDisplayRow(n,t):n}findRowIndex(e,t){var i;return e=this.findRow(e),e&&(i=t.indexOf(e),i>-1)?i:!1}getData(e,t){var i=[],n=this.getRows(e);return n.forEach(function(s){s.type=="row"&&i.push(s.getData(t||"data"))}),i}getComponents(e){var t=[],i=this.getRows(e);return i.forEach(function(n){t.push(n.getComponent())}),t}getDataCount(e){var t=this.getRows(e);return t.length}scrollHorizontal(e){this.scrollLeft=e,this.element.scrollLeft=e,this.dispatch("scroll-horizontal",e)}registerDataPipelineHandler(e,t){typeof t<"u"?(this.dataPipeline.push({handler:e,priority:t}),this.dataPipeline.sort((i,n)=>i.priority-n.priority)):console.error("Data pipeline handlers must have a priority in order to be registered")}registerDisplayPipelineHandler(e,t){typeof t<"u"?(this.displayPipeline.push({handler:e,priority:t}),this.displayPipeline.sort((i,n)=>i.priority-n.priority)):console.error("Display pipeline handlers must have a priority in order to be registered")}refreshActiveData(e,t,i){var n=this.table,s="",a=0,o=["all","dataPipeline","display","displayPipeline","end"];if(!this.table.destroyed){if(typeof e=="function")if(a=this.dataPipeline.findIndex(l=>l.handler===e),a>-1)s="dataPipeline",t&&(a==this.dataPipeline.length-1?s="display":a++);else if(a=this.displayPipeline.findIndex(l=>l.handler===e),a>-1)s="displayPipeline",t&&(a==this.displayPipeline.length-1?s="end":a++);else{console.error("Unable to refresh data, invalid handler provided",e);return}else s=e||"all",a=0;if(this.redrawBlock){(!this.redrawBlockRestoreConfig||this.redrawBlockRestoreConfig&&(this.redrawBlockRestoreConfig.stage===s&&a<this.redrawBlockRestoreConfig.index||o.indexOf(s)<o.indexOf(this.redrawBlockRestoreConfig.stage)))&&(this.redrawBlockRestoreConfig={handler:e,skipStage:t,renderInPosition:i,stage:s,index:a});return}else et.elVisible(this.element)?i?this.reRenderInPosition(this.refreshPipelines.bind(this,e,s,a,i)):(this.refreshPipelines(e,s,a,i),e||this.table.columnManager.renderer.renderColumns(),this.renderTable(),n.options.layoutColumnsOnNewData&&this.table.columnManager.redraw(!0)):this.refreshPipelines(e,s,a,i),this.dispatch("data-refreshed")}}refreshPipelines(e,t,i,n){switch(this.dispatch("data-refreshing"),(!e||!this.activeRowsPipeline[0])&&(this.activeRowsPipeline[0]=this.rows.slice(0)),t){case"all":case"dataPipeline":for(let s=i;s<this.dataPipeline.length;s++){let a=this.dataPipeline[s].handler(this.activeRowsPipeline[s].slice(0));this.activeRowsPipeline[s+1]=a||this.activeRowsPipeline[s].slice(0)}this.setActiveRows(this.activeRowsPipeline[this.dataPipeline.length]);case"display":i=0,this.resetDisplayRows();case"displayPipeline":for(let s=i;s<this.displayPipeline.length;s++){let a=this.displayPipeline[s].handler((s?this.getDisplayRows(s-1):this.activeRows).slice(0),n);this.setDisplayRows(a||this.getDisplayRows(s-1).slice(0),s)}case"end":this.regenerateRowPositions()}this.getDisplayRows().length&&this._clearPlaceholder()}regenerateRowPositions(){var e=this.getDisplayRows(),t=1;e.forEach(i=>{i.type==="row"&&(i.setPosition(t),t++)})}setActiveRows(e){this.activeRows=this.activeRows=Object.assign([],e),this.activeRowsCount=this.activeRows.length}resetDisplayRows(){this.displayRows=[],this.displayRows.push(this.activeRows.slice(0)),this.displayRowsCount=this.displayRows[0].length}setDisplayRows(e,t){this.displayRows[t]=e,t==this.displayRows.length-1&&(this.displayRowsCount=this.displayRows[this.displayRows.length-1].length)}getDisplayRows(e){return typeof e>"u"?this.displayRows.length?this.displayRows[this.displayRows.length-1]:[]:this.displayRows[e]||[]}getVisibleRows(e,t){var i=Object.assign([],this.renderer.visibleRows(!t));return e&&(i=this.chain("rows-visible",[t],i,i)),i}displayRowIterator(e){this.activeRowsPipeline.forEach(e),this.displayRows.forEach(e),this.displayRowsCount=this.displayRows[this.displayRows.length-1].length}getRows(e){var t=[];switch(e){case"active":t=this.activeRows;break;case"display":t=this.table.rowManager.getDisplayRows();break;case"visible":t=this.getVisibleRows(!1,!0);break;default:t=this.chain("rows-retrieve",e,null,this.rows)||this.rows}return t}reRenderInPosition(e){this.redrawBlock?e?e():this.redrawBlockRenderInPosition=!0:(this.dispatchExternal("renderStarted"),this.renderer.rerenderRows(e),this.fixedHeight||this.adjustTableSize(),this.scrollBarCheck(),this.dispatchExternal("renderComplete"))}scrollBarCheck(){var e=0;this.element.scrollHeight>this.element.clientHeight&&(e=this.element.offsetWidth-this.element.clientWidth),e!==this.scrollbarWidth&&(this.scrollbarWidth=e,this.dispatch("scrollbar-vertical",e))}initializeRenderer(){var e,t={virtual:pw,basic:fw};typeof this.table.options.renderVertical=="string"?e=t[this.table.options.renderVertical]:e=this.table.options.renderVertical,e?(this.renderMode=this.table.options.renderVertical,this.renderer=new e(this.table,this.element,this.tableElement),this.renderer.initialize(),(this.table.element.clientHeight||this.table.options.height)&&!(this.table.options.minHeight&&this.table.options.maxHeight)?this.fixedHeight=!0:this.fixedHeight=!1):console.error("Unable to find matching renderer:",this.table.options.renderVertical)}getRenderMode(){return this.renderMode}renderTable(){this.dispatchExternal("renderStarted"),this.element.scrollTop=0,this._clearTable(),this.displayRowsCount?(this.renderer.renderRows(),this.firstRender&&(this.firstRender=!1,this.fixedHeight||this.adjustTableSize(),this.layoutRefresh(!0))):this.renderEmptyScroll(),this.fixedHeight||this.adjustTableSize(),this.dispatch("table-layout"),this.displayRowsCount||this._showPlaceholder(),this.scrollBarCheck(),this.dispatchExternal("renderComplete")}renderEmptyScroll(){this.placeholder?this.tableElement.style.display="none":this.tableElement.style.minWidth=this.table.columnManager.getWidth()+"px"}_clearTable(){this._clearPlaceholder(),this.scrollTop=0,this.scrollLeft=0,this.renderer.clearRows()}tableEmpty(){this.renderEmptyScroll(),this._showPlaceholder()}checkPlaceholder(){this.displayRowsCount?this._clearPlaceholder():this.tableEmpty()}_showPlaceholder(){this.placeholder&&(this.placeholder&&this.placeholder.parentNode&&this.placeholder.parentNode.removeChild(this.placeholder),this.initializePlaceholder(),this.placeholder.setAttribute("tabulator-render-mode",this.renderMode),this.getElement().appendChild(this.placeholder),this._positionPlaceholder(),this.adjustTableSize())}_clearPlaceholder(){this.placeholder&&this.placeholder.parentNode&&this.placeholder.parentNode.removeChild(this.placeholder),this.tableElement.style.minWidth="",this.tableElement.style.display=""}_positionPlaceholder(){this.placeholder&&this.placeholder.parentNode&&(this.placeholder.style.width=this.table.columnManager.getWidth()+"px",this.placeholderContents.style.width=this.table.rowManager.element.clientWidth+"px",this.placeholderContents.style.marginLeft=this.scrollLeft+"px")}styleRow(e,t){var i=e.getElement();t%2?(i.classList.add("tabulator-row-even"),i.classList.remove("tabulator-row-odd")):(i.classList.add("tabulator-row-odd"),i.classList.remove("tabulator-row-even"))}normalizeHeight(e){this.activeRows.forEach(function(t){t.normalizeHeight(e)})}adjustTableSize(){let e=this.element.clientHeight,t,i=!1;if(this.renderer.verticalFillMode==="fill"){let n=Math.floor(this.table.columnManager.getElement().getBoundingClientRect().height+(this.table.footerManager&&this.table.footerManager.active&&!this.table.footerManager.external?this.table.footerManager.getElement().getBoundingClientRect().height:0));if(this.fixedHeight){t=isNaN(this.table.options.minHeight)?this.table.options.minHeight:this.table.options.minHeight+"px";const s="calc(100% - "+n+"px)";this.element.style.minHeight=t||"calc(100% - "+n+"px)",this.element.style.height=s,this.element.style.maxHeight=s}else this.element.style.height="",this.element.style.height=this.table.element.clientHeight-n+"px",this.element.scrollTop=this.scrollTop;this.renderer.resize(),!this.fixedHeight&&e!=this.element.clientHeight&&(i=!0,this.subscribed("table-resize")?this.dispatch("table-resize"):this.redraw()),this.scrollBarCheck()}return this._positionPlaceholder(),i}reinitialize(){this.rows.forEach(function(e){e.reinitialize(!0)})}blockRedraw(){this.redrawBlock=!0,this.redrawBlockRestoreConfig=!1}restoreRedraw(){this.redrawBlock=!1,this.redrawBlockRestoreConfig?(this.refreshActiveData(this.redrawBlockRestoreConfig.handler,this.redrawBlockRestoreConfig.skipStage,this.redrawBlockRestoreConfig.renderInPosition),this.redrawBlockRestoreConfig=!1):this.redrawBlockRenderInPosition&&this.reRenderInPosition(),this.redrawBlockRenderInPosition=!1}redraw(e){this.adjustTableSize(),this.table.tableWidth=this.table.element.clientWidth,e?this.renderTable():(this.reRenderInPosition(),this.scrollHorizontal(this.scrollLeft))}resetScroll(){if(this.element.scrollLeft=0,this.element.scrollTop=0,this.table.browser==="ie"){var e=document.createEvent("Event");e.initEvent("scroll",!1,!0),this.element.dispatchEvent(e)}else this.element.dispatchEvent(new Event("scroll"))}}class gw extends At{constructor(e){super(e),this.active=!1,this.element=this.createElement(),this.containerElement=this.createContainerElement(),this.external=!1}initialize(){this.initializeElement()}createElement(){var e=document.createElement("div");return e.classList.add("tabulator-footer"),e}createContainerElement(){var e=document.createElement("div");return e.classList.add("tabulator-footer-contents"),this.element.appendChild(e),e}initializeElement(){if(this.table.options.footerElement)switch(typeof this.table.options.footerElement){case"string":this.table.options.footerElement[0]==="<"?this.containerElement.innerHTML=this.table.options.footerElement:(this.external=!0,this.containerElement=document.querySelector(this.table.options.footerElement));break;default:this.element=this.table.options.footerElement;break}}getElement(){return this.element}append(e){this.activate(),this.containerElement.appendChild(e),this.table.rowManager.adjustTableSize()}prepend(e){this.activate(),this.element.insertBefore(e,this.element.firstChild),this.table.rowManager.adjustTableSize()}remove(e){e.parentNode.removeChild(e),this.deactivate()}deactivate(e){(!this.element.firstChild||e)&&(this.external||this.element.parentNode.removeChild(this.element),this.active=!1)}activate(){this.active||(this.active=!0,this.external||(this.table.element.appendChild(this.getElement()),this.table.element.style.display=""))}redraw(){this.dispatch("footer-redraw")}}class vw extends At{constructor(e){super(e),this.el=null,this.abortClasses=["tabulator-headers","tabulator-table"],this.previousTargets={},this.listeners=["click","dblclick","contextmenu","mouseenter","mouseleave","mouseover","mouseout","mousemove","mouseup","mousedown","touchstart","touchend"],this.componentMap={"tabulator-cell":"cell","tabulator-row":"row","tabulator-group":"group","tabulator-col":"column"},this.pseudoTrackers={row:{subscriber:null,target:null},cell:{subscriber:null,target:null},group:{subscriber:null,target:null},column:{subscriber:null,target:null}},this.pseudoTracking=!1}initialize(){this.el=this.table.element,this.buildListenerMap(),this.bindSubscriptionWatchers()}buildListenerMap(){var e={};this.listeners.forEach(t=>{e[t]={handler:null,components:[]}}),this.listeners=e}bindPseudoEvents(){Object.keys(this.pseudoTrackers).forEach(e=>{this.pseudoTrackers[e].subscriber=this.pseudoMouseEnter.bind(this,e),this.subscribe(e+"-mouseover",this.pseudoTrackers[e].subscriber)}),this.pseudoTracking=!0}pseudoMouseEnter(e,t,i){this.pseudoTrackers[e].target!==i&&(this.pseudoTrackers[e].target&&this.dispatch(e+"-mouseleave",t,this.pseudoTrackers[e].target),this.pseudoMouseLeave(e,t),this.pseudoTrackers[e].target=i,this.dispatch(e+"-mouseenter",t,i))}pseudoMouseLeave(e,t){var i=Object.keys(this.pseudoTrackers),n={row:["cell"],cell:["row"]};i=i.filter(s=>{var a=n[e];return s!==e&&(!a||a&&!a.includes(s))}),i.forEach(s=>{var a=this.pseudoTrackers[s].target;this.pseudoTrackers[s].target&&(this.dispatch(s+"-mouseleave",t,a),this.pseudoTrackers[s].target=null)})}bindSubscriptionWatchers(){var e=Object.keys(this.listeners),t=Object.values(this.componentMap);for(let i of t)for(let n of e){let s=i+"-"+n;this.subscriptionChange(s,this.subscriptionChanged.bind(this,i,n))}this.subscribe("table-destroy",this.clearWatchers.bind(this))}subscriptionChanged(e,t,i){var n=this.listeners[t].components,s=n.indexOf(e),a=!1;i?s===-1&&(n.push(e),a=!0):this.subscribed(e+"-"+t)||s>-1&&(n.splice(s,1),a=!0),(t==="mouseenter"||t==="mouseleave")&&!this.pseudoTracking&&this.bindPseudoEvents(),a&&this.updateEventListeners()}updateEventListeners(){for(let e in this.listeners){let t=this.listeners[e];t.components.length?t.handler||(t.handler=this.track.bind(this,e),this.el.addEventListener(e,t.handler)):t.handler&&(this.el.removeEventListener(e,t.handler),t.handler=null)}}track(e,t){var i=t.composedPath&&t.composedPath()||t.path,n=this.findTargets(i);n=this.bindComponents(e,n),this.triggerEvents(e,t,n),this.pseudoTracking&&(e=="mouseover"||e=="mouseleave")&&!Object.keys(n).length&&this.pseudoMouseLeave("none",t)}findTargets(e){var t={};let i=Object.keys(this.componentMap);for(let n of e){let s=n.classList?[...n.classList]:[];if(s.filter(l=>this.abortClasses.includes(l)).length)break;let o=s.filter(l=>i.includes(l));for(let l of o)t[this.componentMap[l]]||(t[this.componentMap[l]]=n)}return t.group&&t.group===t.row&&delete t.row,t}bindComponents(e,t){var i=Object.keys(t).reverse(),n=this.listeners[e],s={},a={},o={};for(let l of i){let h,u=t[l],d=this.previousTargets[l];if(d&&d.target===u)h=d.component;else switch(l){case"row":case"group":(n.components.includes("row")||n.components.includes("cell")||n.components.includes("group"))&&(h=this.table.rowManager.getVisibleRows(!0).find(f=>f.getElement()===u),t.row&&t.row.parentNode&&t.row.parentNode.closest(".tabulator-row")&&(t[l]=!1));break;case"column":n.components.includes("column")&&(h=this.table.columnManager.findColumn(u));break;case"cell":n.components.includes("cell")&&(s.row instanceof It?h=s.row.findCell(u):t.row&&console.warn("Event Target Lookup Error - The row this cell is attached to cannot be found, has the table been reinitialized without being destroyed first?"));break}h&&(s[l]=h,o[l]={target:u,component:h})}return this.previousTargets=o,Object.keys(t).forEach(l=>{let h=s[l];a[l]=h}),a}triggerEvents(e,t,i){var n=this.listeners[e];for(let s in i)i[s]&&n.components.includes(s)&&this.dispatch(s+"-"+e,t,i[s])}clearWatchers(){for(let e in this.listeners){let t=this.listeners[e];t.handler&&(this.el.removeEventListener(e,t.handler),t.handler=null)}}}class bw{constructor(e){this.table=e,this.bindings={}}bind(e,t,i){this.bindings[e]||(this.bindings[e]={}),this.bindings[e][t]?console.warn("Unable to bind component handler, a matching function name is already bound",e,t,i):this.bindings[e][t]=i}handle(e,t,i){if(this.bindings[e]&&this.bindings[e][i]&&typeof this.bindings[e][i].bind=="function")return this.bindings[e][i].bind(null,t);i!=="then"&&typeof i=="string"&&!i.startsWith("_")&&this.table.options.debugInvalidComponentFuncs&&console.error("The "+e+" component does not have a "+i+" function, have you checked that you have the correct Tabulator module installed?")}}class ww extends At{constructor(e){super(e),this.requestOrder=0,this.loading=!1}initialize(){}load(e,t,i,n,s,a){var o=++this.requestOrder;if(this.table.destroyed)return Promise.resolve();if(this.dispatchExternal("dataLoading",e),e&&(e.indexOf("{")==0||e.indexOf("[")==0)&&(e=JSON.parse(e)),this.confirm("data-loading",[e,t,i,s])){this.loading=!0,s||this.alertLoader(),t=this.chain("data-params",[e,i,s],t||{},t||{}),t=this.mapParams(t,this.table.options.dataSendParams);var l=this.chain("data-load",[e,t,i,s],!1,Promise.resolve([]));return l.then(h=>{if(this.table.destroyed)console.warn("Data Load Response Blocked - Table has been destroyed");else{!Array.isArray(h)&&typeof h=="object"&&(h=this.mapParams(h,this.objectInvert(this.table.options.dataReceiveParams)));var u=this.chain("data-loaded",[h],null,h);o==this.requestOrder?(this.clearAlert(),u!==!1&&(this.dispatchExternal("dataLoaded",u),this.table.rowManager.setData(u,n,typeof a>"u"?!n:a))):console.warn("Data Load Response Blocked - An active data load request was blocked by an attempt to change table data while the request was being made")}}).catch(h=>{console.error("Data Load Error: ",h),this.dispatchExternal("dataLoadError",h),s||this.alertError(),setTimeout(()=>{this.clearAlert()},this.table.options.dataLoaderErrorTimeout)}).finally(()=>{this.loading=!1})}else return this.dispatchExternal("dataLoaded",e),e||(e=[]),this.table.rowManager.setData(e,n,typeof a>"u"?!n:a),Promise.resolve()}mapParams(e,t){var i={};for(let n in e)i[t.hasOwnProperty(n)?t[n]:n]=e[n];return i}objectInvert(e){var t={};for(let i in e)t[e[i]]=i;return t}blockActiveLoad(){this.requestOrder++}alertLoader(){var e=typeof this.table.options.dataLoader=="function"?this.table.options.dataLoader():this.table.options.dataLoader;e&&this.table.alertManager.alert(this.table.options.dataLoaderLoading||this.langText("data|loading"))}alertError(){this.table.alertManager.alert(this.table.options.dataLoaderError||this.langText("data|error"),"error")}clearAlert(){this.table.alertManager.clear()}}class xw{constructor(e,t,i){this.table=e,this.events={},this.optionsList=t||{},this.subscriptionNotifiers={},this.dispatch=i?this._debugDispatch.bind(this):this._dispatch.bind(this),this.debug=i}subscriptionChange(e,t){this.subscriptionNotifiers[e]||(this.subscriptionNotifiers[e]=[]),this.subscriptionNotifiers[e].push(t),this.subscribed(e)&&this._notifySubscriptionChange(e,!0)}subscribe(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t),this._notifySubscriptionChange(e,!0)}unsubscribe(e,t){var i;if(this.events[e])if(t)if(i=this.events[e].findIndex(n=>n===t),i>-1)this.events[e].splice(i,1);else{console.warn("Cannot remove event, no matching event found:",e,t);return}else delete this.events[e];else{console.warn("Cannot remove event, no events set on:",e);return}this._notifySubscriptionChange(e,!1)}subscribed(e){return this.events[e]&&this.events[e].length}_notifySubscriptionChange(e,t){var i=this.subscriptionNotifiers[e];i&&i.forEach(n=>{n(t)})}_dispatch(){var e=Array.from(arguments),t=e.shift(),i;return this.events[t]&&this.events[t].forEach((n,s)=>{let a=n.apply(this.table,e);s||(i=a)}),i}_debugDispatch(){var e=Array.from(arguments),t=e[0];return e[0]="ExternalEvent:"+e[0],(this.debug===!0||this.debug.includes(t))&&console.log(...e),this._dispatch(...arguments)}}class yw{constructor(e){this.events={},this.subscriptionNotifiers={},this.dispatch=e?this._debugDispatch.bind(this):this._dispatch.bind(this),this.chain=e?this._debugChain.bind(this):this._chain.bind(this),this.confirm=e?this._debugConfirm.bind(this):this._confirm.bind(this),this.debug=e}subscriptionChange(e,t){this.subscriptionNotifiers[e]||(this.subscriptionNotifiers[e]=[]),this.subscriptionNotifiers[e].push(t),this.subscribed(e)&&this._notifySubscriptionChange(e,!0)}subscribe(e,t,i=1e4){this.events[e]||(this.events[e]=[]),this.events[e].push({callback:t,priority:i}),this.events[e].sort((n,s)=>n.priority-s.priority),this._notifySubscriptionChange(e,!0)}unsubscribe(e,t){var i;if(this.events[e]){if(t)if(i=this.events[e].findIndex(n=>n.callback===t),i>-1)this.events[e].splice(i,1);else{console.warn("Cannot remove event, no matching event found:",e,t);return}}else{console.warn("Cannot remove event, no events set on:",e);return}this._notifySubscriptionChange(e,!1)}subscribed(e){return this.events[e]&&this.events[e].length}_chain(e,t,i,n){var s=i;return Array.isArray(t)||(t=[t]),this.subscribed(e)?(this.events[e].forEach((a,o)=>{s=a.callback.apply(this,t.concat([s]))}),s):typeof n=="function"?n():n}_confirm(e,t){var i=!1;return Array.isArray(t)||(t=[t]),this.subscribed(e)&&this.events[e].forEach((n,s)=>{n.callback.apply(this,t)&&(i=!0)}),i}_notifySubscriptionChange(e,t){var i=this.subscriptionNotifiers[e];i&&i.forEach(n=>{n(t)})}_dispatch(){var e=Array.from(arguments),t=e.shift();this.events[t]&&this.events[t].forEach(i=>{i.callback.apply(this,e)})}_debugDispatch(){var e=Array.from(arguments),t=e[0];return e[0]="InternalEvent:"+t,(this.debug===!0||this.debug.includes(t))&&console.log(...e),this._dispatch(...arguments)}_debugChain(){var e=Array.from(arguments),t=e[0];return e[0]="InternalEvent:"+t,(this.debug===!0||this.debug.includes(t))&&console.log(...e),this._chain(...arguments)}_debugConfirm(){var e=Array.from(arguments),t=e[0];return e[0]="InternalEvent:"+t,(this.debug===!0||this.debug.includes(t))&&console.log(...e),this._confirm(...arguments)}}class Ew extends At{constructor(e){super(e)}_warnUser(){this.options("debugDeprecation")&&console.warn(...arguments)}check(e,t,i){var n="";return typeof this.options(e)<"u"?(n="Deprecated Setup Option - Use of the %c"+e+"%c option is now deprecated",t?(n=n+", Please use the %c"+t+"%c option instead",this._warnUser(n,"font-weight: bold;","font-weight: normal;","font-weight: bold;","font-weight: normal;"),i&&(this.table.options[t]=this.table.options[e])):this._warnUser(n,"font-weight: bold;","font-weight: normal;"),!1):!0}checkMsg(e,t){return typeof this.options(e)<"u"?(this._warnUser("%cDeprecated Setup Option - Use of the %c"+e+" %c option is now deprecated, "+t,"font-weight: normal;","font-weight: bold;","font-weight: normal;"),!1):!0}msg(e){this._warnUser(e)}}class Cw extends At{constructor(e){super(e),this.deps={},this.props={}}initialize(){this.deps=Object.assign({},this.options("dependencies"))}lookup(e,t,i){if(Array.isArray(e)){for(const s of e){var n=this.lookup(s,t,!0);if(n)break}if(n)return n;this.error(e)}else return t?this.lookupProp(e,t,i):this.lookupKey(e,i)}lookupProp(e,t,i){var n;if(this.props[e]&&this.props[e][t])return this.props[e][t];if(n=this.lookupKey(e,i),n)return this.props[e]||(this.props[e]={}),this.props[e][t]=n[t]||n,this.props[e][t]}lookupKey(e,t){var i;return this.deps[e]?i=this.deps[e]:window[e]?(this.deps[e]=window[e],i=this.deps[e]):t||this.error(e),i}error(e){console.error("Unable to find dependency",e,"Please check documentation and ensure you have imported the required library into your project")}}function _w(r,e){e&&this.table.columnManager.renderer.reinitializeColumnWidths(r),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()}function Lh(r,e){r.forEach(function(t){t.reinitializeWidth()}),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()}function Tw(r,e){var t=0,i=this.table.rowManager.element.clientWidth,n=0,s=!1;r.forEach((a,o)=>{a.widthFixed||a.reinitializeWidth(),(this.table.options.responsiveLayout?a.modules.responsive.visible:a.visible)&&(s=a),a.visible&&(t+=a.getWidth())}),s?(n=i-t+s.getWidth(),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&(s.setWidth(0),this.table.modules.responsiveLayout.update()),n>0?s.setWidth(n):s.reinitializeWidth()):this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()}function Sw(r,e){var t=this.table.rowManager.element.getBoundingClientRect().width,i=0,n=0,s=0,a=0,o=[],l=[],h=0,u=0,d=0;function c(p){var v;return typeof p=="string"?p.indexOf("%")>-1?v=t/100*parseInt(p):v=parseInt(p):v=p,v}function f(p,v,m,g){var x=[],b=0,F=0,A=0,_=s,y=0,R=0,M=[];function I(N){return m*(N.column.definition.widthGrow||1)}function P(N){return c(N.width)-m*(N.column.definition.widthShrink||0)}return p.forEach(function(N,ne){var he=g?P(N):I(N);N.column.minWidth>=he?x.push(N):N.column.maxWidth&&N.column.maxWidth<he?(N.width=N.column.maxWidth,v-=N.column.maxWidth,_-=g?N.column.definition.widthShrink||1:N.column.definition.widthGrow||1,_&&(m=Math.floor(v/_))):(M.push(N),R+=g?N.column.definition.widthShrink||1:N.column.definition.widthGrow||1)}),x.length?(x.forEach(function(N){b+=g?N.width-N.column.minWidth:N.column.minWidth,N.width=N.column.minWidth}),F=v-b,A=R?Math.floor(F/R):F,y=f(M,F,A,g)):(y=R?v-Math.floor(v/R)*R:v,M.forEach(function(N){N.width=g?P(N):I(N)})),y}this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update(),this.table.rowManager.element.scrollHeight>this.table.rowManager.element.clientHeight&&(t-=this.table.rowManager.element.offsetWidth-this.table.rowManager.element.clientWidth),r.forEach(function(p){var v,m,g;p.visible&&(v=p.definition.width,m=parseInt(p.minWidth),v?(g=c(v),i+=g>m?g:m,p.definition.widthShrink&&(l.push({column:p,width:g>m?g:m}),h+=p.definition.widthShrink)):(o.push({column:p,width:0}),s+=p.definition.widthGrow||1))}),n=t-i,a=Math.floor(n/s),d=f(o,n,a,!1),o.length&&d>0&&(o[o.length-1].width+=d),o.forEach(function(p){n-=p.width}),u=Math.abs(d)+n,u>0&&h&&(d=f(l,u,Math.floor(u/h),!0)),d&&l.length&&(l[l.length-1].width-=d),o.forEach(function(p){p.column.setWidth(p.width)}),l.forEach(function(p){p.column.setWidth(p.width)})}var Dw={fitData:_w,fitDataFill:Lh,fitDataTable:Lh,fitDataStretch:Tw,fitColumns:Sw};const ln=class ln extends ke{constructor(e){super(e,"layout"),this.mode=null,this.registerTableOption("layout","fitData"),this.registerTableOption("layoutColumnsOnNewData",!1),this.registerColumnOption("widthGrow"),this.registerColumnOption("widthShrink")}initialize(){var e=this.table.options.layout;ln.modes[e]?this.mode=e:(console.warn("Layout Error - invalid mode set, defaulting to 'fitData' : "+e),this.mode="fitData"),this.table.element.setAttribute("tabulator-layout",this.mode),this.subscribe("column-init",this.initializeColumn.bind(this))}initializeColumn(e){e.definition.widthGrow&&(e.definition.widthGrow=Number(e.definition.widthGrow)),e.definition.widthShrink&&(e.definition.widthShrink=Number(e.definition.widthShrink))}getMode(){return this.mode}layout(e){var t=this.table.columnManager.columnsByIndex.find(i=>i.definition.variableHeight||i.definition.formatter==="textarea");this.dispatch("layout-refreshing"),ln.modes[this.mode].call(this,this.table.columnManager.columnsByIndex,e),t&&this.table.rowManager.normalizeHeight(!0),this.dispatch("layout-refreshed")}};G(ln,"moduleName","layout"),G(ln,"modes",Dw);let Jo=ln;var kw={default:{groups:{item:"item",items:"items"},columns:{},data:{loading:"Loading",error:"Error"},pagination:{page_size:"Page Size",page_title:"Show Page",first:"First",first_title:"First Page",last:"Last",last_title:"Last Page",prev:"Prev",prev_title:"Prev Page",next:"Next",next_title:"Next Page",all:"All",counter:{showing:"Showing",of:"of",rows:"rows",pages:"pages"}},headerFilters:{default:"filter column...",columns:{}}}};const es=class es extends ke{constructor(e){super(e),this.locale="default",this.lang=!1,this.bindings={},this.langList={},this.registerTableOption("locale",!1),this.registerTableOption("langs",{})}initialize(){this.langList=et.deepClone(es.langs),this.table.options.columnDefaults.headerFilterPlaceholder!==!1&&this.setHeaderFilterPlaceholder(this.table.options.columnDefaults.headerFilterPlaceholder);for(let e in this.table.options.langs)this.installLang(e,this.table.options.langs[e]);this.setLocale(this.table.options.locale),this.registerTableFunction("setLocale",this.setLocale.bind(this)),this.registerTableFunction("getLocale",this.getLocale.bind(this)),this.registerTableFunction("getLang",this.getLang.bind(this))}setHeaderFilterPlaceholder(e){this.langList.default.headerFilters.default=e}installLang(e,t){this.langList[e]?this._setLangProp(this.langList[e],t):this.langList[e]=t}_setLangProp(e,t){for(let i in t)e[i]&&typeof e[i]=="object"?this._setLangProp(e[i],t[i]):e[i]=t[i]}setLocale(e){e=e||"default";function t(i,n){for(var s in i)typeof i[s]=="object"?(n[s]||(n[s]={}),t(i[s],n[s])):n[s]=i[s]}if(e===!0&&navigator.language&&(e=navigator.language.toLowerCase()),e&&!this.langList[e]){let i=e.split("-")[0];this.langList[i]?(console.warn("Localization Error - Exact matching locale not found, using closest match: ",e,i),e=i):(console.warn("Localization Error - Matching locale not found, using default: ",e),e="default")}this.locale=e,this.lang=et.deepClone(this.langList.default||{}),e!="default"&&t(this.langList[e],this.lang),this.dispatchExternal("localized",this.locale,this.lang),this._executeBindings()}getLocale(e){return this.locale}getLang(e){return e?this.langList[e]:this.lang}getText(e,t){var i=t?e+"|"+t:e,n=i.split("|"),s=this._getLangElement(n,this.locale);return s||""}_getLangElement(e,t){var i=this.lang;return e.forEach(function(n){var s;i&&(s=i[n],typeof s<"u"?i=s:i=!1)}),i}bind(e,t){this.bindings[e]||(this.bindings[e]=[]),this.bindings[e].push(t),t(this.getText(e),this.lang)}_executeBindings(){for(let e in this.bindings)this.bindings[e].forEach(t=>{t(this.getText(e),this.lang)})}};G(es,"moduleName","localize"),G(es,"langs",kw);let Zo=es;class Pc extends ke{constructor(e){super(e)}initialize(){this.registerTableFunction("tableComms",this.receive.bind(this))}getConnections(e){var t=[],i;return i=this.table.constructor.registry.lookupTable(e),i.forEach(n=>{this.table!==n&&t.push(n)}),t}send(e,t,i,n){var s=this.getConnections(e);s.forEach(a=>{a.tableComms(this.table.element,t,i,n)}),!s.length&&e&&console.warn("Table Connection Error - No tables matching selector found",e)}receive(e,t,i,n){if(this.table.modExists(t))return this.table.modules[t].commsReceived(e,i,n);console.warn("Inter-table Comms Error - no such module:",t)}}G(Pc,"moduleName","comms");var Rw=Object.freeze({__proto__:null,CommsModule:Pc,LayoutModule:Jo,LocalizeModule:Zo});const ei=class ei{static findTable(e){var t=ei.registry.lookupTable(e,!0);return Array.isArray(t)&&!t.length?!1:t}};G(ei,"registry",{tables:[],register(e){ei.registry.tables.push(e)},deregister(e){var t=ei.registry.tables.indexOf(e);t>-1&&ei.registry.tables.splice(t,1)},lookupTable(e,t){var i=[],n,s;if(typeof e=="string"){if(n=document.querySelectorAll(e),n.length)for(var a=0;a<n.length;a++)s=ei.registry.matchElement(n[a]),s&&i.push(s)}else typeof HTMLElement<"u"&&e instanceof HTMLElement||e instanceof ei?(s=ei.registry.matchElement(e),s&&i.push(s)):Array.isArray(e)?e.forEach(function(o){i=i.concat(ei.registry.lookupTable(o))}):t||console.warn("Table Connection Error - Invalid Selector",e);return i},matchElement(e){return ei.registry.tables.find(function(t){return e instanceof ei?t===e:t.element===e})}});let el=ei;const Qe=class Qe extends el{constructor(){super()}static initializeModuleBinder(e){Qe.modulesRegistered||(Qe.modulesRegistered=!0,Qe._registerModules(Rw,!0),e&&Qe._registerModules(e))}static _extendModule(e,t,i){if(Qe.moduleBindings[e]){var n=Qe.moduleBindings[e][t];if(n)if(typeof i=="object")for(let s in i)n[s]=i[s];else console.warn("Module Error - Invalid value type, it must be an object");else console.warn("Module Error - property does not exist:",t)}else console.warn("Module Error - module does not exist:",e)}static _registerModules(e,t){var i=Object.values(e);t&&i.forEach(n=>{n.prototype.moduleCore=!0}),Qe._registerModule(i)}static _registerModule(e){Array.isArray(e)||(e=[e]),e.forEach(t=>{Qe._registerModuleBinding(t),Qe._registerModuleExtensions(t)})}static _registerModuleBinding(e){e.moduleName?Qe.moduleBindings[e.moduleName]=e:console.error("Unable to bind module, no moduleName defined",e.moduleName)}static _registerModuleExtensions(e){var t=e.moduleExtensions;if(e.moduleExtensions)for(let i in t){let n=t[i];if(Qe.moduleBindings[i])for(let s in n)Qe._extendModule(i,s,n[s]);else{Qe.moduleExtensions[i]||(Qe.moduleExtensions[i]={});for(let s in n)Qe.moduleExtensions[i][s]||(Qe.moduleExtensions[i][s]={}),Object.assign(Qe.moduleExtensions[i][s],n[s])}}Qe._extendModuleFromQueue(e)}static _extendModuleFromQueue(e){var t=Qe.moduleExtensions[e.moduleName];if(t)for(let i in t)Qe._extendModule(e.moduleName,i,t[i])}_bindModules(){var e=[],t=[],i=[];this.modules={};for(var n in Qe.moduleBindings){let s=Qe.moduleBindings[n],a=new s(this);this.modules[n]=a,s.prototype.moduleCore?this.modulesCore.push(a):s.moduleInitOrder?s.moduleInitOrder<0?e.push(a):t.push(a):i.push(a)}e.sort((s,a)=>s.moduleInitOrder>a.moduleInitOrder?1:-1),t.sort((s,a)=>s.moduleInitOrder>a.moduleInitOrder?1:-1),this.modulesRegular=e.concat(i.concat(t))}};G(Qe,"moduleBindings",{}),G(Qe,"moduleExtensions",{}),G(Qe,"modulesRegistered",!1),G(Qe,"defaultModules",!1);let tl=Qe;class Fw extends At{constructor(e){super(e),this.element=this._createAlertElement(),this.msgElement=this._createMsgElement(),this.type=null,this.element.appendChild(this.msgElement)}_createAlertElement(){var e=document.createElement("div");return e.classList.add("tabulator-alert"),e}_createMsgElement(){var e=document.createElement("div");return e.classList.add("tabulator-alert-msg"),e.setAttribute("role","alert"),e}_typeClass(){return"tabulator-alert-state-"+this.type}alert(e,t="msg"){if(e){for(this.clear(),this.dispatch("alert-show",t),this.type=t;this.msgElement.firstChild;)this.msgElement.removeChild(this.msgElement.firstChild);this.msgElement.classList.add(this._typeClass()),typeof e=="function"&&(e=e()),e instanceof HTMLElement?this.msgElement.appendChild(e):this.msgElement.innerHTML=e,this.table.element.appendChild(this.element)}}clear(){this.dispatch("alert-hide",this.type),this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.msgElement.classList.remove(this._typeClass())}}const Gi=class Gi extends tl{static extendModule(){Gi.initializeModuleBinder(),Gi._extendModule(...arguments)}static registerModule(){Gi.initializeModuleBinder(),Gi._registerModule(...arguments)}constructor(e,t,i){super(),Gi.initializeModuleBinder(i),this.options={},this.columnManager=null,this.rowManager=null,this.footerManager=null,this.alertManager=null,this.vdomHoz=null,this.externalEvents=null,this.eventBus=null,this.interactionMonitor=!1,this.browser="",this.browserSlow=!1,this.browserMobile=!1,this.rtl=!1,this.originalElement=null,this.componentFunctionBinder=new bw(this),this.dataLoader=!1,this.modules={},this.modulesCore=[],this.modulesRegular=[],this.deprecationAdvisor=new Ew(this),this.optionsList=new Lc(this,"table constructor"),this.dependencyRegistry=new Cw(this),this.initialized=!1,this.destroyed=!1,this.initializeElement(e)&&(this.initializeCoreSystems(t),setTimeout(()=>{this._create()})),this.constructor.registry.register(this)}initializeElement(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement?(this.element=e,!0):typeof e=="string"?(this.element=document.querySelector(e),this.element?!0:(console.error("Tabulator Creation Error - no element found matching selector: ",e),!1)):(console.error("Tabulator Creation Error - Invalid element provided:",e),!1)}initializeCoreSystems(e){this.columnManager=new dw(this),this.rowManager=new mw(this),this.footerManager=new gw(this),this.dataLoader=new ww(this),this.alertManager=new Fw(this),this._bindModules(),this.options=this.optionsList.generate(Gi.defaultOptions,e),this._clearObjectPointers(),this._mapDeprecatedFunctionality(),this.externalEvents=new xw(this,this.options,this.options.debugEventsExternal),this.eventBus=new yw(this.options.debugEventsInternal),this.interactionMonitor=new vw(this),this.dataLoader.initialize(),this.footerManager.initialize(),this.dependencyRegistry.initialize()}_mapDeprecatedFunctionality(){}_clearSelection(){this.element.classList.add("tabulator-block-select"),window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty(),this.element.classList.remove("tabulator-block-select")}_create(){this.externalEvents.dispatch("tableBuilding"),this.eventBus.dispatch("table-building"),this._rtlCheck(),this._buildElement(),this._initializeTable(),this.initialized=!0,this._loadInitialData().finally(()=>{this.eventBus.dispatch("table-initialized"),this.externalEvents.dispatch("tableBuilt")})}_rtlCheck(){var e=window.getComputedStyle(this.element);switch(this.options.textDirection){case"auto":if(e.direction!=="rtl")break;case"rtl":this.element.classList.add("tabulator-rtl"),this.rtl=!0;break;case"ltr":this.element.classList.add("tabulator-ltr");default:this.rtl=!1}}_clearObjectPointers(){this.options.columns=this.options.columns.slice(0),Array.isArray(this.options.data)&&!this.options.reactiveData&&(this.options.data=this.options.data.slice(0))}_buildElement(){var e=this.element,t=this.options,i;if(e.tagName==="TABLE"){this.originalElement=this.element,i=document.createElement("div");var n=e.attributes;for(var s in n)typeof n[s]=="object"&&i.setAttribute(n[s].name,n[s].value);e.parentNode.replaceChild(i,e),this.element=e=i}for(e.classList.add("tabulator"),e.setAttribute("role","grid");e.firstChild;)e.removeChild(e.firstChild);t.height&&(t.height=isNaN(t.height)?t.height:t.height+"px",e.style.height=t.height),t.minHeight!==!1&&(t.minHeight=isNaN(t.minHeight)?t.minHeight:t.minHeight+"px",e.style.minHeight=t.minHeight),t.maxHeight!==!1&&(t.maxHeight=isNaN(t.maxHeight)?t.maxHeight:t.maxHeight+"px",e.style.maxHeight=t.maxHeight)}_initializeTable(){var e=this.element,t=this.options;this.interactionMonitor.initialize(),this.columnManager.initialize(),this.rowManager.initialize(),this._detectBrowser(),this.modulesCore.forEach(i=>{i.initialize()}),e.appendChild(this.columnManager.getElement()),e.appendChild(this.rowManager.getElement()),t.footerElement&&this.footerManager.activate(),t.autoColumns&&t.data&&this.columnManager.generateColumnsFromRowData(this.options.data),this.modulesRegular.forEach(i=>{i.initialize()}),this.columnManager.setColumns(t.columns),this.eventBus.dispatch("table-built")}_loadInitialData(){return this.dataLoader.load(this.options.data).finally(()=>{this.columnManager.verticalAlignHeaders()})}destroy(){var e=this.element;for(this.destroyed=!0,this.constructor.registry.deregister(this),this.eventBus.dispatch("table-destroy"),this.rowManager.destroy();e.firstChild;)e.removeChild(e.firstChild);e.classList.remove("tabulator"),this.externalEvents.dispatch("tableDestroyed")}_detectBrowser(){var e=navigator.userAgent||navigator.vendor||window.opera;e.indexOf("Trident")>-1?(this.browser="ie",this.browserSlow=!0):e.indexOf("Edge")>-1?(this.browser="edge",this.browserSlow=!0):e.indexOf("Firefox")>-1?(this.browser="firefox",this.browserSlow=!1):e.indexOf("Mac OS")>-1?(this.browser="safari",this.browserSlow=!1):(this.browser="other",this.browserSlow=!1),this.browserMobile=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(e.slice(0,4))}initGuard(e,t){var i,n;return this.options.debugInitialization&&!this.initialized&&(e||(i=new Error().stack.split(`
`),n=i[0]=="Error"?i[2]:i[1],n[0]==" "?e=n.trim().split(" ")[1].split(".")[1]:e=n.trim().split("@")[0]),console.warn("Table Not Initialized - Calling the "+e+" function before the table is initialized may result in inconsistent behavior, Please wait for the `tableBuilt` event before calling this function."+(t?" "+t:""))),this.initialized}blockRedraw(){this.initGuard(),this.eventBus.dispatch("redraw-blocking"),this.rowManager.blockRedraw(),this.columnManager.blockRedraw(),this.eventBus.dispatch("redraw-blocked")}restoreRedraw(){this.initGuard(),this.eventBus.dispatch("redraw-restoring"),this.rowManager.restoreRedraw(),this.columnManager.restoreRedraw(),this.eventBus.dispatch("redraw-restored")}setData(e,t,i){return this.initGuard(!1,"To set initial data please use the 'data' property in the table constructor."),this.dataLoader.load(e,t,i,!1)}clearData(){this.initGuard(),this.dataLoader.blockActiveLoad(),this.rowManager.clearData()}getData(e){return this.rowManager.getData(e)}getDataCount(e){return this.rowManager.getDataCount(e)}replaceData(e,t,i){return this.initGuard(),this.dataLoader.load(e,t,i,!0,!0)}updateData(e){var t=0;return this.initGuard(),new Promise((i,n)=>{this.dataLoader.blockActiveLoad(),typeof e=="string"&&(e=JSON.parse(e)),e&&e.length>0?e.forEach(s=>{var a=this.rowManager.findRow(s[this.options.index]);a?(t++,a.updateData(s).then(()=>{t--,t||i()}).catch(o=>{n("Update Error - Unable to update row",s,o)})):n("Update Error - Unable to find row",s)}):(console.warn("Update Error - No data provided"),n("Update Error - No data provided"))})}addData(e,t,i){return this.initGuard(),new Promise((n,s)=>{this.dataLoader.blockActiveLoad(),typeof e=="string"&&(e=JSON.parse(e)),e?this.rowManager.addRows(e,t,i).then(a=>{var o=[];a.forEach(function(l){o.push(l.getComponent())}),n(o)}):(console.warn("Update Error - No data provided"),s("Update Error - No data provided"))})}updateOrAddData(e){var t=[],i=0;return this.initGuard(),new Promise((n,s)=>{this.dataLoader.blockActiveLoad(),typeof e=="string"&&(e=JSON.parse(e)),e&&e.length>0?e.forEach(a=>{var o=this.rowManager.findRow(a[this.options.index]);i++,o?o.updateData(a).then(()=>{i--,t.push(o.getComponent()),i||n(t)}):this.rowManager.addRows(a).then(l=>{i--,t.push(l[0].getComponent()),i||n(t)})}):(console.warn("Update Error - No data provided"),s("Update Error - No data provided"))})}getRow(e){var t=this.rowManager.findRow(e);return t?t.getComponent():(console.warn("Find Error - No matching row found:",e),!1)}getRowFromPosition(e){var t=this.rowManager.getRowFromPosition(e);return t?t.getComponent():(console.warn("Find Error - No matching row found:",e),!1)}deleteRow(e){var t=[];this.initGuard(),Array.isArray(e)||(e=[e]);for(let i of e){let n=this.rowManager.findRow(i,!0);if(n)t.push(n);else return console.error("Delete Error - No matching row found:",i),Promise.reject("Delete Error - No matching row found")}return t.sort((i,n)=>this.rowManager.rows.indexOf(i)>this.rowManager.rows.indexOf(n)?1:-1),t.forEach(i=>{i.delete()}),this.rowManager.reRenderInPosition(),Promise.resolve()}addRow(e,t,i){return this.initGuard(),typeof e=="string"&&(e=JSON.parse(e)),this.rowManager.addRows(e,t,i,!0).then(n=>n[0].getComponent())}updateOrAddRow(e,t){var i=this.rowManager.findRow(e);return this.initGuard(),typeof t=="string"&&(t=JSON.parse(t)),i?i.updateData(t).then(()=>i.getComponent()):this.rowManager.addRows(t).then(n=>n[0].getComponent())}updateRow(e,t){var i=this.rowManager.findRow(e);return this.initGuard(),typeof t=="string"&&(t=JSON.parse(t)),i?i.updateData(t).then(()=>Promise.resolve(i.getComponent())):(console.warn("Update Error - No matching row found:",e),Promise.reject("Update Error - No matching row found"))}scrollToRow(e,t,i){var n=this.rowManager.findRow(e);return n?this.rowManager.scrollToRow(n,t,i):(console.warn("Scroll Error - No matching row found:",e),Promise.reject("Scroll Error - No matching row found"))}moveRow(e,t,i){var n=this.rowManager.findRow(e);this.initGuard(),n?n.moveToRow(t,i):console.warn("Move Error - No matching row found:",e)}getRows(e){return this.rowManager.getComponents(e)}getRowPosition(e){var t=this.rowManager.findRow(e);return t?t.getPosition():(console.warn("Position Error - No matching row found:",e),!1)}setColumns(e){this.initGuard(!1,"To set initial columns please use the 'columns' property in the table constructor"),this.columnManager.setColumns(e)}getColumns(e){return this.columnManager.getComponents(e)}getColumn(e){var t=this.columnManager.findColumn(e);return t?t.getComponent():(console.warn("Find Error - No matching column found:",e),!1)}getColumnDefinitions(){return this.columnManager.getDefinitionTree()}showColumn(e){var t=this.columnManager.findColumn(e);if(this.initGuard(),t)t.show();else return console.warn("Column Show Error - No matching column found:",e),!1}hideColumn(e){var t=this.columnManager.findColumn(e);if(this.initGuard(),t)t.hide();else return console.warn("Column Hide Error - No matching column found:",e),!1}toggleColumn(e){var t=this.columnManager.findColumn(e);if(this.initGuard(),t)t.visible?t.hide():t.show();else return console.warn("Column Visibility Toggle Error - No matching column found:",e),!1}addColumn(e,t,i){var n=this.columnManager.findColumn(i);return this.initGuard(),this.columnManager.addColumn(e,t,n).then(s=>s.getComponent())}deleteColumn(e){var t=this.columnManager.findColumn(e);return this.initGuard(),t?t.delete():(console.warn("Column Delete Error - No matching column found:",e),Promise.reject())}updateColumnDefinition(e,t){var i=this.columnManager.findColumn(e);return this.initGuard(),i?i.updateDefinition(t):(console.warn("Column Update Error - No matching column found:",e),Promise.reject())}moveColumn(e,t,i){var n=this.columnManager.findColumn(e),s=this.columnManager.findColumn(t);this.initGuard(),n?s?this.columnManager.moveColumn(n,s,i):console.warn("Move Error - No matching column found:",s):console.warn("Move Error - No matching column found:",e)}scrollToColumn(e,t,i){return new Promise((n,s)=>{var a=this.columnManager.findColumn(e);return a?this.columnManager.scrollToColumn(a,t,i):(console.warn("Scroll Error - No matching column found:",e),Promise.reject("Scroll Error - No matching column found"))})}redraw(e){this.initGuard(),this.columnManager.redraw(e),this.rowManager.redraw(e)}setHeight(e){this.options.height=isNaN(e)?e:e+"px",this.element.style.height=this.options.height,this.rowManager.initializeRenderer(),this.rowManager.redraw(!0)}on(e,t){this.externalEvents.subscribe(e,t)}off(e,t){this.externalEvents.unsubscribe(e,t)}dispatchEvent(){var e=Array.from(arguments);e.shift(),this.externalEvents.dispatch(...arguments)}alert(e,t){this.initGuard(),this.alertManager.alert(e,t)}clearAlert(){this.initGuard(),this.alertManager.clear()}modExists(e,t){return this.modules[e]?!0:(t&&console.error("Tabulator Module Not Installed: "+e),!1)}module(e){var t=this.modules[e];return t||console.error("Tabulator module not installed: "+e),t}};G(Gi,"defaultOptions",hw);let il=Gi;var zn=il;class Mw extends zn{static extendModule(){zn.initializeModuleBinder(so),zn._extendModule(...arguments)}static registerModule(){zn.initializeModuleBinder(so),zn._registerModule(...arguments)}constructor(e,t,i){super(e,t,so)}}var Aw=Mw;function iD(r,e,t,i={}){const n=(l,h)=>{if(h&&typeof h=="object"){const u=l.getElement();Object.keys(h).forEach(d=>{u.style[d]=h[d]})}return l.getValue()!==void 0&&l.getValue()!==null?l.getValue():""},s=e.map(l=>{if(l.cellStyle&&typeof l.cellStyle=="object"){const h=l.formatter,{cellStyle:u,...d}=l;return{...d,formatter:c=>(n(c,u),h?h(c):c.getValue())}}return{...l}}),o={...{height:"50vh",layout:"fitColumns",layoutColumnsOnNewData:!1,responsiveLayout:!1,responsiveLayoutCollapseStartOpen:!0,autoResize:!0,renderVertical:"virtual",renderHorizontal:"virtual",data:t||[],reactiveData:!1,dataTree:!1,dataTreeStartExpanded:!1,columns:s,autoColumns:!1,movableColumns:!0,resizableColumns:!0,headerVisible:!0,headerSort:!0,headerFilterLiveFilterDelay:300,movableRows:!0,resizableRows:!1,selectable:!0,selectableRollingSelection:!0,selectablePersistence:!0,pagination:"local",paginationSize:50,paginationButtonCount:10,paginationSizeSelector:[50,100,200,300],paginationInitialPage:1,placeholder:" .",columnMoved:(l,h)=>{console.log("Column moved:",l.getField(),h.map(u=>u.getField()))},columnDefaults:{tooltip:!0,cssClass:""}},...i,data:t};try{return new Aw(r,o)}catch(l){throw console.error("Tabulator  :",l),l}}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var sa={};sa.version="0.20.3";var Yi=1200,rs=function(r){Yi=r};function Ow(){rs(1200)}var Fs=function(e){return String.fromCharCode(e)},Ph=function(e){return String.fromCharCode(e)},Ht="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function aa(r){for(var e="",t=0,i=0,n=0,s=0,a=0,o=0,l=0,h=0;h<r.length;)t=r.charCodeAt(h++),s=t>>2,i=r.charCodeAt(h++),a=(t&3)<<4|i>>4,n=r.charCodeAt(h++),o=(i&15)<<2|n>>6,l=n&63,isNaN(i)?o=l=64:isNaN(n)&&(l=64),e+=Ht.charAt(s)+Ht.charAt(a)+Ht.charAt(o)+Ht.charAt(l);return e}function Lw(r){for(var e="",t=0,i=0,n=0,s=0,a=0,o=0,l=0,h=0;h<r.length;)t=r.charCodeAt(h++),t>255&&(t=95),s=t>>2,i=r.charCodeAt(h++),i>255&&(i=95),a=(t&3)<<4|i>>4,n=r.charCodeAt(h++),n>255&&(n=95),o=(i&15)<<2|n>>6,l=n&63,isNaN(i)?o=l=64:isNaN(n)&&(l=64),e+=Ht.charAt(s)+Ht.charAt(a)+Ht.charAt(o)+Ht.charAt(l);return e}function Pw(r){for(var e="",t=0,i=0,n=0,s=0,a=0,o=0,l=0,h=0;h<r.length;)t=r[h++],s=t>>2,i=r[h++],a=(t&3)<<4|i>>4,n=r[h++],o=(i&15)<<2|n>>6,l=n&63,isNaN(i)?o=l=64:isNaN(n)&&(l=64),e+=Ht.charAt(s)+Ht.charAt(a)+Ht.charAt(o)+Ht.charAt(l);return e}function wr(r){var e="",t=0,i=0,n=0,s=0,a=0,o=0,l=0;if(r.slice(0,5)=="data:"){var h=r.slice(0,1024).indexOf(";base64,");h>-1&&(r=r.slice(h+8))}r=r.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<r.length;)s=Ht.indexOf(r.charAt(h++)),a=Ht.indexOf(r.charAt(h++)),t=s<<2|a>>4,e+=String.fromCharCode(t),o=Ht.indexOf(r.charAt(h++)),i=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(i)),l=Ht.indexOf(r.charAt(h++)),n=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(n));return e}var Ve=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Hi=function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}(),oa=function(){if(typeof Buffer>"u")return!1;var r=Hi([65,0]);if(!r)return!1;var e=r.toString("utf16le");return e.length==1}();function Vr(r){return Ve?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function Nh(r){return Ve?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var ii=function(e){return Ve?Hi(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function Na(r){if(typeof ArrayBuffer>"u")return ii(r);for(var e=new ArrayBuffer(r.length),t=new Uint8Array(e),i=0;i!=r.length;++i)t[i]=r.charCodeAt(i)&255;return e}function Ur(r){if(Array.isArray(r))return r.map(function(i){return String.fromCharCode(i)}).join("");for(var e=[],t=0;t<r.length;++t)e[t]=String.fromCharCode(r[t]);return e.join("")}function Nw(r){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(r)}var wt=Ve?function(r){return Buffer.concat(r.map(function(e){return Buffer.isBuffer(e)?e:Hi(e)}))}:function(r){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<r.length;++e)t+=r[e].length;var i=new Uint8Array(t),n=0;for(e=0,t=0;e<r.length;t+=n,++e)n=r[e].length,r[e]instanceof Uint8Array?i.set(r[e],t):typeof r[e]=="string"?i.set(new Uint8Array(ii(r[e])),t):i.set(new Uint8Array(r[e]),t);return i}return[].concat.apply([],r.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Iw(r){for(var e=[],t=0,i=r.length+250,n=Vr(r.length+255),s=0;s<r.length;++s){var a=r.charCodeAt(s);if(a<128)n[t++]=a;else if(a<2048)n[t++]=192|a>>6&31,n[t++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=r.charCodeAt(++s)&1023;n[t++]=240|a>>8&7,n[t++]=128|a>>2&63,n[t++]=128|o>>6&15|(a&3)<<4,n[t++]=128|o&63}else n[t++]=224|a>>12&15,n[t++]=128|a>>6&63,n[t++]=128|a&63;t>i&&(e.push(n.slice(0,t)),t=0,n=Vr(65535),i=65530)}return e.push(n.slice(0,t)),wt(e)}var Yn=/\u0000/g,Ms=/[\u0001-\u0006]/g;function dn(r){for(var e="",t=r.length-1;t>=0;)e+=r.charAt(t--);return e}function bi(r,e){var t=""+r;return t.length>=e?t:at("0",e-t.length)+t}function Tl(r,e){var t=""+r;return t.length>=e?t:at(" ",e-t.length)+t}function la(r,e){var t=""+r;return t.length>=e?t:t+at(" ",e-t.length)}function Bw(r,e){var t=""+Math.round(r);return t.length>=e?t:at("0",e-t.length)+t}function Hw(r,e){var t=""+r;return t.length>=e?t:at("0",e-t.length)+t}var Ih=Math.pow(2,32);function Zr(r,e){if(r>Ih||r<-Ih)return Bw(r,e);var t=Math.round(r);return Hw(t,e)}function ha(r,e){return e=e||0,r.length>=7+e&&(r.charCodeAt(e)|32)===103&&(r.charCodeAt(e+1)|32)===101&&(r.charCodeAt(e+2)|32)===110&&(r.charCodeAt(e+3)|32)===101&&(r.charCodeAt(e+4)|32)===114&&(r.charCodeAt(e+5)|32)===97&&(r.charCodeAt(e+6)|32)===108}var Bh=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ao=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function zw(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"/ "hh""mm""ss" "',r}var rt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Hh={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Ww={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ua(r,e,t){for(var i=r<0?-1:1,n=r*i,s=0,a=1,o=0,l=1,h=0,u=0,d=Math.floor(n);h<e&&(d=Math.floor(n),o=d*a+s,u=d*h+l,!(n-d<5e-8));)n=1/(n-d),s=a,a=o,l=h,h=u;if(u>e&&(h>e?(u=l,o=s):(u=h,o=a)),!t)return[0,i*o,u];var c=Math.floor(i*o/u);return[c,i*o-c*u,u]}function Vw(r){var e=r.toPrecision(16);if(e.indexOf("e")>-1){var t=e.slice(0,e.indexOf("e"));return t=t.indexOf(".")>-1?t.slice(0,t.slice(0,2)=="0."?17:16):t.slice(0,15)+at("0",t.length-15),t+e.slice(e.indexOf("e"))}var i=e.indexOf(".")>-1?e.slice(0,e.slice(0,2)=="0."?17:16):e.slice(0,15)+at("0",e.length-15);return Number(i)}function en(r,e,t){if(r>2958465||r<0)return null;r=Vw(r);var i=r|0,n=Math.floor(86400*(r-i)),s=0,a=[],o={D:i,T:n,u:86400*(r-i)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(i+=1462),o.u>.9999&&(o.u=0,++n==86400&&(o.T=n=0,++i,++o.D)),i===60)a=t?[1317,10,29]:[1900,2,29],s=3;else if(i===0)a=t?[1317,8,29]:[1900,1,0],s=6;else{i>60&&--i;var l=new Date(1900,0,1);l.setDate(l.getDate()+i-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),i<60&&(s=(s+6)%7),t&&(s=Xw(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=n%60,n=Math.floor(n/60),o.M=n%60,n=Math.floor(n/60),o.H=n,o.q=s,o}function Sl(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Uw(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Gw(r){var e=r<0?12:11,t=Sl(r.toFixed(12));return t.length<=e||(t=r.toPrecision(10),t.length<=e)?t:r.toExponential(5)}function Yw(r){var e=Sl(r.toFixed(11));return e.length>(r<0?12:11)||e==="0"||e==="-0"?r.toPrecision(6):e}function jw(r){if(!isFinite(r))return isNaN(r)?"#NUM!":"#DIV/0!";var e=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),t;return e>=-4&&e<=-1?t=r.toPrecision(10+e):Math.abs(e)<=9?t=Gw(r):e===10?t=r.toFixed(10).substr(0,12):t=Yw(r),Sl(Uw(t.toUpperCase()))}function rl(r,e){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):jw(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return tr(14,Mt(r,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+r)}function Xw(r,e){e[0]-=581;var t=r.getDay();return r<60&&(t=(t+6)%7),t}function $w(r,e,t,i){var n="",s=0,a=0,o=t.y,l,h=0;switch(r){case 98:o=t.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,h=2;break;default:l=o%1e4,h=4;break}break;case 109:switch(e.length){case 1:case 2:l=t.m,h=e.length;break;case 3:return ao[t.m-1][1];case 5:return ao[t.m-1][0];default:return ao[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=t.d,h=e.length;break;case 3:return Bh[t.q][0];default:return Bh[t.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(t.H+11)%12,h=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=t.H,h=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=t.M,h=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?bi(t.S,e.length):(i>=2?a=i===3?1e3:100:a=i===1?10:1,s=Math.round(a*(t.S+t.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(n=bi(s,2+i),e==="ss"?n.substr(0,2):"."+n.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+(i==0?Math.round(t.S+t.u):t.S);break;default:throw"bad abstime format: "+e}h=e.length===3?1:2;break;case 101:l=o,h=1;break}var u=h>0?bi(l,h):"";return u}function pr(r){var e=3;if(r.length<=e)return r;for(var t=r.length%e,i=r.substr(0,t);t!=r.length;t+=e)i+=(i.length>0?",":"")+r.substr(t,e);return i}var Nc=/%/g;function Kw(r,e,t){var i=e.replace(Nc,""),n=e.length-i.length;return qi(r,i,t*Math.pow(10,2*n))+at("%",n)}function Qw(r,e,t){for(var i=e.length-1;e.charCodeAt(i-1)===44;)--i;return qi(r,e.substr(0,i),t/Math.pow(10,3*(e.length-i)))}function Ic(r,e){var t,i=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Ic(r,-e);var n=r.indexOf(".");n===-1&&(n=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%n;if(s<0&&(s+=n),t=(e/Math.pow(10,s)).toPrecision(i+1+(n+s)%n),t.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,n)+"."+t.substr(2+n),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,h,u){return l+h+u.substr(0,(n+s)%n)+"."+u.substr(s)+"E"})}else t=e.toExponential(i);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Bc=/# (\?+)( ?)\/( ?)(\d+)/;function qw(r,e,t){var i=parseInt(r[4],10),n=Math.round(e*i),s=Math.floor(n/i),a=n-s*i,o=i;return t+(s===0?"":""+s)+" "+(a===0?at(" ",r[1].length+1+r[4].length):Tl(a,r[1].length)+r[2]+"/"+r[3]+bi(o,r[4].length))}function Jw(r,e,t){return t+(e===0?"":""+e)+at(" ",r[1].length+2+r[4].length)}var Hc=/^#*0*\.([0#]+)/,zc=/\)[^)]*[0#]/,Wc=/\(###\) ###\\?-####/;function jt(r){for(var e="",t,i=0;i!=r.length;++i)switch(t=r.charCodeAt(i)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function zh(r,e){var t=Math.pow(10,e);return""+Math.round(r*t)/t}function Wh(r,e){var t=r-Math.floor(r),i=Math.pow(10,e);return e<(""+Math.round(t*i)).length?0:Math.round(t*i)}function Zw(r,e){return e<(""+Math.round((r-Math.floor(r))*Math.pow(10,e))).length?1:0}function ex(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function oi(r,e,t){if(r.charCodeAt(0)===40&&!e.match(zc)){var i=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?oi("n",i,t):"("+oi("n",i,-t)+")"}if(e.charCodeAt(e.length-1)===44)return Qw(r,e,t);if(e.indexOf("%")!==-1)return Kw(r,e,t);if(e.indexOf("E")!==-1)return Ic(e,t);if(e.charCodeAt(0)===36)return"$"+oi(r,e.substr(e.charAt(1)==" "?2:1),t);var n,s,a,o,l=Math.abs(t),h=t<0?"-":"";if(e.match(/^00+$/))return h+Zr(l,e.length);if(e.match(/^[#?]+$/))return n=Zr(t,0),n==="0"&&(n=""),n.length>e.length?n:jt(e.substr(0,e.length-n.length))+n;if(s=e.match(Bc))return qw(s,l,h);if(e.match(/^#+0+$/))return h+Zr(l,e.length-e.indexOf("0"));if(s=e.match(Hc))return n=zh(t,s[1].length).replace(/^([^\.]+)$/,"$1."+jt(s[1])).replace(/\.$/,"."+jt(s[1])).replace(/\.(\d*)$/,function(p,v){return"."+v+at("0",jt(s[1]).length-v.length)}),e.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return h+zh(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return h+pr(Zr(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+oi(r,e,-t):pr(""+(Math.floor(t)+Zw(t,s[1].length)))+"."+bi(Wh(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return oi(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return n=dn(oi(r,e.replace(/[\\-]/g,""),t)),a=0,dn(dn(e.replace(/\\/g,"")).replace(/[0#]/g,function(p){return a<n.length?n.charAt(a++):p==="0"?"0":""}));if(e.match(Wc))return n=oi(r,"##########",t),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=ua(l,Math.pow(10,a)-1,!1),n=""+h,u=qi("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),n+=u+s[2]+"/"+s[3],u=la(o[2],a),u.length<s[4].length&&(u=jt(s[4].substr(s[4].length-u.length))+u),n+=u,n;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=ua(l,Math.pow(10,a)-1,!0),h+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Tl(o[1],a)+s[2]+"/"+s[3]+la(o[2],a):at(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return n=Zr(t,0),e.length<=n.length?n:jt(e.substr(0,e.length-n.length))+n;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){n=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=n.indexOf(".");var d=e.indexOf(".")-a,c=e.length-n.length-d;return jt(e.substr(0,d)+n+e.substr(e.length-c))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=Wh(t,s[1].length),t<0?"-"+oi(r,e,-t):pr(ex(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?bi(0,3-p.length):"")+p})+"."+bi(a,s[1].length);switch(e){case"###,##0.00":return oi(r,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var f=pr(Zr(l,0));return f!=="0"?h+f:"";case"###,###.00":return oi(r,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return oi(r,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function tx(r,e,t){for(var i=e.length-1;e.charCodeAt(i-1)===44;)--i;return qi(r,e.substr(0,i),t/Math.pow(10,3*(e.length-i)))}function ix(r,e,t){var i=e.replace(Nc,""),n=e.length-i.length;return qi(r,i,t*Math.pow(10,2*n))+at("%",n)}function Vc(r,e){var t,i=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Vc(r,-e);var n=r.indexOf(".");n===-1&&(n=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%n;if(s<0&&(s+=n),t=(e/Math.pow(10,s)).toPrecision(i+1+(n+s)%n),!t.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,h,u){return l+h+u.substr(0,(n+s)%n)+"."+u.substr(s)+"E"})}else t=e.toExponential(i);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Ci(r,e,t){if(r.charCodeAt(0)===40&&!e.match(zc)){var i=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Ci("n",i,t):"("+Ci("n",i,-t)+")"}if(e.charCodeAt(e.length-1)===44)return tx(r,e,t);if(e.indexOf("%")!==-1)return ix(r,e,t);if(e.indexOf("E")!==-1)return Vc(e,t);if(e.charCodeAt(0)===36)return"$"+Ci(r,e.substr(e.charAt(1)==" "?2:1),t);var n,s,a,o,l=Math.abs(t),h=t<0?"-":"";if(e.match(/^00+$/))return h+bi(l,e.length);if(e.match(/^[#?]+$/))return n=""+t,t===0&&(n=""),n.length>e.length?n:jt(e.substr(0,e.length-n.length))+n;if(s=e.match(Bc))return Jw(s,l,h);if(e.match(/^#+0+$/))return h+bi(l,e.length-e.indexOf("0"));if(s=e.match(Hc))return n=(""+t).replace(/^([^\.]+)$/,"$1."+jt(s[1])).replace(/\.$/,"."+jt(s[1])),n=n.replace(/\.(\d*)$/,function(p,v){return"."+v+at("0",jt(s[1]).length-v.length)}),e.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return h+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return h+pr(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Ci(r,e,-t):pr(""+t)+"."+at("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Ci(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return n=dn(Ci(r,e.replace(/[\\-]/g,""),t)),a=0,dn(dn(e.replace(/\\/g,"")).replace(/[0#]/g,function(p){return a<n.length?n.charAt(a++):p==="0"?"0":""}));if(e.match(Wc))return n=Ci(r,"##########",t),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=ua(l,Math.pow(10,a)-1,!1),n=""+h,u=qi("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),n+=u+s[2]+"/"+s[3],u=la(o[2],a),u.length<s[4].length&&(u=jt(s[4].substr(s[4].length-u.length))+u),n+=u,n;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=ua(l,Math.pow(10,a)-1,!0),h+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Tl(o[1],a)+s[2]+"/"+s[3]+la(o[2],a):at(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return n=""+t,e.length<=n.length?n:jt(e.substr(0,e.length-n.length))+n;if(s=e.match(/^([#0]+)\.([#0]+)$/)){n=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=n.indexOf(".");var d=e.indexOf(".")-a,c=e.length-n.length-d;return jt(e.substr(0,d)+n+e.substr(e.length-c))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Ci(r,e,-t):pr(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?bi(0,3-p.length):"")+p})+"."+bi(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var f=pr(""+l);return f!=="0"?h+f:"";default:if(e.match(/\.[0#?]*$/))return Ci(r,e.slice(0,e.lastIndexOf(".")),t)+jt(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function qi(r,e,t){return(t|0)===t?Ci(r,e,t):oi(r,e,t)}function rx(r){for(var e=[],t=!1,i=0,n=0;i<r.length;++i)switch(r.charCodeAt(i)){case 34:t=!t;break;case 95:case 42:case 92:++i;break;case 59:e[e.length]=r.substr(n,i-n),n=i+1}if(e[e.length]=r.substr(n),t===!0)throw new Error("Format |"+r+"| unterminated string ");return e}var Uc=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Gr(r){for(var e=0,t="",i="";e<r.length;)switch(t=r.charAt(e)){case"G":ha(r,e)&&(e+=6),e++;break;case'"':for(;r.charCodeAt(++e)!==34&&e<r.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(r.charAt(e+1)==="1"||r.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(r.substr(e,3).toUpperCase()==="A/P"||r.substr(e,5).toUpperCase()==="AM/PM"||r.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(i=t;r.charAt(e++)!=="]"&&e<r.length;)i+=r.charAt(e);if(i.match(Uc))return!0;break;case".":case"0":case"#":for(;e<r.length&&("0#?.,E+-%".indexOf(t=r.charAt(++e))>-1||t=="\\"&&r.charAt(e+1)=="-"&&"0#".indexOf(r.charAt(e+2))>-1););break;case"?":for(;r.charAt(++e)===t;);break;case"*":++e,(r.charAt(e)==" "||r.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<r.length&&"0123456789".indexOf(r.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function nx(r,e,t,i){for(var n=[],s="",a=0,o="",l="t",h,u,d,c="H";a<r.length;)switch(o=r.charAt(a)){case"G":if(!ha(r,a))throw new Error("unrecognized character "+o+" in "+r);n[n.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(d=r.charCodeAt(++a))!==34&&a<r.length;)s+=String.fromCharCode(d);n[n.length]={t:"t",v:s},++a;break;case"\\":var f=r.charAt(++a),p=f==="("||f===")"?f:"t";n[n.length]={t:p,v:f},++a;break;case"_":n[n.length]={t:"t",v:" "},a+=2;break;case"@":n[n.length]={t:"T",v:e},++a;break;case"B":case"b":if(r.charAt(a+1)==="1"||r.charAt(a+1)==="2"){if(h==null&&(h=en(e,t,r.charAt(a+1)==="2"),h==null))return"";n[n.length]={t:"X",v:r.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||h==null&&(h=en(e,t),h==null))return"";for(s=o;++a<r.length&&r.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=c),n[n.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var v={t:o,v:o};if(h==null&&(h=en(e,t)),r.substr(a,3).toUpperCase()==="A/P"?(h!=null&&(v.v=h.H>=12?r.charAt(a+2):o),v.t="T",c="h",a+=3):r.substr(a,5).toUpperCase()==="AM/PM"?(h!=null&&(v.v=h.H>=12?"PM":"AM"),v.t="T",a+=5,c="h"):r.substr(a,5).toUpperCase()==="/"?(h!=null&&(v.v=h.H>=12?"":""),v.t="T",a+=5,c="h"):(v.t="t",++a),h==null&&v.t==="T")return"";n[n.length]=v,l=o;break;case"[":for(s=o;r.charAt(a++)!=="]"&&a<r.length;)s+=r.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Uc)){if(h==null&&(h=en(e,t),h==null))return"";n[n.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Gr(r)||(n[n.length]={t:"t",v:s}));break;case".":if(h!=null){for(s=o;++a<r.length&&(o=r.charAt(a))==="0";)s+=o;n[n.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<r.length&&"0#?.,E+-%".indexOf(o=r.charAt(a))>-1;)s+=o;n[n.length]={t:"n",v:s};break;case"?":for(s=o;r.charAt(++a)===o;)s+=o;n[n.length]={t:o,v:s},l=o;break;case"*":++a,(r.charAt(a)==" "||r.charAt(a)=="*")&&++a;break;case"(":case")":n[n.length]={t:i===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<r.length&&"0123456789".indexOf(r.charAt(++a))>-1;)s+=r.charAt(a);n[n.length]={t:"D",v:s};break;case" ":n[n.length]={t:o,v:o},++a;break;case"$":n[n.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+r);n[n.length]={t:"t",v:o},++a;break}var m=0,g=0,x;for(a=n.length-1,l="t";a>=0;--a)switch(n[a].t){case"h":case"H":n[a].t=c,l="h",m<1&&(m=1);break;case"s":(x=n[a].v.match(/\.0+$/))&&(g=Math.max(g,x[0].length-1),m=4),m<3&&(m=3);case"d":case"y":case"e":l=n[a].t;break;case"M":l=n[a].t,m<2&&(m=2);break;case"m":l==="s"&&(n[a].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&n[a].v.match(/[Hh]/)&&(m=1),m<2&&n[a].v.match(/[Mm]/)&&(m=2),m<3&&n[a].v.match(/[Ss]/)&&(m=3)}var b;switch(m){case 0:break;case 1:case 2:case 3:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H),h.H>=24&&(h.H=0,++h.D,b=en(h.D),b.u=h.u,b.S=h.S,b.M=h.M,b.H=h.H,h=b);break;case 4:switch(g){case 1:h.u=Math.round(h.u*10)/10;break;case 2:h.u=Math.round(h.u*100)/100;break;case 3:h.u=Math.round(h.u*1e3)/1e3;break}h.u>=1&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H),h.H>=24&&(h.H=0,++h.D,b=en(h.D),b.u=h.u,b.S=h.S,b.M=h.M,b.H=h.H,h=b);break}var F="",A;for(a=0;a<n.length;++a)switch(n[a].t){case"t":case"T":case" ":case"D":break;case"X":n[a].v="",n[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[a].v=$w(n[a].t.charCodeAt(0),n[a].v,h,g),n[a].t="t";break;case"n":case"?":for(A=a+1;n[A]!=null&&((o=n[A].t)==="?"||o==="D"||(o===" "||o==="t")&&n[A+1]!=null&&(n[A+1].t==="?"||n[A+1].t==="t"&&n[A+1].v==="/")||n[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(n[A].v==="/"||n[A].v===" "&&n[A+1]!=null&&n[A+1].t=="?"));)n[a].v+=n[A].v,n[A]={v:"",t:";"},++A;F+=n[a].v,a=A-1;break;case"G":n[a].t="t",n[a].v=rl(e,t);break}var _="",y,R;if(F.length>0){F.charCodeAt(0)==40?(y=e<0&&F.charCodeAt(0)===45?-e:e,R=qi("n",F,y)):(y=e<0&&i>1?-e:e,R=qi("n",F,y),y<0&&n[0]&&n[0].t=="t"&&(R=R.substr(1),n[0].v="-"+n[0].v)),A=R.length-1;var M=n.length;for(a=0;a<n.length;++a)if(n[a]!=null&&n[a].t!="t"&&n[a].v.indexOf(".")>-1){M=a;break}var I=n.length;if(M===n.length&&R.indexOf("E")===-1){for(a=n.length-1;a>=0;--a)n[a]==null||"n?".indexOf(n[a].t)===-1||(A>=n[a].v.length-1?(A-=n[a].v.length,n[a].v=R.substr(A+1,n[a].v.length)):A<0?n[a].v="":(n[a].v=R.substr(0,A+1),A=-1),n[a].t="t",I=a);A>=0&&I<n.length&&(n[I].v=R.substr(0,A+1)+n[I].v)}else if(M!==n.length&&R.indexOf("E")===-1){for(A=R.indexOf(".")-1,a=M;a>=0;--a)if(!(n[a]==null||"n?".indexOf(n[a].t)===-1)){for(u=n[a].v.indexOf(".")>-1&&a===M?n[a].v.indexOf(".")-1:n[a].v.length-1,_=n[a].v.substr(u+1);u>=0;--u)A>=0&&(n[a].v.charAt(u)==="0"||n[a].v.charAt(u)==="#")&&(_=R.charAt(A--)+_);n[a].v=_,n[a].t="t",I=a}for(A>=0&&I<n.length&&(n[I].v=R.substr(0,A+1)+n[I].v),A=R.indexOf(".")+1,a=M;a<n.length;++a)if(!(n[a]==null||"n?(".indexOf(n[a].t)===-1&&a!==M)){for(u=n[a].v.indexOf(".")>-1&&a===M?n[a].v.indexOf(".")+1:0,_=n[a].v.substr(0,u);u<n[a].v.length;++u)A<R.length&&(_+=R.charAt(A++));n[a].v=_,n[a].t="t",I=a}}}for(a=0;a<n.length;++a)n[a]!=null&&"n?".indexOf(n[a].t)>-1&&(y=i>1&&e<0&&a>0&&n[a-1].v==="-"?-e:e,n[a].v=qi(n[a].t,n[a].v,y),n[a].t="t");var P="";for(a=0;a!==n.length;++a)n[a]!=null&&(P+=n[a].v);return P}var Vh=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Uh(r,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(r==t)return!0;break;case">":if(r>t)return!0;break;case"<":if(r<t)return!0;break;case"<>":if(r!=t)return!0;break;case">=":if(r>=t)return!0;break;case"<=":if(r<=t)return!0;break}return!1}function sx(r,e){var t=rx(r),i=t.length,n=t[i-1].indexOf("@");if(i<4&&n>-1&&--i,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||n>-1?t[t.length-1]:"@"];switch(typeof e=="number"&&!isFinite(e)&&(e=0),t.length){case 1:t=n>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=n>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=n>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[i,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var a=t[0].match(Vh),o=t[1].match(Vh);return Uh(e,a)?[i,t[0]]:Uh(e,o)?[i,t[1]]:[i,t[a!=null&&o!=null?2:1]]}return[i,s]}function tr(r,e,t){t==null&&(t={});var i="";switch(typeof r){case"string":r=="m/d/yy"&&t.dateNF?i=t.dateNF:i=r;break;case"number":r==14&&t.dateNF?i=t.dateNF:i=(t.table!=null?t.table:rt)[r],i==null&&(i=t.table&&t.table[Hh[r]]||rt[Hh[r]]),i==null&&(i=Ww[r]||"General");break}if(ha(i,0))return rl(e,t);e instanceof Date&&(e=Mt(e,t.date1904));var n=sx(i,e);if(ha(n[1]))return rl(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else{if(e===""||e==null)return"";if(isNaN(e)&&n[1].indexOf("0")>-1)return"#NUM!";if(!isFinite(e)&&n[1].indexOf("0")>-1)return"#DIV/0!"}return nx(n[1],e,t,n[0])}function Gc(r,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(rt[t]==null){e<0&&(e=t);continue}if(rt[t]==r){e=t;break}}e<0&&(e=391)}return rt[e]=r,e}function Ia(r){for(var e=0;e!=392;++e)r[e]!==void 0&&Gc(r[e],e)}function Ba(){rt=zw()}var ca=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function ax(r){var e=typeof r=="number"?rt[r]:r;return e=e.replace(ca,"(\\d+)"),ca.lastIndex=0,new RegExp("^"+e+"$")}function ox(r,e,t){var i=-1,n=-1,s=-1,a=-1,o=-1,l=-1;(e.match(ca)||[]).forEach(function(d,c){var f=parseInt(t[c+1],10);switch(d.toLowerCase().charAt(0)){case"y":i=f;break;case"d":s=f;break;case"h":a=f;break;case"s":l=f;break;case"m":a>=0?o=f:n=f;break}}),ca.lastIndex=0,l>=0&&o==-1&&n>=0&&(o=n,n=-1);var h=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?h:i==-1&&n==-1&&s==-1?u:h+"T"+u}var lx={"d.m":"d\\.m"};function hx(r,e){return Gc(lx[r]||r,e)}var Gh=function(){var r={};r.version="1.2.0";function e(){for(var y=0,R=new Array(256),M=0;M!=256;++M)y=M,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,R[M]=y;return typeof Int32Array<"u"?new Int32Array(R):R}var t=e();function i(y){var R=0,M=0,I=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)P[I]=y[I];for(I=0;I!=256;++I)for(M=y[I],R=256+I;R<4096;R+=256)M=P[R]=M>>>8^y[M&255];var N=[];for(I=1;I!=16;++I)N[I-1]=typeof Int32Array<"u"&&typeof P.subarray=="function"?P.subarray(I*256,I*256+256):P.slice(I*256,I*256+256);return N}var n=i(t),s=n[0],a=n[1],o=n[2],l=n[3],h=n[4],u=n[5],d=n[6],c=n[7],f=n[8],p=n[9],v=n[10],m=n[11],g=n[12],x=n[13],b=n[14];function F(y,R){for(var M=R^-1,I=0,P=y.length;I<P;)M=M>>>8^t[(M^y.charCodeAt(I++))&255];return~M}function A(y,R){for(var M=R^-1,I=y.length-15,P=0;P<I;)M=b[y[P++]^M&255]^x[y[P++]^M>>8&255]^g[y[P++]^M>>16&255]^m[y[P++]^M>>>24]^v[y[P++]]^p[y[P++]]^f[y[P++]]^c[y[P++]]^d[y[P++]]^u[y[P++]]^h[y[P++]]^l[y[P++]]^o[y[P++]]^a[y[P++]]^s[y[P++]]^t[y[P++]];for(I+=15;P<I;)M=M>>>8^t[(M^y[P++])&255];return~M}function _(y,R){for(var M=R^-1,I=0,P=y.length,N=0,ne=0;I<P;)N=y.charCodeAt(I++),N<128?M=M>>>8^t[(M^N)&255]:N<2048?(M=M>>>8^t[(M^(192|N>>6&31))&255],M=M>>>8^t[(M^(128|N&63))&255]):N>=55296&&N<57344?(N=(N&1023)+64,ne=y.charCodeAt(I++)&1023,M=M>>>8^t[(M^(240|N>>8&7))&255],M=M>>>8^t[(M^(128|N>>2&63))&255],M=M>>>8^t[(M^(128|ne>>6&15|(N&3)<<4))&255],M=M>>>8^t[(M^(128|ne&63))&255]):(M=M>>>8^t[(M^(224|N>>12&15))&255],M=M>>>8^t[(M^(128|N>>6&63))&255],M=M>>>8^t[(M^(128|N&63))&255]);return~M}return r.table=t,r.bstr=F,r.buf=A,r.str=_,r}(),Ze=function(){var e={};e.version="1.2.2";function t(w,S){for(var E=w.split("/"),C=S.split("/"),T=0,D=0,z=Math.min(E.length,C.length);T<z;++T){if(D=E[T].length-C[T].length)return D;if(E[T]!=C[T])return E[T]<C[T]?-1:1}return E.length-C.length}function i(w){if(w.charAt(w.length-1)=="/")return w.slice(0,-1).indexOf("/")===-1?w:i(w.slice(0,-1));var S=w.lastIndexOf("/");return S===-1?w:w.slice(0,S+1)}function n(w){if(w.charAt(w.length-1)=="/")return n(w.slice(0,-1));var S=w.lastIndexOf("/");return S===-1?w:w.slice(S+1)}function s(w,S){typeof S=="string"&&(S=new Date(S));var E=S.getHours();E=E<<6|S.getMinutes(),E=E<<5|S.getSeconds()>>>1,w.write_shift(2,E);var C=S.getFullYear()-1980;C=C<<4|S.getMonth()+1,C=C<<5|S.getDate(),w.write_shift(2,C)}function a(w){var S=w.read_shift(2)&65535,E=w.read_shift(2)&65535,C=new Date,T=E&31;E>>>=5;var D=E&15;E>>>=4,C.setMilliseconds(0),C.setFullYear(E+1980),C.setMonth(D-1),C.setDate(T);var z=S&31;S>>>=5;var Y=S&63;return S>>>=6,C.setHours(S),C.setMinutes(Y),C.setSeconds(z<<1),C}function o(w){Xt(w,0);for(var S={},E=0;w.l<=w.length-4;){var C=w.read_shift(2),T=w.read_shift(2),D=w.l+T,z={};switch(C){case 21589:E=w.read_shift(1),E&1&&(z.mtime=w.read_shift(4)),T>5&&(E&2&&(z.atime=w.read_shift(4)),E&4&&(z.ctime=w.read_shift(4))),z.mtime&&(z.mt=new Date(z.mtime*1e3));break;case 1:{var Y=w.read_shift(4),B=w.read_shift(4);z.usz=B*Math.pow(2,32)+Y,Y=w.read_shift(4),B=w.read_shift(4),z.csz=B*Math.pow(2,32)+Y}break}w.l=D,S[C]=z}return S}var l;function h(){return l||(l=ux)}function u(w,S){if(w[0]==80&&w[1]==75)return $l(w,S);if((w[0]|32)==109&&(w[1]|32)==105)return mf(w,S);if(w.length<512)throw new Error("CFB file size "+w.length+" < 512");var E=3,C=512,T=0,D=0,z=0,Y=0,B=0,W=[],V=w.slice(0,512);Xt(V,0);var q=d(V);switch(E=q[0],E){case 3:C=512;break;case 4:C=4096;break;case 0:if(q[1]==0)return $l(w,S);default:throw new Error("Major Version: Expected 3 or 4 saw "+E)}C!==512&&(V=w.slice(0,C),Xt(V,28));var te=w.slice(0,C);c(V,E);var ce=V.read_shift(4,"i");if(E===3&&ce!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ce);V.l+=4,z=V.read_shift(4,"i"),V.l+=4,V.chk("00100000","Mini Stream Cutoff Size: "),Y=V.read_shift(4,"i"),T=V.read_shift(4,"i"),B=V.read_shift(4,"i"),D=V.read_shift(4,"i");for(var J=-1,re=0;re<109&&(J=V.read_shift(4,"i"),!(J<0));++re)W[re]=J;var Ce=f(w,C);m(B,D,Ce,C,W);var st=x(Ce,z,W,C);z<st.length&&(st[z].name="!Directory"),T>0&&Y!==ne&&(st[Y].name="!MiniFAT"),st[W[0]].name="!FAT",st.fat_addrs=W,st.ssz=C;var ht={},Ot=[],Pn=[],Nn=[];b(z,st,Ce,Ot,T,ht,Pn,Y),p(Pn,Nn,Ot),Ot.shift();var In={FileIndex:Pn,FullPaths:Nn};return S&&S.raw&&(In.raw={header:te,sectors:Ce}),In}function d(w){if(w[w.l]==80&&w[w.l+1]==75)return[0,0];w.chk(he,"Header Signature: "),w.l+=16;var S=w.read_shift(2,"u");return[w.read_shift(2,"u"),S]}function c(w,S){var E=9;switch(w.l+=2,E=w.read_shift(2)){case 9:if(S!=3)throw new Error("Sector Shift: Expected 9 saw "+E);break;case 12:if(S!=4)throw new Error("Sector Shift: Expected 12 saw "+E);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+E)}w.chk("0600","Mini Sector Shift: "),w.chk("000000000000","Reserved: ")}function f(w,S){for(var E=Math.ceil(w.length/S)-1,C=[],T=1;T<E;++T)C[T-1]=w.slice(T*S,(T+1)*S);return C[E-1]=w.slice(E*S),C}function p(w,S,E){for(var C=0,T=0,D=0,z=0,Y=0,B=E.length,W=[],V=[];C<B;++C)W[C]=V[C]=C,S[C]=E[C];for(;Y<V.length;++Y)C=V[Y],T=w[C].L,D=w[C].R,z=w[C].C,W[C]===C&&(T!==-1&&W[T]!==T&&(W[C]=W[T]),D!==-1&&W[D]!==D&&(W[C]=W[D])),z!==-1&&(W[z]=C),T!==-1&&C!=W[C]&&(W[T]=W[C],V.lastIndexOf(T)<Y&&V.push(T)),D!==-1&&C!=W[C]&&(W[D]=W[C],V.lastIndexOf(D)<Y&&V.push(D));for(C=1;C<B;++C)W[C]===C&&(D!==-1&&W[D]!==D?W[C]=W[D]:T!==-1&&W[T]!==T&&(W[C]=W[T]));for(C=1;C<B;++C)if(w[C].type!==0){if(Y=C,Y!=W[Y])do Y=W[Y],S[C]=S[Y]+"/"+S[C];while(Y!==0&&W[Y]!==-1&&Y!=W[Y]);W[C]=-1}for(S[0]+="/",C=1;C<B;++C)w[C].type!==2&&(S[C]+="/")}function v(w,S,E){for(var C=w.start,T=w.size,D=[],z=C;E&&T>0&&z>=0;)D.push(S.slice(z*N,z*N+N)),T-=N,z=kr(E,z*4);return D.length===0?H(0):wt(D).slice(0,w.size)}function m(w,S,E,C,T){var D=ne;if(w===ne){if(S!==0)throw new Error("DIFAT chain shorter than expected")}else if(w!==-1){var z=E[w],Y=(C>>>2)-1;if(!z)return;for(var B=0;B<Y&&(D=kr(z,B*4))!==ne;++B)T.push(D);S>=1&&m(kr(z,C-4),S-1,E,C,T)}}function g(w,S,E,C,T){var D=[],z=[];T||(T=[]);var Y=C-1,B=0,W=0;for(B=S;B>=0;){T[B]=!0,D[D.length]=B,z.push(w[B]);var V=E[Math.floor(B*4/C)];if(W=B*4&Y,C<4+W)throw new Error("FAT boundary crossed: "+B+" 4 "+C);if(!w[V])break;B=kr(w[V],W)}return{nodes:D,data:qh([z])}}function x(w,S,E,C){var T=w.length,D=[],z=[],Y=[],B=[],W=C-1,V=0,q=0,te=0,ce=0;for(V=0;V<T;++V)if(Y=[],te=V+S,te>=T&&(te-=T),!z[te]){B=[];var J=[];for(q=te;q>=0;){J[q]=!0,z[q]=!0,Y[Y.length]=q,B.push(w[q]);var re=E[Math.floor(q*4/C)];if(ce=q*4&W,C<4+ce)throw new Error("FAT boundary crossed: "+q+" 4 "+C);if(!w[re]||(q=kr(w[re],ce),J[q]))break}D[te]={nodes:Y,data:qh([B])}}return D}function b(w,S,E,C,T,D,z,Y){for(var B=0,W=C.length?2:0,V=S[w].data,q=0,te=0,ce;q<V.length;q+=128){var J=V.slice(q,q+128);Xt(J,64),te=J.read_shift(2),ce=Al(J,0,te-W),C.push(ce);var re={name:ce,type:J.read_shift(1),color:J.read_shift(1),L:J.read_shift(4,"i"),R:J.read_shift(4,"i"),C:J.read_shift(4,"i"),clsid:J.read_shift(16),state:J.read_shift(4,"i"),start:0,size:0},Ce=J.read_shift(2)+J.read_shift(2)+J.read_shift(2)+J.read_shift(2);Ce!==0&&(re.ct=F(J,J.l-8));var st=J.read_shift(2)+J.read_shift(2)+J.read_shift(2)+J.read_shift(2);st!==0&&(re.mt=F(J,J.l-8)),re.start=J.read_shift(4,"i"),re.size=J.read_shift(4,"i"),re.size<0&&re.start<0&&(re.size=re.type=0,re.start=ne,re.name=""),re.type===5?(B=re.start,T>0&&B!==ne&&(S[B].name="!StreamData")):re.size>=4096?(re.storage="fat",S[re.start]===void 0&&(S[re.start]=g(E,re.start,S.fat_addrs,S.ssz)),S[re.start].name=re.name,re.content=S[re.start].data.slice(0,re.size)):(re.storage="minifat",re.size<0?re.size=0:B!==ne&&re.start!==ne&&S[B]&&(re.content=v(re,S[B].data,(S[Y]||{}).data))),re.content&&Xt(re.content,0),D[ce]=re,z.push(re)}}function F(w,S){return new Date((ni(w,S+4)/1e7*Math.pow(2,32)+ni(w,S)/1e7-11644473600)*1e3)}function A(w,S){return h(),u(l.readFileSync(w),S)}function _(w,S){var E=S&&S.type;switch(E||Ve&&Buffer.isBuffer(w)&&(E="buffer"),E||"base64"){case"file":return A(w,S);case"base64":return u(ii(wr(w)),S);case"binary":return u(ii(w),S)}return u(w,S)}function y(w,S){var E=S||{},C=E.root||"Root Entry";if(w.FullPaths||(w.FullPaths=[]),w.FileIndex||(w.FileIndex=[]),w.FullPaths.length!==w.FileIndex.length)throw new Error("inconsistent CFB structure");w.FullPaths.length===0&&(w.FullPaths[0]=C+"/",w.FileIndex[0]={name:C,type:5}),E.CLSID&&(w.FileIndex[0].clsid=E.CLSID),R(w)}function R(w){var S="Sh33tJ5";if(!Ze.find(w,"/"+S)){var E=H(4);E[0]=55,E[1]=E[3]=50,E[2]=54,w.FileIndex.push({name:S,type:2,content:E,size:4,L:69,R:69,C:69}),w.FullPaths.push(w.FullPaths[0]+S),M(w)}}function M(w,S){y(w);for(var E=!1,C=!1,T=w.FullPaths.length-1;T>=0;--T){var D=w.FileIndex[T];switch(D.type){case 0:C?E=!0:(w.FileIndex.pop(),w.FullPaths.pop());break;case 1:case 2:case 5:C=!0,isNaN(D.R*D.L*D.C)&&(E=!0),D.R>-1&&D.L>-1&&D.R==D.L&&(E=!0);break;default:E=!0;break}}if(!(!E&&!S)){var z=new Date(1987,1,19),Y=0,B=Object.create?Object.create(null):{},W=[];for(T=0;T<w.FullPaths.length;++T)B[w.FullPaths[T]]=!0,w.FileIndex[T].type!==0&&W.push([w.FullPaths[T],w.FileIndex[T]]);for(T=0;T<W.length;++T){var V=i(W[T][0]);for(C=B[V];!C;){for(;i(V)&&!B[i(V)];)V=i(V);W.push([V,{name:n(V).replace("/",""),type:1,clsid:fe,ct:z,mt:z,content:null}]),B[V]=!0,V=i(W[T][0]),C=B[V]}}for(W.sort(function(ce,J){return t(ce[0],J[0])}),w.FullPaths=[],w.FileIndex=[],T=0;T<W.length;++T)w.FullPaths[T]=W[T][0],w.FileIndex[T]=W[T][1];for(T=0;T<W.length;++T){var q=w.FileIndex[T],te=w.FullPaths[T];if(q.name=n(te).replace("/",""),q.L=q.R=q.C=-(q.color=1),q.size=q.content?q.content.length:0,q.start=0,q.clsid=q.clsid||fe,T===0)q.C=W.length>1?1:-1,q.size=0,q.type=5;else if(te.slice(-1)=="/"){for(Y=T+1;Y<W.length&&i(w.FullPaths[Y])!=te;++Y);for(q.C=Y>=W.length?-1:Y,Y=T+1;Y<W.length&&i(w.FullPaths[Y])!=i(te);++Y);q.R=Y>=W.length?-1:Y,q.type=1}else i(w.FullPaths[T+1]||"")==i(te)&&(q.R=T+1),q.type=2}}}function I(w,S){var E=S||{};if(E.fileType=="mad")return gf(w,E);switch(M(w),E.fileType){case"zip":return hf(w,E)}var C=function(ce){for(var J=0,re=0,Ce=0;Ce<ce.FileIndex.length;++Ce){var st=ce.FileIndex[Ce];if(st.content){var ht=st.content.length;ht>0&&(ht<4096?J+=ht+63>>6:re+=ht+511>>9)}}for(var Ot=ce.FullPaths.length+3>>2,Pn=J+7>>3,Nn=J+127>>7,In=Pn+re+Ot+Nn,Tr=In+127>>7,Ka=Tr<=109?0:Math.ceil((Tr-109)/127);In+Tr+Ka+127>>7>Tr;)Ka=++Tr<=109?0:Math.ceil((Tr-109)/127);var Wi=[1,Ka,Tr,Nn,Ot,re,J,0];return ce.FileIndex[0].size=J<<6,Wi[7]=(ce.FileIndex[0].start=Wi[0]+Wi[1]+Wi[2]+Wi[3]+Wi[4]+Wi[5])+(Wi[6]+7>>3),Wi}(w),T=H(C[7]<<9),D=0,z=0;{for(D=0;D<8;++D)T.write_shift(1,se[D]);for(D=0;D<8;++D)T.write_shift(2,0);for(T.write_shift(2,62),T.write_shift(2,3),T.write_shift(2,65534),T.write_shift(2,9),T.write_shift(2,6),D=0;D<3;++D)T.write_shift(2,0);for(T.write_shift(4,0),T.write_shift(4,C[2]),T.write_shift(4,C[0]+C[1]+C[2]+C[3]-1),T.write_shift(4,0),T.write_shift(4,4096),T.write_shift(4,C[3]?C[0]+C[1]+C[2]-1:ne),T.write_shift(4,C[3]),T.write_shift(-4,C[1]?C[0]-1:ne),T.write_shift(4,C[1]),D=0;D<109;++D)T.write_shift(-4,D<C[2]?C[1]+D:-1)}if(C[1])for(z=0;z<C[1];++z){for(;D<236+z*127;++D)T.write_shift(-4,D<C[2]?C[1]+D:-1);T.write_shift(-4,z===C[1]-1?ne:z+1)}var Y=function(ce){for(z+=ce;D<z-1;++D)T.write_shift(-4,D+1);ce&&(++D,T.write_shift(-4,ne))};for(z=D=0,z+=C[1];D<z;++D)T.write_shift(-4,ee.DIFSECT);for(z+=C[2];D<z;++D)T.write_shift(-4,ee.FATSECT);Y(C[3]),Y(C[4]);for(var B=0,W=0,V=w.FileIndex[0];B<w.FileIndex.length;++B)V=w.FileIndex[B],V.content&&(W=V.content.length,!(W<4096)&&(V.start=z,Y(W+511>>9)));for(Y(C[6]+7>>3);T.l&511;)T.write_shift(-4,ee.ENDOFCHAIN);for(z=D=0,B=0;B<w.FileIndex.length;++B)V=w.FileIndex[B],V.content&&(W=V.content.length,!(!W||W>=4096)&&(V.start=z,Y(W+63>>6)));for(;T.l&511;)T.write_shift(-4,ee.ENDOFCHAIN);for(D=0;D<C[4]<<2;++D){var q=w.FullPaths[D];if(!q||q.length===0){for(B=0;B<17;++B)T.write_shift(4,0);for(B=0;B<3;++B)T.write_shift(4,-1);for(B=0;B<12;++B)T.write_shift(4,0);continue}V=w.FileIndex[D],D===0&&(V.start=V.size?V.start-1:ne);var te=D===0&&E.root||V.name;if(te.length>31&&(console.error("Name "+te+" will be truncated to "+te.slice(0,31)),te=te.slice(0,31)),W=2*(te.length+1),T.write_shift(64,te,"utf16le"),T.write_shift(2,W),T.write_shift(1,V.type),T.write_shift(1,V.color),T.write_shift(-4,V.L),T.write_shift(-4,V.R),T.write_shift(-4,V.C),V.clsid)T.write_shift(16,V.clsid,"hex");else for(B=0;B<4;++B)T.write_shift(4,0);T.write_shift(4,V.state||0),T.write_shift(4,0),T.write_shift(4,0),T.write_shift(4,0),T.write_shift(4,0),T.write_shift(4,V.start),T.write_shift(4,V.size),T.write_shift(4,0)}for(D=1;D<w.FileIndex.length;++D)if(V=w.FileIndex[D],V.size>=4096)if(T.l=V.start+1<<9,Ve&&Buffer.isBuffer(V.content))V.content.copy(T,T.l,0,V.size),T.l+=V.size+511&-512;else{for(B=0;B<V.size;++B)T.write_shift(1,V.content[B]);for(;B&511;++B)T.write_shift(1,0)}for(D=1;D<w.FileIndex.length;++D)if(V=w.FileIndex[D],V.size>0&&V.size<4096)if(Ve&&Buffer.isBuffer(V.content))V.content.copy(T,T.l,0,V.size),T.l+=V.size+63&-64;else{for(B=0;B<V.size;++B)T.write_shift(1,V.content[B]);for(;B&63;++B)T.write_shift(1,0)}if(Ve)T.l=T.length;else for(;T.l<T.length;)T.write_shift(1,0);return T}function P(w,S){var E=w.FullPaths.map(function(B){return B.toUpperCase()}),C=E.map(function(B){var W=B.split("/");return W[W.length-(B.slice(-1)=="/"?2:1)]}),T=!1;S.charCodeAt(0)===47?(T=!0,S=E[0].slice(0,-1)+S):T=S.indexOf("/")!==-1;var D=S.toUpperCase(),z=T===!0?E.indexOf(D):C.indexOf(D);if(z!==-1)return w.FileIndex[z];var Y=!D.match(Ms);for(D=D.replace(Yn,""),Y&&(D=D.replace(Ms,"!")),z=0;z<E.length;++z)if((Y?E[z].replace(Ms,"!"):E[z]).replace(Yn,"")==D||(Y?C[z].replace(Ms,"!"):C[z]).replace(Yn,"")==D)return w.FileIndex[z];return null}var N=64,ne=-2,he="d0cf11e0a1b11ae1",se=[208,207,17,224,161,177,26,225],fe="00000000000000000000000000000000",ee={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ne,FREESECT:-1,HEADER_SIGNATURE:he,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:fe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ge(w,S,E){h();var C=I(w,E);l.writeFileSync(S,C)}function _e(w){for(var S=new Array(w.length),E=0;E<w.length;++E)S[E]=String.fromCharCode(w[E]);return S.join("")}function Je(w,S){var E=I(w,S);switch(S&&S.type||"buffer"){case"file":return h(),l.writeFileSync(S.filename,E),E;case"binary":return typeof E=="string"?E:_e(E);case"base64":return aa(typeof E=="string"?E:_e(E));case"buffer":if(Ve)return Buffer.isBuffer(E)?E:Hi(E);case"array":return typeof E=="string"?ii(E):E}return E}var tt;function De(w){try{var S=w.InflateRaw,E=new S;if(E._processChunk(new Uint8Array([3,0]),E._finishFlushFlag),E.bytesRead)tt=w;else throw new Error("zlib does not expose bytesRead")}catch(C){console.error("cannot use native zlib: "+(C.message||C))}}function Fe(w,S){if(!tt)return jl(w,S);var E=tt.InflateRaw,C=new E,T=C._processChunk(w.slice(w.l),C._finishFlushFlag);return w.l+=C.bytesRead,T}function Ae(w){return tt?tt.deflateRawSync(w):Ln(w)}var Ne=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],He=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Oe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function k(w){var S=(w<<1|w<<11)&139536|(w<<5|w<<15)&558144;return(S>>16|S>>8|S)&255}for(var U=typeof Uint8Array<"u",L=U?new Uint8Array(256):[],O=0;O<256;++O)L[O]=k(O);function K(w,S){var E=L[w&255];return S<=8?E>>>8-S:(E=E<<8|L[w>>8&255],S<=16?E>>>16-S:(E=E<<8|L[w>>16&255],E>>>24-S))}function de(w,S){var E=S&7,C=S>>>3;return(w[C]|(E<=6?0:w[C+1]<<8))>>>E&3}function oe(w,S){var E=S&7,C=S>>>3;return(w[C]|(E<=5?0:w[C+1]<<8))>>>E&7}function Ee(w,S){var E=S&7,C=S>>>3;return(w[C]|(E<=4?0:w[C+1]<<8))>>>E&15}function le(w,S){var E=S&7,C=S>>>3;return(w[C]|(E<=3?0:w[C+1]<<8))>>>E&31}function Me(w,S){var E=S&7,C=S>>>3;return(w[C]|(E<=1?0:w[C+1]<<8))>>>E&127}function xe(w,S,E){var C=S&7,T=S>>>3,D=(1<<E)-1,z=w[T]>>>C;return E<8-C||(z|=w[T+1]<<8-C,E<16-C)||(z|=w[T+2]<<16-C,E<24-C)||(z|=w[T+3]<<24-C),z&D}function Le(w,S,E){var C=S&7,T=S>>>3;return C<=5?w[T]|=(E&7)<<C:(w[T]|=E<<C&255,w[T+1]=(E&7)>>8-C),S+3}function it(w,S,E){var C=S&7,T=S>>>3;return E=(E&1)<<C,w[T]|=E,S+1}function pt(w,S,E){var C=S&7,T=S>>>3;return E<<=C,w[T]|=E&255,E>>>=8,w[T+1]=E,S+8}function _t(w,S,E){var C=S&7,T=S>>>3;return E<<=C,w[T]|=E&255,E>>>=8,w[T+1]=E&255,w[T+2]=E>>>8,S+16}function pe(w,S){var E=w.length,C=2*E>S?2*E:S+5,T=0;if(E>=S)return w;if(Ve){var D=Nh(C);if(w.copy)w.copy(D);else for(;T<w.length;++T)D[T]=w[T];return D}else if(U){var z=new Uint8Array(C);if(z.set)z.set(w);else for(;T<E;++T)z[T]=w[T];return z}return w.length=C,w}function Ge(w){for(var S=new Array(w),E=0;E<w;++E)S[E]=0;return S}function ae(w,S,E){var C=1,T=0,D=0,z=0,Y=0,B=w.length,W=U?new Uint16Array(32):Ge(32);for(D=0;D<32;++D)W[D]=0;for(D=B;D<E;++D)w[D]=0;B=w.length;var V=U?new Uint16Array(B):Ge(B);for(D=0;D<B;++D)W[T=w[D]]++,C<T&&(C=T),V[D]=0;for(W[0]=0,D=1;D<=C;++D)W[D+16]=Y=Y+W[D-1]<<1;for(D=0;D<B;++D)Y=w[D],Y!=0&&(V[D]=W[Y+16]++);var q=0;for(D=0;D<B;++D)if(q=w[D],q!=0)for(Y=K(V[D],C)>>C-q,z=(1<<C+4-q)-1;z>=0;--z)S[Y|z<<q]=q&15|D<<4;return C}var nr=U?new Uint16Array(512):Ge(512),Ei=U?new Uint16Array(32):Ge(32);if(!U){for(var dt=0;dt<512;++dt)nr[dt]=0;for(dt=0;dt<32;++dt)Ei[dt]=0}(function(){for(var w=[],S=0;S<32;S++)w.push(5);ae(w,Ei,32);var E=[];for(S=0;S<=143;S++)E.push(8);for(;S<=255;S++)E.push(9);for(;S<=279;S++)E.push(7);for(;S<=287;S++)E.push(8);ae(E,nr,288)})();var Xa=function(){for(var S=U?new Uint8Array(32768):[],E=0,C=0;E<Oe.length-1;++E)for(;C<Oe[E+1];++C)S[C]=E;for(;C<32768;++C)S[C]=29;var T=U?new Uint8Array(259):[];for(E=0,C=0;E<He.length-1;++E)for(;C<He[E+1];++C)T[C]=E;function D(Y,B){for(var W=0;W<Y.length;){var V=Math.min(65535,Y.length-W),q=W+V==Y.length;for(B.write_shift(1,+q),B.write_shift(2,V),B.write_shift(2,~V&65535);V-- >0;)B[B.l++]=Y[W++]}return B.l}function z(Y,B){for(var W=0,V=0,q=U?new Uint16Array(32768):[];V<Y.length;){var te=Math.min(65535,Y.length-V);if(te<10){for(W=Le(B,W,+(V+te==Y.length)),W&7&&(W+=8-(W&7)),B.l=W/8|0,B.write_shift(2,te),B.write_shift(2,~te&65535);te-- >0;)B[B.l++]=Y[V++];W=B.l*8;continue}W=Le(B,W,+(V+te==Y.length)+2);for(var ce=0;te-- >0;){var J=Y[V];ce=(ce<<5^J)&32767;var re=-1,Ce=0;if((re=q[ce])&&(re|=V&-32768,re>V&&(re-=32768),re<V))for(;Y[re+Ce]==Y[V+Ce]&&Ce<250;)++Ce;if(Ce>2){J=T[Ce],J<=22?W=pt(B,W,L[J+1]>>1)-1:(pt(B,W,3),W+=5,pt(B,W,L[J-23]>>5),W+=3);var st=J<8?0:J-4>>2;st>0&&(_t(B,W,Ce-He[J]),W+=st),J=S[V-re],W=pt(B,W,L[J]>>3),W-=3;var ht=J<4?0:J-2>>1;ht>0&&(_t(B,W,V-re-Oe[J]),W+=ht);for(var Ot=0;Ot<Ce;++Ot)q[ce]=V&32767,ce=(ce<<5^Y[V])&32767,++V;te-=Ce-1}else J<=143?J=J+48:W=it(B,W,1),W=pt(B,W,L[J]),q[ce]=V&32767,++V}W=pt(B,W,0)-1}return B.l=(W+7)/8|0,B.l}return function(B,W){return B.length<8?D(B,W):z(B,W)}}();function Ln(w){var S=H(50+Math.floor(w.length*1.1)),E=Xa(w,S);return S.slice(0,E)}var ze=U?new Uint16Array(32768):Ge(32768),Ut=U?new Uint16Array(32768):Ge(32768),Cr=U?new Uint16Array(128):Ge(128),xs=1,zi=1;function _r(w,S){var E=le(w,S)+257;S+=5;var C=le(w,S)+1;S+=5;var T=Ee(w,S)+4;S+=4;for(var D=0,z=U?new Uint8Array(19):Ge(19),Y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B=1,W=U?new Uint8Array(8):Ge(8),V=U?new Uint8Array(8):Ge(8),q=z.length,te=0;te<T;++te)z[Ne[te]]=D=oe(w,S),B<D&&(B=D),W[D]++,S+=3;var ce=0;for(W[0]=0,te=1;te<=B;++te)V[te]=ce=ce+W[te-1]<<1;for(te=0;te<q;++te)(ce=z[te])!=0&&(Y[te]=V[ce]++);var J=0;for(te=0;te<q;++te)if(J=z[te],J!=0){ce=L[Y[te]]>>8-J;for(var re=(1<<7-J)-1;re>=0;--re)Cr[ce|re<<J]=J&7|te<<3}var Ce=[];for(B=1;Ce.length<E+C;)switch(ce=Cr[Me(w,S)],S+=ce&7,ce>>>=3){case 16:for(D=3+de(w,S),S+=2,ce=Ce[Ce.length-1];D-- >0;)Ce.push(ce);break;case 17:for(D=3+oe(w,S),S+=3;D-- >0;)Ce.push(0);break;case 18:for(D=11+Me(w,S),S+=7;D-- >0;)Ce.push(0);break;default:Ce.push(ce),B<ce&&(B=ce);break}var st=Ce.slice(0,E),ht=Ce.slice(E);for(te=E;te<286;++te)st[te]=0;for(te=C;te<30;++te)ht[te]=0;return xs=ae(st,ze,286),zi=ae(ht,Ut,30),S}function ys(w,S){if(w[0]==3&&!(w[1]&3))return[Vr(S),2];for(var E=0,C=0,T=Nh(S||1<<18),D=0,z=T.length>>>0,Y=0,B=0;(C&1)==0;){if(C=oe(w,E),E+=3,C>>>1)C>>1==1?(Y=9,B=5):(E=_r(w,E),Y=xs,B=zi);else{E&7&&(E+=8-(E&7));var W=w[E>>>3]|w[(E>>>3)+1]<<8;if(E+=32,W>0)for(!S&&z<D+W&&(T=pe(T,D+W),z=T.length);W-- >0;)T[D++]=w[E>>>3],E+=8;continue}for(;;){!S&&z<D+32767&&(T=pe(T,D+32767),z=T.length);var V=xe(w,E,Y),q=C>>>1==1?nr[V]:ze[V];if(E+=q&15,q>>>=4,(q>>>8&255)===0)T[D++]=q;else{if(q==256)break;q-=257;var te=q<8?0:q-4>>2;te>5&&(te=0);var ce=D+He[q];te>0&&(ce+=xe(w,E,te),E+=te),V=xe(w,E,B),q=C>>>1==1?Ei[V]:Ut[V],E+=q&15,q>>>=4;var J=q<4?0:q-2>>1,re=Oe[q];for(J>0&&(re+=xe(w,E,J),E+=J),!S&&z<ce&&(T=pe(T,ce+100),z=T.length);D<ce;)T[D]=T[D-re],++D}}}return S?[T,E+7>>>3]:[T.slice(0,D),E+7>>>3]}function jl(w,S){var E=w.slice(w.l||0),C=ys(E,S);return w.l+=C[1],C[0]}function Xl(w,S){if(w)typeof console<"u"&&console.error(S);else throw new Error(S)}function $l(w,S){var E=w;Xt(E,0);var C=[],T=[],D={FileIndex:C,FullPaths:T};y(D,{root:S.root});for(var z=E.length-4;(E[z]!=80||E[z+1]!=75||E[z+2]!=5||E[z+3]!=6)&&z>=0;)--z;E.l=z+4,E.l+=4;var Y=E.read_shift(2);E.l+=6;var B=E.read_shift(4);for(E.l=B,z=0;z<Y;++z){E.l+=20;var W=E.read_shift(4),V=E.read_shift(4),q=E.read_shift(2),te=E.read_shift(2),ce=E.read_shift(2);E.l+=8;var J=E.read_shift(4),re=o(E.slice(E.l+q,E.l+q+te));E.l+=q+te+ce;var Ce=E.l;E.l=J+4,re&&re[1]&&((re[1]||{}).usz&&(V=re[1].usz),(re[1]||{}).csz&&(W=re[1].csz)),lf(E,W,V,D,re),E.l=Ce}return D}function lf(w,S,E,C,T){w.l+=2;var D=w.read_shift(2),z=w.read_shift(2),Y=a(w);if(D&8257)throw new Error("Unsupported ZIP encryption");for(var B=w.read_shift(4),W=w.read_shift(4),V=w.read_shift(4),q=w.read_shift(2),te=w.read_shift(2),ce="",J=0;J<q;++J)ce+=String.fromCharCode(w[w.l++]);if(te){var re=o(w.slice(w.l,w.l+te));(re[21589]||{}).mt&&(Y=re[21589].mt),(re[1]||{}).usz&&(V=re[1].usz),(re[1]||{}).csz&&(W=re[1].csz),T&&((T[21589]||{}).mt&&(Y=T[21589].mt),(T[1]||{}).usz&&(V=T[1].usz),(T[1]||{}).csz&&(W=T[1].csz))}w.l+=te;var Ce=w.slice(w.l,w.l+W);switch(z){case 8:Ce=Fe(w,V);break;case 0:w.l+=W;break;default:throw new Error("Unsupported ZIP Compression method "+z)}var st=!1;D&8&&(B=w.read_shift(4),B==134695760&&(B=w.read_shift(4),st=!0),W=w.read_shift(4),V=w.read_shift(4)),W!=S&&Xl(st,"Bad compressed size: "+S+" != "+W),V!=E&&Xl(st,"Bad uncompressed size: "+E+" != "+V),$a(C,ce,Ce,{unsafe:!0,mt:Y})}function hf(w,S){var E=S||{},C=[],T=[],D=H(1),z=E.compression?8:0,Y=0,B=0,W=0,V=0,q=0,te=w.FullPaths[0],ce=te,J=w.FileIndex[0],re=[],Ce=0;for(B=1;B<w.FullPaths.length;++B)if(ce=w.FullPaths[B].slice(te.length),J=w.FileIndex[B],!(!J.size||!J.content||Array.isArray(J.content)&&J.content.length==0||ce=="Sh33tJ5")){var st=V,ht=H(ce.length);for(W=0;W<ce.length;++W)ht.write_shift(1,ce.charCodeAt(W)&127);ht=ht.slice(0,ht.l),re[q]=typeof J.content=="string"?Gh.bstr(J.content,0):Gh.buf(J.content,0);var Ot=typeof J.content=="string"?ii(J.content):J.content;z==8&&(Ot=Ae(Ot)),D=H(30),D.write_shift(4,67324752),D.write_shift(2,20),D.write_shift(2,Y),D.write_shift(2,z),J.mt?s(D,J.mt):D.write_shift(4,0),D.write_shift(-4,re[q]),D.write_shift(4,Ot.length),D.write_shift(4,J.content.length),D.write_shift(2,ht.length),D.write_shift(2,0),V+=D.length,C.push(D),V+=ht.length,C.push(ht),V+=Ot.length,C.push(Ot),D=H(46),D.write_shift(4,33639248),D.write_shift(2,0),D.write_shift(2,20),D.write_shift(2,Y),D.write_shift(2,z),D.write_shift(4,0),D.write_shift(-4,re[q]),D.write_shift(4,Ot.length),D.write_shift(4,J.content.length),D.write_shift(2,ht.length),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(4,0),D.write_shift(4,st),Ce+=D.l,T.push(D),Ce+=ht.length,T.push(ht),++q}return D=H(22),D.write_shift(4,101010256),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(2,q),D.write_shift(2,q),D.write_shift(4,Ce),D.write_shift(4,V),D.write_shift(2,0),wt([wt(C),wt(T),D])}var Es={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function uf(w,S){if(w.ctype)return w.ctype;var E=w.name||"",C=E.match(/\.([^\.]+)$/);return C&&Es[C[1]]||S&&(C=(E=S).match(/[\.\\]([^\.\\])+$/),C&&Es[C[1]])?Es[C[1]]:"application/octet-stream"}function cf(w){for(var S=aa(w),E=[],C=0;C<S.length;C+=76)E.push(S.slice(C,C+76));return E.join(`\r
`)+`\r
`}function df(w){var S=w.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(W){var V=W.charCodeAt(0).toString(16).toUpperCase();return"="+(V.length==1?"0"+V:V)});S=S.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),S.charAt(0)==`
`&&(S="=0D"+S.slice(1)),S=S.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var E=[],C=S.split(`\r
`),T=0;T<C.length;++T){var D=C[T];if(D.length==0){E.push("");continue}for(var z=0;z<D.length;){var Y=76,B=D.slice(z,z+Y);B.charAt(Y-1)=="="?Y--:B.charAt(Y-2)=="="?Y-=2:B.charAt(Y-3)=="="&&(Y-=3),B=D.slice(z,z+Y),z+=Y,z<D.length&&(B+="="),E.push(B)}}return E.join(`\r
`)}function ff(w){for(var S=[],E=0;E<w.length;++E){for(var C=w[E];E<=w.length&&C.charAt(C.length-1)=="=";)C=C.slice(0,C.length-1)+w[++E];S.push(C)}for(var T=0;T<S.length;++T)S[T]=S[T].replace(/[=][0-9A-Fa-f]{2}/g,function(D){return String.fromCharCode(parseInt(D.slice(1),16))});return ii(S.join(`\r
`))}function pf(w,S,E){for(var C="",T="",D="",z,Y=0;Y<10;++Y){var B=S[Y];if(!B||B.match(/^\s*$/))break;var W=B.match(/^([^:]*?):\s*([^\s].*)$/);if(W)switch(W[1].toLowerCase()){case"content-location":C=W[2].trim();break;case"content-type":D=W[2].trim();break;case"content-transfer-encoding":T=W[2].trim();break}}switch(++Y,T.toLowerCase()){case"base64":z=ii(wr(S.slice(Y).join("")));break;case"quoted-printable":z=ff(S.slice(Y));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+T)}var V=$a(w,C.slice(E.length),z,{unsafe:!0});D&&(V.ctype=D)}function mf(w,S){if(_e(w.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var E=S&&S.root||"",C=(Ve&&Buffer.isBuffer(w)?w.toString("binary"):_e(w)).split(`\r
`),T=0,D="";for(T=0;T<C.length;++T)if(D=C[T],!!/^Content-Location:/i.test(D)&&(D=D.slice(D.indexOf("file")),E||(E=D.slice(0,D.lastIndexOf("/")+1)),D.slice(0,E.length)!=E))for(;E.length>0&&(E=E.slice(0,E.length-1),E=E.slice(0,E.lastIndexOf("/")+1),D.slice(0,E.length)!=E););var z=(C[1]||"").match(/boundary="(.*?)"/);if(!z)throw new Error("MAD cannot find boundary");var Y="--"+(z[1]||""),B=[],W=[],V={FileIndex:B,FullPaths:W};y(V);var q,te=0;for(T=0;T<C.length;++T){var ce=C[T];ce!==Y&&ce!==Y+"--"||(te++&&pf(V,C.slice(q,T),E),q=T)}return V}function gf(w,S){var E=S||{},C=E.boundary||"SheetJS";C="------="+C;for(var T=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+C.slice(2)+'"',"","",""],D=w.FullPaths[0],z=D,Y=w.FileIndex[0],B=1;B<w.FullPaths.length;++B)if(z=w.FullPaths[B].slice(D.length),Y=w.FileIndex[B],!(!Y.size||!Y.content||z=="Sh33tJ5")){z=z.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ce){return"_x"+Ce.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ce){return"_u"+Ce.charCodeAt(0).toString(16)+"_"});for(var W=Y.content,V=Ve&&Buffer.isBuffer(W)?W.toString("binary"):_e(W),q=0,te=Math.min(1024,V.length),ce=0,J=0;J<=te;++J)(ce=V.charCodeAt(J))>=32&&ce<128&&++q;var re=q>=te*4/5;T.push(C),T.push("Content-Location: "+(E.root||"file:///C:/SheetJS/")+z),T.push("Content-Transfer-Encoding: "+(re?"quoted-printable":"base64")),T.push("Content-Type: "+uf(Y,z)),T.push(""),T.push(re?df(V):cf(V))}return T.push(C+`--\r
`),T.join(`\r
`)}function vf(w){var S={};return y(S,w),S}function $a(w,S,E,C){var T=C&&C.unsafe;T||y(w);var D=!T&&Ze.find(w,S);if(!D){var z=w.FullPaths[0];S.slice(0,z.length)==z?z=S:(z.slice(-1)!="/"&&(z+="/"),z=(z+S).replace("//","/")),D={name:n(S),type:2},w.FileIndex.push(D),w.FullPaths.push(z),T||Ze.utils.cfb_gc(w)}return D.content=E,D.size=E?E.length:0,C&&(C.CLSID&&(D.clsid=C.CLSID),C.mt&&(D.mt=C.mt),C.ct&&(D.ct=C.ct)),D}function bf(w,S){y(w);var E=Ze.find(w,S);if(E){for(var C=0;C<w.FileIndex.length;++C)if(w.FileIndex[C]==E)return w.FileIndex.splice(C,1),w.FullPaths.splice(C,1),!0}return!1}function wf(w,S,E){y(w);var C=Ze.find(w,S);if(C){for(var T=0;T<w.FileIndex.length;++T)if(w.FileIndex[T]==C)return w.FileIndex[T].name=n(E),w.FullPaths[T]=E,!0}return!1}function xf(w){M(w,!0)}return e.find=P,e.read=_,e.parse=u,e.write=Je,e.writeFile=ge,e.utils={cfb_new:vf,cfb_add:$a,cfb_del:bf,cfb_mov:wf,cfb_gc:xf,ReadShift:jn,CheckField:od,prep_blob:Xt,bconcat:wt,use_zlib:De,_deflateRaw:Ln,_inflateRaw:jl,consts:ee},e}(),ux;function Yh(r){return typeof r=="string"?Na(r):Array.isArray(r)?Nw(r):r}function gs(r,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=Na(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(r,e)}var i=t=="utf8"?ns(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(i,r);if(typeof Blob<"u"){var n=new Blob([Yh(i)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,r);if(typeof saveAs<"u")return saveAs(n,r);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:r,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=r,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}else if(typeof URL<"u"&&!URL.createObjectURL&&typeof chrome=="object"){var o="data:application/octet-stream;base64,"+Pw(new Uint8Array(Yh(i)));return chrome.downloads.download({url:o,filename:r,saveAs:!0})}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(r);return l.open("w"),l.encoding="binary",Array.isArray(e)&&(e=Ur(e)),l.write(e),l.close(),e}catch(h){if(!h.message||h.message.indexOf("onstruct")==-1)throw h}throw new Error("cannot save file "+r)}function xt(r){for(var e=Object.keys(r),t=[],i=0;i<e.length;++i)Object.prototype.hasOwnProperty.call(r,e[i])&&t.push(e[i]);return t}function jh(r,e){for(var t=[],i=xt(r),n=0;n!==i.length;++n)t[r[i[n]][e]]==null&&(t[r[i[n]][e]]=i[n]);return t}function Dl(r){for(var e=[],t=xt(r),i=0;i!==t.length;++i)e[r[t[i]]]=t[i];return e}function Ha(r){for(var e=[],t=xt(r),i=0;i!==t.length;++i)e[r[t[i]]]=parseInt(t[i],10);return e}function cx(r){for(var e=[],t=xt(r),i=0;i!==t.length;++i)e[r[t[i]]]==null&&(e[r[t[i]]]=[]),e[r[t[i]]].push(t[i]);return e}var Yc=Date.UTC(1899,11,30,0,0,0),dx=Date.UTC(1899,11,31,0,0,0),fx=Date.UTC(1904,0,1,0,0,0);function Mt(r,e){var t=r.getTime(),i=(t-Yc)/(24*60*60*1e3);return e?(i-=1462,i<-1402?i-1:i):i<60?i-1:i}function fn(r){if(r>=60&&r<61)return r;var e=new Date;return e.setTime((r>60?r:r+1)*24*60*60*1e3+Yc),e}var px=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,mx=/^(\d+)-(\d+)-(\d+)$/,jc=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function Zt(r,e){if(r instanceof Date)return r;var t=r.match(px);if(t)return new Date((e?fx:dx)+((parseInt(t[1],10)*60+parseInt(t[2],10))*60+(t[3]?parseInt(t[3].slice(1),10):0))*1e3+(t[4]?parseInt((t[4]+"000").slice(1,4),10):0));if(t=r.match(mx),t)return new Date(Date.UTC(+t[1],+t[2]-1,+t[3],0,0,0,0));if(t=r.match(jc),t)return new Date(Date.UTC(+t[1],+t[2]-1,+t[3],+t[4],+t[5],t[6]&&parseInt(t[6].slice(1),10)||0,t[7]&&parseInt((t[7]+"0000").slice(1,4),10)||0));var i=new Date(r);return i}function kl(r,e){if(Ve&&Buffer.isBuffer(r))return r.toString("binary");if(typeof TextDecoder<"u")try{var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[]/g,function(s){return t[s]||s})}catch{}var i=[],n=0;try{for(n=0;n<r.length-65536;n+=65536)i.push(String.fromCharCode.apply(0,r.slice(n,n+65536)));i.push(String.fromCharCode.apply(0,r.slice(n)))}catch{try{for(;n<r.length-16384;n+=16384)i.push(String.fromCharCode.apply(0,r.slice(n,n+16384)));i.push(String.fromCharCode.apply(0,r.slice(n)))}catch{for(;n!=r.length;++n)i.push(String.fromCharCode(r[n]))}}return i.join("")}function Vt(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=Vt(r[t]));return e}function at(r,e){for(var t="";t.length<e;)t+=r;return t}function Ji(r){var e=Number(r);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(r))return e;var t=1,i=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(i))||(i=i.replace(/[(]([^()]*)[)]/,function(n,s){return t=-t,s}),!isNaN(e=Number(i)))?e/t:e}var gx=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,vx=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,bx=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,wx=new Date("6/9/69 00:00 UTC").valueOf()==-177984e5;function xx(r){return r[2]?r[3]?r[4]?new Date(Date.UTC(1899,11,31,+r[1]%12+(r[7]=="p"?12:0),+r[2],+r[4],parseFloat(r[3])*1e3)):new Date(Date.UTC(1899,11,31,r[7]=="p"?12:0,+r[1],+r[2],parseFloat(r[3])*1e3)):r[5]?new Date(Date.UTC(1899,11,31,+r[1]%12+(r[7]=="p"?12:0),+r[2],+r[5],r[6]?parseFloat(r[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+r[1]%12+(r[7]=="p"?12:0),+r[2],0,0)):new Date(Date.UTC(1899,11,31,+r[1]%12+(r[7]=="p"?12:0),0,0,0))}function yx(r){return r[2]?r[3]?r[4]?new Date(Date.UTC(1899,11,31,+r[1],+r[2],+r[4],parseFloat(r[3])*1e3)):new Date(Date.UTC(1899,11,31,0,+r[1],+r[2],parseFloat(r[3])*1e3)):r[5]?new Date(Date.UTC(1899,11,31,+r[1],+r[2],+r[5],r[6]?parseFloat(r[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+r[1],+r[2],0,0)):new Date(Date.UTC(1899,11,31,+r[1],0,0,0))}var Ex=["january","february","march","april","may","june","july","august","september","october","november","december"];function da(r){if(bx.test(r))return r.indexOf("Z")==-1?za(new Date(r)):new Date(r);var e=r.toLowerCase(),t=e.replace(/\s+/g," ").trim(),i=t.match(gx);if(i)return xx(i);if(i=t.match(vx),i)return yx(i);if(i=t.match(jc),i)return new Date(Date.UTC(+i[1],+i[2]-1,+i[3],+i[4],+i[5],i[6]&&parseInt(i[6].slice(1),10)||0,i[7]&&parseInt((i[7]+"0000").slice(1,4),10)||0));var n=new Date(wx&&r.indexOf("UTC")==-1?r+" UTC":r),s=new Date(NaN),a=n.getYear();n.getMonth();var o=n.getDate();if(isNaN(o))return s;if(e.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(e=e.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),e.length>3&&Ex.indexOf(e)==-1)return s}else if(e.replace(/[ap]m?/,"").match(/[a-z]/))return s;return a<0||a>8099||r.match(/[^-0-9:,\/\\\ ]/)?s:n}function Sn(r){return new Date(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),r.getUTCMilliseconds())}function za(r){return new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()))}function Te(r,e,t){if(r.FullPaths){if(Array.isArray(t)&&typeof t[0]=="string"&&(t=t.join("")),typeof t=="string"){var i;return Ve?i=Hi(t):i=Iw(t),Ze.utils.cfb_add(r,e,i)}Ze.utils.cfb_add(r,e,t)}else r.file(e,t)}function Rl(){return Ze.utils.cfb_new()}var Et=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Cx={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Fl=Dl(Cx),Ml=/[&<>'"]/g,_x=/[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g;function Se(r){var e=r+"";return e.replace(Ml,function(t){return Fl[t]}).replace(_x,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Xh(r){return Se(r).replace(/ /g,"_x0020_")}var Xc=/[\u0000-\u001f]/g;function oo(r){var e=r+"";return e.replace(Ml,function(t){return Fl[t]}).replace(/\n/g,"<br/>").replace(Xc,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function Tx(r){var e=r+"";return e.replace(Ml,function(t){return Fl[t]}).replace(Xc,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function Sx(r){return r.replace(/(\r\n|[\r\n])/g,"&#10;")}function Dx(r){switch(r){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function lo(r){for(var e="",t=0,i=0,n=0,s=0,a=0,o=0;t<r.length;){if(i=r.charCodeAt(t++),i<128){e+=String.fromCharCode(i);continue}if(n=r.charCodeAt(t++),i>191&&i<224){a=(i&31)<<6,a|=n&63,e+=String.fromCharCode(a);continue}if(s=r.charCodeAt(t++),i<240){e+=String.fromCharCode((i&15)<<12|(n&63)<<6|s&63);continue}a=r.charCodeAt(t++),o=((i&7)<<18|(n&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function $h(r){var e=Vr(2*r.length),t,i,n=1,s=0,a=0,o;for(i=0;i<r.length;i+=n)n=1,(o=r.charCodeAt(i))<128?t=o:o<224?(t=(o&31)*64+(r.charCodeAt(i+1)&63),n=2):o<240?(t=(o&15)*4096+(r.charCodeAt(i+1)&63)*64+(r.charCodeAt(i+2)&63),n=3):(n=4,t=(o&7)*262144+(r.charCodeAt(i+1)&63)*4096+(r.charCodeAt(i+2)&63)*64+(r.charCodeAt(i+3)&63),t-=65536,a=55296+(t>>>10&1023),t=56320+(t&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function Kh(r){return Hi(r,"binary").toString("utf8")}var As="foo bar baz",pn=Ve&&(Kh(As)==lo(As)&&Kh||$h(As)==lo(As)&&$h)||lo,ns=Ve?function(r){return Hi(r,"utf8").toString("binary")}:function(r){for(var e=[],t=0,i=0,n=0;t<r.length;)switch(i=r.charCodeAt(t++),!0){case i<128:e.push(String.fromCharCode(i));break;case i<2048:e.push(String.fromCharCode(192+(i>>6))),e.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,n=r.charCodeAt(t++)-56320+(i<<10),e.push(String.fromCharCode(240+(n>>18&7))),e.push(String.fromCharCode(144+(n>>12&63))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)));break;default:e.push(String.fromCharCode(224+(i>>12))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)))}return e.join("")},kx=function(){var r=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var i=t.replace(/^[\t\n\r ]+/,"").replace(/(^|[^\t\n\r ])[\t\n\r ]+$/,"$1").replace(/>\s+/g,">").replace(/\b\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^<>]*>/g,""),n=0;n<r.length;++n)i=i.replace(r[n][0],r[n][1]);return i}}(),$c=/(^\s|\s$|\n)/;function kt(r,e){return"<"+r+(e.match($c)?' xml:space="preserve"':"")+">"+e+"</"+r+">"}function ss(r){return xt(r).map(function(e){return" "+e+'="'+r[e]+'"'}).join("")}function Z(r,e,t){return"<"+r+(t!=null?ss(t):"")+(e!=null?(e.match($c)?' xml:space="preserve"':"")+">"+e+"</"+r:"/")+">"}function nl(r,e){try{return r.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function Rx(r,e){switch(typeof r){case"string":var t=Z("vt:lpwstr",Se(r));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Z((r|0)==r?"vt:i4":"vt:r8",Se(String(r)));case"boolean":return Z("vt:bool",r?"true":"false")}if(r instanceof Date)return Z("vt:filetime",nl(r));throw new Error("Unable to serialize "+r)}var Tt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Rn=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ri={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Fx(r,e){for(var t=1-2*(r[e+7]>>>7),i=((r[e+7]&127)<<4)+(r[e+6]>>>4&15),n=r[e+6]&15,s=5;s>=0;--s)n=n*256+r[e+s];return i==2047?n==0?t*(1/0):NaN:(i==0?i=-1022:(i-=1023,n+=Math.pow(2,52)),t*Math.pow(2,i-52)*n)}function Mx(r,e,t){var i=(e<0||1/e==-1/0?1:0)<<7,n=0,s=0,a=i?-e:e;isFinite(a)?a==0?n=s=0:(n=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?n=-1022:(s-=Math.pow(2,52),n+=1023)):(n=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)r[t+o]=s&255;r[t+6]=(n&15)<<4|s&15,r[t+7]=n>>4|i}var Qh=function(r){for(var e=[],t=10240,i=0;i<r[0].length;++i)if(r[0][i])for(var n=0,s=r[0][i].length;n<s;n+=t)e.push.apply(e,r[0][i].slice(n,n+t));return e},qh=Ve?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(e){return Buffer.isBuffer(e)?e:Hi(e)})):Qh(r)}:Qh,Jh=function(r,e,t){for(var i=[],n=e;n<t;n+=2)i.push(String.fromCharCode(Gn(r,n)));return i.join("").replace(Yn,"")},Al=Ve?function(r,e,t){return!Buffer.isBuffer(r)||!oa?Jh(r,e,t):r.toString("utf16le",e,t).replace(Yn,"")}:Jh,Zh=function(r,e,t){for(var i=[],n=e;n<e+t;++n)i.push(("0"+r[n].toString(16)).slice(-2));return i.join("")},Kc=Ve?function(r,e,t){return Buffer.isBuffer(r)?r.toString("hex",e,e+t):Zh(r,e,t)}:Zh,eu=function(r,e,t){for(var i=[],n=e;n<t;n++)i.push(String.fromCharCode(rn(r,n)));return i.join("")},vs=Ve?function(e,t,i){return Buffer.isBuffer(e)?e.toString("utf8",t,i):eu(e,t,i)}:eu,Qc=function(r,e){var t=ni(r,e);return t>0?vs(r,e+4,e+4+t-1):""},qc=Qc,Jc=function(r,e){var t=ni(r,e);return t>0?vs(r,e+4,e+4+t-1):""},Zc=Jc,ed=function(r,e){var t=2*ni(r,e);return t>0?vs(r,e+4,e+4+t-1):""},td=ed,id=function(e,t){var i=ni(e,t);return i>0?Al(e,t+4,t+4+i):""},rd=id,nd=function(r,e){var t=ni(r,e);return t>0?vs(r,e+4,e+4+t):""},sd=nd,ad=function(r,e){return Fx(r,e)},fa=ad,Ol=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Ve&&(qc=function(e,t){if(!Buffer.isBuffer(e))return Qc(e,t);var i=e.readUInt32LE(t);return i>0?e.toString("utf8",t+4,t+4+i-1):""},Zc=function(e,t){if(!Buffer.isBuffer(e))return Jc(e,t);var i=e.readUInt32LE(t);return i>0?e.toString("utf8",t+4,t+4+i-1):""},td=function(e,t){if(!Buffer.isBuffer(e)||!oa)return ed(e,t);var i=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+i-1)},rd=function(e,t){if(!Buffer.isBuffer(e)||!oa)return id(e,t);var i=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+i)},sd=function(e,t){if(!Buffer.isBuffer(e))return nd(e,t);var i=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+i)},fa=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):ad(e,t)},Ol=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var rn=function(r,e){return r[e]},Gn=function(r,e){return r[e+1]*256+r[e]},Ax=function(r,e){var t=r[e+1]*256+r[e];return t<32768?t:(65535-t+1)*-1},ni=function(r,e){return r[e+3]*(1<<24)+(r[e+2]<<16)+(r[e+1]<<8)+r[e]},kr=function(r,e){return r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]},Ox=function(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]};function jn(r,e){var t="",i,n,s=[],a,o,l,h;switch(e){case"dbcs":if(h=this.l,Ve&&Buffer.isBuffer(this)&&oa)t=this.slice(this.l,this.l+2*r).toString("utf16le");else for(l=0;l<r;++l)t+=String.fromCharCode(Gn(this,h)),h+=2;r*=2;break;case"utf8":t=vs(this,this.l,this.l+r);break;case"utf16le":r*=2,t=Al(this,this.l,this.l+r);break;case"wstr":return jn.call(this,r,"dbcs");case"lpstr-ansi":t=qc(this,this.l),r=4+ni(this,this.l);break;case"lpstr-cp":t=Zc(this,this.l),r=4+ni(this,this.l);break;case"lpwstr":t=td(this,this.l),r=4+2*ni(this,this.l);break;case"lpp4":r=4+ni(this,this.l),t=rd(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+ni(this,this.l),t=sd(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,t="";(a=rn(this,this.l+r++))!==0;)s.push(Fs(a));t=s.join("");break;case"_wstr":for(r=0,t="";(a=Gn(this,this.l+r))!==0;)s.push(Fs(a)),r+=2;r+=2,t=s.join("");break;case"dbcs-cont":for(t="",h=this.l,l=0;l<r;++l){if(this.lens&&this.lens.indexOf(h)!==-1)return a=rn(this,h),this.l=h+1,o=jn.call(this,r-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Fs(Gn(this,h))),h+=2}t=s.join(""),r*=2;break;case"cpstr":case"sbcs-cont":for(t="",h=this.l,l=0;l!=r;++l){if(this.lens&&this.lens.indexOf(h)!==-1)return a=rn(this,h),this.l=h+1,o=jn.call(this,r-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Fs(rn(this,h))),h+=1}t=s.join("");break;default:switch(r){case 1:return i=rn(this,this.l),this.l++,i;case 2:return i=(e==="i"?Ax:Gn)(this,this.l),this.l+=2,i;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(i=(r>0?kr:Ox)(this,this.l),this.l+=4,i):(n=ni(this,this.l),this.l+=4,n);case 8:case-8:if(e==="f")return r==8?n=fa(this,this.l):n=fa([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;r=8;case 16:t=Kc(this,this.l,r);break}}return this.l+=r,t}var Lx=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255,r[t+2]=e>>>16&255,r[t+3]=e>>>24&255},Px=function(r,e,t){r[t]=e&255,r[t+1]=e>>8&255,r[t+2]=e>>16&255,r[t+3]=e>>24&255},Nx=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255};function Ix(r,e,t){var i=0,n=0;if(t==="dbcs"){for(n=0;n!=e.length;++n)Nx(this,e.charCodeAt(n),this.l+2*n);i=2*e.length}else if(t==="sbcs"||t=="cpstr"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=e.length;++n)this[this.l+n]=e.charCodeAt(n)&255;i=e.length}else if(t==="hex"){for(;n<r;++n)this[this.l++]=parseInt(e.slice(2*n,2*n+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+r,this.length);for(n=0;n<Math.min(e.length,r);++n){var a=e.charCodeAt(n);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(r){case 1:i=1,this[this.l]=e&255;break;case 2:i=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:i=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:i=4,Lx(this,e,this.l);break;case 8:if(i=8,t==="f"){Mx(this,e,this.l);break}case 16:break;case-4:i=4,Px(this,e,this.l);break}return this.l+=i,this}function od(r,e){var t=Kc(this,this.l,r.length>>1);if(t!==r)throw new Error(e+"Expected "+r+" saw "+t);this.l+=r.length>>1}function Xt(r,e){r.l=e,r.read_shift=jn,r.chk=od,r.write_shift=Ix}function Ii(r,e){r.l+=e}function H(r){var e=Vr(r);return Xt(e,0),e}function zt(){var r=[],e=Ve?16384:2048;Ve&&H(e).copy;var t=function(u){var d=H(u);return Xt(d,0),d},i=t(e),n=function(){i&&(i.l&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&r.push(i)),i=null)},s=function(u){return i&&u<i.length-i.l?i:(n(),i=t(Math.max(u+1,e)))},a=function(){return n(),wt(r)},o=function(){return n(),r},l=function(u){n(),i=u,i.l==null&&(i.l=i.length),s(e)};return{next:s,push:l,end:a,_bufs:r,end2:o}}function X(r,e,t,i){var n=+e,s;if(!isNaN(n)){i||(i=GT[n].p||(t||[]).length||0),s=1+(n>=128?1:0)+1,i>=128&&++s,i>=16384&&++s,i>=2097152&&++s;var a=r.next(s);n<=127?a.write_shift(1,n):(a.write_shift(1,(n&127)+128),a.write_shift(1,n>>7));for(var o=0;o!=4;++o)if(i>=128)a.write_shift(1,(i&127)+128),i>>=7;else{a.write_shift(1,i);break}i>0&&Ol(t)&&r.push(t)}}function Xn(r,e,t){var i=Vt(r);if(e.s?(i.cRel&&(i.c+=e.s.c),i.rRel&&(i.r+=e.s.r)):(i.cRel&&(i.c+=e.c),i.rRel&&(i.r+=e.r)),!t||t.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function tu(r,e,t){var i=Vt(r);return i.s=Xn(i.s,e.s,t),i.e=Xn(i.e,e.s,t),i}function $n(r,e){if(r.cRel&&r.c<0)for(r=Vt(r);r.c<0;)r.c+=e>8?16384:256;if(r.rRel&&r.r<0)for(r=Vt(r);r.r<0;)r.r+=e>8?1048576:e>5?65536:16384;var t=ct(r);return!r.cRel&&r.cRel!=null&&(t=zx(t)),!r.rRel&&r.rRel!=null&&(t=Bx(t)),t}function ho(r,e){return r.s.r==0&&!r.s.rRel&&r.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+$e(r.s.c)+":"+(r.e.cRel?"":"$")+$e(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(e.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+qe(r.s.r)+":"+(r.e.rRel?"":"$")+qe(r.e.r):$n(r.s,e.biff)+":"+$n(r.e,e.biff)}function Ll(r){return parseInt(Hx(r),10)-1}function qe(r){return""+(r+1)}function Bx(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Hx(r){return r.replace(/\$(\d+)$/,"$1")}function Pl(r){for(var e=Wx(r),t=0,i=0;i!==e.length;++i)t=26*t+e.charCodeAt(i)-64;return t-1}function $e(r){if(r<0)throw new Error("invalid column "+r);var e="";for(++r;r;r=Math.floor((r-1)/26))e=String.fromCharCode((r-1)%26+65)+e;return e}function zx(r){return r.replace(/^([A-Z])/,"$$$1")}function Wx(r){return r.replace(/^\$([A-Z])/,"$1")}function Vx(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function lt(r){for(var e=0,t=0,i=0;i<r.length;++i){var n=r.charCodeAt(i);n>=48&&n<=57?e=10*e+(n-48):n>=65&&n<=90&&(t=26*t+(n-64))}return{c:t-1,r:e-1}}function ct(r){for(var e=r.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(r.r+1)}function Ft(r){var e=r.indexOf(":");return e==-1?{s:lt(r),e:lt(r)}:{s:lt(r.slice(0,e)),e:lt(r.slice(e+1))}}function yt(r,e){return typeof e>"u"||typeof e=="number"?yt(r.s,r.e):(typeof r!="string"&&(r=ct(r)),typeof e!="string"&&(e=ct(e)),r==e?r:r+":"+e)}function as(r){var e=Ft(r);return"$"+$e(e.s.c)+"$"+qe(e.s.r)+":$"+$e(e.e.c)+"$"+qe(e.e.r)}function os(r,e){if(!r&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r.replace(/'/g,"''")+"'":r}function nt(r){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,i=0,n=0,s=r.length;for(t=0;i<s&&!((n=r.charCodeAt(i)-64)<1||n>26);++i)t=26*t+n;for(e.s.c=--t,t=0;i<s&&!((n=r.charCodeAt(i)-48)<0||n>9);++i)t=10*t+n;if(e.s.r=--t,i===s||n!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++i,t=0;i!=s&&!((n=r.charCodeAt(i)-64)<1||n>26);++i)t=26*t+n;for(e.e.c=--t,t=0;i!=s&&!((n=r.charCodeAt(i)-48)<0||n>9);++i)t=10*t+n;return e.e.r=--t,e}function iu(r,e){var t=r.t=="d"&&e instanceof Date;if(r.z!=null)try{return r.w=tr(r.z,t?Mt(e):e)}catch{}try{return r.w=tr((r.XF||{}).numFmtId||(t?14:0),t?Mt(e):e)}catch{return""+e}}function ir(r,e,t){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&t&&t.dateNF&&(r.z=t.dateNF),r.t=="e"?Qt[r.v]||r.v:e==null?iu(r,r.v):iu(r,e))}function Fn(r,e){var t=e&&e.sheet?e.sheet:"Sheet1",i={};return i[t]=r,{SheetNames:[t],Sheets:i}}function Ux(r){var e={},t=r||{};return t.dense&&(e["!data"]=[]),e}function ld(r,e,t){var i=t||{},n=r?r["!data"]!=null:i.dense,s=r||(n?{"!data":[]}:{});n&&!s["!data"]&&(s["!data"]=[]);var a=0,o=0;if(s&&i.origin!=null)if(typeof i.origin=="number")a=i.origin;else{var l=typeof i.origin=="string"?lt(i.origin):i.origin;a=l.r,o=l.c}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=nt(s["!ref"]);h.s.c=u.s.c,h.s.r=u.s.r,h.e.c=Math.max(h.e.c,u.e.c),h.e.r=Math.max(h.e.r,u.e.r),a==-1&&(h.e.r=a=s["!ref"]?u.e.r+1:0)}else h.s.c=h.e.c=h.s.r=h.e.r=0;for(var d=[],c=!1,f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");var p=a+f;n&&(s["!data"][p]||(s["!data"][p]=[]),d=s["!data"][p]);for(var v=e[f],m=0;m!=v.length;++m)if(!(typeof v[m]>"u")){var g={v:v[m],t:""},x=o+m;if(h.s.r>p&&(h.s.r=p),h.s.c>x&&(h.s.c=x),h.e.r<p&&(h.e.r=p),h.e.c<x&&(h.e.c=x),c=!0,v[m]&&typeof v[m]=="object"&&!Array.isArray(v[m])&&!(v[m]instanceof Date))g=v[m];else if(Array.isArray(g.v)&&(g.f=v[m][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(i.nullError)g.t="e",g.v=0;else if(i.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?isFinite(g.v)?g.t="n":isNaN(g.v)?(g.t="e",g.v=15):(g.t="e",g.v=7):typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=i.dateNF||rt[14],i.UTC||(g.v=za(g.v)),i.cellDates?(g.t="d",g.w=tr(g.z,Mt(g.v,i.date1904))):(g.t="n",g.v=Mt(g.v,i.date1904),g.w=tr(g.z,g.v))):g.t="s";if(n)d[x]&&d[x].z&&(g.z=d[x].z),d[x]=g;else{var b=$e(x)+(p+1);s[b]&&s[b].z&&(g.z=s[b].z),s[b]=g}}}return c&&h.s.c<104e5&&(s["!ref"]=yt(h)),s}function Mn(r,e){return ld(null,r,e)}function Gx(r){return r.read_shift(4,"i")}function xi(r,e){return e||(e=H(4)),e.write_shift(4,r),e}function Wt(r){var e=r.read_shift(4);return e===0?"":r.read_shift(e,"dbcs")}function Ct(r,e){var t=!1;return e==null&&(t=!0,e=H(4+2*r.length)),e.write_shift(4,r.length),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}function Yx(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function jx(r,e){return e||(e=H(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Nl(r,e){var t=r.l,i=r.read_shift(1),n=Wt(r),s=[],a={t:n,h:n};if((i&1)!==0){for(var o=r.read_shift(4),l=0;l!=o;++l)s.push(Yx(r));a.r=s}else a.r=[{ich:0,ifnt:0}];return r.l=t+e,a}function Xx(r,e){var t=!1;return e==null&&(t=!0,e=H(15+4*r.t.length)),e.write_shift(1,0),Ct(r.t,e),t?e.slice(0,e.l):e}var $x=Nl;function Kx(r,e){var t=!1;return e==null&&(t=!0,e=H(23+4*r.t.length)),e.write_shift(1,1),Ct(r.t,e),e.write_shift(4,1),jx({},e),t?e.slice(0,e.l):e}function pi(r){var e=r.read_shift(4),t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:e,iStyleRef:t}}function $r(r,e){return e==null&&(e=H(8)),e.write_shift(-4,r.c),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}function Kr(r){var e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:e}}function Qr(r,e){return e==null&&(e=H(4)),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}var Qx=Wt,hd=Ct;function Wa(r){var e=r.read_shift(4);return e===0||e===4294967295?"":r.read_shift(e,"dbcs")}function ls(r,e){var t=!1;return e==null&&(t=!0,e=H(127)),e.write_shift(4,r.length>0?r.length:4294967295),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}var qx=Wt,sl=Wa,Il=ls;function Bl(r){var e=r.slice(r.l,r.l+4),t=e[0]&1,i=e[0]&2;r.l+=4;var n=i===0?fa([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):kr(e,0)>>2;return t?n/100:n}function ud(r,e){e==null&&(e=H(4));var t=0,i=0,n=r*100;if(r==(r|0)&&r>=-536870912&&r<1<<29?i=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(i=1,t=1),i)e.write_shift(-4,((t?n:r)<<2)+(t+2));else throw new Error("unsupported RkNumber "+r)}function cd(r){var e={s:{},e:{}};return e.s.r=r.read_shift(4),e.e.r=r.read_shift(4),e.s.c=r.read_shift(4),e.e.c=r.read_shift(4),e}function Jx(r,e){return e||(e=H(16)),e.write_shift(4,r.s.r),e.write_shift(4,r.e.r),e.write_shift(4,r.s.c),e.write_shift(4,r.e.c),e}var qr=cd,An=Jx;function On(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function Yr(r,e){return(e||H(8)).write_shift(8,r,"f")}function Zx(r){var e={},t=r.read_shift(1),i=t>>>1,n=r.read_shift(1),s=r.read_shift(2,"i"),a=r.read_shift(1),o=r.read_shift(1),l=r.read_shift(1);switch(r.l++,i){case 0:e.auto=1;break;case 1:e.index=n;var h=ly[n];h&&(e.rgb=pu(h));break;case 2:e.rgb=pu([a,o,l]);break;case 3:e.theme=n;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function pa(r,e){if(e||(e=H(8)),!r||r.auto)return e.write_shift(4,0),e.write_shift(4,0),e;r.index!=null?(e.write_shift(1,2),e.write_shift(1,r.index)):r.theme!=null?(e.write_shift(1,6),e.write_shift(1,r.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=r.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!r.rgb||r.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var i=r.rgb||"FFFFFF";typeof i=="number"&&(i=("000000"+i.toString(16)).slice(-6)),e.write_shift(1,parseInt(i.slice(0,2),16)),e.write_shift(1,parseInt(i.slice(2,4),16)),e.write_shift(1,parseInt(i.slice(4,6),16)),e.write_shift(1,255)}return e}function ey(r){var e=r.read_shift(1);r.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function ty(r,e){e||(e=H(2));var t=(r.italic?2:0)|(r.strike?8:0)|(r.outline?16:0)|(r.shadow?32:0)|(r.condense?64:0)|(r.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var dd=2,ti=3,Os=11,ma=19,Ls=64,iy=65,ry=71,ny=4108,sy=4126,Dt=80,ru={1:{n:"CodePage",t:dd},2:{n:"Category",t:Dt},3:{n:"PresentationFormat",t:Dt},4:{n:"ByteCount",t:ti},5:{n:"LineCount",t:ti},6:{n:"ParagraphCount",t:ti},7:{n:"SlideCount",t:ti},8:{n:"NoteCount",t:ti},9:{n:"HiddenCount",t:ti},10:{n:"MultimediaClipCount",t:ti},11:{n:"ScaleCrop",t:Os},12:{n:"HeadingPairs",t:ny},13:{n:"TitlesOfParts",t:sy},14:{n:"Manager",t:Dt},15:{n:"Company",t:Dt},16:{n:"LinksUpToDate",t:Os},17:{n:"CharacterCount",t:ti},19:{n:"SharedDoc",t:Os},22:{n:"HyperlinksChanged",t:Os},23:{n:"AppVersion",t:ti,p:"version"},24:{n:"DigSig",t:iy},26:{n:"ContentType",t:Dt},27:{n:"ContentStatus",t:Dt},28:{n:"Language",t:Dt},29:{n:"Version",t:Dt},255:{},2147483648:{n:"Locale",t:ma},2147483651:{n:"Behavior",t:ma},1919054434:{}},nu={1:{n:"CodePage",t:dd},2:{n:"Title",t:Dt},3:{n:"Subject",t:Dt},4:{n:"Author",t:Dt},5:{n:"Keywords",t:Dt},6:{n:"Comments",t:Dt},7:{n:"Template",t:Dt},8:{n:"LastAuthor",t:Dt},9:{n:"RevNumber",t:Dt},10:{n:"EditTime",t:Ls},11:{n:"LastPrinted",t:Ls},12:{n:"CreatedDate",t:Ls},13:{n:"ModifiedDate",t:Ls},14:{n:"PageCount",t:ti},15:{n:"WordCount",t:ti},16:{n:"CharCount",t:ti},17:{n:"Thumbnail",t:ry},18:{n:"Application",t:Dt},19:{n:"DocSecurity",t:ti},255:{},2147483648:{n:"Locale",t:ma},2147483651:{n:"Behavior",t:ma},1919054434:{}};function ay(r){return r.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var oy=ay([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ly=Vt(oy),Qt={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Li={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},hy=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],uy={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Ps={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function fd(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function pd(r,e,t){var i=cx(uy),n=[],s;n[n.length]=Et,n[n.length]=Z("Types",null,{xmlns:Tt.CT,"xmlns:xsd":Tt.xsd,"xmlns:xsi":Tt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return Z("Default",null,{Extension:h[0],ContentType:h[1]})}));var a=function(h){r[h]&&r[h].length>0&&(s=r[h][0],n[n.length]=Z("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Ps[h][e.bookType]||Ps[h].xlsx}))},o=function(h){(r[h]||[]).forEach(function(u){n[n.length]=Z("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Ps[h][e.bookType]||Ps[h].xlsx})})},l=function(h){(r[h]||[]).forEach(function(u){n[n.length]=Z("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:i[h][0]})})};return a("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Pe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function md(r){var e=r.lastIndexOf("/");return r.slice(0,e+1)+"_rels/"+r.slice(e+1)+".rels"}function mn(r){var e=[Et,Z("Relationships",null,{xmlns:Tt.RELS})];return xt(r["!id"]).forEach(function(t){e[e.length]=Z("Relationship",null,r["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function We(r,e,t,i,n,s){if(n||(n={}),r["!id"]||(r["!id"]={}),r["!idx"]||(r["!idx"]=1),e<0)for(e=r["!idx"];r["!id"]["rId"+e];++e);if(r["!idx"]=e+1,n.Id="rId"+e,n.Type=i,n.Target=t,[Pe.HLINK,Pe.XPATH,Pe.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),r["!id"][n.Id])throw new Error("Cannot rewrite rId "+e);return r["!id"][n.Id]=n,r[("/"+n.Target).replace("//","/")]=n,e}function cy(r){var e=[Et];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<r.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+r[t][0]+'" manifest:media-type="'+r[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function su(r,e,t){return['  <rdf:Description rdf:about="'+r+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function dy(r,e){return['  <rdf:Description rdf:about="'+r+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function fy(r){var e=[Et];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=r.length;++t)e.push(su(r[t][0],r[t][1])),e.push(dy("",r[t][0]));return e.push(su("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function gd(r,e){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+sa.version+"</meta:generator></office:meta></office:document-meta>"}var Br=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function uo(r,e,t,i,n){n[r]!=null||e==null||e===""||(n[r]=e,e=Se(e),i[i.length]=t?Z(r,e,t):kt(r,e))}function vd(r,e){var t=e||{},i=[Et,Z("cp:coreProperties",null,{"xmlns:cp":Tt.CORE_PROPS,"xmlns:dc":Tt.dc,"xmlns:dcterms":Tt.dcterms,"xmlns:dcmitype":Tt.dcmitype,"xmlns:xsi":Tt.xsi})],n={};if(!r&&!t.Props)return i.join("");r&&(r.CreatedDate!=null&&uo("dcterms:created",typeof r.CreatedDate=="string"?r.CreatedDate:nl(r.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},i,n),r.ModifiedDate!=null&&uo("dcterms:modified",typeof r.ModifiedDate=="string"?r.ModifiedDate:nl(r.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},i,n));for(var s=0;s!=Br.length;++s){var a=Br[s],o=t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:r?r[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&uo(a[0],o,null,i,n)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var gn=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],bd=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function wd(r){var e=[],t=Z;return r||(r={}),r.Application="SheetJS",e[e.length]=Et,e[e.length]=Z("Properties",null,{xmlns:Tt.EXT_PROPS,"xmlns:vt":Tt.vt}),gn.forEach(function(i){if(r[i[1]]!==void 0){var n;switch(i[2]){case"string":n=Se(String(r[i[1]]));break;case"bool":n=r[i[1]]?"true":"false";break}n!==void 0&&(e[e.length]=t(i[0],n))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",r.SheetNames.map(function(i){return"<vt:lpstr>"+Se(i)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function xd(r){var e=[Et,Z("Properties",null,{xmlns:Tt.CUST_PROPS,"xmlns:vt":Tt.vt})];if(!r)return e.join("");var t=1;return xt(r).forEach(function(n){++t,e[e.length]=Z("property",Rx(r[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Se(n)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var au={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function py(r,e){var t=[];return xt(au).map(function(i){for(var n=0;n<Br.length;++n)if(Br[n][1]==i)return Br[n];for(n=0;n<gn.length;++n)if(gn[n][1]==i)return gn[n];throw i}).forEach(function(i){if(r[i[1]]!=null){var n=e&&e.Props&&e.Props[i[1]]!=null?e.Props[i[1]]:r[i[1]];switch(i[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),t.push(kt(au[i[1]]||i[1],n))}}),Z("DocumentProperties",t.join(""),{xmlns:ri.o})}function my(r,e){var t=["Worksheets","SheetNames"],i="CustomDocumentProperties",n=[];return r&&xt(r).forEach(function(s){if(Object.prototype.hasOwnProperty.call(r,s)){for(var a=0;a<Br.length;++a)if(s==Br[a][1])return;for(a=0;a<gn.length;++a)if(s==gn[a][1])return;for(a=0;a<t.length;++a)if(s==t[a])return;var o=r[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),n.push(Z(Xh(s),o,{"dt:dt":l}))}}),e&&xt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(r&&Object.prototype.hasOwnProperty.call(r,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),n.push(Z(Xh(s),a,{"dt:dt":o}))}}),"<"+i+' xmlns="'+ri.o+'">'+n.join("")+"</"+i+">"}function gy(r){var e=typeof r=="string"?new Date(Date.parse(r)):r,t=e.getTime()/1e3+11644473600,i=t%Math.pow(2,32),n=(t-i)/Math.pow(2,32);i*=1e7,n*=1e7;var s=i/Math.pow(2,32)|0;s>0&&(i=i%Math.pow(2,32),n+=s);var a=H(8);return a.write_shift(4,i),a.write_shift(4,n),a}function ou(r,e){var t=H(4),i=H(4);switch(t.write_shift(4,r==80?31:r),r){case 3:i.write_shift(-4,e);break;case 5:i=H(8),i.write_shift(8,e,"f");break;case 11:i.write_shift(4,e?1:0);break;case 64:i=gy(e);break;case 31:case 80:for(i=H(4+2*(e.length+1)+(e.length%2?0:2)),i.write_shift(4,e.length+1),i.write_shift(0,e,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+e)}return wt([t,i])}var yd=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function vy(r){switch(typeof r){case"boolean":return 11;case"number":return(r|0)==r?3:5;case"string":return 31;case"object":if(r instanceof Date)return 64;break}return-1}function lu(r,e,t){var i=H(8),n=[],s=[],a=8,o=0,l=H(8),h=H(8);if(l.write_shift(4,2),l.write_shift(4,1200),h.write_shift(4,1),s.push(l),n.push(h),a+=8+l.length,!e){h=H(8),h.write_shift(4,0),n.unshift(h);var u=[H(4)];for(u[0].write_shift(4,r.length),o=0;o<r.length;++o){var d=r[o][0];for(l=H(8+2*(d.length+1)+(d.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,d.length+1),l.write_shift(0,d,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=wt(u),s.unshift(l),a+=8+l.length}for(o=0;o<r.length;++o)if(!(e&&!e[r[o][0]])&&!(yd.indexOf(r[o][0])>-1||bd.indexOf(r[o][0])>-1)&&r[o][1]!=null){var c=r[o][1],f=0;if(e){f=+e[r[o][0]];var p=t[f];if(p.p=="version"&&typeof c=="string"){var v=c.split(".");c=(+v[0]<<16)+(+v[1]||0)}l=ou(p.t,c)}else{var m=vy(c);m==-1&&(m=31,c=String(c)),l=ou(m,c)}s.push(l),h=H(8),h.write_shift(4,e?f:2+o),n.push(h),a+=8+l.length}var g=8*(s.length+1);for(o=0;o<s.length;++o)n[o].write_shift(4,g),g+=s[o].length;return i.write_shift(4,a),i.write_shift(4,s.length),wt([i].concat(n).concat(s))}function hu(r,e,t,i,n,s){var a=H(n?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Ze.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,n?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,n?68:48);var l=lu(r,t,i);if(o.push(l),n){var h=lu(n,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(h)}return wt(o)}function by(r,e){e||(e=H(r));for(var t=0;t<r;++t)e.write_shift(1,0);return e}function wy(r,e){return r.read_shift(e)===1}function Nt(r,e){return e||(e=H(2)),e.write_shift(2,+!!r),e}function Ys(r){return r.read_shift(2,"u")}function ui(r,e){return e||(e=H(2)),e.write_shift(2,r),e}function Ed(r,e,t){return t||(t=H(2)),t.write_shift(1,e=="e"?+r:+!!r),t.write_shift(1,e=="e"?1:0),t}function Cd(r,e,t){var i=r.read_shift(t&&t.biff>=12?2:1),n="sbcs-cont",s=Yi;if(t&&t.biff>=8&&(Yi=1200),!t||t.biff==8){var a=r.read_shift(1);a&&(n="dbcs-cont")}else t.biff==12&&(n="wstr");t.biff>=2&&t.biff<=5&&(n="cpstr");var o=i?r.read_shift(i,n):"";return Yi=s,o}function xy(r){var e=r.t||"",t=H(3);t.write_shift(2,e.length),t.write_shift(1,1);var i=H(2*e.length);i.write_shift(2*e.length,e,"utf16le");var n=[t,i];return wt(n)}function yy(r,e,t){var i;if(t){if(t.biff>=2&&t.biff<=5)return r.read_shift(e,"cpstr");if(t.biff>=12)return r.read_shift(e,"dbcs-cont")}var n=r.read_shift(1);return n===0?i=r.read_shift(e,"sbcs-cont"):i=r.read_shift(e,"dbcs-cont"),i}function Ey(r,e,t){var i=r.read_shift(t&&t.biff==2?1:2);return i===0?(r.l++,""):yy(r,i,t)}function Cy(r,e,t){if(t.biff>5)return Ey(r,e,t);var i=r.read_shift(1);return i===0?(r.l++,""):r.read_shift(i,t.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function _d(r,e,t){return t||(t=H(3+2*r.length)),t.write_shift(2,r.length),t.write_shift(1,1),t.write_shift(31,r,"utf16le"),t}function uu(r,e){e||(e=H(6+r.length*2)),e.write_shift(4,1+r.length);for(var t=0;t<r.length;++t)e.write_shift(2,r.charCodeAt(t));return e.write_shift(2,0),e}function _y(r){var e=H(512),t=0,i=r.Target;i.slice(0,7)=="file://"&&(i=i.slice(7));var n=i.indexOf("#"),s=n>-1?31:23;switch(i.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(t=0;t<a.length;++t)e.write_shift(4,a[t]);if(s==28)i=i.slice(1),uu(i,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));var o=n>-1?i.slice(0,n):i;for(e.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)e.write_shift(2,o.charCodeAt(t));e.write_shift(2,0),s&8&&uu(n>-1?i.slice(n+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));for(var l=0;i.slice(l*3,l*3+3)=="../"||i.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,i.length-3*l+1),t=0;t<i.length-3*l;++t)e.write_shift(1,i.charCodeAt(t+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function jr(r,e,t,i){return i||(i=H(6)),i.write_shift(2,r),i.write_shift(2,e),i.write_shift(2,t||0),i}function Ty(r,e,t){var i=t.biff>8?4:2,n=r.read_shift(i),s=r.read_shift(i,"i"),a=r.read_shift(i,"i");return[n,s,a]}function Sy(r){var e=r.read_shift(2),t=r.read_shift(2),i=r.read_shift(2),n=r.read_shift(2);return{s:{c:i,r:e},e:{c:n,r:t}}}function Td(r,e){return e||(e=H(8)),e.write_shift(2,r.s.r),e.write_shift(2,r.e.r),e.write_shift(2,r.s.c),e.write_shift(2,r.e.c),e}function Hl(r,e,t){var i=1536,n=16;switch(t.bookType){case"biff8":break;case"biff5":i=1280,n=8;break;case"biff4":i=4,n=6;break;case"biff3":i=3,n=6;break;case"biff2":i=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=H(n);return s.write_shift(2,i),s.write_shift(2,e),n>4&&s.write_shift(2,29282),n>6&&s.write_shift(2,1997),n>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function Dy(r,e){var t=!e||e.biff==8,i=H(t?112:54);for(i.write_shift(e.biff==8?2:1,7),t&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(t?0:536870912));i.l<i.length;)i.write_shift(1,t?0:32);return i}function ky(r,e){var t=!e||e.biff>=8?2:1,i=H(8+t*r.name.length);i.write_shift(4,r.pos),i.write_shift(1,r.hs||0),i.write_shift(1,r.dt),i.write_shift(1,r.name.length),e.biff>=8&&i.write_shift(1,1),i.write_shift(t*r.name.length,r.name,e.biff<8?"sbcs":"utf16le");var n=i.slice(0,i.l);return n.l=i.l,n}function Ry(r,e){var t=H(8);t.write_shift(4,r.Count),t.write_shift(4,r.Unique);for(var i=[],n=0;n<r.length;++n)i[n]=xy(r[n]);var s=wt([t].concat(i));return s.parts=[t.length].concat(i.map(function(a){return a.length})),s}function Fy(){var r=H(18);return r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,29280),r.write_shift(2,17600),r.write_shift(2,56),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,1),r.write_shift(2,500),r}function My(r){var e=H(18),t=1718;return r&&r.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function Ay(r,e){var t=r.name||"Arial",i=e&&e.biff==5,n=i?15+t.length:16+2*t.length,s=H(n);return s.write_shift(2,r.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),i||s.write_shift(1,1),s.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le"),s}function Oy(r,e,t,i){var n=H(10);return jr(r,e,i,n),n.write_shift(4,t),n}function Ly(r,e,t,i,n){var s=!n||n.biff==8,a=H(8+ +s+(1+s)*t.length);return jr(r,e,i,a),a.write_shift(2,t.length),s&&a.write_shift(1,1),a.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),a}function Py(r,e,t,i){var n=t&&t.biff==5;i||(i=H(n?3+e.length:5+2*e.length)),i.write_shift(2,r),i.write_shift(n?1:2,e.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*e.length,e,n?"sbcs":"utf16le");var s=i.length>i.l?i.slice(0,i.l):i;return s.l==null&&(s.l=s.length),s}function Ny(r){var e=H(1+r.length);return e.write_shift(1,r.length),e.write_shift(r.length,r,"sbcs"),e}function Iy(r){var e=H(3+r.length);return e.l+=2,e.write_shift(1,r.length),e.write_shift(r.length,r,"sbcs"),e}function By(r,e){var t=e.biff==8||!e.biff?4:2,i=H(2*t+6);return i.write_shift(t,r.s.r),i.write_shift(t,r.e.r+1),i.write_shift(2,r.s.c),i.write_shift(2,r.e.c+1),i.write_shift(2,0),i}function cu(r,e,t,i){var n=t&&t.biff==5;i||(i=H(n?16:20)),i.write_shift(2,0),r.style?(i.write_shift(2,r.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,r.numFmtId||0),i.write_shift(2,e<<4));var s=0;return r.numFmtId>0&&n&&(s|=1024),i.write_shift(4,s),i.write_shift(4,0),n||i.write_shift(4,0),i.write_shift(2,0),i}function Hy(r){var e=H(4);return e.l+=2,e.write_shift(1,r.numFmtId),e.l++,e}function Sd(r){var e=H(12);return e.l++,e.write_shift(1,r.numFmtId),e.l+=10,e}var zy=Sd;function Wy(r){var e=H(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function co(r,e,t,i,n,s){var a=H(8);return jr(r,e,i,a),Ed(t,s,a),a}function Vy(r,e,t,i){var n=H(14);return jr(r,e,i,n),Yr(t,n),n}function Uy(r,e,t){if(t.biff<8||!(t.biff>8)&&e==r[r.l]+(r[r.l+1]==3?1:0)+1)return du(r,e,t);for(var i=[],n=r.l+e,s=r.read_shift(t.biff>8?4:2);s--!==0;)i.push(Ty(r,t.biff>8?12:6,t));if(r.l!=n)throw new Error("Bad ExternSheet: "+r.l+" != "+n);return i}function du(r,e,t){r[r.l+1]==3&&r[r.l]++;var i=Cd(r,e,t);return i.charCodeAt(0)==3?i.slice(1):i}function fo(r,e,t,i){var n=H(6+(i||r.length));return n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,i||r.length),n.write_shift(r.length,r,"sbcs"),n}function Gy(r){var e=H(2+r.length*8);e.write_shift(2,r.length);for(var t=0;t<r.length;++t)Td(r[t],e);return e}function Yy(r){var e=H(24),t=lt(r[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)e.write_shift(1,parseInt(i[n],16));return wt([e,_y(r[1])])}function jy(r){var e=r[1].Tooltip,t=H(10+2*(e.length+1));t.write_shift(2,2048);var i=lt(r[0]);t.write_shift(2,i.r),t.write_shift(2,i.r),t.write_shift(2,i.c),t.write_shift(2,i.c);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function Xy(r){return r||(r=H(4)),r.write_shift(2,1),r.write_shift(2,1),r}function $y(r,e,t){if(!t.cellStyles)return Ii(r,e);var i=t&&t.biff>=12?4:2,n=r.read_shift(i),s=r.read_shift(i),a=r.read_shift(i),o=r.read_shift(i),l=r.read_shift(2);i==2&&(r.l+=2);var h={s:n,e:s,w:a,ixfe:o,flags:l};return(t.biff>=5||!t.biff)&&(h.level=l>>8&7),h}function Ky(r,e){var t=H(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,r.width*256),t.write_shift(2,0);var i=0;return r.hidden&&(i|=1),t.write_shift(1,i),i=r.level||0,t.write_shift(1,i),t.write_shift(2,0),t}function Qy(r){for(var e=H(2*r),t=0;t<r;++t)e.write_shift(2,t+1);return e}function bs(r,e,t,i,n){return r||(r=H(7)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(1,i||0),r.write_shift(1,n||0),r.write_shift(1,0),r}function qy(r,e,t,i,n){var s=H(15);return bs(s,r,e,i||0,n||0),s.write_shift(8,t,"f"),s}function Jy(r,e,t,i,n){var s=H(9);return bs(s,r,e,i||0,n||0),s.write_shift(2,t),s}var Zy=function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Dl({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,l){var h=[],u=Vr(1);switch(l.type){case"base64":u=ii(wr(o));break;case"binary":u=ii(o);break;case"buffer":case"array":u=o;break}Xt(u,0);var d=u.read_shift(1),c=!!(d&136),f=!1,p=!1;switch(d){case 2:break;case 3:break;case 48:f=!0,c=!0;break;case 49:f=!0,c=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var v=0,m=521;d==2&&(v=u.read_shift(2)),u.l+=3,d!=2&&(v=u.read_shift(4)),v>1048576&&(v=1e6),d!=2&&(m=u.read_shift(2));var g=u.read_shift(2);l.codepage,d!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&r[u[u.l]],u.l+=1,u.l+=2),p&&(u.l+=36);for(var x=[],b={},F=Math.min(u.length,d==2?521:m-10-(f?264:0)),A=p?32:11;u.l<F&&u[u.l]!=13;)switch(b={},b.name=Ur(u.slice(u.l,u.l+A)).replace(/[\u0000\r\n][\S\s]*$/g,""),u.l+=A,b.type=String.fromCharCode(u.read_shift(1)),d!=2&&!p&&(b.offset=u.read_shift(4)),b.len=u.read_shift(1),d==2&&(b.offset=u.read_shift(2)),b.dec=u.read_shift(1),b.name.length&&x.push(b),d!=2&&(u.l+=p?13:14),b.type){case"B":(!f||b.len!=8)&&l.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+b.type)}if(u[u.l]!==13&&(u.l=m-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=m;var _=0,y=0;for(h[0]=[],y=0;y!=x.length;++y)h[0][y]=x[y].name;for(;v-- >0;){if(u[u.l]===42){u.l+=g;continue}for(++u.l,h[++_]=[],y=0,y=0;y!=x.length;++y){var R=u.slice(u.l,u.l+x[y].len);u.l+=x[y].len,Xt(R,0);var M=Ur(R);switch(x[y].type){case"C":M.trim().length&&(h[_][y]=M.replace(/([^\s])\s+$/,"$1"));break;case"D":M.length===8?(h[_][y]=new Date(Date.UTC(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8),0,0,0,0)),l&&l.UTC||(h[_][y]=Sn(h[_][y]))):h[_][y]=M;break;case"F":h[_][y]=parseFloat(M.trim());break;case"+":case"I":h[_][y]=p?R.read_shift(-4,"i")^2147483648:R.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":h[_][y]=!0;break;case"N":case"F":h[_][y]=!1;break;case"":case"\0":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!c)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));h[_][y]="##MEMO##"+(p?parseInt(M.trim(),10):R.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(h[_][y]=+M||0);break;case"@":h[_][y]=new Date(R.read_shift(-8,"f")-621356832e5);break;case"T":{var I=R.read_shift(4),P=R.read_shift(4);if(I==0&&P==0)break;h[_][y]=new Date((I-2440588)*864e5+P),l&&l.UTC||(h[_][y]=Sn(h[_][y]))}break;case"Y":h[_][y]=R.read_shift(4,"i")/1e4+R.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[_][y]=-R.read_shift(-8,"f");break;case"B":if(f&&x[y].len==8){h[_][y]=R.read_shift(8,"f");break}case"G":case"P":R.l+=x[y].len;break;case"0":if(x[y].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[y].type)}}}if(d!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(h=h.slice(0,l.sheetRows)),l.DBF=x,h}function i(o,l){var h=l||{};h.dateNF||(h.dateNF="yyyymmdd");var u=Mn(t(o,h),h);return u["!cols"]=h.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete h.DBF,u}function n(o,l){try{var h=Fn(i(o,l),l);return h.bookType="dbf",h}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){if(!o["!ref"])throw new Error("Cannot export empty sheet to DBF");var h=l||{},u=Yi;if(+h.codepage>=0&&rs(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var d=zt(),c=hl(o,{header:1,raw:!0,cellDates:!0}),f=c[0],p=c.slice(1),v=o["!cols"]||[],m=0,g=0,x=0,b=1;for(m=0;m<f.length;++m){if(((v[m]||{}).DBF||{}).name){f[m]=v[m].DBF.name,++x;continue}if(f[m]!=null){if(++x,typeof f[m]=="number"&&(f[m]=f[m].toString(10)),typeof f[m]!="string")throw new Error("DBF Invalid column name "+f[m]+" |"+typeof f[m]+"|");if(f.indexOf(f[m])!==m){for(g=0;g<1024;++g)if(f.indexOf(f[m]+"_"+g)==-1){f[m]+="_"+g;break}}}}var F=nt(o["!ref"]),A=[],_=[],y=[];for(m=0;m<=F.e.c-F.s.c;++m){var R="",M="",I=0,P=[];for(g=0;g<p.length;++g)p[g][m]!=null&&P.push(p[g][m]);if(P.length==0||f[m]==null){A[m]="?";continue}for(g=0;g<P.length;++g){switch(typeof P[g]){case"number":M="B";break;case"string":M="C";break;case"boolean":M="L";break;case"object":M=P[g]instanceof Date?"D":"C";break;default:M="C"}I=Math.max(I,String(P[g]).length),R=R&&R!=M?"C":M}I>250&&(I=250),M=((v[m]||{}).DBF||{}).type,M=="C"&&v[m].DBF.len>I&&(I=v[m].DBF.len),R=="B"&&M=="N"&&(R="N",y[m]=v[m].DBF.dec,I=v[m].DBF.len),_[m]=R=="C"||M=="N"?I:s[R]||0,b+=_[m],A[m]=R}var N=d.next(32);for(N.write_shift(4,318902576),N.write_shift(4,p.length),N.write_shift(2,296+32*x),N.write_shift(2,b),m=0;m<4;++m)N.write_shift(4,0);var ne=+e[Yi]||3;for(N.write_shift(4,0|ne<<8),r[ne]!=+h.codepage&&(h.codepage&&console.error("DBF Unsupported codepage "+Yi+", using 1252"),Yi=1252),m=0,g=0;m<f.length;++m)if(f[m]!=null){var he=d.next(32),se=(f[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);he.write_shift(1,se,"sbcs"),he.write_shift(1,A[m]=="?"?"C":A[m],"sbcs"),he.write_shift(4,g),he.write_shift(1,_[m]||s[A[m]]||0),he.write_shift(1,y[m]||0),he.write_shift(1,2),he.write_shift(4,0),he.write_shift(1,0),he.write_shift(4,0),he.write_shift(4,0),g+=_[m]||s[A[m]]||0}var fe=d.next(264);for(fe.write_shift(4,13),m=0;m<65;++m)fe.write_shift(4,0);for(m=0;m<p.length;++m){var ee=d.next(b);for(ee.write_shift(1,0),g=0;g<f.length;++g)if(f[g]!=null)switch(A[g]){case"L":ee.write_shift(1,p[m][g]==null?63:p[m][g]?84:70);break;case"B":ee.write_shift(8,p[m][g]||0,"f");break;case"N":var ge="0";for(typeof p[m][g]=="number"&&(ge=p[m][g].toFixed(y[g]||0)),ge.length>_[g]&&(ge=ge.slice(0,_[g])),x=0;x<_[g]-ge.length;++x)ee.write_shift(1,32);ee.write_shift(1,ge,"sbcs");break;case"D":p[m][g]?(ee.write_shift(4,("0000"+p[m][g].getFullYear()).slice(-4),"sbcs"),ee.write_shift(2,("00"+(p[m][g].getMonth()+1)).slice(-2),"sbcs"),ee.write_shift(2,("00"+p[m][g].getDate()).slice(-2),"sbcs")):ee.write_shift(8,"00000000","sbcs");break;case"C":var _e=ee.l,Je=String(p[m][g]!=null?p[m][g]:"").slice(0,_[g]);for(ee.write_shift(1,Je,"cpstr"),_e+=_[g]-ee.l,x=0;x<_e;++x)ee.write_shift(1,32);break}}return Yi=u,d.next(1).write_shift(1,26),d.end()}return{to_workbook:n,to_sheet:i,from_sheet:a}}(),eE=function(){var r={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+xt(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1").replace("{","\\{")+"|\\|)","gm");try{e=new RegExp("\x1BN("+xt(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm")}catch{}var t=function(f,p){var v=r[p];return typeof v=="number"?Ph(v):v},i=function(f,p,v){var m=p.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return m==59?f:Ph(m)};r["|"]=254;var n=function(f){return f.replace(/\n/g,"\x1B :").replace(/\r/g,"\x1B =")};function s(f,p){switch(p.type){case"base64":return a(wr(f),p);case"binary":return a(f,p);case"buffer":return a(Ve&&Buffer.isBuffer(f)?f.toString("binary"):Ur(f),p);case"array":return a(kl(f),p)}throw new Error("Unrecognized type "+p.type)}function a(f,p){var v=f.split(/[\n\r]+/),m=-1,g=-1,x=0,b=0,F=[],A=[],_=null,y={},R=[],M=[],I=[],P=0,N,ne={Workbook:{WBProps:{},Names:[]}};for(+p.codepage>=0&&rs(+p.codepage);x!==v.length;++x){P=0;var he=v[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(e,t),se=he.replace(/;;/g,"\0").split(";").map(function(O){return O.replace(/\u0000/g,";")}),fe=se[0],ee;if(he.length>0)switch(fe){case"ID":break;case"E":break;case"B":break;case"O":for(b=1;b<se.length;++b)switch(se[b].charAt(0)){case"V":{var ge=parseInt(se[b].slice(1),10);ge>=1&&ge<=4&&(ne.Workbook.WBProps.date1904=!0)}break}break;case"W":break;case"P":switch(se[1].charAt(0)){case"P":A.push(he.slice(3).replace(/;;/g,";"));break}break;case"NN":{var _e={Sheet:0};for(b=1;b<se.length;++b)switch(se[b].charAt(0)){case"N":_e.Name=se[b].slice(1);break;case"E":_e.Ref=(p&&p.sheet||"Sheet1")+"!"+vu(se[b].slice(1));break}ne.Workbook.Names.push(_e)}break;case"C":var Je=!1,tt=!1,De=!1,Fe=!1,Ae=-1,Ne=-1,He="",Oe="z",k="";for(b=1;b<se.length;++b)switch(se[b].charAt(0)){case"A":k=se[b].slice(1);break;case"X":g=parseInt(se[b].slice(1),10)-1,tt=!0;break;case"Y":for(m=parseInt(se[b].slice(1),10)-1,tt||(g=0),N=F.length;N<=m;++N)F[N]=[];break;case"K":ee=se[b].slice(1),ee.charAt(0)==='"'?(ee=ee.slice(1,ee.length-1),Oe="s"):ee==="TRUE"||ee==="FALSE"?(ee=ee==="TRUE",Oe="b"):ee.charAt(0)=="#"&&Li[ee]!=null?(Oe="e",ee=Li[ee]):isNaN(Ji(ee))||(ee=Ji(ee),Oe="n",_!==null&&Gr(_)&&p.cellDates&&(ee=fn(ne.Workbook.WBProps.date1904?ee+1462:ee),Oe=typeof ee=="number"?"n":"d")),Je=!0;break;case"E":Fe=!0,He=vu(se[b].slice(1),{r:m,c:g});break;case"S":De=!0;break;case"G":break;case"R":Ae=parseInt(se[b].slice(1),10)-1;break;case"C":Ne=parseInt(se[b].slice(1),10)-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+he)}if(Je&&(F[m][g]?(F[m][g].t=Oe,F[m][g].v=ee):F[m][g]={t:Oe,v:ee},_&&(F[m][g].z=_),p.cellText!==!1&&_&&(F[m][g].w=tr(F[m][g].z,F[m][g].v,{date1904:ne.Workbook.WBProps.date1904})),_=null),De){if(Fe)throw new Error("SYLK shared formula cannot have own formula");var U=Ae>-1&&F[Ae][Ne];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");He=tC(U[1],{r:m-Ae,c:g-Ne})}He&&(F[m][g]?F[m][g].f=He:F[m][g]={t:"n",f:He}),k&&(F[m][g]||(F[m][g]={t:"z"}),F[m][g].c=[{a:"SheetJSYLK",t:k}]);break;case"F":var L=0;for(b=1;b<se.length;++b)switch(se[b].charAt(0)){case"X":g=parseInt(se[b].slice(1),10)-1,++L;break;case"Y":for(m=parseInt(se[b].slice(1),10)-1,N=F.length;N<=m;++N)F[N]=[];break;case"M":P=parseInt(se[b].slice(1),10)/20;break;case"F":break;case"G":break;case"P":_=A[parseInt(se[b].slice(1),10)];break;case"S":break;case"D":break;case"N":break;case"W":for(I=se[b].slice(1).split(" "),N=parseInt(I[0],10);N<=parseInt(I[1],10);++N)P=parseInt(I[2],10),M[N-1]=P===0?{hidden:!0}:{wch:P};break;case"C":g=parseInt(se[b].slice(1),10)-1,M[g]||(M[g]={});break;case"R":m=parseInt(se[b].slice(1),10)-1,R[m]||(R[m]={}),P>0?(R[m].hpt=P,R[m].hpx=Fd(P)):P===0&&(R[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+he)}L<1&&(_=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+he)}}return R.length>0&&(y["!rows"]=R),M.length>0&&(y["!cols"]=M),M.forEach(function(O){zl(O)}),p&&p.sheetRows&&(F=F.slice(0,p.sheetRows)),[F,y,ne]}function o(f,p){var v=s(f,p),m=v[0],g=v[1],x=v[2],b=Vt(p);b.date1904=(((x||{}).Workbook||{}).WBProps||{}).date1904;var F=Mn(m,b);xt(g).forEach(function(_){F[_]=g[_]});var A=Fn(F,p);return xt(x).forEach(function(_){A[_]=x[_]}),A.bookType="sylk",A}function l(f,p,v,m,g,x){var b="C;Y"+(v+1)+";X"+(m+1)+";K";switch(f.t){case"n":b+=isFinite(f.v)?f.v||0:Qt[isNaN(f.v)?36:7],f.f&&!f.F&&(b+=";E"+Ua(f.f,{r:v,c:m}));break;case"b":b+=f.v?"TRUE":"FALSE";break;case"e":b+=f.w||Qt[f.v]||f.v;break;case"d":b+=Mt(Zt(f.v,x),x);break;case"s":b+='"'+(f.v==null?"":String(f.v)).replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function h(f,p,v){var m="C;Y"+(p+1)+";X"+(v+1)+";A";return m+=n(f.map(function(g){return g.t}).join("")),m}function u(f,p){p.forEach(function(v,m){var g="F;W"+(m+1)+" "+(m+1)+" ";v.hidden?g+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=ga(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=va(v.wpx)),typeof v.wch=="number"&&(g+=Math.round(v.wch))),g.charAt(g.length-1)!=" "&&f.push(g)})}function d(f,p){p.forEach(function(v,m){var g="F;";v.hidden?g+="M0;":v.hpt?g+="M"+20*v.hpt+";":v.hpx&&(g+="M"+20*ba(v.hpx)+";"),g.length>2&&f.push(g+"R"+(m+1))})}function c(f,p,v){p||(p={}),p._formats=["General"];var m=["ID;PSheetJS;N;E"],g=[],x=nt(f["!ref"]||"A1"),b,F=f["!data"]!=null,A=`\r
`,_=(((v||{}).Workbook||{}).WBProps||{}).date1904,y="General";m.push("P;PGeneral");var R=x.s.r,M=x.s.c,I=[];if(f["!ref"]){for(R=x.s.r;R<=x.e.r;++R)if(!(F&&!f["!data"][R])){for(I=[],M=x.s.c;M<=x.e.c;++M)b=F?f["!data"][R][M]:f[$e(M)+qe(R)],!(!b||!b.c)&&I.push(h(b.c,R,M));I.length&&g.push(I.join(A))}}if(f["!ref"]){for(R=x.s.r;R<=x.e.r;++R)if(!(F&&!f["!data"][R])){for(I=[],M=x.s.c;M<=x.e.c;++M)if(b=F?f["!data"][R][M]:f[$e(M)+qe(R)],!(!b||b.v==null&&(!b.f||b.F))){if((b.z||(b.t=="d"?rt[14]:"General"))!=y){var P=p._formats.indexOf(b.z);P==-1&&(p._formats.push(b.z),P=p._formats.length-1,m.push("P;P"+b.z.replace(/;/g,";;"))),I.push("F;P"+P+";Y"+(R+1)+";X"+(M+1))}I.push(l(b,f,R,M,p,_))}g.push(I.join(A))}}return m.push("F;P0;DG0G8;M255"),f["!cols"]&&u(m,f["!cols"]),f["!rows"]&&d(m,f["!rows"]),f["!ref"]&&m.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" ")),m.push("O;L;D;B"+(_?";V4":"")+";K47;G100 0.001"),delete p._formats,m.join(A)+A+g.join(A)+A+"E"+A}return{to_workbook:o,from_sheet:c}}(),tE=function(){function r(o,l){switch(l.type){case"base64":return e(wr(o),l);case"binary":return e(o,l);case"buffer":return e(Ve&&Buffer.isBuffer(o)?o.toString("binary"):Ur(o),l);case"array":return e(kl(o),l)}throw new Error("Unrecognized type "+l.type)}function e(o,l){for(var h=o.split(`
`),u=-1,d=-1,c=0,f=[];c!==h.length;++c){if(h[c].trim()==="BOT"){f[++u]=[],d=0;continue}if(!(u<0)){var p=h[c].trim().split(","),v=p[0],m=p[1];++c;for(var g=h[c]||"";(g.match(/["]/g)||[]).length&1&&c<h.length-1;)g+=`
`+h[++c];switch(g=g.trim(),+v){case-1:if(g==="BOT"){f[++u]=[],d=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?f[u][d]=!0:g==="FALSE"?f[u][d]=!1:isNaN(Ji(m))?isNaN(da(m).getDate())?f[u][d]=m:(f[u][d]=Zt(m),l&&l.UTC||(f[u][d]=Sn(f[u][d]))):f[u][d]=Ji(m),++d;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),f[u][d++]=g!==""?g:null;break}if(g==="EOD")break}}return l&&l.sheetRows&&(f=f.slice(0,l.sheetRows)),f}function t(o,l){return Mn(r(o,l),l)}function i(o,l){var h=Fn(t(o,l),l);return h.bookType="dif",h}function n(o,l){return"0,"+String(o)+`\r
`+l}function s(o){return`1,0\r
"`+o.replace(/"/g,'""')+'"'}function a(o){if(!o["!ref"])throw new Error("Cannot export empty sheet to DIF");for(var l=nt(o["!ref"]),h=o["!data"]!=null,u=[`TABLE\r
0,1\r
"sheetjs"\r
`,`VECTORS\r
0,`+(l.e.r-l.s.r+1)+`\r
""\r
`,`TUPLES\r
0,`+(l.e.c-l.s.c+1)+`\r
""\r
`,`DATA\r
0,0\r
""\r
`],d=l.s.r;d<=l.e.r;++d){for(var c=h?o["!data"][d]:[],f=`-1,0\r
BOT\r
`,p=l.s.c;p<=l.e.c;++p){var v=h?c&&c[p]:o[ct({r:d,c:p})];if(v==null){f+=`1,0\r
""\r
`;continue}switch(v.t){case"n":v.w!=null?f+="0,"+v.w+`\r
V`:v.v!=null?f+=n(v.v,"V"):v.f!=null&&!v.F?f+=s("="+v.f):f+=`1,0\r
""`;break;case"b":f+=v.v?n(1,"TRUE"):n(0,"FALSE");break;case"s":f+=s(isNaN(+v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=tr(v.z||rt[14],Mt(Zt(v.v)))),f+=n(v.w,"V");break;default:f+=`1,0\r
""`}f+=`\r
`}u.push(f)}return u.join("")+`-1,0\r
EOD`}return{to_workbook:i,to_sheet:t,from_sheet:a}}(),Dd=function(){function r(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(d,c){for(var f=d.split(`
`),p=-1,v=-1,m=0,g=[];m!==f.length;++m){var x=f[m].trim().split(":");if(x[0]==="cell"){var b=lt(x[1]);if(g.length<=b.r)for(p=g.length;p<=b.r;++p)g[p]||(g[p]=[]);switch(p=b.r,v=b.c,x[2]){case"t":g[p][v]=r(x[3]);break;case"v":g[p][v]=+x[3];break;case"vtf":var F=x[x.length-1];case"vtc":switch(x[3]){case"nl":g[p][v]=!!+x[4];break;default:g[p][v]=x[x.length-1].charAt(0)=="#"?{t:"e",v:Li[x[x.length-1]]}:+x[4];break}x[2]=="vtf"&&(g[p][v]=[g[p][v],F])}}}return c&&c.sheetRows&&(g=g.slice(0,c.sheetRows)),g}function i(d,c){return Mn(t(d,c),c)}function n(d,c){return Fn(i(d,c),c)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function h(d){if(!d||!d["!ref"])return"";for(var c=[],f=[],p,v="",m=Ft(d["!ref"]),g=d["!data"]!=null,x=m.s.r;x<=m.e.r;++x)for(var b=m.s.c;b<=m.e.c;++b)if(v=ct({r:x,c:b}),p=g?(d["!data"][x]||[])[b]:d[v],!(!p||p.v==null||p.t==="z")){switch(f=["cell",v,"t"],p.t){case"s":f.push(e(p.v));break;case"b":f[2]="vt"+(p.f?"f":"c"),f[3]="nl",f[4]=p.v?"1":"0",f[5]=e(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var F=Mt(Zt(p.v));f[2]="vtc",f[3]="nd",f[4]=""+F,f[5]=p.w||tr(p.z||rt[14],F);break;case"n":isFinite(p.v)?p.f?(f[2]="vtf",f[3]="n",f[4]=p.v,f[5]=e(p.f)):(f[2]="v",f[3]=p.v):(f[2]="vt"+(p.f?"f":"c"),f[3]="e"+Qt[isNaN(p.v)?36:7],f[4]="0",f[5]=p.f||f[3].slice(1),f[6]="e",f[7]=f[3].slice(1));break;case"e":continue}c.push(f.join(":"))}return c.push("sheet:c:"+(m.e.c-m.s.c+1)+":r:"+(m.e.r-m.s.r+1)+":tvf:1"),c.push("valueformat:1:text-wiki"),c.join(`
`)}function u(d){return[s,a,o,a,h(d),l].join(`
`)}return{to_workbook:n,to_sheet:i,from_sheet:u}}(),iE=function(){function r(u,d,c,f,p){p.raw?d[c][f]=u:u===""||(u==="TRUE"?d[c][f]=!0:u==="FALSE"?d[c][f]=!1:isNaN(Ji(u))?isNaN(da(u).getDate())?u.charCodeAt(0)==35&&Li[u]!=null?d[c][f]={t:"e",v:Li[u],w:u}:d[c][f]=u:d[c][f]=Zt(u):d[c][f]=Ji(u))}function e(u,d){var c=d||{},f=[];if(!u||u.length===0)return f;for(var p=u.split(/[\r\n]/),v=p.length-1;v>=0&&p[v].length===0;)--v;for(var m=10,g=0,x=0;x<=v;++x)g=p[x].indexOf(" "),g==-1?g=p[x].length:g++,m=Math.max(m,g);for(x=0;x<=v;++x){f[x]=[];var b=0;for(r(p[x].slice(0,m).trim(),f,x,b,c),b=1;b<=(p[x].length-m)/10+1;++b)r(p[x].slice(m+(b-1)*10,m+b*10).trim(),f,x,b,c)}return c.sheetRows&&(f=f.slice(0,c.sheetRows)),f}var t={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function n(u){for(var d={},c=!1,f=0,p=0;f<u.length;++f)(p=u.charCodeAt(f))==34?c=!c:!c&&p in t&&(d[p]=(d[p]||0)+1);p=[];for(f in d)Object.prototype.hasOwnProperty.call(d,f)&&p.push([d[f],f]);if(!p.length){d=i;for(f in d)Object.prototype.hasOwnProperty.call(d,f)&&p.push([d[f],f])}return p.sort(function(v,m){return v[0]-m[0]||i[v[1]]-i[m[1]]}),t[p.pop()[1]]||44}function s(u,d){var c=d||{},f="",p={};c.dense&&(p["!data"]=[]);var v={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(f=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(f=u.charAt(4),u=u.slice(6)):f=n(u.slice(0,1024)):c&&c.FS?f=c.FS:f=n(u.slice(0,1024));var m=0,g=0,x=0,b=0,F=0,A=f.charCodeAt(0),_=!1,y=0,R=u.charCodeAt(0),M=c.dateNF!=null?ax(c.dateNF):null;function I(){var P=u.slice(b,F);P.slice(-1)=="\r"&&(P=P.slice(0,-1));var N={};if(P.charAt(0)=='"'&&P.charAt(P.length-1)=='"'&&(P=P.slice(1,-1).replace(/""/g,'"')),c.cellText!==!1&&(N.w=P),P.length===0)N.t="z";else if(c.raw)N.t="s",N.v=P;else if(P.trim().length===0)N.t="s",N.v=P;else if(P.charCodeAt(0)==61)P.charCodeAt(1)==34&&P.charCodeAt(P.length-1)==34?(N.t="s",N.v=P.slice(2,-1).replace(/""/g,'"')):iC(P)?(N.t="s",N.f=P.slice(1),N.v=P):(N.t="s",N.v=P);else if(P=="TRUE")N.t="b",N.v=!0;else if(P=="FALSE")N.t="b",N.v=!1;else if(!isNaN(x=Ji(P)))N.t="n",N.v=x;else if(!isNaN((x=da(P)).getDate())||M&&P.match(M)){if(N.z=c.dateNF||rt[14],M&&P.match(M)){var ne=ox(P,c.dateNF,P.match(M)||[]);x=Zt(ne),c&&c.UTC===!1&&(x=Sn(x))}else c&&c.UTC===!1?x=Sn(x):c.cellText!==!1&&c.dateNF&&(N.w=tr(N.z,x));c.cellDates?(N.t="d",N.v=x):(N.t="n",N.v=Mt(x)),c.cellNF||delete N.z}else P.charCodeAt(0)==35&&Li[P]!=null?(N.t="e",N.w=P,N.v=Li[P]):(N.t="s",N.v=P);if(N.t=="z"||(c.dense?(p["!data"][m]||(p["!data"][m]=[]),p["!data"][m][g]=N):p[ct({c:g,r:m})]=N),b=F+1,R=u.charCodeAt(b),v.e.c<g&&(v.e.c=g),v.e.r<m&&(v.e.r=m),y==A)++g;else if(g=0,++m,c.sheetRows&&c.sheetRows<=m)return!0}e:for(;F<u.length;++F)switch(y=u.charCodeAt(F)){case 34:R===34&&(_=!_);break;case 13:if(_)break;u.charCodeAt(F+1)==10&&++F;case A:case 10:if(!_&&I())break e;break}return F-b>0&&I(),p["!ref"]=yt(v),p}function a(u,d){return!(d&&d.PRN)||d.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,d):Mn(e(u,d),d)}function o(u,d){var c="",f=d.type=="string"?[0,0,0,0]:RS(u,d);switch(d.type){case"base64":c=wr(u);break;case"binary":c=u;break;case"buffer":d.codepage==65001?c=u.toString("utf8"):(d.codepage,c=Ve&&Buffer.isBuffer(u)?u.toString("binary"):Ur(u));break;case"array":c=kl(u);break;case"string":c=u;break;default:throw new Error("Unrecognized type "+d.type)}return f[0]==239&&f[1]==187&&f[2]==191?c=pn(c.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?c=pn(c):d.type=="binary",c.slice(0,19)=="socialcalc:version:"?Dd.to_sheet(d.type=="string"?c:pn(c),d):a(c,d)}function l(u,d){return Fn(o(u,d),d)}function h(u){var d=[];if(!u["!ref"])return"";for(var c=nt(u["!ref"]),f,p=u["!data"]!=null,v=c.s.r;v<=c.e.r;++v){for(var m=[],g=c.s.c;g<=c.e.c;++g){var x=ct({r:v,c:g});if(f=p?(u["!data"][v]||[])[g]:u[x],!f||f.v==null){m.push("          ");continue}for(var b=(f.w||(ir(f),f.w)||"").slice(0,10);b.length<10;)b+=" ";m.push(b+(g===0?" ":""))}d.push(m.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:h}}(),fu=function(){function r(k,U,L){if(k){Xt(k,k.l||0);for(var O=L.Enum||Fe;k.l<k.length;){var K=k.read_shift(2),de=O[K]||O[65535],oe=k.read_shift(2),Ee=k.l+oe,le=de.f&&de.f(k,oe,L);if(k.l=Ee,U(le,de,K))return}}}function e(k,U){switch(U.type){case"base64":return i(ii(wr(k)),U);case"binary":return i(ii(k),U);case"buffer":case"array":return i(k,U)}throw"Unsupported type "+U.type}var t=["mmmm","dd-mmm-yyyy","dd-mmm","mmm-yyyy","@","mm/dd","hh:mm:ss AM/PM","hh:mm AM/PM","mm/dd/yyyy","mm/dd","hh:mm:ss","hh:mm"];function i(k,U){if(!k)return k;var L=U||{},O={},K="Sheet1",de="",oe=0,Ee={},le=[],Me=[],xe=[];L.dense&&(xe=O["!data"]=[]);var Le={s:{r:0,c:0},e:{r:0,c:0}},it=L.sheetRows||0,pt={};if(k[4]==81&&k[5]==80&&k[6]==87)return Oe(k,U);if(k[2]==0&&(k[3]==8||k[3]==9)&&k.length>=16&&k[14]==5&&k[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(k[2]==2)L.Enum=Fe,r(k,function(ae,nr,Ei){switch(Ei){case 0:L.vers=ae,ae>=4096&&(L.qpro=!0);break;case 255:L.vers=ae,L.works=!0;break;case 6:Le=ae;break;case 204:ae&&(de=ae);break;case 222:de=ae;break;case 15:case 51:(!L.qpro&&!L.works||Ei==51)&&ae[1].v.charCodeAt(0)<48&&(ae[1].v=ae[1].v.slice(1)),(L.works||L.works2)&&(ae[1].v=ae[1].v.replace(/\r\n/g,`
`));case 13:case 14:case 16:(ae[2]&112)==112&&(ae[2]&15)>1&&(ae[2]&15)<15&&(ae[1].z=L.dateNF||t[(ae[2]&15)-1]||rt[14],L.cellDates&&(ae[1].v=fn(ae[1].v),ae[1].t=typeof ae[1].v=="number"?"n":"d")),L.qpro&&ae[3]>oe&&(O["!ref"]=yt(Le),Ee[K]=O,le.push(K),O={},L.dense&&(xe=O["!data"]=[]),Le={s:{r:0,c:0},e:{r:0,c:0}},oe=ae[3],K=de||"Sheet"+(oe+1),de="");var dt=L.dense?(xe[ae[0].r]||[])[ae[0].c]:O[ct(ae[0])];if(dt){dt.t=ae[1].t,dt.v=ae[1].v,ae[1].z!=null&&(dt.z=ae[1].z),ae[1].f!=null&&(dt.f=ae[1].f),pt=dt;break}L.dense?(xe[ae[0].r]||(xe[ae[0].r]=[]),xe[ae[0].r][ae[0].c]=ae[1]):O[ct(ae[0])]=ae[1],pt=ae[1];break;case 21509:L.works2=!0;break;case 21506:ae==5281&&(pt.z="hh:mm:ss",L.cellDates&&pt.t=="n"&&(pt.v=fn(pt.v),pt.t=typeof pt.v=="number"?"n":"d"));break}},L);else if(k[2]==26||k[2]==14)L.Enum=Ae,k[2]==14&&(L.qpro=!0,k.l=0),r(k,function(ae,nr,Ei){switch(Ei){case 204:K=ae;break;case 22:ae[1].v.charCodeAt(0)<48&&(ae[1].v=ae[1].v.slice(1)),ae[1].v=ae[1].v.replace(/\x0F./g,function(dt){return String.fromCharCode(dt.charCodeAt(1)-32)}).replace(/\r\n/g,`
`);case 23:case 24:case 25:case 37:case 39:case 40:if(ae[3]>oe&&(O["!ref"]=yt(Le),Ee[K]=O,le.push(K),O={},L.dense&&(xe=O["!data"]=[]),Le={s:{r:0,c:0},e:{r:0,c:0}},oe=ae[3],K="Sheet"+(oe+1)),it>0&&ae[0].r>=it)break;L.dense?(xe[ae[0].r]||(xe[ae[0].r]=[]),xe[ae[0].r][ae[0].c]=ae[1]):O[ct(ae[0])]=ae[1],Le.e.c<ae[0].c&&(Le.e.c=ae[0].c),Le.e.r<ae[0].r&&(Le.e.r=ae[0].r);break;case 27:ae[14e3]&&(Me[ae[14e3][0]]=ae[14e3][1]);break;case 1537:Me[ae[0]]=ae[1],ae[0]==oe&&(K=ae[1]);break}},L);else throw new Error("Unrecognized LOTUS BOF "+k[2]);if(O["!ref"]=yt(Le),Ee[de||K]=O,le.push(de||K),!Me.length)return{SheetNames:le,Sheets:Ee};for(var _t={},pe=[],Ge=0;Ge<Me.length;++Ge)Ee[le[Ge]]?(pe.push(Me[Ge]||le[Ge]),_t[Me[Ge]]=Ee[Me[Ge]]||Ee[le[Ge]]):(pe.push(Me[Ge]),_t[Me[Ge]]={"!ref":"A1"});return{SheetNames:pe,Sheets:_t}}function n(k,U){var L=U||{};if(+L.codepage>=0&&rs(+L.codepage),L.type=="string")throw new Error("Cannot write WK1 to JS string");var O=zt();if(!k["!ref"])throw new Error("Cannot export empty sheet to WK1");var K=nt(k["!ref"]),de=k["!data"]!=null,oe=[];Q(O,0,a(1030)),Q(O,6,h(K));for(var Ee=Math.min(K.e.r,8191),le=K.s.c;le<=K.e.c;++le)oe[le]=$e(le);for(var Me=K.s.r;Me<=Ee;++Me){var xe=qe(Me);for(le=K.s.c;le<=K.e.c;++le){var Le=de?(k["!data"][Me]||[])[le]:k[oe[le]+xe];if(!(!Le||Le.t=="z"))switch(Le.t){case"n":(Le.v|0)==Le.v&&Le.v>=-32768&&Le.v<=32767?Q(O,13,m(Me,le,Le)):Q(O,14,x(Me,le,Le));break;case"d":var it=Mt(Le.v);(it|0)==it&&it>=-32768&&it<=32767?Q(O,13,m(Me,le,{v:it,z:Le.z||rt[14]})):Q(O,14,x(Me,le,{v:it,z:Le.z||rt[14]}));break;default:var pt=ir(Le);Q(O,15,f(Me,le,pt.slice(0,239)))}}}return Q(O,1),O.end()}function s(k,U){var L=U||{};if(+L.codepage>=0&&rs(+L.codepage),L.type=="string")throw new Error("Cannot write WK3 to JS string");var O=zt();Q(O,0,o(k));for(var K=0,de=0;K<k.SheetNames.length;++K)(k.Sheets[k.SheetNames[K]]||{})["!ref"]&&Q(O,27,De(k.SheetNames[K],de++));var oe=0;for(K=0;K<k.SheetNames.length;++K){var Ee=k.Sheets[k.SheetNames[K]];if(!(!Ee||!Ee["!ref"])){for(var le=nt(Ee["!ref"]),Me=Ee["!data"]!=null,xe=[],Le=Math.min(le.e.r,8191),it=le.s.r;it<=Le;++it)for(var pt=qe(it),_t=le.s.c;_t<=le.e.c;++_t){it===le.s.r&&(xe[_t]=$e(_t));var pe=xe[_t]+pt,Ge=Me?(Ee["!data"][it]||[])[_t]:Ee[pe];if(!(!Ge||Ge.t=="z"))if(Ge.t=="n")Q(O,23,ne(it,_t,oe,Ge.v));else{var ae=ir(Ge);Q(O,22,I(it,_t,oe,ae.slice(0,239)))}}++oe}}return Q(O,1),O.end()}function a(k){var U=H(2);return U.write_shift(2,k),U}function o(k){var U=H(26);U.write_shift(2,4096),U.write_shift(2,4),U.write_shift(4,0);for(var L=0,O=0,K=0,de=0;de<k.SheetNames.length;++de){var oe=k.SheetNames[de],Ee=k.Sheets[oe];if(!(!Ee||!Ee["!ref"])){++K;var le=Ft(Ee["!ref"]);L<le.e.r&&(L=le.e.r),O<le.e.c&&(O=le.e.c)}}return L>8191&&(L=8191),U.write_shift(2,L),U.write_shift(1,K),U.write_shift(1,O),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(1,1),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(4,0),U}function l(k,U,L){var O={s:{c:0,r:0},e:{c:0,r:0}};return U==8&&L.qpro?(O.s.c=k.read_shift(1),k.l++,O.s.r=k.read_shift(2),O.e.c=k.read_shift(1),k.l++,O.e.r=k.read_shift(2),O):(O.s.c=k.read_shift(2),O.s.r=k.read_shift(2),U==12&&L.qpro&&(k.l+=2),O.e.c=k.read_shift(2),O.e.r=k.read_shift(2),U==12&&L.qpro&&(k.l+=2),O.s.c==65535&&(O.s.c=O.e.c=O.s.r=O.e.r=0),O)}function h(k){var U=H(8);return U.write_shift(2,k.s.c),U.write_shift(2,k.s.r),U.write_shift(2,k.e.c),U.write_shift(2,k.e.r),U}function u(k,U,L){var O=[{c:0,r:0},{t:"n",v:0},0,0];return L.qpro&&L.vers!=20768?(O[0].c=k.read_shift(1),O[3]=k.read_shift(1),O[0].r=k.read_shift(2),k.l+=2):L.works?(O[0].c=k.read_shift(2),O[0].r=k.read_shift(2),O[2]=k.read_shift(2)):(O[2]=k.read_shift(1),O[0].c=k.read_shift(2),O[0].r=k.read_shift(2)),O}function d(k){return k.z&&Gr(k.z)?240|(t.indexOf(k.z)+1||2):255}function c(k,U,L){var O=k.l+U,K=u(k,U,L);if(K[1].t="s",(L.vers&65534)==20768){k.l++;var de=k.read_shift(1);return K[1].v=k.read_shift(de,"utf8"),K}return L.qpro&&k.l++,K[1].v=k.read_shift(O-k.l,"cstr"),K}function f(k,U,L){var O=H(7+L.length);O.write_shift(1,255),O.write_shift(2,U),O.write_shift(2,k),O.write_shift(1,39);for(var K=0;K<O.length;++K){var de=L.charCodeAt(K);O.write_shift(1,de>=128?95:de)}return O.write_shift(1,0),O}function p(k,U,L){var O=k.l+U,K=u(k,U,L);if(K[1].t="s",L.vers==20768){var de=k.read_shift(1);return K[1].v=k.read_shift(de,"utf8"),K}return K[1].v=k.read_shift(O-k.l,"cstr"),K}function v(k,U,L){var O=u(k,U,L);return O[1].v=k.read_shift(2,"i"),O}function m(k,U,L){var O=H(7);return O.write_shift(1,d(L)),O.write_shift(2,U),O.write_shift(2,k),O.write_shift(2,L.v,"i"),O}function g(k,U,L){var O=u(k,U,L);return O[1].v=k.read_shift(8,"f"),O}function x(k,U,L){var O=H(13);return O.write_shift(1,d(L)),O.write_shift(2,U),O.write_shift(2,k),O.write_shift(8,L.v,"f"),O}function b(k,U,L){var O=k.l+U,K=u(k,U,L);if(K[1].v=k.read_shift(8,"f"),L.qpro)k.l=O;else{var de=k.read_shift(2);y(k.slice(k.l,k.l+de),K),k.l+=de}return K}function F(k,U,L){var O=U&32768;return U&=-32769,U=(O?k:0)+(U>=8192?U-16384:U),(O?"":"$")+(L?$e(U):qe(U))}var A={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],54:["DATE",3],63:["ROUND",2],64:["TIME",3],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function y(k,U){Xt(k,0);for(var L=[],O=0,K="",de="",oe="",Ee="";k.l<k.length;){var le=k[k.l++];switch(le){case 0:L.push(k.read_shift(8,"f"));break;case 1:de=F(U[0].c,k.read_shift(2),!0),K=F(U[0].r,k.read_shift(2),!1),L.push(de+K);break;case 2:{var Me=F(U[0].c,k.read_shift(2),!0),xe=F(U[0].r,k.read_shift(2),!1);de=F(U[0].c,k.read_shift(2),!0),K=F(U[0].r,k.read_shift(2),!1),L.push(Me+xe+":"+de+K)}break;case 3:if(k.l<k.length){console.error("WK1 premature formula end");return}break;case 4:L.push("("+L.pop()+")");break;case 5:L.push(k.read_shift(2));break;case 6:{for(var Le="";le=k[k.l++];)Le+=String.fromCharCode(le);L.push('"'+Le.replace(/"/g,'""')+'"')}break;case 8:L.push("-"+L.pop());break;case 23:L.push("+"+L.pop());break;case 22:L.push("NOT("+L.pop()+")");break;case 20:case 21:Ee=L.pop(),oe=L.pop(),L.push(["AND","OR"][le-20]+"("+oe+","+Ee+")");break;default:if(le<32&&_[le])Ee=L.pop(),oe=L.pop(),L.push(oe+_[le]+Ee);else if(A[le]){if(O=A[le][1],O==69&&(O=k[k.l++]),O>L.length){console.error("WK1 bad formula parse 0x"+le.toString(16)+":|"+L.join("|")+"|");return}var it=L.slice(-O);L.length-=O,L.push(A[le][0]+"("+it.join(",")+")")}else return le<=7?console.error("WK1 invalid opcode "+le.toString(16)):le<=24?console.error("WK1 unsupported op "+le.toString(16)):le<=30?console.error("WK1 invalid opcode "+le.toString(16)):le<=115?console.error("WK1 unsupported function opcode "+le.toString(16)):console.error("WK1 unrecognized opcode "+le.toString(16))}}L.length==1?U[1].f=""+L[0]:console.error("WK1 bad formula parse |"+L.join("|")+"|")}function R(k){var U=[{c:0,r:0},{t:"n",v:0},0];return U[0].r=k.read_shift(2),U[3]=k[k.l++],U[0].c=k[k.l++],U}function M(k,U){var L=R(k);return L[1].t="s",L[1].v=k.read_shift(U-4,"cstr"),L}function I(k,U,L,O){var K=H(6+O.length);K.write_shift(2,k),K.write_shift(1,L),K.write_shift(1,U),K.write_shift(1,39);for(var de=0;de<O.length;++de){var oe=O.charCodeAt(de);K.write_shift(1,oe>=128?95:oe)}return K.write_shift(1,0),K}function P(k,U){var L=R(k);L[1].v=k.read_shift(2);var O=L[1].v>>1;if(L[1].v&1)switch(O&7){case 0:O=(O>>3)*5e3;break;case 1:O=(O>>3)*500;break;case 2:O=(O>>3)/20;break;case 3:O=(O>>3)/200;break;case 4:O=(O>>3)/2e3;break;case 5:O=(O>>3)/2e4;break;case 6:O=(O>>3)/16;break;case 7:O=(O>>3)/64;break}return L[1].v=O,L}function N(k,U){var L=R(k),O=k.read_shift(4),K=k.read_shift(4),de=k.read_shift(2);if(de==65535)return O===0&&K===3221225472?(L[1].t="e",L[1].v=15):O===0&&K===3489660928?(L[1].t="e",L[1].v=42):L[1].v=0,L;var oe=de&32768;return de=(de&32767)-16446,L[1].v=(1-oe*2)*(K*Math.pow(2,de+32)+O*Math.pow(2,de)),L}function ne(k,U,L,O){var K=H(14);if(K.write_shift(2,k),K.write_shift(1,L),K.write_shift(1,U),O==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var de=0,oe=0,Ee=0,le=0;return O<0&&(de=1,O=-O),oe=Math.log2(O)|0,O/=Math.pow(2,oe-31),le=O>>>0,(le&2147483648)==0&&(O/=2,++oe,le=O>>>0),O-=le,le|=2147483648,le>>>=0,O*=Math.pow(2,32),Ee=O>>>0,K.write_shift(4,Ee),K.write_shift(4,le),oe+=16383+(de?32768:0),K.write_shift(2,oe),K}function he(k,U){var L=N(k);return k.l+=U-14,L}function se(k,U){var L=R(k),O=k.read_shift(4);return L[1].v=O>>6,L}function fe(k,U){var L=R(k),O=k.read_shift(8,"f");return L[1].v=O,L}function ee(k,U){var L=fe(k);return k.l+=U-12,L}function ge(k,U){return k[k.l+U-1]==0?k.read_shift(U,"cstr"):""}function _e(k,U){var L=k[k.l++];L>U-1&&(L=U-1);for(var O="";O.length<L;)O+=String.fromCharCode(k[k.l++]);return O}function Je(k,U,L){if(!(!L.qpro||U<21)){var O=k.read_shift(1);k.l+=17,k.l+=1,k.l+=2;var K=k.read_shift(U-21,"cstr");return[O,K]}}function tt(k,U){for(var L={},O=k.l+U;k.l<O;){var K=k.read_shift(2);if(K==14e3){for(L[K]=[0,""],L[K][0]=k.read_shift(2);k[k.l];)L[K][1]+=String.fromCharCode(k[k.l]),k.l++;k.l++}}return L}function De(k,U){var L=H(5+k.length);L.write_shift(2,14e3),L.write_shift(2,U);for(var O=0;O<k.length;++O){var K=k.charCodeAt(O);L[L.l++]=K>127?95:K}return L[L.l++]=0,L}var Fe={0:{n:"BOF",f:Ys},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:c},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ge},222:{n:"SHEETNAMELP",f:_e},255:{n:"BOF",f:Ys},21506:{n:"WKSNF",f:Ys},65535:{n:""}},Ae={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:M},23:{n:"NUMBER17",f:N},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:he},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:tt},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:se},38:{n:"??"},39:{n:"NUMBER27",f:fe},40:{n:"FORMULA28",f:ee},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ge},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Je},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},Ne={5:"dd-mmm-yy",6:"dd-mmm",7:"mmm-yy",8:"mm/dd/yy",10:"hh:mm:ss AM/PM",11:"hh:mm AM/PM",14:"dd-mmm-yyyy",15:"mmm-yyyy",34:"0.00",50:"0.00;[Red]0.00",66:"0.00;(0.00)",82:"0.00;[Red](0.00)",162:'"$"#,##0.00;\\("$"#,##0.00\\)',288:"0%",304:"0E+00",320:"# ?/?"};function He(k){var U=k.read_shift(2),L=k.read_shift(1);if(L!=0)throw"unsupported QPW string type "+L.toString(16);return k.read_shift(U,"sbcs-cont")}function Oe(k,U){Xt(k,0);var L=U||{},O={};L.dense&&(O["!data"]=[]);var K=[],de="",oe={s:{r:-1,c:-1},e:{r:-1,c:-1}},Ee=0,le=0,Me=0,xe=0,Le={SheetNames:[],Sheets:{}},it=[];e:for(;k.l<k.length;){var pt=k.read_shift(2),_t=k.read_shift(2),pe=k.slice(k.l,k.l+_t);switch(Xt(pe,0),pt){case 1:if(pe.read_shift(4)!=962023505)throw"Bad QPW9 BOF!";break;case 2:break e;case 8:break;case 10:for(var Ge=pe.read_shift(4),ae=(pe.length-pe.l)/Ge|0,nr=0;nr<Ge;++nr){var Ei=pe.l+ae,dt={};pe.l+=2,dt.numFmtId=pe.read_shift(2),Ne[dt.numFmtId]&&(dt.z=Ne[dt.numFmtId]),pe.l=Ei,it.push(dt)}break;case 1025:break;case 1026:break;case 1031:for(pe.l+=12;pe.l<pe.length;)Ee=pe.read_shift(2),le=pe.read_shift(1),K.push(pe.read_shift(Ee,"cstr"));break;case 1032:break;case 1537:{var Xa=pe.read_shift(2);O={},L.dense&&(O["!data"]=[]),oe.s.c=pe.read_shift(2),oe.e.c=pe.read_shift(2),oe.s.r=pe.read_shift(4),oe.e.r=pe.read_shift(4),pe.l+=4,pe.l+2<pe.length&&(Ee=pe.read_shift(2),le=pe.read_shift(1),de=Ee==0?"":pe.read_shift(Ee,"cstr")),de||(de=$e(Xa))}break;case 1538:{if(oe.s.c>255||oe.s.r>999999)break;oe.e.c<oe.s.c&&(oe.e.c=oe.s.c),oe.e.r<oe.s.r&&(oe.e.r=oe.s.r),O["!ref"]=yt(oe),Yl(Le,O,de)}break;case 2561:Me=pe.read_shift(2),oe.e.c<Me&&(oe.e.c=Me),oe.s.c>Me&&(oe.s.c=Me),xe=pe.read_shift(4),oe.s.r>xe&&(oe.s.r=xe),xe=pe.read_shift(4),oe.e.r<xe&&(oe.e.r=xe);break;case 3073:{xe=pe.read_shift(4),Ee=pe.read_shift(4),oe.s.r>xe&&(oe.s.r=xe),oe.e.r<xe+Ee-1&&(oe.e.r=xe+Ee-1);for(var Ln=$e(Me);pe.l<pe.length;){var ze={t:"z"},Ut=pe.read_shift(1),Cr=-1;Ut&128&&(Cr=pe.read_shift(2));var xs=Ut&64?pe.read_shift(2)-1:0;switch(Ut&31){case 0:break;case 1:break;case 2:ze={t:"n",v:pe.read_shift(2)};break;case 3:ze={t:"n",v:pe.read_shift(2,"i")};break;case 4:ze={t:"n",v:Bl(pe)};break;case 5:ze={t:"n",v:pe.read_shift(8,"f")};break;case 7:ze={t:"s",v:K[le=pe.read_shift(4)-1]};break;case 8:ze={t:"n",v:pe.read_shift(8,"f")},pe.l+=2,pe.l+=4,isNaN(ze.v)&&(ze={t:"e",v:15});break;default:throw"Unrecognized QPW cell type "+(Ut&31)}Cr!=-1&&(it[Cr-1]||{}).z&&(ze.z=it[Cr-1].z);var zi=0;if(Ut&32)switch(Ut&31){case 2:zi=pe.read_shift(2);break;case 3:zi=pe.read_shift(2,"i");break;case 7:zi=pe.read_shift(2);break;default:throw"Unsupported delta for QPW cell type "+(Ut&31)}if(!(!L.sheetStubs&&ze.t=="z")){var _r=Vt(ze);ze.t=="n"&&ze.z&&Gr(ze.z)&&L.cellDates&&(_r.v=fn(ze.v),_r.t=typeof _r.v=="number"?"n":"d"),O["!data"]!=null?(O["!data"][xe]||(O["!data"][xe]=[]),O["!data"][xe][Me]=_r):O[Ln+qe(xe)]=_r}for(++xe,--Ee;xs-- >0&&Ee>=0;){if(Ut&32)switch(Ut&31){case 2:ze={t:"n",v:ze.v+zi&65535};break;case 3:ze={t:"n",v:ze.v+zi&65535},ze.v>32767&&(ze.v-=65536);break;case 7:ze={t:"s",v:K[le=le+zi>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(Ut&31)}else switch(Ut&31){case 1:ze={t:"z"};break;case 2:ze={t:"n",v:pe.read_shift(2)};break;case 7:ze={t:"s",v:K[le=pe.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(Ut&31)}!L.sheetStubs&&ze.t=="z"||(O["!data"]!=null?(O["!data"][xe]||(O["!data"][xe]=[]),O["!data"][xe][Me]=ze):O[Ln+qe(xe)]=ze),++xe,--Ee}}}break;case 3074:{Me=pe.read_shift(2),xe=pe.read_shift(4);var ys=He(pe);O["!data"]!=null?(O["!data"][xe]||(O["!data"][xe]=[]),O["!data"][xe][Me]={t:"s",v:ys}):O[$e(Me)+qe(xe)]={t:"s",v:ys}}break}k.l+=_t}return Le}return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}}(),rE=/^\s|\s$|[\t\n\r]/;function nE(r,e){if(!e.bookSST)return"";var t=[Et];t[t.length]=Z("sst",null,{xmlns:Rn[0],count:r.Count,uniqueCount:r.Unique});for(var i=0;i!=r.length;++i)if(r[i]!=null){var n=r[i],s="<si>";n.r?s+=n.r:(s+="<t",n.t||(n.t=""),typeof n.t!="string"&&(n.t=String(n.t)),n.t.match(rE)&&(s+=' xml:space="preserve"'),s+=">"+Se(n.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function sE(r){return[r.read_shift(4),r.read_shift(4)]}function aE(r,e){return e||(e=H(8)),e.write_shift(4,r.Count),e.write_shift(4,r.Unique),e}var oE=Xx;function lE(r){var e=zt();X(e,159,aE(r));for(var t=0;t<r.length;++t)X(e,19,oE(r[t]));return X(e,160),e.end()}function hE(r){for(var e=[],t=r.split(""),i=0;i<t.length;++i)e[i]=t[i].charCodeAt(0);return e}function kd(r){var e=0,t,i=hE(r),n=i.length+1,s,a,o,l,h;for(t=Vr(n),t[0]=i.length,s=1;s!=n;++s)t[s]=i[s-1];for(s=n-1;s>=0;--s)a=t[s],o=(e&16384)===0?0:1,l=e<<1&32767,h=o|l,e=h^a;return e^52811}function uE(r,e){var t=["{\\rtf1\\ansi"];if(!r["!ref"])return t[0]+"}";for(var i=nt(r["!ref"]),n,s=r["!data"]!=null,a=[],o=i.s.r;o<=i.e.r;++o){t.push("\\trowd\\trautofit1");for(var l=i.s.c;l<=i.e.c;++l)t.push("\\cellx"+(l+1));for(t.push("\\pard\\intbl"),s&&(a=r["!data"][o]||[]),l=i.s.c;l<=i.e.c;++l){var h=ct({r:o,c:l});if(n=s?a[l]:r[h],!n||n.v==null&&(!n.f||n.F)){t.push(" \\cell");continue}t.push(" "+(n.w||(ir(n),n.w)||"").replace(/[\r\n]/g,"\\par ")),t.push("\\cell")}t.push("\\pard\\intbl\\row")}return t.join("")+"}"}function pu(r){for(var e=0,t=1;e!=3;++e)t=t*256+(r[e]>255?255:r[e]<0?0:r[e]);return t.toString(16).toUpperCase().slice(1)}var cE=6,Zi=cE;function ga(r){return Math.floor((r+Math.round(128/Zi)/256)*Zi)}function va(r){return Math.floor((r-5)/Zi*100+.5)/100}function al(r){return Math.round((r*Zi+5)/Zi*256)/256}function zl(r){r.width?(r.wpx=ga(r.width),r.wch=va(r.wpx),r.MDW=Zi):r.wpx?(r.wch=va(r.wpx),r.width=al(r.wch),r.MDW=Zi):typeof r.wch=="number"&&(r.width=al(r.wch),r.wpx=ga(r.width),r.MDW=Zi),r.customWidth&&delete r.customWidth}var dE=96,Rd=dE;function ba(r){return r*96/Rd}function Fd(r){return r*Rd/96}function fE(r){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var i=t[0];i<=t[1];++i)r[i]!=null&&(e[e.length]=Z("numFmt",null,{numFmtId:i,formatCode:Se(r[i])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Z("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function pE(r){var e=[];return e[e.length]=Z("cellXfs",null),r.forEach(function(t){e[e.length]=Z("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Z("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function mE(r,e){var t=[Et,Z("styleSheet",null,{xmlns:Rn[0],"xmlns:vt":Tt.vt})],i;return r.SSF&&(i=fE(r.SSF))!=null&&(t[t.length]=i),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=pE(e.cellXfs))&&(t[t.length]=i),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function gE(r,e){var t=r.read_shift(2),i=Wt(r);return[t,i]}function vE(r,e,t){t||(t=H(6+4*e.length)),t.write_shift(2,r),Ct(e,t);var i=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),i}function bE(r,e,t){var i={};i.sz=r.read_shift(2)/20;var n=ey(r);n.fItalic&&(i.italic=1),n.fCondense&&(i.condense=1),n.fExtend&&(i.extend=1),n.fShadow&&(i.shadow=1),n.fOutline&&(i.outline=1),n.fStrikeout&&(i.strike=1);var s=r.read_shift(2);switch(s===700&&(i.bold=1),r.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var a=r.read_shift(1);a!=0&&(i.underline=a);var o=r.read_shift(1);o>0&&(i.family=o);var l=r.read_shift(1);switch(l>0&&(i.charset=l),r.l++,i.color=Zx(r),r.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=Wt(r),i}function wE(r,e){e||(e=H(25+4*32)),e.write_shift(2,r.sz*20),ty(r,e),e.write_shift(2,r.bold?700:400);var t=0;r.vertAlign=="superscript"?t=1:r.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,r.underline||0),e.write_shift(1,r.family||0),e.write_shift(1,r.charset||0),e.write_shift(1,0),pa(r.color,e);var i=0;return i=2,e.write_shift(1,i),Ct(r.name,e),e.length>e.l?e.slice(0,e.l):e}var xE=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],po,yE=Ii;function mu(r,e){e||(e=H(4*3+8*7+16*1)),po||(po=Dl(xE));var t=po[r.patternType];t==null&&(t=40),e.write_shift(4,t);var i=0;if(t!=40)for(pa({auto:1},e),pa({auto:1},e);i<12;++i)e.write_shift(4,0);else{for(;i<4;++i)e.write_shift(4,0);for(;i<12;++i)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function EE(r,e){var t=r.l+e,i=r.read_shift(2),n=r.read_shift(2);return r.l=t,{ixfe:i,numFmtId:n}}function Md(r,e,t){t||(t=H(16)),t.write_shift(2,e||0),t.write_shift(2,r.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var i=0;return t.write_shift(1,i),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Wn(r,e){return e||(e=H(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var CE=Ii;function _E(r,e){return e||(e=H(51)),e.write_shift(1,0),Wn(null,e),Wn(null,e),Wn(null,e),Wn(null,e),Wn(null,e),e.length>e.l?e.slice(0,e.l):e}function TE(r,e){return e||(e=H(12+4*10)),e.write_shift(4,r.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),ls(r.name||"",e),e.length>e.l?e.slice(0,e.l):e}function SE(r,e,t){var i=H(2052);return i.write_shift(4,r),ls(e,i),ls(t,i),i.length>i.l?i.slice(0,i.l):i}function DE(r,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var n=i[0];n<=i[1];++n)e[n]!=null&&++t}),t!=0&&(X(r,615,xi(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var n=i[0];n<=i[1];++n)e[n]!=null&&X(r,44,vE(n,e[n]))}),X(r,616))}}function kE(r){var e=1;X(r,611,xi(e)),X(r,43,wE({sz:12,color:{theme:1},name:"Calibri",family:2})),X(r,612)}function RE(r){var e=2;X(r,603,xi(e)),X(r,45,mu({patternType:"none"})),X(r,45,mu({patternType:"gray125"})),X(r,604)}function FE(r){var e=1;X(r,613,xi(e)),X(r,46,_E()),X(r,614)}function ME(r){var e=1;X(r,626,xi(e)),X(r,47,Md({numFmtId:0},65535)),X(r,627)}function AE(r,e){X(r,617,xi(e.length)),e.forEach(function(t){X(r,47,Md(t,0))}),X(r,618)}function OE(r){var e=1;X(r,619,xi(e)),X(r,48,TE({xfId:0,name:"Normal"})),X(r,620)}function LE(r){var e=0;X(r,505,xi(e)),X(r,506)}function PE(r){var e=0;X(r,508,SE(e,"TableStyleMedium9","PivotStyleMedium4")),X(r,509)}function NE(r,e){var t=zt();return X(t,278),DE(t,r.SSF),kE(t),RE(t),FE(t),ME(t),AE(t,e.cellXfs),OE(t),LE(t),PE(t),X(t,279),t.end()}function Ad(r,e){if(e&&e.themeXLSX)return e.themeXLSX;if(r&&typeof r.raw=="string")return r.raw;var t=[Et];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function IE(r,e){return{flags:r.read_shift(4),version:r.read_shift(4),name:Wt(r)}}function BE(r){var e=H(12+2*r.name.length);return e.write_shift(4,r.flags),e.write_shift(4,r.version),Ct(r.name,e),e.slice(0,e.l)}function HE(r){for(var e=[],t=r.read_shift(4);t-- >0;)e.push([r.read_shift(4),r.read_shift(4)]);return e}function zE(r){var e=H(4+8*r.length);e.write_shift(4,r.length);for(var t=0;t<r.length;++t)e.write_shift(4,r[t][0]),e.write_shift(4,r[t][1]);return e}function WE(r,e){var t=H(8+2*e.length);return t.write_shift(4,r),Ct(e,t),t.slice(0,t.l)}function VE(r){return r.l+=4,r.read_shift(4)!=0}function UE(r,e){var t=H(8);return t.write_shift(4,r),t.write_shift(4,1),t}function GE(){var r=zt();return X(r,332),X(r,334,xi(1)),X(r,335,BE({name:"XLDAPR",version:12e4,flags:3496657072})),X(r,336),X(r,339,WE(1,"XLDAPR")),X(r,52),X(r,35,xi(514)),X(r,4096,xi(0)),X(r,4097,ui(1)),X(r,36),X(r,53),X(r,340),X(r,337,UE(1)),X(r,51,zE([[1,0]])),X(r,338),X(r,333),r.end()}function YE(){var r=[Et];return r.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),r.join("")}function jE(r){var e={};e.i=r.read_shift(4);var t={};t.r=r.read_shift(4),t.c=r.read_shift(4),e.r=ct(t);var i=r.read_shift(1);return i&2&&(e.l="1"),i&8&&(e.a="1"),e}function Od(r,e,t){var i=[21600,21600],n=["m0,0l0",i[1],i[0],i[1],i[0],"0xe"].join(","),s=[Z("xml",null,{"xmlns:v":ri.v,"xmlns:o":ri.o,"xmlns:x":ri.x,"xmlns:mv":ri.mv}).replace(/\/>/,">"),Z("o:shapelayout",Z("o:idmap",null,{"v:ext":"edit",data:r}),{"v:ext":"edit"})],a=65536*r,o=e||[];return o.length>0&&s.push(Z("v:shapetype",[Z("v:stroke",null,{joinstyle:"miter"}),Z("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202",coordsize:i.join(","),"o:spt":202,path:n})),o.forEach(function(l){++a,s.push(XE(l,a))}),s.push("</xml>"),s.join("")}function XE(r,e,t){var i=lt(r[0]),n={color2:"#BEFF82",type:"gradient"};n.type=="gradient"&&(n.angle="-180");var s=n.type=="gradient"?Z("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,a=Z("v:fill",s,n),o={on:"t",obscured:"t"};return["<v:shape"+ss({id:"_x0000_s"+e,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(r[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",a,Z("v:shadow",null,o),Z("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",kt("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),kt("x:AutoFill","False"),kt("x:Row",String(i.r)),kt("x:Column",String(i.c)),r[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"].join("")}function $E(r){var e=[Et,Z("comments",null,{xmlns:Rn[0]})],t=[];return e.push("<authors>"),r.forEach(function(i){i[1].forEach(function(n){var s=Se(n.a);t.indexOf(s)==-1&&(t.push(s),e.push("<author>"+s+"</author>")),n.T&&n.ID&&t.indexOf("tc="+n.ID)==-1&&(t.push("tc="+n.ID),e.push("<author>tc="+n.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),r.forEach(function(i){var n=0,s=[],a=0;if(i[1][0]&&i[1][0].T&&i[1][0].ID&&(n=t.indexOf("tc="+i[1][0].ID)),i[1].forEach(function(h){h.a&&(n=t.indexOf(Se(h.a))),h.T&&++a,s.push(h.t==null?"":Se(h.t))}),a===0)i[1].forEach(function(h){e.push('<comment ref="'+i[0]+'" authorId="'+t.indexOf(Se(h.a))+'"><text>'),e.push(kt("t",h.t==null?"":Se(h.t))),e.push("</text></comment>")});else{i[1][0]&&i[1][0].T&&i[1][0].ID&&(n=t.indexOf("tc="+i[1][0].ID)),e.push('<comment ref="'+i[0]+'" authorId="'+n+'"><text>');for(var o=`Comment:
    `+s[0]+`
`,l=1;l<s.length;++l)o+=`Reply:
    `+s[l]+`
`;e.push(kt("t",Se(o))),e.push("</text></comment>")}}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function Ld(r,e,t){var i=[Et,Z("ThreadedComments",null,{xmlns:Tt.TCMNT}).replace(/[\/]>/,">")];return r.forEach(function(n){var s="";(n[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),i.push(Z("threadedComment",kt("text",a.t||""),l))})}),i.push("</ThreadedComments>"),i.join("")}function Pd(r){var e=[Et,Z("personList",null,{xmlns:Tt.TCMNT,"xmlns:x":Rn[0]}).replace(/[\/]>/,">")];return r.forEach(function(t,i){e.push(Z("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function KE(r){var e={};e.iauthor=r.read_shift(4);var t=qr(r);return e.rfx=t.s,e.ref=ct(t.s),r.l+=16,e}function QE(r,e){return e==null&&(e=H(36)),e.write_shift(4,r[1].iauthor),An(r[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var qE=Wt;function gu(r){return Ct(r.slice(0,54))}function JE(r){var e=zt(),t=[];return X(e,628),X(e,630),r.forEach(function(i){i[1].forEach(function(n){t.indexOf(n.a)>-1||(t.push(n.a.slice(0,54)),X(e,632,gu(n.a)),n.T&&n.ID&&t.indexOf("tc="+n.ID)==-1&&(t.push("tc="+n.ID),X(e,632,gu("tc="+n.ID))))})}),X(e,631),X(e,633),r.forEach(function(i){i[1].forEach(function(n){var s=-1;n.ID&&(s=t.indexOf("tc="+n.ID)),s==-1&&i[1][0].T&&i[1][0].ID&&(s=t.indexOf("tc="+i[1][0].ID)),s==-1&&(s=t.indexOf(n.a)),n.iauthor=s;var a={s:lt(i[0]),e:lt(i[0])};X(e,635,QE([a,n])),n.t&&n.t.length>0&&X(e,637,Kx(n)),X(e,636),delete n.iauthor})}),X(e,634),X(e,629),e.end()}function ZE(r,e){e.FullPaths.forEach(function(t,i){if(i!=0){var n=t.replace(/^[\/]*[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&Ze.utils.cfb_add(r,n,e.FileIndex[i].content)}})}var eC=["xlsb","xlsm","xlam","biff8","xla"],vu=function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(i,n,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var h=s.length>0?parseInt(s,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=e.c:--u,l?h+=e.r:--h,n+(o?"":"$")+$e(u)+(l?"":"$")+qe(h)}return function(n,s){return e=s,n.replace(r,t)}}(),Va=/(^|[^._A-Z0-9])(\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\$?)(\d{1,7})(?![_.\(A-Za-z0-9])/g;try{Va=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g}catch{}var Ua=function(){return function(e,t){return e.replace(Va,function(i,n,s,a,o,l){var h=Pl(a)-(s?0:t.c),u=Ll(l)-(o?0:t.r),d=o=="$"?u+1:u==0?"":"["+u+"]",c=s=="$"?h+1:h==0?"":"["+h+"]";return n+"R"+d+"C"+c})}}();function tC(r,e){return r.replace(Va,function(t,i,n,s,a,o){return i+(n=="$"?n+s:$e(Pl(s)+e.c))+(a=="$"?a+o:qe(Ll(o)+e.r))})}function iC(r){return r.length!=1}function vt(r){r.l+=1}function xr(r,e){var t=r.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function Nd(r,e,t){var i=2;if(t){if(t.biff>=2&&t.biff<=5)return Id(r);t.biff==12&&(i=4)}var n=r.read_shift(i),s=r.read_shift(i),a=xr(r),o=xr(r);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Id(r){var e=xr(r),t=xr(r),i=r.read_shift(1),n=r.read_shift(1);return{s:{r:e[0],c:i,cRel:e[1],rRel:e[2]},e:{r:t[0],c:n,cRel:t[1],rRel:t[2]}}}function rC(r,e,t){if(t.biff<8)return Id(r);var i=r.read_shift(t.biff==12?4:2),n=r.read_shift(t.biff==12?4:2),s=xr(r),a=xr(r);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:a[0],cRel:a[1],rRel:a[2]}}}function Bd(r,e,t){if(t&&t.biff>=2&&t.biff<=5)return nC(r);var i=r.read_shift(t&&t.biff==12?4:2),n=xr(r);return{r:i,c:n[0],cRel:n[1],rRel:n[2]}}function nC(r){var e=xr(r),t=r.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function sC(r){var e=r.read_shift(2),t=r.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function aC(r,e,t){var i=t&&t.biff?t.biff:8;if(i>=2&&i<=5)return oC(r);var n=r.read_shift(i>=12?4:2),s=r.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;n>524287;)n-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:n,c:s,cRel:a,rRel:o}}function oC(r){var e=r.read_shift(2),t=r.read_shift(1),i=(e&32768)>>15,n=(e&16384)>>14;return e&=16383,i==1&&e>=8192&&(e=e-16384),n==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:n,rRel:i}}function lC(r,e,t){var i=(r[r.l++]&96)>>5,n=Nd(r,t.biff>=2&&t.biff<=5?6:8,t);return[i,n]}function hC(r,e,t){var i=(r[r.l++]&96)>>5,n=r.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}var a=Nd(r,s,t);return[i,n,a]}function uC(r,e,t){var i=(r[r.l++]&96)>>5;return r.l+=t&&t.biff>8?12:t.biff<8?6:8,[i]}function cC(r,e,t){var i=(r[r.l++]&96)>>5,n=r.read_shift(2),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}return r.l+=s,[i,n]}function dC(r,e,t){var i=(r[r.l++]&96)>>5,n=rC(r,e-1,t);return[i,n]}function fC(r,e,t){var i=(r[r.l++]&96)>>5;return r.l+=t.biff==2?6:t.biff==12?14:7,[i]}function bu(r){var e=r[r.l+1]&1,t=1;return r.l+=4,[e,t]}function pC(r,e,t){r.l+=2;for(var i=r.read_shift(t&&t.biff==2?1:2),n=[],s=0;s<=i;++s)n.push(r.read_shift(t&&t.biff==2?1:2));return n}function mC(r,e,t){var i=r[r.l+1]&255?1:0;return r.l+=2,[i,r.read_shift(t&&t.biff==2?1:2)]}function gC(r,e,t){var i=r[r.l+1]&255?1:0;return r.l+=2,[i,r.read_shift(t&&t.biff==2?1:2)]}function vC(r){var e=r[r.l+1]&255?1:0;return r.l+=2,[e,r.read_shift(2)]}function bC(r,e,t){var i=r[r.l+1]&255?1:0;return r.l+=t&&t.biff==2?3:4,[i]}function Hd(r){var e=r.read_shift(1),t=r.read_shift(1);return[e,t]}function wC(r){return r.read_shift(2),Hd(r)}function xC(r){return r.read_shift(2),Hd(r)}function yC(r,e,t){var i=(r[r.l]&96)>>5;r.l+=1;var n=Bd(r,0,t);return[i,n]}function EC(r,e,t){var i=(r[r.l]&96)>>5;r.l+=1;var n=aC(r,0,t);return[i,n]}function CC(r,e,t){var i=(r[r.l]&96)>>5;r.l+=1;var n=r.read_shift(2);t&&t.biff==5&&(r.l+=12);var s=Bd(r,0,t);return[i,n,s]}function _C(r,e,t){var i=(r[r.l]&96)>>5;r.l+=1;var n=r.read_shift(t&&t.biff<=3?1:2);return[P_[n],Vd[n],i]}function TC(r,e,t){var i=r[r.l++],n=r.read_shift(1),s=t&&t.biff<=3?[i==88?-1:0,r.read_shift(1)]:SC(r);return[n,(s[0]===0?Vd:L_)[s[1]]]}function SC(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function DC(r,e,t){r.l+=t&&t.biff==2?3:4}function kC(r,e,t){if(r.l++,t&&t.biff==12)return[r.read_shift(4,"i"),0];var i=r.read_shift(2),n=r.read_shift(t&&t.biff==2?1:2);return[i,n]}function RC(r){return r.l++,Qt[r.read_shift(1)]}function FC(r){return r.l++,r.read_shift(2)}function MC(r){return r.l++,r.read_shift(1)!==0}function AC(r){return r.l++,On(r)}function OC(r,e,t){return r.l++,Cd(r,e-1,t)}function LC(r,e){var t=[r.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=wy(r,1)?"TRUE":"FALSE",e!=12&&(r.l+=7);break;case 37:case 16:t[1]=Qt[r[r.l]],r.l+=e==12?4:8;break;case 0:r.l+=8;break;case 1:t[1]=On(r);break;case 2:t[1]=Cy(r,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function PC(r,e,t){for(var i=r.read_shift(t.biff==12?4:2),n=[],s=0;s!=i;++s)n.push((t.biff==12?qr:Sy)(r));return n}function NC(r,e,t){var i=0,n=0;t.biff==12?(i=r.read_shift(4),n=r.read_shift(4)):(n=1+r.read_shift(1),i=1+r.read_shift(2)),t.biff>=2&&t.biff<8&&(--i,--n==0&&(n=256));for(var s=0,a=[];s!=i&&(a[s]=[]);++s)for(var o=0;o!=n;++o)a[s][o]=LC(r,t.biff);return a}function IC(r,e,t){var i=r.read_shift(1)>>>5&3,n=!t||t.biff>=8?4:2,s=r.read_shift(n);switch(t.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[i,0,s]}function BC(r,e,t){if(t.biff==5)return HC(r);var i=r.read_shift(1)>>>5&3,n=r.read_shift(2),s=r.read_shift(4);return[i,n,s]}function HC(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2,"i");r.l+=8;var i=r.read_shift(2);return r.l+=12,[e,t,i]}function zC(r,e,t){var i=r.read_shift(1)>>>5&3;r.l+=t&&t.biff==2?3:4;var n=r.read_shift(t&&t.biff==2?1:2);return[i,n]}function WC(r,e,t){var i=r.read_shift(1)>>>5&3,n=r.read_shift(t&&t.biff==2?1:2);return[i,n]}function VC(r,e,t){var i=r.read_shift(1)>>>5&3;return r.l+=4,t.biff<8&&r.l--,t.biff==12&&(r.l+=2),[i]}function UC(r,e,t){var i=(r[r.l++]&96)>>5,n=r.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return r.l+=s,[i,n]}var GC=Ii,YC=Ii,jC=Ii;function ws(r,e,t){return r.l+=2,[sC(r)]}function Wl(r){return r.l+=6,[]}var XC=ws,$C=Wl,KC=Wl,QC=ws;function zd(r){return r.l+=2,[Ys(r),r.read_shift(2)&1]}var qC=ws,JC=zd,ZC=Wl,e_=ws,t_=ws,i_=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function r_(r){r.l+=2;var e=r.read_shift(2),t=r.read_shift(2),i=r.read_shift(4),n=r.read_shift(2),s=r.read_shift(2),a=i_[t>>2&31];return{ixti:e,coltype:t&3,rt:a,idx:i,c:n,C:s}}function n_(r){return r.l+=2,[r.read_shift(4)]}function s_(r,e,t){return r.l+=5,r.l+=2,r.l+=t.biff==2?1:4,["PTGSHEET"]}function a_(r,e,t){return r.l+=t.biff==2?4:5,["PTGENDSHEET"]}function o_(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function l_(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function h_(r){return r.l+=4,[0,0]}var wu={1:{n:"PtgExp",f:kC},2:{n:"PtgTbl",f:jC},3:{n:"PtgAdd",f:vt},4:{n:"PtgSub",f:vt},5:{n:"PtgMul",f:vt},6:{n:"PtgDiv",f:vt},7:{n:"PtgPower",f:vt},8:{n:"PtgConcat",f:vt},9:{n:"PtgLt",f:vt},10:{n:"PtgLe",f:vt},11:{n:"PtgEq",f:vt},12:{n:"PtgGe",f:vt},13:{n:"PtgGt",f:vt},14:{n:"PtgNe",f:vt},15:{n:"PtgIsect",f:vt},16:{n:"PtgUnion",f:vt},17:{n:"PtgRange",f:vt},18:{n:"PtgUplus",f:vt},19:{n:"PtgUminus",f:vt},20:{n:"PtgPercent",f:vt},21:{n:"PtgParen",f:vt},22:{n:"PtgMissArg",f:vt},23:{n:"PtgStr",f:OC},26:{n:"PtgSheet",f:s_},27:{n:"PtgEndSheet",f:a_},28:{n:"PtgErr",f:RC},29:{n:"PtgBool",f:MC},30:{n:"PtgInt",f:FC},31:{n:"PtgNum",f:AC},32:{n:"PtgArray",f:fC},33:{n:"PtgFunc",f:_C},34:{n:"PtgFuncVar",f:TC},35:{n:"PtgName",f:IC},36:{n:"PtgRef",f:yC},37:{n:"PtgArea",f:lC},38:{n:"PtgMemArea",f:zC},39:{n:"PtgMemErr",f:GC},40:{n:"PtgMemNoMem",f:YC},41:{n:"PtgMemFunc",f:WC},42:{n:"PtgRefErr",f:VC},43:{n:"PtgAreaErr",f:uC},44:{n:"PtgRefN",f:EC},45:{n:"PtgAreaN",f:dC},46:{n:"PtgMemAreaN",f:o_},47:{n:"PtgMemNoMemN",f:l_},57:{n:"PtgNameX",f:BC},58:{n:"PtgRef3d",f:CC},59:{n:"PtgArea3d",f:hC},60:{n:"PtgRefErr3d",f:UC},61:{n:"PtgAreaErr3d",f:cC},255:{}},u_={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},c_={1:{n:"PtgElfLel",f:zd},2:{n:"PtgElfRw",f:e_},3:{n:"PtgElfCol",f:XC},6:{n:"PtgElfRwV",f:t_},7:{n:"PtgElfColV",f:QC},10:{n:"PtgElfRadical",f:qC},11:{n:"PtgElfRadicalS",f:ZC},13:{n:"PtgElfColS",f:$C},15:{n:"PtgElfColSV",f:KC},16:{n:"PtgElfRadicalLel",f:JC},25:{n:"PtgList",f:r_},29:{n:"PtgSxName",f:n_},255:{}},d_={0:{n:"PtgAttrNoop",f:h_},1:{n:"PtgAttrSemi",f:bC},2:{n:"PtgAttrIf",f:gC},4:{n:"PtgAttrChoose",f:pC},8:{n:"PtgAttrGoto",f:mC},16:{n:"PtgAttrSum",f:DC},32:{n:"PtgAttrBaxcel",f:bu},33:{n:"PtgAttrBaxcel",f:bu},64:{n:"PtgAttrSpace",f:wC},65:{n:"PtgAttrSpaceSemi",f:xC},128:{n:"PtgAttrIfError",f:vC},255:{}};function f_(r,e,t,i){if(i.biff<8)return Ii(r,e);for(var n=r.l+e,s=[],a=0;a!==t.length;++a)switch(t[a][0]){case"PtgArray":t[a][1]=NC(r,0,i),s.push(t[a][1]);break;case"PtgMemArea":t[a][2]=PC(r,t[a][1],i),s.push(t[a][2]);break;case"PtgExp":i&&i.biff==12&&(t[a][1][1]=r.read_shift(4),s.push(t[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[a][0]}return e=n-r.l,e!==0&&s.push(Ii(r,e)),s}function p_(r,e,t){for(var i=r.l+e,n,s,a=[];i!=r.l;)e=i-r.l,s=r[r.l],n=wu[s]||wu[u_[s]],(s===24||s===25)&&(n=(s===24?c_:d_)[r[r.l+1]]),!n||!n.f?Ii(r,e):a.push([n.n,n.f(r,e,t)]);return a}function m_(r){for(var e=[],t=0;t<r.length;++t){for(var i=r[t],n=[],s=0;s<i.length;++s){var a=i[s];if(a)switch(a[0]){case 2:n.push('"'+a[1].replace(/"/g,'""')+'"');break;default:n.push(a[1])}else n.push("")}e.push(n.join(","))}return e.join(";")}var g_={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function v_(r,e){var t=r.lastIndexOf("!"),i=e.lastIndexOf("!");return t==-1&&i==-1?r+":"+e:t>0&&i>0&&r.slice(0,t).toLowerCase()==e.slice(0,i).toLowerCase()?r+":"+e.slice(i+1):(console.error("Cannot hydrate range",r,e),r+":"+e)}function Wd(r,e,t){if(!r)return"SH33TJSERR0";if(t.biff>8&&(!r.XTI||!r.XTI[e]))return r.SheetNames[e];if(!r.XTI)return"SH33TJSERR6";var i=r.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":r.XTI[e-1];if(!i)return"SH33TJSERR1";var n="";if(t.biff>8)switch(r[i[0]][0]){case 357:return n=i[1]==-1?"#REF":r.SheetNames[i[1]],i[1]==i[2]?n:n+":"+r.SheetNames[i[2]];case 358:return t.SID!=null?r.SheetNames[t.SID]:"SH33TJSSAME"+r[i[0]][0];case 355:default:return"SH33TJSSRC"+r[i[0]][0]}switch(r[i[0]][0][0]){case 1025:return n=i[1]==-1?"#REF":r.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?n:n+":"+r.SheetNames[i[2]];case 14849:return r[i[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return r[i[0]][0][3]?(n=i[1]==-1?"#REF":r[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?n:n+":"+r[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function xu(r,e,t){var i=Wd(r,e,t);return i=="#REF"?i:os(i,t)}function Dn(r,e,t,i,n){var s=n&&n.biff||8,a={s:{c:0,r:0}},o=[],l,h,u,d=0,c=0,f,p="";if(!r[0]||!r[0][0])return"";for(var v=-1,m="",g=0,x=r[0].length;g<x;++g){var b=r[0][g];switch(b[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),h=o.pop(),v>=0){switch(r[0][v][1][0]){case 0:m=at(" ",r[0][v][1][1]);break;case 1:m=at("\r",r[0][v][1][1]);break;default:if(m="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][v][1][0])}h=h+m,v=-1}o.push(h+g_[b[0]]+l);break;case"PtgIsect":l=o.pop(),h=o.pop(),o.push(h+" "+l);break;case"PtgUnion":l=o.pop(),h=o.pop(),o.push(h+","+l);break;case"PtgRange":l=o.pop(),h=o.pop(),o.push(v_(h,l));break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Xn(b[1][1],a,n),o.push($n(u,s));break;case"PtgRefN":u=t?Xn(b[1][1],t,n):b[1][1],o.push($n(u,s));break;case"PtgRef3d":d=b[1][1],u=Xn(b[1][2],a,n),p=xu(i,d,n),o.push(p+"!"+$n(u,s));break;case"PtgFunc":case"PtgFuncVar":var F=b[1][0],A=b[1][1];F||(F=0),F&=127;var _=F==0?[]:o.slice(-F);o.length-=F,A==="User"&&(A=_.shift()),o.push(A+"("+_.join(",")+")");break;case"PtgBool":o.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(b[1]);break;case"PtgNum":o.push(String(b[1]));break;case"PtgStr":o.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(b[1]);break;case"PtgAreaN":f=tu(b[1][1],t?{s:t}:a,n),o.push(ho(f,n));break;case"PtgArea":f=tu(b[1][1],a,n),o.push(ho(f,n));break;case"PtgArea3d":d=b[1][1],f=b[1][2],p=xu(i,d,n),o.push(p+"!"+ho(f,n));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":c=b[1][2];var y=(i.names||[])[c-1]||(i[0]||[])[c],R=y?y.Name:"SH33TJSNAME"+String(c);R&&R.slice(0,6)=="_xlfn."&&!n.xlfn&&(R=R.slice(6)),o.push(R);break;case"PtgNameX":var M=b[1][1];c=b[1][2];var I;if(n.biff<=5)M<0&&(M=-M),i[M]&&(I=i[M][c]);else{var P="";if(((i[M]||[])[0]||[])[0]==14849||(((i[M]||[])[0]||[])[0]==1025?i[M][c]&&i[M][c].itab>0&&(P=i.SheetNames[i[M][c].itab-1]+"!"):P=i.SheetNames[c-1]+"!"),i[M]&&i[M][c])P+=i[M][c].Name;else if(i[0]&&i[0][c])P+=i[0][c].Name;else{var N=(Wd(i,M,n)||"").split(";;");N[c-1]?P=N[c-1]:P+="SH33TJSERRX"}o.push(P);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var ne="(",he=")";if(v>=0){switch(m="",r[0][v][1][0]){case 2:ne=at(" ",r[0][v][1][1])+ne;break;case 3:ne=at("\r",r[0][v][1][1])+ne;break;case 4:he=at(" ",r[0][v][1][1])+he;break;case 5:he=at("\r",r[0][v][1][1])+he;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][v][1][0])}v=-1}o.push(ne+o.pop()+he);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:b[1][1],r:b[1][0]};var se={c:t.c,r:t.r};if(i.sharedf[ct(u)]){var fe=i.sharedf[ct(u)];o.push(Dn(fe,a,se,i,n))}else{var ee=!1;for(l=0;l!=i.arrayf.length;++l)if(h=i.arrayf[l],!(u.c<h[0].s.c||u.c>h[0].e.c)&&!(u.r<h[0].s.r||u.r>h[0].e.r)){o.push(Dn(h[1],a,se,i,n)),ee=!0;break}ee||o.push(b[1])}break;case"PtgArray":o.push("{"+m_(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=g;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var ge=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&v>=0&&ge.indexOf(r[0][g][0])==-1){b=r[0][v];var _e=!0;switch(b[1][0]){case 4:_e=!1;case 0:m=at(" ",b[1][1]);break;case 5:_e=!1;case 1:m=at("\r",b[1][1]);break;default:if(m="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}o.push((_e?m:"")+o.pop()+(_e?"":m)),v=-1}}if(o.length>1&&n.WTF)throw new Error("bad formula stack");return o[0]=="TRUE"?!0:o[0]=="FALSE"?!1:o[0]}function b_(r){if(r==null){var e=H(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof r=="number")return Yr(r);return Yr(0)}function w_(r,e,t,i,n){var s=jr(e,t,n),a=b_(r.v),o=H(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var h=H(r.bf.length),u=0;u<r.bf.length;++u)h[u]=r.bf[u];var d=wt([s,a,o,h]);return d}function Ga(r,e,t){var i=r.read_shift(4),n=p_(r,i,t),s=r.read_shift(4),a=s>0?f_(r,s,n,t):null;return[n,a]}var x_=Ga,Ya=Ga,y_=Ga,E_=Ga;function yu(r){if((r|0)==r&&r<Math.pow(2,16)&&r>=0){var e=H(11);return e.write_shift(4,3),e.write_shift(1,30),e.write_shift(2,r),e.write_shift(4,0),e}var t=H(17);return t.write_shift(4,11),t.write_shift(1,31),t.write_shift(8,r),t.write_shift(4,0),t}function C_(r){var e=H(10);return e.write_shift(4,2),e.write_shift(1,28),e.write_shift(1,r),e.write_shift(4,0),e}function __(r){var e=H(10);return e.write_shift(4,2),e.write_shift(1,29),e.write_shift(1,r?1:0),e.write_shift(4,0),e}function T_(r){var e=H(7);e.write_shift(4,3+2*r.length),e.write_shift(1,23),e.write_shift(2,r.length);var t=H(2*r.length);t.write_shift(2*r.length,r,"utf16le");var i=H(4);return i.write_shift(4,0),wt([e,t,i])}function S_(r){var e=lt(r),t=H(15);return t.write_shift(4,7),t.write_shift(1,36),t.write_shift(4,e.r),t.write_shift(2,e.c|(r.charAt(0)=="$"?0:1)<<14|(r.match(/\$\d/)?0:1)<<15),t.write_shift(4,0),t}function D_(r,e){var t=r.lastIndexOf("!"),i=r.slice(0,t);r=r.slice(t+1);var n=lt(r);i.charAt(0)=="'"&&(i=i.slice(1,-1).replace(/''/g,"'"));var s=H(17);return s.write_shift(4,9),s.write_shift(1,58),s.write_shift(2,2+e.SheetNames.map(function(a){return a.toLowerCase()}).indexOf(i.toLowerCase())),s.write_shift(4,n.r),s.write_shift(2,n.c|(r.charAt(0)=="$"?0:1)<<14|(r.match(/\$\d/)?0:1)<<15),s.write_shift(4,0),s}function k_(r,e){var t=r.lastIndexOf("!"),i=r.slice(0,t);r=r.slice(t+1),i.charAt(0)=="'"&&(i=i.slice(1,-1).replace(/''/g,"'"));var n=H(17);return n.write_shift(4,9),n.write_shift(1,60),n.write_shift(2,2+e.SheetNames.map(function(s){return s.toLowerCase()}).indexOf(i.toLowerCase())),n.write_shift(4,0),n.write_shift(2,0),n.write_shift(4,0),n}function R_(r){var e=r.split(":"),t=e[0],i=H(23);i.write_shift(4,15),t=e[0];var n=lt(t);return i.write_shift(1,36),i.write_shift(4,n.r),i.write_shift(2,n.c|(t.charAt(0)=="$"?0:1)<<14|(t.match(/\$\d/)?0:1)<<15),i.write_shift(4,0),t=e[1],n=lt(t),i.write_shift(1,36),i.write_shift(4,n.r),i.write_shift(2,n.c|(t.charAt(0)=="$"?0:1)<<14|(t.match(/\$\d/)?0:1)<<15),i.write_shift(4,0),i.write_shift(1,17),i.write_shift(4,0),i}function F_(r,e){var t=r.lastIndexOf("!"),i=r.slice(0,t);r=r.slice(t+1),i.charAt(0)=="'"&&(i=i.slice(1,-1).replace(/''/g,"'"));var n=r.split(":"),s=H(27);s.write_shift(4,19);var a=n[0],o=lt(a);return s.write_shift(1,58),s.write_shift(2,2+e.SheetNames.map(function(l){return l.toLowerCase()}).indexOf(i.toLowerCase())),s.write_shift(4,o.r),s.write_shift(2,o.c|(a.charAt(0)=="$"?0:1)<<14|(a.match(/\$\d/)?0:1)<<15),a=n[1],o=lt(a),s.write_shift(1,58),s.write_shift(2,2+e.SheetNames.map(function(l){return l.toLowerCase()}).indexOf(i.toLowerCase())),s.write_shift(4,o.r),s.write_shift(2,o.c|(a.charAt(0)=="$"?0:1)<<14|(a.match(/\$\d/)?0:1)<<15),s.write_shift(1,17),s.write_shift(4,0),s}function M_(r,e){var t=r.lastIndexOf("!"),i=r.slice(0,t);r=r.slice(t+1),i.charAt(0)=="'"&&(i=i.slice(1,-1).replace(/''/g,"'"));var n=Ft(r),s=H(23);return s.write_shift(4,15),s.write_shift(1,59),s.write_shift(2,2+e.SheetNames.map(function(a){return a.toLowerCase()}).indexOf(i.toLowerCase())),s.write_shift(4,n.s.r),s.write_shift(4,n.e.r),s.write_shift(2,n.s.c),s.write_shift(2,n.e.c),s.write_shift(4,0),s}function A_(r,e){if(typeof r=="number")return yu(r);if(typeof r=="boolean")return __(r);if(/^#(DIV\/0!|GETTING_DATA|N\/A|NAME\?|NULL!|NUM!|REF!|VALUE!)$/.test(r))return C_(+Li[r]);if(r.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return S_(r);if(r.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return R_(r);if(r.match(/^#REF!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return M_(r,e);if(r.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return D_(r,e);if(r.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return F_(r,e);if(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!#REF!$/.test(r))return k_(r,e);if(/^".*"$/.test(r))return T_(r);if(/^[+-]\d+$/.test(r))return yu(parseInt(r,10));throw"Formula |"+r+"| not supported for XLSB"}var O_=A_,L_={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Vd={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},P_={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function N_(r){var e="of:="+r.replace(Va,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Ud(r){return r.replace(/!/,".").replace(/:/,":.")}var Kn=typeof Map<"u";function Vl(r,e,t){var i=0,n=r.length;if(t){if(Kn?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var s=Kn?t.get(e):t[e];i<s.length;++i)if(r[s[i]].t===e)return r.Count++,s[i]}}else for(;i<n;++i)if(r[i].t===e)return r.Count++,i;return r[n]={t:e},r.Count++,r.Unique++,t&&(Kn?(t.has(e)||t.set(e,[]),t.get(e).push(n)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(n))),n}function ja(r,e){var t={min:r+1,max:r+1},i=-1;return e.MDW&&(Zi=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?i=va(e.wpx):e.wch!=null&&(i=e.wch),i>-1?(t.width=al(i),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function Gd(r,e){if(r){var t=[.7,.7,.75,.75,.3,.3];r.left==null&&(r.left=t[0]),r.right==null&&(r.right=t[1]),r.top==null&&(r.top=t[2]),r.bottom==null&&(r.bottom=t[3]),r.header==null&&(r.header=t[4]),r.footer==null&&(r.footer=t[5])}}function Er(r,e,t){var i=t.revssf[e.z!=null?e.z:"General"],n=60,s=r.length;if(i==null&&t.ssf){for(;n<392;++n)if(t.ssf[n]==null){hx(e.z,n),t.ssf[n]=e.z,t.revssf[e.z]=i=n;break}}for(n=0;n!=s;++n)if(r[n].numFmtId===i)return n;return r[s]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function I_(r,e,t){if(r&&r["!ref"]){var i=nt(r["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+t+"): "+r["!ref"])}}function B_(r){if(r.length===0)return"";for(var e='<mergeCells count="'+r.length+'">',t=0;t!=r.length;++t)e+='<mergeCell ref="'+yt(r[t])+'"/>';return e+"</mergeCells>"}function H_(r,e,t,i,n){var s=!1,a={},o=null;if(i.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[t];try{e.Workbook&&(l=e.Workbook.Sheets[t].CodeName||l)}catch{}s=!0,a.codeName=ns(Se(l))}if(r&&r["!outline"]){var h={summaryBelow:1,summaryRight:1};r["!outline"].above&&(h.summaryBelow=0),r["!outline"].left&&(h.summaryRight=0),o=(o||"")+Z("outlinePr",null,h)}!s&&!o||(n[n.length]=Z("sheetPr",o,a))}var z_=["objects","scenarios","selectLockedCells","selectUnlockedCells"],W_=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function V_(r){var e={sheet:1};return z_.forEach(function(t){r[t]!=null&&r[t]&&(e[t]="1")}),W_.forEach(function(t){r[t]!=null&&!r[t]&&(e[t]="0")}),r.password&&(e.password=kd(r.password).toString(16).toUpperCase()),Z("sheetProtection",null,e)}function U_(r){return Gd(r),Z("pageMargins",null,r)}function G_(r,e){for(var t=["<cols>"],i,n=0;n!=e.length;++n)(i=e[n])&&(t[t.length]=Z("col",null,ja(n,i)));return t[t.length]="</cols>",t.join("")}function Y_(r,e,t,i){var n=typeof r.ref=="string"?r.ref:yt(r.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,a=Ft(n);a.s.r==a.e.r&&(a.e.r=Ft(e["!ref"]).e.r,n=yt(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==i){l.Ref=os(t.SheetNames[i])+"!"+as(n);break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+t.SheetNames[i]+"'!"+n}),Z("autoFilter",null,{ref:n})}function j_(r,e,t,i){var n={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),Z("sheetViews",Z("sheetView",null,n),{})}function X_(r,e,t,i,n,s,a){if(r.c&&t["!comments"].push([e,r.c]),(r.v===void 0||r.t==="z"&&!(i||{}).sheetStubs)&&typeof r.f!="string"&&typeof r.z>"u")return"";var o="",l=r.t,h=r.v;if(r.t!=="z")switch(r.t){case"b":o=r.v?"1":"0";break;case"n":isNaN(r.v)?(r.t="e",o=Qt[r.v=36]):isFinite(r.v)?o=""+r.v:(r.t="e",o=Qt[r.v=7]);break;case"e":o=Qt[r.v];break;case"d":if(i&&i.cellDates){var u=Zt(r.v,a);o=u.toISOString(),u.getUTCFullYear()<1900&&(o=o.slice(o.indexOf("T")+1).replace("Z",""))}else r=Vt(r),r.t="n",o=""+(r.v=Mt(Zt(r.v,a),a));typeof r.z>"u"&&(r.z=rt[14]);break;default:o=r.v;break}var d=r.t=="z"||r.v==null?"":kt("v",Se(o)),c={r:e},f=Er(i.cellXfs,r,i);switch(f!==0&&(c.s=f),r.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(r.v==null){delete r.t;break}if(r.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){d=kt("v",""+Vl(i.Strings,r.v,i.revStrings)),c.t="s";break}else c.t="str";break}if(r.t!=l&&(r.t=l,r.v=h),typeof r.f=="string"&&r.f){var p=r.F&&r.F.slice(0,e.length)==e?{t:"array",ref:r.F}:null;d=Z("f",Se(r.f),p)+(r.v!=null?d:"")}return r.l&&(r.l.display=Se(o),t["!links"].push([e,r.l])),r.D&&(c.cm=1),Z("c",d,c)}function $_(r,e,t,i){var n=[],s=[],a=nt(r["!ref"]),o="",l,h="",u=[],d=0,c=0,f=r["!rows"],p=r["!data"]!=null,v=p?r["!data"]:[],m={r:h},g,x=-1,b=(((i||{}).Workbook||{}).WBProps||{}).date1904;for(c=a.s.c;c<=a.e.c;++c)u[c]=$e(c);for(d=a.s.r;d<=a.e.r;++d){s=[],h=qe(d);var F=p?v[d]:[];for(c=a.s.c;c<=a.e.c;++c){l=u[c]+h;var A=p?F[c]:r[l];A!==void 0&&(o=X_(A,l,r,e,t,i,b))!=null&&s.push(o)}(s.length>0||f&&f[d])&&(m={r:h},f&&f[d]&&(g=f[d],g.hidden&&(m.hidden=1),x=-1,g.hpx?x=ba(g.hpx):g.hpt&&(x=g.hpt),x>-1&&(m.ht=x,m.customHeight=1),g.level&&(m.outlineLevel=g.level)),n[n.length]=Z("row",s.join(""),m))}if(f)for(;d<f.length;++d)f&&f[d]&&(m={r:d+1},g=f[d],g.hidden&&(m.hidden=1),x=-1,g.hpx?x=ba(g.hpx):g.hpt&&(x=g.hpt),x>-1&&(m.ht=x,m.customHeight=1),g.level&&(m.outlineLevel=g.level),n[n.length]=Z("row","",m));return n.join("")}function K_(r,e,t,i){var n=[Et,Z("worksheet",null,{xmlns:Rn[0],"xmlns:r":Tt.r})],s=t.SheetNames[r],a=0,o="",l=t.Sheets[s];l==null&&(l={});var h=l["!ref"]||"A1",u=nt(h);if(u.e.c>16383||u.e.r>1048575){if(e.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),h=yt(u)}i||(i={}),l["!comments"]=[];var d=[];H_(l,t,r,e,n),n[n.length]=Z("dimension",null,{ref:h}),n[n.length]=j_(l,e,r,t),e.sheetFormat&&(n[n.length]=Z("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(n[n.length]=G_(l,l["!cols"])),n[a=n.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=$_(l,e,r,t),o.length>0&&(n[n.length]=o)),n.length>a+1&&(n[n.length]="</sheetData>",n[a]=n[a].replace("/>",">")),l["!protect"]&&(n[n.length]=V_(l["!protect"])),l["!autofilter"]!=null&&(n[n.length]=Y_(l["!autofilter"],l,t,r)),l["!merges"]!=null&&l["!merges"].length>0&&(n[n.length]=B_(l["!merges"]));var c=-1,f,p=-1;return l["!links"].length>0&&(n[n.length]="<hyperlinks>",l["!links"].forEach(function(v){v[1].Target&&(f={ref:v[0]},v[1].Target.charAt(0)!="#"&&(p=We(i,-1,Se(v[1].Target).replace(/#[\s\S]*$/,""),Pe.HLINK),f["r:id"]="rId"+p),(c=v[1].Target.indexOf("#"))>-1&&(f.location=Se(v[1].Target.slice(c+1))),v[1].Tooltip&&(f.tooltip=Se(v[1].Tooltip)),f.display=v[1].display,n[n.length]=Z("hyperlink",null,f))}),n[n.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(n[n.length]=U_(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(n[n.length]=kt("ignoredErrors",Z("ignoredError",null,{numberStoredAsText:1,sqref:h}))),d.length>0&&(p=We(i,-1,"../drawings/drawing"+(r+1)+".xml",Pe.DRAW),n[n.length]=Z("drawing",null,{"r:id":"rId"+p}),l["!drawing"]=d),l["!comments"].length>0&&(p=We(i,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Pe.VML),n[n.length]=Z("legacyDrawing",null,{"r:id":"rId"+p}),l["!legacy"]=p),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function Q_(r,e){var t={},i=r.l+e;t.r=r.read_shift(4),r.l+=4;var n=r.read_shift(2);r.l+=1;var s=r.read_shift(1);return r.l=i,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=n/20),t}function q_(r,e,t){var i=H(145),n=(t["!rows"]||[])[r]||{};i.write_shift(4,r),i.write_shift(4,0);var s=320;n.hpx?s=ba(n.hpx)*20:n.hpt&&(s=n.hpt*20),i.write_shift(2,s),i.write_shift(1,0);var a=0;n.level&&(a|=n.level),n.hidden&&(a|=16),(n.hpx||n.hpt)&&(a|=32),i.write_shift(1,a),i.write_shift(1,0);var o=0,l=i.l;i.l+=4;for(var h={r,c:0},u=t["!data"]!=null,d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var c=-1,f=-1,p=d<<10;p<d+1<<10;++p){h.c=p;var v=u?(t["!data"][h.r]||[])[h.c]:t[ct(h)];v&&(c<0&&(c=p),f=p)}c<0||(++o,i.write_shift(4,c),i.write_shift(4,f))}var m=i.l;return i.l=l,i.write_shift(4,o),i.l=m,i.length>i.l?i.slice(0,i.l):i}function J_(r,e,t,i){var n=q_(i,t,e);(n.length>17||(e["!rows"]||[])[i])&&X(r,0,n)}var Z_=qr,e2=An;function t2(){}function i2(r,e){var t={},i=r[r.l];return++r.l,t.above=!(i&64),t.left=!(i&128),r.l+=18,t.name=Qx(r),t}function r2(r,e,t){t==null&&(t=H(84+4*r.length));var i=192;e&&(e.above&&(i&=-65),e.left&&(i&=-129)),t.write_shift(1,i);for(var n=1;n<3;++n)t.write_shift(1,0);return pa({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),hd(r,t),t.slice(0,t.l)}function n2(r){var e=pi(r);return[e]}function s2(r,e,t){return t==null&&(t=H(8)),$r(e,t)}function a2(r){var e=Kr(r);return[e]}function o2(r,e,t){return t==null&&(t=H(4)),Qr(e,t)}function l2(r){var e=pi(r),t=r.read_shift(1);return[e,t,"b"]}function h2(r,e,t){return t==null&&(t=H(9)),$r(e,t),t.write_shift(1,r.v?1:0),t}function u2(r){var e=Kr(r),t=r.read_shift(1);return[e,t,"b"]}function c2(r,e,t){return t==null&&(t=H(5)),Qr(e,t),t.write_shift(1,r.v?1:0),t}function d2(r){var e=pi(r),t=r.read_shift(1);return[e,t,"e"]}function mo(r,e,t){return t==null&&(t=H(9)),$r(e,t),t.write_shift(1,r.v),t}function f2(r){var e=Kr(r),t=r.read_shift(1);return[e,t,"e"]}function go(r,e,t){return t==null&&(t=H(8)),Qr(e,t),t.write_shift(1,r.v),t.write_shift(2,0),t.write_shift(1,0),t}function p2(r){var e=pi(r),t=r.read_shift(4);return[e,t,"s"]}function m2(r,e,t){return t==null&&(t=H(12)),$r(e,t),t.write_shift(4,e.v),t}function g2(r){var e=Kr(r),t=r.read_shift(4);return[e,t,"s"]}function v2(r,e,t){return t==null&&(t=H(8)),Qr(e,t),t.write_shift(4,e.v),t}function b2(r){var e=pi(r),t=On(r);return[e,t,"n"]}function w2(r,e,t){return t==null&&(t=H(16)),$r(e,t),Yr(r.v,t),t}function x2(r){var e=Kr(r),t=On(r);return[e,t,"n"]}function y2(r,e,t){return t==null&&(t=H(12)),Qr(e,t),Yr(r.v,t),t}function E2(r){var e=pi(r),t=Bl(r);return[e,t,"n"]}function C2(r,e,t){return t==null&&(t=H(12)),$r(e,t),ud(r.v,t),t}function _2(r){var e=Kr(r),t=Bl(r);return[e,t,"n"]}function T2(r,e,t){return t==null&&(t=H(8)),Qr(e,t),ud(r.v,t),t}function S2(r){var e=pi(r),t=Nl(r);return[e,t,"is"]}function D2(r){var e=pi(r),t=Wt(r);return[e,t,"str"]}function k2(r,e,t){var i=r.v==null?"":String(r.v);return t==null&&(t=H(12+4*r.v.length)),$r(e,t),Ct(i,t),t.length>t.l?t.slice(0,t.l):t}function R2(r){var e=Kr(r),t=Wt(r);return[e,t,"str"]}function F2(r,e,t){var i=r.v==null?"":String(r.v);return t==null&&(t=H(8+4*i.length)),Qr(e,t),Ct(i,t),t.length>t.l?t.slice(0,t.l):t}function M2(r,e,t){var i=r.l+e,n=pi(r);n.r=t["!row"];var s=r.read_shift(1),a=[n,s,"b"];if(t.cellFormula){r.l+=2;var o=Ya(r,i-r.l,t);a[3]=Dn(o,null,n,t.supbooks,t)}else r.l=i;return a}function A2(r,e,t){var i=r.l+e,n=pi(r);n.r=t["!row"];var s=r.read_shift(1),a=[n,s,"e"];if(t.cellFormula){r.l+=2;var o=Ya(r,i-r.l,t);a[3]=Dn(o,null,n,t.supbooks,t)}else r.l=i;return a}function O2(r,e,t){var i=r.l+e,n=pi(r);n.r=t["!row"];var s=On(r),a=[n,s,"n"];if(t.cellFormula){r.l+=2;var o=Ya(r,i-r.l,t);a[3]=Dn(o,null,n,t.supbooks,t)}else r.l=i;return a}function L2(r,e,t){var i=r.l+e,n=pi(r);n.r=t["!row"];var s=Wt(r),a=[n,s,"str"];if(t.cellFormula){r.l+=2;var o=Ya(r,i-r.l,t);a[3]=Dn(o,null,n,t.supbooks,t)}else r.l=i;return a}var P2=qr,N2=An;function I2(r,e){return e==null&&(e=H(4)),e.write_shift(4,r),e}function B2(r,e){var t=r.l+e,i=qr(r),n=Wa(r),s=Wt(r),a=Wt(r),o=Wt(r);r.l=t;var l={rfx:i,relId:n,loc:s,display:o};return a&&(l.Tooltip=a),l}function H2(r,e){var t=H(50+4*(r[1].Target.length+(r[1].Tooltip||"").length));An({s:lt(r[0]),e:lt(r[0])},t),Il("rId"+e,t);var i=r[1].Target.indexOf("#"),n=i==-1?"":r[1].Target.slice(i+1);return Ct(n||"",t),Ct(r[1].Tooltip||"",t),Ct("",t),t.slice(0,t.l)}function z2(){}function W2(r,e,t){var i=r.l+e,n=cd(r),s=r.read_shift(1),a=[n];if(a[2]=s,t.cellFormula){var o=x_(r,i-r.l,t);a[1]=o}else r.l=i;return a}function V2(r,e,t){var i=r.l+e,n=qr(r),s=[n];if(t.cellFormula){var a=E_(r,i-r.l,t);s[1]=a,r.l=i}else r.l=i;return s}function U2(r,e,t){t==null&&(t=H(18));var i=ja(r,e);t.write_shift(-4,r),t.write_shift(-4,r),t.write_shift(4,(i.width||10)*256),t.write_shift(4,0);var n=0;return e.hidden&&(n|=1),typeof i.width=="number"&&(n|=2),e.level&&(n|=e.level<<8),t.write_shift(2,n),t}var Yd=["left","right","top","bottom","header","footer"];function G2(r){var e={};return Yd.forEach(function(t){e[t]=On(r)}),e}function Y2(r,e){return e==null&&(e=H(6*8)),Gd(r),Yd.forEach(function(t){Yr(r[t],e)}),e}function j2(r){var e=r.read_shift(2);return r.l+=28,{RTL:e&32}}function X2(r,e,t){t==null&&(t=H(30));var i=924;return(((e||{}).Views||[])[0]||{}).RTL&&(i|=32),t.write_shift(2,i),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function $2(r){var e=H(24);return e.write_shift(4,4),e.write_shift(4,1),An(r,e),e}function K2(r,e){return e==null&&(e=H(16*4+2)),e.write_shift(2,r.password?kd(r.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,r[t[0]]!=null&&!r[t[0]]?1:0):e.write_shift(4,r[t[0]]!=null&&r[t[0]]?0:1)}),e}function Q2(){}function q2(){}function J2(r,e,t,i,n,s,a,o){var l={r:t,c:i};if(e.c&&s["!comments"].push([ct(l),e.c]),e.v===void 0)return!1;var h="";switch(e.t){case"b":h=e.v?"1":"0";break;case"d":e=Vt(e),e.z=e.z||rt[14],e.v=Mt(Zt(e.v,o),o),e.t="n";break;case"n":case"e":h=""+e.v;break;default:h=e.v;break}switch(l.s=Er(n.cellXfs,e,n),e.l&&s["!links"].push([ct(l),e.l]),e.t){case"s":case"str":return n.bookSST?(h=Vl(n.Strings,e.v==null?"":String(e.v),n.revStrings),l.t="s",l.v=h,a?X(r,18,v2(e,l)):X(r,7,m2(e,l))):(l.t="str",a?X(r,17,F2(e,l)):X(r,6,k2(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?X(r,13,T2(e,l)):X(r,2,C2(e,l)):isFinite(e.v)?a?X(r,16,y2(e,l)):X(r,5,w2(e,l)):(l.t="e",isNaN(e.v)?a?X(r,14,go({v:36},l)):X(r,3,mo({v:36},l)):a?X(r,14,go({v:7},l)):X(r,3,mo({v:7},l))),!0;case"b":return l.t="b",a?X(r,15,c2(e,l)):X(r,4,h2(e,l)),!0;case"e":return l.t="e",a?X(r,14,go(e,l)):X(r,3,mo(e,l)),!0}return a?X(r,12,o2(e,l)):X(r,1,s2(e,l)),!0}function Z2(r,e,t,i,n){var s=nt(e["!ref"]||"A1"),a="",o=[],l=(((n||{}).Workbook||{}).WBProps||{}).date1904;X(r,145);var h=e["!data"]!=null,u=h?e["!data"][s.s.r]:[],d=s.e.r;e["!rows"]&&(d=Math.max(s.e.r,e["!rows"].length-1));for(var c=s.s.r;c<=d;++c)if(a=qe(c),h&&(u=e["!data"][c]),J_(r,e,s,c),!(h&&!u)){var f=!1;if(c<=s.e.r)for(var p=s.s.c;p<=s.e.c;++p){c===s.s.r&&(o[p]=$e(p));var v=h?u[p]:e[o[p]+a];if(!v){f=!1;continue}f=J2(r,v,c,p,i,e,f,l)}}X(r,146)}function eT(r,e){!e||!e["!merges"]||(X(r,177,I2(e["!merges"].length)),e["!merges"].forEach(function(t){X(r,176,N2(t))}),X(r,178))}function tT(r,e){!e||!e["!cols"]||(X(r,390),e["!cols"].forEach(function(t,i){t&&X(r,60,U2(i,t))}),X(r,391))}function iT(r,e){!e||!e["!ref"]||(X(r,648),X(r,649,$2(nt(e["!ref"]))),X(r,650))}function rT(r,e,t){e["!links"].forEach(function(i){if(i[1].Target){var n=We(t,-1,i[1].Target.replace(/#[\s\S]*$/,""),Pe.HLINK);X(r,494,H2(i,n))}}),delete e["!links"]}function nT(r,e,t,i){if(e["!comments"].length>0){var n=We(i,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Pe.VML);X(r,551,Il("rId"+n)),e["!legacy"]=n}}function sT(r,e,t,i){if(e["!autofilter"]){var n=e["!autofilter"],s=typeof n.ref=="string"?n.ref:yt(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var a=t.Workbook.Names,o=Ft(s);o.s.r==o.e.r&&(o.e.r=Ft(e["!ref"]).e.r,s=yt(o));for(var l=0;l<a.length;++l){var h=a[l];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==i){h.Ref=os(t.SheetNames[i])+"!"+as(s);break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:os(t.SheetNames[i])+"!"+as(s)}),X(r,161,An(nt(s))),X(r,162)}}function aT(r,e,t){X(r,133),X(r,137,X2(e,t)),X(r,138),X(r,134)}function oT(r,e){e["!protect"]&&X(r,535,K2(e["!protect"]))}function lT(r,e,t,i){var n=zt(),s=t.SheetNames[r],a=t.Sheets[s]||{},o=s;try{t&&t.Workbook&&(o=t.Workbook.Sheets[r].CodeName||o)}catch{}var l=nt(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],X(n,129),(t.vbaraw||a["!outline"])&&X(n,147,r2(o,a["!outline"])),X(n,148,e2(l)),aT(n,a,t.Workbook),tT(n,a),Z2(n,a,r,e,t),oT(n,a),sT(n,a,t,r),eT(n,a),rT(n,a,i),a["!margins"]&&X(n,476,Y2(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&iT(n,a),nT(n,a,r,i),X(n,130),n.end()}function hT(r,e){r.l+=10;var t=Wt(r);return{name:t}}var uT=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function cT(r){return!r.Workbook||!r.Workbook.WBProps?"false":Dx(r.Workbook.WBProps.date1904)?"true":"false"}var dT=":][*?/\\".split("");function jd(r,e){try{if(r=="")throw new Error("Sheet name cannot be blank");if(r.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(r.charCodeAt(0)==39||r.charCodeAt(r.length-1)==39)throw new Error("Sheet name cannot start or end with apostrophe (')");if(r.toLowerCase()=="history")throw new Error("Sheet name cannot be 'History'");dT.forEach(function(t){if(r.indexOf(t)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}catch(t){throw t}return!0}function fT(r,e,t){r.forEach(function(i,n){jd(i);for(var s=0;s<n;++s)if(i==r[s])throw new Error("Duplicate Sheet Name: "+i);if(t){var a=e&&e[n]&&e[n].CodeName||i;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function pT(r){if(!r||!r.SheetNames||!r.Sheets)throw new Error("Invalid Workbook");if(!r.SheetNames.length)throw new Error("Workbook is empty");var e=r.Workbook&&r.Workbook.Sheets||[];fT(r.SheetNames,e,!!r.vbaraw);for(var t=0;t<r.SheetNames.length;++t)I_(r.Sheets[r.SheetNames[t]],r.SheetNames[t],t);r.SheetNames.forEach(function(i,n){var s=r.Sheets[i];if(!(!s||!s["!autofilter"])){var a;r.Workbook||(r.Workbook={}),r.Workbook.Names||(r.Workbook.Names=[]),r.Workbook.Names.forEach(function(l){l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n&&(a=l)});var o=os(i)+"!"+as(s["!autofilter"].ref);a?a.Ref=o:r.Workbook.Names.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:o})}})}function mT(r){var e=[Et];e[e.length]=Z("workbook",null,{xmlns:Rn[0],"xmlns:r":Tt.r});var t=r.Workbook&&(r.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};r.Workbook&&r.Workbook.WBProps&&(uT.forEach(function(o){r.Workbook.WBProps[o[0]]!=null&&r.Workbook.WBProps[o[0]]!=o[1]&&(i[o[0]]=r.Workbook.WBProps[o[0]])}),r.Workbook.WBProps.CodeName&&(i.codeName=r.Workbook.WBProps.CodeName,delete i.CodeName)),e[e.length]=Z("workbookPr",null,i);var n=r.Workbook&&r.Workbook.Sheets||[],s=0;if(n&&n[0]&&n[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=r.SheetNames.length&&!(!n[s]||!n[s].Hidden);++s);s==r.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=r.SheetNames.length;++s){var a={name:Se(r.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),n[s])switch(n[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=Z("sheet",null,a)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",r.Workbook&&r.Workbook.Names&&r.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=Z("definedName",Se(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function gT(r,e){var t={};return t.Hidden=r.read_shift(4),t.iTabID=r.read_shift(4),t.strRelID=sl(r),t.name=Wt(r),t}function vT(r,e){return e||(e=H(127)),e.write_shift(4,r.Hidden),e.write_shift(4,r.iTabID),Il(r.strRelID,e),Ct(r.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function bT(r,e){var t={},i=r.read_shift(4);t.defaultThemeVersion=r.read_shift(4);var n=e>8?Wt(r):"";return n.length>0&&(t.CodeName=n),t.autoCompressPictures=!!(i&65536),t.backupFile=!!(i&64),t.checkCompatibility=!!(i&4096),t.date1904=!!(i&1),t.filterPrivacy=!!(i&8),t.hidePivotFieldList=!!(i&1024),t.promptedSolutions=!!(i&16),t.publishItems=!!(i&2048),t.refreshAllConnections=!!(i&262144),t.saveExternalLinkValues=!!(i&128),t.showBorderUnselectedTables=!!(i&4),t.showInkAnnotation=!!(i&32),t.showObjects=["all","placeholders","none"][i>>13&3],t.showPivotChartFilter=!!(i&32768),t.updateLinks=["userSet","never","always"][i>>8&3],t}function wT(r,e){e||(e=H(72));var t=0;return r&&(r.date1904&&(t|=1),r.filterPrivacy&&(t|=8)),e.write_shift(4,t),e.write_shift(4,0),hd(r&&r.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function xT(r,e,t){var i=r.l+e,n=r.read_shift(4);r.l+=1;var s=r.read_shift(4),a=qx(r),o,l="";try{o=y_(r,0,t);try{l=Wa(r)}catch{}}catch{console.error("Could not parse defined name "+a)}n&32&&(a="_xlnm."+a),r.l=i;var h={Name:a,Ptg:o,Flags:n};return s<268435455&&(h.Sheet=s),l&&(h.Comment=l),h}function yT(r,e){var t=H(9),i=0,n=r.Name;hy.indexOf(n)>-1&&(i|=32,n=n.slice(6)),t.write_shift(4,i),t.write_shift(1,0),t.write_shift(4,r.Sheet==null?4294967295:r.Sheet);var s=[t,Ct(n),O_(r.Ref,e)];if(r.Comment)s.push(ls(r.Comment));else{var a=H(4);a.write_shift(4,4294967295),s.push(a)}return wt(s)}function ET(r,e){X(r,143);for(var t=0;t!=e.SheetNames.length;++t){var i=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,n={Hidden:i,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};X(r,156,vT(n))}X(r,144)}function CT(r,e){e||(e=H(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return Ct("SheetJS",e),Ct(sa.version,e),Ct(sa.version,e),Ct("7262",e),e.length>e.l?e.slice(0,e.l):e}function _T(r,e){e||(e=H(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,r),e.write_shift(4,r);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function TT(r,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,i=0,n=-1,s=-1;i<t.length;++i)!t[i]||!t[i].Hidden&&n==-1?n=i:t[i].Hidden==1&&s==-1&&(s=i);s>n||(X(r,135),X(r,158,_T(n)),X(r,136))}}function ST(r,e){!e.Workbook||!e.Workbook.Names||e.Workbook.Names.forEach(function(t){try{if(t.Flags&14)return;X(r,39,yT(t,e))}catch{console.error("Could not serialize defined name "+JSON.stringify(t))}})}function DT(r){var e=r.SheetNames.length,t=H(12*e+28);t.write_shift(4,e+2),t.write_shift(4,0),t.write_shift(4,-2),t.write_shift(4,-2),t.write_shift(4,0),t.write_shift(4,-1),t.write_shift(4,-1);for(var i=0;i<e;++i)t.write_shift(4,0),t.write_shift(4,i),t.write_shift(4,i);return t}function kT(r,e){X(r,353),X(r,357),X(r,362,DT(e)),X(r,354)}function RT(r,e){var t=zt();return X(t,131),X(t,128,CT()),X(t,153,wT(r.Workbook&&r.Workbook.WBProps||null)),TT(t,r),ET(t,r),kT(t,r),(r.Workbook||{}).Names&&ST(t,r),X(t,132),t.end()}function FT(r,e){var t=[];return r.Props&&t.push(py(r.Props,e)),r.Custprops&&t.push(my(r.Props,r.Custprops)),t.join("")}function MT(r){return(((r||{}).Workbook||{}).WBProps||{}).date1904?'<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel"><Date1904/></ExcelWorkbook>':""}function AT(r,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(i,n){var s=[];s.push(Z("NumberFormat",null,{"ss:Format":Se(rt[i.numFmtId])}));var a={"ss:ID":"s"+(21+n)};t.push(Z("Style",s.join(""),a))}),Z("Styles",t.join(""))}function Xd(r){return Z("NamedRange",null,{"ss:Name":r.Name.slice(0,6)=="_xlnm."?r.Name.slice(6):r.Name,"ss:RefersTo":"="+Ua(r.Ref,{r:0,c:0})})}function OT(r){if(!((r||{}).Workbook||{}).Names)return"";for(var e=r.Workbook.Names,t=[],i=0;i<e.length;++i){var n=e[i];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||t.push(Xd(n)))}return Z("Names",t.join(""))}function LT(r,e,t,i){if(!r||!((i||{}).Workbook||{}).Names)return"";for(var n=i.Workbook.Names,s=[],a=0;a<n.length;++a){var o=n[a];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||s.push(Xd(o)))}return s.join("")}function PT(r,e,t,i){if(!r)return"";var n=[];if(r["!margins"]&&(n.push("<PageSetup>"),r["!margins"].header&&n.push(Z("Header",null,{"x:Margin":r["!margins"].header})),r["!margins"].footer&&n.push(Z("Footer",null,{"x:Margin":r["!margins"].footer})),n.push(Z("PageMargins",null,{"x:Bottom":r["!margins"].bottom||"0.75","x:Left":r["!margins"].left||"0.7","x:Right":r["!margins"].right||"0.7","x:Top":r["!margins"].top||"0.75"})),n.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[t])if(i.Workbook.Sheets[t].Hidden)n.push(Z("Visible",i.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(i.Workbook.Sheets[s]&&!i.Workbook.Sheets[s].Hidden);++s);s==t&&n.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),r["!protect"]&&(n.push(kt("ProtectContents","True")),r["!protect"].objects&&n.push(kt("ProtectObjects","True")),r["!protect"].scenarios&&n.push(kt("ProtectScenarios","True")),r["!protect"].selectLockedCells!=null&&!r["!protect"].selectLockedCells?n.push(kt("EnableSelection","NoSelection")):r["!protect"].selectUnlockedCells!=null&&!r["!protect"].selectUnlockedCells&&n.push(kt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){r["!protect"][a[0]]&&n.push("<"+a[1]+"/>")})),n.length==0?"":Z("WorksheetOptions",n.join(""),{xmlns:ri.x})}function NT(r){return r.map(function(e){var t=Sx(e.t||""),i=Z("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"}),n={};return e.a&&(n["ss:Author"]=e.a),r.hidden||(n["ss:ShowAlways"]="1"),Z("Comment",i,n)}).join("")}function IT(r,e,t,i,n,s,a){if(!r||r.v==null&&r.f==null)return"";var o={};if(r.f&&(o["ss:Formula"]="="+Se(Ua(r.f,a))),r.F&&r.F.slice(0,e.length)==e){var l=lt(r.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(r.l&&r.l.Target&&(o["ss:HRef"]=Se(r.l.Target),r.l.Tooltip&&(o["x:HRefScreenTip"]=Se(r.l.Tooltip))),t["!merges"])for(var h=t["!merges"],u=0;u!=h.length;++u)h[u].s.c!=a.c||h[u].s.r!=a.r||(h[u].e.c>h[u].s.c&&(o["ss:MergeAcross"]=h[u].e.c-h[u].s.c),h[u].e.r>h[u].s.r&&(o["ss:MergeDown"]=h[u].e.r-h[u].s.r));var d="",c="";switch(r.t){case"z":if(!i.sheetStubs)return"";break;case"n":isFinite(r.v)?(d="Number",c=String(r.v)):(d="Error",c=Qt[isNaN(r.v)?36:7]);break;case"b":d="Boolean",c=r.v?"1":"0";break;case"e":d="Error",c=Qt[r.v];break;case"d":d="DateTime",c=new Date(r.v).toISOString(),r.z==null&&(r.z=r.z||rt[14]);break;case"s":d="String",c=Tx(r.v||"");break}var f=Er(i.cellXfs,r,i);o["ss:StyleID"]="s"+(21+f),o["ss:Index"]=a.c+1;var p=r.v!=null?c:"",v=r.t=="z"?"":'<Data ss:Type="'+d+'">'+p+"</Data>";return(r.c||[]).length>0&&(v+=NT(r.c)),Z("Cell",v,o)}function BT(r,e){var t='<Row ss:Index="'+(r+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Fd(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function HT(r,e,t,i){if(!r["!ref"])return"";var n=nt(r["!ref"]),s=r["!merges"]||[],a=0,o=[];r["!cols"]&&r["!cols"].forEach(function(m,g){zl(m);var x=!!m.width,b=ja(g,m),F={"ss:Index":g+1};x&&(F["ss:Width"]=ga(b.width)),m.hidden&&(F["ss:Hidden"]="1"),o.push(Z("Column",null,F))});for(var l=r["!data"]!=null,h={r:0,c:0},u=n.s.r;u<=n.e.r;++u){var d=[BT(u,(r["!rows"]||[])[u])];h.r=u;for(var c=n.s.c;c<=n.e.c;++c){h.c=c;var f=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>c)&&!(s[a].s.r>u)&&!(s[a].e.c<c)&&!(s[a].e.r<u)){(s[a].s.c!=c||s[a].s.r!=u)&&(f=!0);break}if(!f){var p=$e(c)+qe(u),v=l?(r["!data"][u]||[])[c]:r[p];d.push(IT(v,p,r,e,t,i,h))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function zT(r,e,t){var i=[],n=t.SheetNames[r],s=t.Sheets[n],a=s?LT(s,e,r,t):"";return a.length>0&&i.push("<Names>"+a+"</Names>"),a=s?HT(s,e,r,t):"",a.length>0&&i.push("<Table>"+a+"</Table>"),i.push(PT(s,e,r,t)),s&&s["!autofilter"]&&i.push('<AutoFilter x:Range="'+Ua(as(s["!autofilter"].ref),{r:0,c:0})+'" xmlns="urn:schemas-microsoft-com:office:excel"></AutoFilter>'),i.join("")}function WT(r,e){e||(e={}),r.SSF||(r.SSF=Vt(rt)),r.SSF&&(Ba(),Ia(r.SSF),e.revssf=Ha(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF,e.cellXfs=[],Er(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(FT(r,e)),t.push(MT(r)),t.push(""),t.push(OT(r));for(var i=0;i<r.SheetNames.length;++i)t.push(Z("Worksheet",zT(i,e,r),{"ss:Name":Se(r.SheetNames[i])}));return t[2]=AT(r,e),Et+Z("Workbook",t.join(""),{xmlns:ri.ss,"xmlns:o":ri.o,"xmlns:x":ri.x,"xmlns:ss":ri.ss,"xmlns:dt":ri.dt,"xmlns:html":ri.html})}var vo={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function VT(r,e){var t=[],i=[],n=[],s=0,a,o=jh(ru,"n"),l=jh(nu,"n");if(r.Props)for(a=xt(r.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?i:n).push([a[s],r.Props[a[s]]]);if(r.Custprops)for(a=xt(r.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(r.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(l,a[s])?i:n).push([a[s],r.Custprops[a[s]]]);var h=[];for(s=0;s<n.length;++s)yd.indexOf(n[s][0])>-1||bd.indexOf(n[s][0])>-1||n[s][1]!=null&&h.push(n[s]);i.length&&Ze.utils.cfb_add(e,"/SummaryInformation",hu(i,vo.SI,l,nu)),(t.length||h.length)&&Ze.utils.cfb_add(e,"/DocumentSummaryInformation",hu(t,vo.DSI,o,ru,h.length?h:null,vo.UDI))}function UT(r,e){var t=e||{},i=Ze.utils.cfb_new({root:"R"}),n="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":n="/Workbook",t.biff=8;break;case"biff5":n="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Ze.utils.cfb_add(i,n,Kd(r,t)),t.biff==8&&(r.Props||r.Custprops)&&VT(r,i),t.biff==8&&r.vbaraw&&ZE(i,Ze.read(r.vbaraw,{type:typeof r.vbaraw=="string"?"binary":"buffer"})),i}var GT={0:{f:Q_},1:{f:n2},2:{f:E2},3:{f:d2},4:{f:l2},5:{f:b2},6:{f:D2},7:{f:p2},8:{f:L2},9:{f:O2},10:{f:M2},11:{f:A2},12:{f:a2},13:{f:_2},14:{f:f2},15:{f:u2},16:{f:x2},17:{f:R2},18:{f:g2},19:{f:Nl},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:xT},40:{},42:{},43:{f:bE},44:{f:gE},45:{f:yE},46:{f:CE},47:{f:EE},48:{},49:{f:Gx},50:{},51:{f:HE},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:$y},62:{f:S2},63:{f:jE},64:{f:Q2},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ii,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:j2},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:i2},148:{f:Z_,p:16},151:{f:z2},152:{},153:{f:bT},154:{},155:{},156:{f:gT},157:{},158:{},159:{T:1,f:sE},160:{T:-1},161:{T:1,f:qr},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:P2},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:IE},336:{T:-1},337:{f:VE,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:sl},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Uy},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:W2},427:{f:V2},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:G2},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:t2},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:B2},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:sl},551:{f:Wa},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:qE},633:{T:1},634:{T:-1},635:{T:1,f:KE},636:{T:-1},637:{f:$x},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:hT},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:q2},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Q(r,e,t,i){var n=e;if(!isNaN(n)){var s=i||(t||[]).length||0,a=r.next(4);a.write_shift(2,n),a.write_shift(2,s),s>0&&Ol(t)&&r.push(t)}}function YT(r,e,t,i){var n=(t||[]).length||0;if(n<=8224)return Q(r,e,t,n);var s=e;if(!isNaN(s)){for(var a=t.parts||[],o=0,l=0,h=0;h+(a[o]||8224)<=8224;)h+=a[o]||8224,o++;var u=r.next(4);for(u.write_shift(2,s),u.write_shift(2,h),r.push(t.slice(l,l+h)),l+=h;l<n;){for(u=r.next(4),u.write_shift(2,60),h=0;h+(a[o]||8224)<=8224;)h+=a[o]||8224,o++;u.write_shift(2,h),r.push(t.slice(l,l+h)),l+=h}}}function bo(r,e,t,i){var n=H(9);return bs(n,r,e),Ed(t,i||"b",n),n}function jT(r,e,t){var i=H(8+2*t.length);return bs(i,r,e),i.write_shift(1,t.length),i.write_shift(t.length,t,"sbcs"),i.l<i.length?i.slice(0,i.l):i}function $d(r,e){e.forEach(function(t){var i=t[0].map(function(s){return s.t}).join("");if(i.length<=2048)return Q(r,28,fo(i,t[1],t[2]));Q(r,28,fo(i.slice(0,2048),t[1],t[2],i.length));for(var n=2048;n<i.length;n+=2048)Q(r,28,fo(i.slice(n,Math.min(n+2048,i.length)),-1,-1,Math.min(2048,i.length-n)))})}function XT(r,e,t,i,n,s){var a=0;e.z!=null&&(a=n._BIFF2FmtTable.indexOf(e.z),a==-1&&(n._BIFF2FmtTable.push(e.z),a=n._BIFF2FmtTable.length-1));var o=0;if(e.z!=null){for(;o<n.cellXfs.length&&n.cellXfs[o].numFmtId!=a;++o);o==n.cellXfs.length&&n.cellXfs.push({numFmtId:a})}if(e.v!=null)switch(e.t){case"d":case"n":var l=e.t=="d"?Mt(Zt(e.v,s),s):e.v;n.biff==2&&l==(l|0)&&l>=0&&l<65536?Q(r,2,Jy(t,i,l,o,a)):isNaN(l)?Q(r,5,bo(t,i,36,"e")):isFinite(l)?Q(r,3,qy(t,i,l,o,a)):Q(r,5,bo(t,i,7,"e"));return;case"b":case"e":Q(r,5,bo(t,i,e.v,e.t));return;case"s":case"str":Q(r,4,jT(t,i,e.v==null?"":String(e.v).slice(0,255)));return}Q(r,1,bs(null,t,i))}function $T(r,e,t,i,n){var s=e["!data"]!=null,a=nt(e["!ref"]||"A1"),o="",l=[];if(a.e.c>255||a.e.r>16383){if(i.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.r,16383)}for(var h=(((n||{}).Workbook||{}).WBProps||{}).date1904,u=[],d=[],c=a.s.c;c<=a.e.c;++c)l[c]=$e(c);for(var f=a.s.r;f<=a.e.r;++f)for(s&&(u=e["!data"][f]||[]),o=qe(f),c=a.s.c;c<=a.e.c;++c){var p=s?u[c]:e[l[c]+o];p&&(XT(r,p,f,c,i,h),p.c&&d.push([p.c,f,c]))}$d(r,d)}function KT(r,e){for(var t=e||{},i=zt(),n=0,s=0;s<r.SheetNames.length;++s)r.SheetNames[s]==t.sheet&&(n=s);if(n==0&&t.sheet&&r.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);Q(i,t.biff==4?1033:t.biff==3?521:9,Hl(r,16,t)),((r.Workbook||{}).WBProps||{}).date1904&&Q(i,34,Nt(!0)),t.cellXfs=[{numFmtId:0}],t._BIFF2FmtTable=["General"],t._Fonts=[];var a=zt();return $T(a,r.Sheets[r.SheetNames[n]],n,t,r),t._BIFF2FmtTable.forEach(function(o){t.biff<=3?Q(i,30,Ny(o)):Q(i,1054,Iy(o))}),t.cellXfs.forEach(function(o){switch(t.biff){case 2:Q(i,67,Hy(o));break;case 3:Q(i,579,Sd(o));break;case 4:Q(i,1091,zy(o));break}}),delete t._BIFF2FmtTable,delete t.cellXfs,delete t._Fonts,i.push(a.end()),Q(i,10),i.end()}var mi=1,li=[];function QT(){var r=H(82+8*li.length);r.write_shift(2,15),r.write_shift(2,61440),r.write_shift(4,74+8*li.length);{r.write_shift(2,0),r.write_shift(2,61446),r.write_shift(4,16+8*li.length);{r.write_shift(4,mi),r.write_shift(4,li.length+1);for(var e=0,t=0;t<li.length;++t)e+=li[t]&&li[t][1]||0;r.write_shift(4,e),r.write_shift(4,li.length)}li.forEach(function(i){r.write_shift(4,i[0]),r.write_shift(4,i[2])})}return r.write_shift(2,51),r.write_shift(2,61451),r.write_shift(4,18),r.write_shift(2,191),r.write_shift(4,524296),r.write_shift(2,385),r.write_shift(4,134217793),r.write_shift(2,448),r.write_shift(4,134217792),r.write_shift(2,64),r.write_shift(2,61726),r.write_shift(4,16),r.write_shift(4,134217741),r.write_shift(4,134217740),r.write_shift(4,134217751),r.write_shift(4,268435703),r}function qT(r,e){var t=[],i=0,n=zt(),s=mi,a;e.forEach(function(l,h){var u="",d=l[0].map(function(b){return b.a&&!u&&(u=b.a),b.t}).join("");++mi;{var c=H(150);c.write_shift(2,15),c.write_shift(2,61444),c.write_shift(4,150),c.write_shift(2,3234),c.write_shift(2,61450),c.write_shift(4,8),c.write_shift(4,mi),c.write_shift(4,2560),c.write_shift(2,227),c.write_shift(2,61451),c.write_shift(4,84),c.write_shift(2,128),c.write_shift(4,0),c.write_shift(2,139),c.write_shift(4,2),c.write_shift(2,191),c.write_shift(4,524296),c.write_shift(2,344),c.l+=4,c.write_shift(2,385),c.write_shift(4,134217808),c.write_shift(2,387),c.write_shift(4,134217808),c.write_shift(2,389),c.write_shift(4,268435700),c.write_shift(2,447),c.write_shift(4,1048592),c.write_shift(2,448),c.write_shift(4,134217809),c.write_shift(2,451),c.write_shift(4,268435700),c.write_shift(2,513),c.write_shift(4,134217809),c.write_shift(2,515),c.write_shift(4,268435700),c.write_shift(2,575),c.write_shift(4,196609),c.write_shift(2,959),c.write_shift(4,131072|(l[0].hidden?2:0)),c.l+=2,c.write_shift(2,61456),c.write_shift(4,18),c.write_shift(2,3),c.write_shift(2,l[2]+2),c.l+=2,c.write_shift(2,l[1]+1),c.l+=2,c.write_shift(2,l[2]+4),c.l+=2,c.write_shift(2,l[1]+5),c.l+=2,c.l+=2,c.write_shift(2,61457),c.l+=4,c.l=150,h==0?a=c:Q(n,236,c)}i+=150;{var f=H(52);f.write_shift(2,21),f.write_shift(2,18),f.write_shift(2,25),f.write_shift(2,mi),f.write_shift(2,0),f.l=22,f.write_shift(2,13),f.write_shift(2,22),f.write_shift(4,1651663474),f.write_shift(4,2503426821),f.write_shift(4,2150634280),f.write_shift(4,1768515844+mi*256),f.write_shift(2,0),f.write_shift(4,0),f.l+=4,Q(n,93,f)}{var p=H(8);p.l+=2,p.write_shift(2,61453),p.l+=4,Q(n,236,p)}i+=8;{var v=H(18);v.write_shift(2,18),v.l+=8,v.write_shift(2,d.length),v.write_shift(2,16),v.l+=4,Q(n,438,v);{var m=H(1+d.length);m.write_shift(1,0),m.write_shift(d.length,d,"sbcs"),Q(n,60,m)}{var g=H(16);g.l+=8,g.write_shift(2,d.length),g.l+=6,Q(n,60,g)}}{var x=H(12+u.length);x.write_shift(2,l[1]),x.write_shift(2,l[2]),x.write_shift(2,0|(l[0].hidden?0:2)),x.write_shift(2,mi),x.write_shift(2,u.length),x.write_shift(1,0),x.write_shift(u.length,u,"sbcs"),x.l++,t.push(x)}});{var o=H(80);o.write_shift(2,15),o.write_shift(2,61442),o.write_shift(4,i+o.length-8),o.write_shift(2,16),o.write_shift(2,61448),o.write_shift(4,8),o.write_shift(4,e.length+1),o.write_shift(4,mi),o.write_shift(2,15),o.write_shift(2,61443),o.write_shift(4,i+48),o.write_shift(2,15),o.write_shift(2,61444),o.write_shift(4,40),o.write_shift(2,1),o.write_shift(2,61449),o.write_shift(4,16),o.l+=16,o.write_shift(2,2),o.write_shift(2,61450),o.write_shift(4,8),o.write_shift(4,s),o.write_shift(4,5),Q(r,236,a?wt([o,a]):o)}r.push(n.end()),t.forEach(function(l){Q(r,28,l)}),li.push([s,e.length+1,mi]),++mi}function JT(r,e,t){Q(r,49,Ay({sz:12,name:"Arial"},t))}function ZT(r,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var n=i[0];n<=i[1];++n)e[n]!=null&&Q(r,1054,Py(n,e[n],t))})}function eS(r,e){var t=H(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Q(r,2151,t),t=H(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),Td(nt(e["!ref"]||"A1"),t),t.write_shift(4,4),Q(r,2152,t)}function tS(r,e){for(var t=0;t<16;++t)Q(r,224,cu({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(i){Q(r,224,cu(i,0,e))})}function iS(r,e){for(var t=0;t<e["!links"].length;++t){var i=e["!links"][t];Q(r,440,Yy(i)),i[1].Tooltip&&Q(r,2048,jy(i))}delete e["!links"]}function rS(r,e){if(e){var t=0;e.forEach(function(i,n){++t<=256&&i&&Q(r,125,Ky(ja(n,i),n))})}}function nS(r,e,t,i,n,s){var a=16+Er(n.cellXfs,e,n);if(e.v==null&&!e.bf){Q(r,513,jr(t,i,a));return}if(e.bf)Q(r,6,w_(e,t,i,n,a));else switch(e.t){case"d":case"n":var o=e.t=="d"?Mt(Zt(e.v,s),s):e.v;isNaN(o)?Q(r,517,co(t,i,36,a,n,"e")):isFinite(o)?Q(r,515,Vy(t,i,o,a)):Q(r,517,co(t,i,7,a,n,"e"));break;case"b":case"e":Q(r,517,co(t,i,e.v,a,n,e.t));break;case"s":case"str":if(n.bookSST){var l=Vl(n.Strings,e.v==null?"":String(e.v),n.revStrings);Q(r,253,Oy(t,i,l,a))}else Q(r,516,Ly(t,i,(e.v==null?"":String(e.v)).slice(0,255),a,n));break;default:Q(r,513,jr(t,i,a))}}function sS(r,e,t){var i=zt(),n=t.SheetNames[r],s=t.Sheets[n]||{},a=(t||{}).Workbook||{},o=(a.Sheets||[])[r]||{},l=s["!data"]!=null,h=e.biff==8,u="",d=[],c=nt(s["!ref"]||"A1"),f=h?65536:16384;if(c.e.c>255||c.e.r>=f){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV"+f);c.e.c=Math.min(c.e.c,255),c.e.r=Math.min(c.e.r,f-1)}Q(i,2057,Hl(t,16,e)),Q(i,13,ui(1)),Q(i,12,ui(100)),Q(i,15,Nt(!0)),Q(i,17,Nt(!1)),Q(i,16,Yr(.001)),Q(i,95,Nt(!0)),Q(i,42,Nt(!1)),Q(i,43,Nt(!1)),Q(i,130,ui(1)),Q(i,128,Wy()),Q(i,131,Nt(!1)),Q(i,132,Nt(!1)),h&&rS(i,s["!cols"]),Q(i,512,By(c,e));var p=(((t||{}).Workbook||{}).WBProps||{}).date1904;h&&(s["!links"]=[]);for(var v=c.s.c;v<=c.e.c;++v)d[v]=$e(v);for(var m=[],g=[],x=c.s.r;x<=c.e.r;++x)for(l&&(g=s["!data"][x]||[]),u=qe(x),v=c.s.c;v<=c.e.c;++v){var b=l?g[v]:s[d[v]+u];b&&(nS(i,b,x,v,e,p),h&&b.l&&s["!links"].push([d[v]+u,b.l]),b.c&&m.push([b.c,x,v]))}var F=o.CodeName||o.name||n;return h?qT(i,m):$d(i,m),h&&Q(i,574,My((a.Views||[])[0])),h&&(s["!merges"]||[]).length&&Q(i,229,Gy(s["!merges"])),h&&iS(i,s),Q(i,442,_d(F)),h&&eS(i,s),Q(i,10),i.end()}function aS(r,e,t){var i=zt(),n=(r||{}).Workbook||{},s=n.Sheets||[],a=n.WBProps||{},o=t.biff==8,l=t.biff==5;if(Q(i,2057,Hl(r,5,t)),t.bookType=="xla"&&Q(i,135),Q(i,225,o?ui(1200):null),Q(i,193,by(2)),l&&Q(i,191),l&&Q(i,192),Q(i,226),Q(i,92,Dy("SheetJS",t)),Q(i,66,ui(o?1200:1252)),o&&Q(i,353,ui(0)),o&&Q(i,448),Q(i,317,Qy(r.SheetNames.length)),o&&r.vbaraw&&Q(i,211),o&&r.vbaraw){var h=a.CodeName||"ThisWorkbook";Q(i,442,_d(h))}Q(i,156,ui(17)),Q(i,25,Nt(!1)),Q(i,18,Nt(!1)),Q(i,19,ui(0)),o&&Q(i,431,Nt(!1)),o&&Q(i,444,ui(0)),Q(i,61,Fy()),Q(i,64,Nt(!1)),Q(i,141,ui(0)),Q(i,34,Nt(cT(r)=="true")),Q(i,14,Nt(!0)),o&&Q(i,439,Nt(!1)),Q(i,218,ui(0)),JT(i,r,t),ZT(i,r.SSF,t),tS(i,t),o&&Q(i,352,Nt(!1));var u=i.end(),d=zt();o&&Q(d,140,Xy()),o&&li.length&&Q(d,235,QT()),o&&t.Strings&&YT(d,252,Ry(t.Strings)),Q(d,10);var c=d.end(),f=zt(),p=0,v=0;for(v=0;v<r.SheetNames.length;++v)p+=(o?12:11)+(o?2:1)*r.SheetNames[v].length;var m=u.length+p+c.length;for(v=0;v<r.SheetNames.length;++v){var g=s[v]||{};Q(f,133,ky({pos:m,hs:g.Hidden||0,dt:0,name:r.SheetNames[v]},t)),m+=e[v].length}var x=f.end();if(p!=x.length)throw new Error("BS8 "+p+" != "+x.length);var b=[];return u.length&&b.push(u),x.length&&b.push(x),c.length&&b.push(c),wt(b)}function oS(r,e){var t=e||{},i=[];r&&!r.SSF&&(r.SSF=Vt(rt)),r&&r.SSF&&(Ba(),Ia(r.SSF),t.revssf=Ha(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF),mi=1,li=[],t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ul(t),t.cellXfs=[],Er(t.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={});for(var n=0;n<r.SheetNames.length;++n)i[i.length]=sS(n,t,r);return i.unshift(aS(r,i,t)),wt(i)}function Kd(r,e){for(var t=0;t<=r.SheetNames.length;++t){var i=r.Sheets[r.SheetNames[t]];if(!(!i||!i["!ref"])){var n=Ft(i["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+r.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost."),n.e.r>65535&&typeof console<"u"&&console.error&&console.error("Worksheet '"+r.SheetNames[t]+"' extends beyond row 65536.  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return oS(r,e);case 4:case 3:case 2:return KT(r,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function lS(r,e,t,i){for(var n=r["!merges"]||[],s=[],a={},o=r["!data"]!=null,l=e.s.c;l<=e.e.c;++l){for(var h=0,u=0,d=0;d<n.length;++d)if(!(n[d].s.r>t||n[d].s.c>l)&&!(n[d].e.r<t||n[d].e.c<l)){if(n[d].s.r<t||n[d].s.c<l){h=-1;break}h=n[d].e.r-n[d].s.r+1,u=n[d].e.c-n[d].s.c+1;break}if(!(h<0)){var c=$e(l)+qe(t),f=o?(r["!data"][t]||[])[l]:r[c];f&&f.t=="n"&&f.v!=null&&!isFinite(f.v)&&(isNaN(f.v)?f={t:"e",v:36,w:Qt[36]}:f={t:"e",v:7,w:Qt[7]});var p=f&&f.v!=null&&(f.h||oo(f.w||(ir(f),f.w)||""))||"";a={},h>1&&(a.rowspan=h),u>1&&(a.colspan=u),i.editable?p='<span contenteditable="true">'+p+"</span>":f&&(a["data-t"]=f&&f.t||"z",f.v!=null&&(a["data-v"]=oo(f.v instanceof Date?f.v.toISOString():f.v)),f.z!=null&&(a["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+oo(f.l.Target)+'">'+p+"</a>")),a.id=(i.id||"sjs")+"-"+c,s.push(Z("td",p,a))}}var v="<tr>";return v+s.join("")+"</tr>"}var hS='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',uS="</body></html>";function cS(r,e,t){var i=[];return i.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function Qd(r,e){var t=e||{},i=t.header!=null?t.header:hS,n=t.footer!=null?t.footer:uS,s=[i],a=Ft(r["!ref"]||"A1");if(s.push(cS(r,a,t)),r["!ref"])for(var o=a.s.r;o<=a.e.r;++o)s.push(lS(r,a,o,t));return s.push("</table>"+n),s.join("")}function qd(r,e,t){var i=e.rows;if(!i)throw"Unsupported origin when "+e.tagName+" is not a TABLE";var n=t||{},s=r["!data"]!=null,a=0,o=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?lt(n.origin):n.origin;a=l.r,o=l.c}var h=Math.min(n.sheetRows||1e7,i.length),u={s:{r:0,c:0},e:{r:a,c:o}};if(r["!ref"]){var d=Ft(r["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),a==-1&&(u.e.r=a=d.e.r+1)}var c=[],f=0,p=r["!rows"]||(r["!rows"]=[]),v=0,m=0,g=0,x=0,b=0,F=0;for(r["!cols"]||(r["!cols"]=[]);v<i.length&&m<h;++v){var A=i[v];if(Eu(A)){if(n.display)continue;p[m]={hidden:!0}}var _=A.cells;for(g=x=0;g<_.length;++g){var y=_[g];if(!(n.display&&Eu(y))){var R=y.hasAttribute("data-v")?y.getAttribute("data-v"):y.hasAttribute("v")?y.getAttribute("v"):kx(y.innerHTML),M=y.getAttribute("data-z")||y.getAttribute("z");for(f=0;f<c.length;++f){var I=c[f];I.s.c==x+o&&I.s.r<m+a&&m+a<=I.e.r&&(x=I.e.c+1-o,f=-1)}F=+y.getAttribute("colspan")||1,((b=+y.getAttribute("rowspan")||1)>1||F>1)&&c.push({s:{r:m+a,c:x+o},e:{r:m+a+(b||1)-1,c:x+o+(F||1)-1}});var P={t:"s",v:R},N=y.getAttribute("data-t")||y.getAttribute("t")||"";R!=null&&(R.length==0?P.t=N||"z":n.raw||R.trim().length==0||N=="s"||(N=="e"&&Qt[+R]?P={t:"e",v:+R,w:Qt[+R]}:R==="TRUE"?P={t:"b",v:!0}:R==="FALSE"?P={t:"b",v:!1}:isNaN(Ji(R))?isNaN(da(R).getDate())?R.charCodeAt(0)==35&&Li[R]!=null&&(P={t:"e",v:Li[R],w:R}):(P={t:"d",v:Zt(R)},n.UTC&&(P.v=za(P.v)),n.cellDates||(P={t:"n",v:Mt(P.v)}),P.z=n.dateNF||rt[14]):P={t:"n",v:Ji(R)})),P.z===void 0&&M!=null&&(P.z=M);var ne="",he=y.getElementsByTagName("A");if(he&&he.length)for(var se=0;se<he.length&&!(he[se].hasAttribute("href")&&(ne=he[se].getAttribute("href"),ne.charAt(0)!="#"));++se);ne&&ne.charAt(0)!="#"&&ne.slice(0,11).toLowerCase()!="javascript:"&&(P.l={Target:ne}),s?(r["!data"][m+a]||(r["!data"][m+a]=[]),r["!data"][m+a][x+o]=P):r[ct({c:x+o,r:m+a})]=P,u.e.c<x+o&&(u.e.c=x+o),x+=F}}++m}return c.length&&(r["!merges"]=(r["!merges"]||[]).concat(c)),u.e.r=Math.max(u.e.r,m-1+a),r["!ref"]=yt(u),m>=h&&(r["!fullref"]=yt((u.e.r=i.length-v+m-1+a,u))),r}function Jd(r,e){var t=e||{},i={};return t.dense&&(i["!data"]=[]),qd(i,r,e)}function dS(r,e){var t=Fn(Jd(r,e),e);return t}function Eu(r){var e="",t=fS(r);return t&&(e=t(r).getPropertyValue("display")),e||(e=r.style&&r.style.display),e==="none"}function fS(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var pS=function(){var r=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+ss({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+r+"</office:document-styles>";return function(){return Et+e}}();function mS(r,e){var t="number",i="",n={"style:name":e},s="",a=0;r=r.replace(/"[$]"/g,"$");e:{if(r.indexOf(";")>-1&&(console.error("Unsupported ODS Style Map exported.  Using first branch of "+r),r=r.slice(0,r.indexOf(";"))),r=="@"){t="text",i="<number:text-content/>";break e}if(r.indexOf(/\$/)>-1&&(t="currency"),r[a]=='"'){for(s="";r[++a]!='"'||r[++a]=='"';)s+=r[a];--a,r[a+1]=="*"?(a++,i+="<number:fill-character>"+Se(s.replace(/""/g,'"'))+"</number:fill-character>"):i+="<number:text>"+Se(s.replace(/""/g,'"'))+"</number:text>",r=r.slice(a+1),a=0}var o=r.match(/# (\?+)\/(\?+)/);if(o){i+=Z("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":o[1].length,"number:max-denominator-value":Math.max(+o[1].replace(/./g,"9"),+o[2].replace(/./g,"9"))});break e}if(o=r.match(/# (\?+)\/(\d+)/)){i+=Z("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":o[1].length,"number:denominator-value":+o[2]});break e}if(o=r.match(/\b(\d+)(|\.\d+)%/)){t="percentage",i+=Z("number:number",null,{"number:decimal-places":o[2]&&o.length-1||0,"number:min-decimal-places":o[2]&&o.length-1||0,"number:min-integer-digits":o[1].length})+"<number:text>%</number:text>";break e}var l=!1;if(["y","m","d"].indexOf(r[0])>-1){t="date";t:for(;a<r.length;++a)switch(s=r[a].toLowerCase()){case"h":case"s":l=!0,--a;break t;case"m":i:for(var h=a+1;h<r.length;++h)switch(r[h]){case"y":case"d":break i;case"h":case"s":l=!0,--a;break t}case"y":case"d":for(;(r[++a]||"").toLowerCase()==s[0];)s+=s[0];switch(--a,s){case"y":case"yy":i+="<number:year/>";break;case"yyy":case"yyyy":i+='<number:year number:style="long"/>';break;case"mmmmm":console.error("ODS has no equivalent of format |mmmmm|");case"m":case"mm":case"mmm":case"mmmm":i+='<number:month number:style="'+(s.length%2?"short":"long")+'" number:textual="'+(s.length>=3?"true":"false")+'"/>';break;case"d":case"dd":i+='<number:day number:style="'+(s.length%2?"short":"long")+'"/>';break;case"ddd":case"dddd":i+='<number:day-of-week number:style="'+(s.length%2?"short":"long")+'"/>';break}break;case'"':for(;r[++a]!='"'||r[++a]=='"';)s+=r[a];--a,i+="<number:text>"+Se(s.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"\\":s=r[++a],i+="<number:text>"+Se(s)+"</number:text>";break;case"/":case":":i+="<number:text>"+Se(s)+"</number:text>";break;default:console.error("unrecognized character "+s+" in ODF format "+r)}if(!l)break e;r=r.slice(a+1),a=0}if(r.match(/^\[?[hms]/)){for(t=="number"&&(t="time"),r.match(/\[/)&&(r=r.replace(/[\[\]]/g,""),n["number:truncate-on-overflow"]="false");a<r.length;++a)switch(s=r[a].toLowerCase()){case"h":case"m":case"s":for(;(r[++a]||"").toLowerCase()==s[0];)s+=s[0];switch(--a,s){case"h":case"hh":i+='<number:hours number:style="'+(s.length%2?"short":"long")+'"/>';break;case"m":case"mm":i+='<number:minutes number:style="'+(s.length%2?"short":"long")+'"/>';break;case"s":case"ss":if(r[a+1]==".")do s+=r[a+1],++a;while(r[a+1]=="0");i+='<number:seconds number:style="'+(s.match("ss")?"long":"short")+'"'+(s.match(/\./)?' number:decimal-places="'+(s.match(/0+/)||[""])[0].length+'"':"")+"/>";break}break;case'"':for(;r[++a]!='"'||r[++a]=='"';)s+=r[a];--a,i+="<number:text>"+Se(s.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":case":":i+="<number:text>"+Se(s)+"</number:text>";break;case"a":if(r.slice(a,a+3).toLowerCase()=="a/p"){i+="<number:am-pm/>",a+=2;break}if(r.slice(a,a+5).toLowerCase()=="am/pm"){i+="<number:am-pm/>",a+=4;break}default:console.error("unrecognized character "+s+" in ODF format "+r)}break e}if(r.indexOf(/\$/)>-1&&(t="currency"),r[0]=="$"&&(i+='<number:currency-symbol number:language="en" number:country="US">$</number:currency-symbol>',r=r.slice(1),a=0),a=0,r[a]=='"'){for(;r[++a]!='"'||r[++a]=='"';)s+=r[a];--a,r[a+1]=="*"?(a++,i+="<number:fill-character>"+Se(s.replace(/""/g,'"'))+"</number:fill-character>"):i+="<number:text>"+Se(s.replace(/""/g,'"'))+"</number:text>",r=r.slice(a+1),a=0}var u=r.match(/([#0][0#,]*)(\.[0#]*|)(E[+]?0*|)/i);if(!u||!u[0])console.error("Could not find numeric part of "+r);else{var d=u[1].replace(/,/g,"");i+="<number:"+(u[3]?"scientific-":"")+'number number:min-integer-digits="'+(d.indexOf("0")==-1?"0":d.length-d.indexOf("0"))+'"'+(u[0].indexOf(",")>-1?' number:grouping="true"':"")+(u[2]&&' number:decimal-places="'+(u[2].length-1)+'"'||' number:decimal-places="0"')+(u[3]&&u[3].indexOf("+")>-1?' number:forced-exponent-sign="true"':"")+(u[3]?' number:min-exponent-digits="'+u[3].match(/0+/)[0].length+'"':"")+"></number:"+(u[3]?"scientific-":"")+"number>",a=u.index+u[0].length}if(r[a]=='"'){for(s="";r[++a]!='"'||r[++a]=='"';)s+=r[a];--a,i+="<number:text>"+Se(s.replace(/""/g,'"'))+"</number:text>"}}return i?Z("number:"+t+"-style",i,n):(console.error("Could not generate ODS number format for |"+r+"|"),"")}function Cu(r,e,t){for(var i=[],n=0;n<r.length;++n){var s=r[n];s&&s.Sheet==(t==-1?null:t)&&i.push(s)}return i.length?`      <table:named-expressions>
`+i.map(function(a){var o=(t==-1?"$":"")+Ud(a.Ref);return"        "+Z("table:named-range",null,{"table:name":a.Name,"table:cell-range-address":o,"table:base-cell-address":o.replace(/[\.][^\.]*$/,".$A$1")})}).join(`
`)+`
      </table:named-expressions>
`:""}var _u=function(){var r=function(n,s){return Se(n).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=function(n,s,a,o,l,h){var u=[];u.push('      <table:table table:name="'+Se(s.SheetNames[a])+`" table:style-name="ta1">
`);var d=0,c=0,f=Ft(n["!ref"]||"A1"),p=n["!merges"]||[],v=0,m=n["!data"]!=null;if(n["!cols"])for(c=0;c<=f.e.c;++c)u.push("        <table:table-column"+(n["!cols"][c]?' table:style-name="co'+n["!cols"][c].ods+'"':"")+`></table:table-column>
`);var g="",x=n["!rows"]||[];for(d=0;d<f.s.r;++d)g=x[d]?' table:style-name="ro'+x[d].ods+'"':"",u.push("        <table:table-row"+g+`></table:table-row>
`);for(;d<=f.e.r;++d){for(g=x[d]?' table:style-name="ro'+x[d].ods+'"':"",u.push("        <table:table-row"+g+`>
`),c=0;c<f.s.c;++c)u.push(e);for(;c<=f.e.c;++c){var b=!1,F={},A="";for(v=0;v!=p.length;++v)if(!(p[v].s.c>c)&&!(p[v].s.r>d)&&!(p[v].e.c<c)&&!(p[v].e.r<d)){(p[v].s.c!=c||p[v].s.r!=d)&&(b=!0),F["table:number-columns-spanned"]=p[v].e.c-p[v].s.c+1,F["table:number-rows-spanned"]=p[v].e.r-p[v].s.r+1;break}if(b){u.push(`          <table:covered-table-cell/>
`);continue}var _=ct({r:d,c}),y=m?(n["!data"][d]||[])[c]:n[_];if(y&&y.f&&(F["table:formula"]=Se(N_(y.f)),y.F&&y.F.slice(0,_.length)==_)){var R=Ft(y.F);F["table:number-matrix-columns-spanned"]=R.e.c-R.s.c+1,F["table:number-matrix-rows-spanned"]=R.e.r-R.s.r+1}if(!y){u.push(e);continue}switch(y.t){case"b":A=y.v?"TRUE":"FALSE",F["office:value-type"]="boolean",F["office:boolean-value"]=y.v?"true":"false";break;case"n":isFinite(y.v)?(A=y.w||String(y.v||0),F["office:value-type"]="float",F["office:value"]=y.v||0):(isNaN(y.v)?(A="#NUM!",F["table:formula"]="of:=#NUM!"):(A="#DIV/0!",F["table:formula"]="of:="+(y.v<0?"-":"")+"1/0"),F["office:string-value"]="",F["office:value-type"]="string",F["calcext:value-type"]="error");break;case"s":case"str":A=y.v==null?"":y.v,F["office:value-type"]="string";break;case"d":A=y.w||Zt(y.v,h).toISOString(),F["office:value-type"]="date",F["office:date-value"]=Zt(y.v,h).toISOString(),F["table:style-name"]="ce1";break;default:u.push(e);continue}var M=r(A);if(y.l&&y.l.Target){var I=y.l.Target;I=I.charAt(0)=="#"?"#"+Ud(I.slice(1)):I,I.charAt(0)!="#"&&!I.match(/^\w+:/)&&(I="../"+I),M=Z("text:a",M,{"xlink:href":I.replace(/&/g,"&amp;")})}l[y.z]&&(F["table:style-name"]="ce"+l[y.z].slice(1));var P=Z("text:p",M,{});if(y.c){for(var N="",ne="",he={},se=0;se<y.c.length;++se)!N&&y.c[se].a&&(N=y.c[se].a),ne+="<text:p>"+r(y.c[se].t)+"</text:p>";y.c.hidden||(he["office:display"]=!0),P=Z("office:annotation",ne,he)+P}u.push("          "+Z("table:table-cell",P,F)+`
`)}u.push(`        </table:table-row>
`)}return(s.Workbook||{}).Names&&u.push(Cu(s.Workbook.Names,s.SheetNames,a)),u.push(`      </table:table>
`),u.join("")},i=function(n,s){n.push(` <office:automatic-styles>
`);var a=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var c=u["!cols"][d];if(c.width==null&&c.wpx==null&&c.wch==null)continue;zl(c),c.ods=a;var f=u["!cols"][d].wpx+"px";n.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),n.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),n.push(`  </style:style>
`),++a}}});var o=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=o;var c=u["!rows"][d].hpx+"px";n.push('  <style:style style:name="ro'+o+`" style:family="table-row">
`),n.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+c+`"/>
`),n.push(`  </style:style>
`),++o}}}),n.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),n.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),n.push(`  </style:style>
`),n.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),n.push(`   <number:month number:style="long"/>
`),n.push(`   <number:text>/</number:text>
`),n.push(`   <number:day number:style="long"/>
`),n.push(`   <number:text>/</number:text>
`),n.push(`   <number:year/>
`),n.push(`  </number:date-style>
`);var l={},h=69;return s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u){var d=u["!data"]!=null;if(u["!ref"])for(var c=Ft(u["!ref"]),f=0;f<=c.e.r;++f)for(var p=0;p<=c.e.c;++p){var v=d?(u["!data"][f]||[])[p]:u[ct({r:f,c:p})];if(!(!v||!v.z||v.z.toLowerCase()=="general")&&!l[v.z]){var m=mS(v.z,"N"+h);m&&(l[v.z]="N"+h,++h,n.push(m+`
`))}}}}),n.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),xt(l).forEach(function(u){n.push('<style:style style:name="ce'+l[u].slice(1)+'" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="'+l[u]+`"/>
`)}),n.push(` </office:automatic-styles>
`),l};return function(s,a){var o=[Et],l=ss({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=ss({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(o.push("<office:document"+l+h+`>
`),o.push(gd().replace(/<office:document-meta[^<>]*?>/,"").replace(/<\/office:document-meta>/,"")+`
`)):o.push("<office:document-content"+l+`>
`);var u=i(o,s);o.push(`  <office:body>
`),o.push(`    <office:spreadsheet>
`),((s.Workbook||{}).WBProps||{}).date1904&&o.push(`      <table:calculation-settings table:case-sensitive="false" table:search-criteria-must-apply-to-whole-cell="true" table:use-wildcards="true" table:use-regular-expressions="false" table:automatic-find-labels="false">
        <table:null-date table:date-value="1904-01-01"/>
      </table:calculation-settings>
`);for(var d=0;d!=s.SheetNames.length;++d)o.push(t(s.Sheets[s.SheetNames[d]],s,d,a,u,((s.Workbook||{}).WBProps||{}).date1904));return(s.Workbook||{}).Names&&o.push(Cu(s.Workbook.Names,s.SheetNames,-1)),o.push(`    </office:spreadsheet>
`),o.push(`  </office:body>
`),a.bookType=="fods"?o.push("</office:document>"):o.push("</office:document-content>"),o.join("")}}();function Zd(r,e){if(e.bookType=="fods")return _u(r,e);var t=Rl(),i="",n=[],s=[];return i="mimetype",Te(t,i,"application/vnd.oasis.opendocument.spreadsheet"),i="content.xml",Te(t,i,_u(r,e)),n.push([i,"text/xml"]),s.push([i,"ContentFile"]),i="styles.xml",Te(t,i,pS(r,e)),n.push([i,"text/xml"]),s.push([i,"StylesFile"]),i="meta.xml",Te(t,i,Et+gd()),n.push([i,"text/xml"]),s.push([i,"MetadataFile"]),i="manifest.rdf",Te(t,i,fy(s)),n.push([i,"application/rdf+xml"]),i="META-INF/manifest.xml",Te(t,i,cy(n)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */var Kt=function(){try{return typeof Uint8Array>"u"||typeof Uint8Array.prototype.subarray>"u"?"slice":typeof Buffer<"u"?typeof Buffer.prototype.subarray>"u"?"slice":(typeof Buffer.from=="function"?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch{return"slice"}}();function wa(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function hs(r){return typeof TextDecoder<"u"?new TextDecoder().decode(r):pn(Ur(r))}function Gt(r){return typeof TextEncoder<"u"?new TextEncoder().encode(r):ii(ns(r))}function yr(r){for(var e=0,t=0;t<r.length;++t)e+=r[t].length;var i=new Uint8Array(e),n=0;for(t=0;t<r.length;++t){var s=r[t],a=s.length;if(a<250)for(var o=0;o<a;++o)i[n++]=s[o];else i.set(s,n),n+=a}return i}function gS(r,e,t){var i=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-16,n=t/Math.pow(10,i-6176);r[e+15]|=i>>7,r[e+14]|=(i&127)<<1;for(var s=0;n>=1;++s,n/=256)r[e+s]=n&255;r[e+15]|=t>=0?0:128}function us(r,e){var t=e.l,i=r[t]&127;e:if(r[t++]>=128&&(i|=(r[t]&127)<<7,r[t++]<128||(i|=(r[t]&127)<<14,r[t++]<128)||(i|=(r[t]&127)<<21,r[t++]<128)||(i+=(r[t]&127)*Math.pow(2,28),++t,r[t++]<128)||(i+=(r[t]&127)*Math.pow(2,35),++t,r[t++]<128)||(i+=(r[t]&127)*Math.pow(2,42),++t,r[t++]<128)))break e;return e.l=t,i}function me(r){var e=new Uint8Array(7);e[0]=r&127;var t=1;e:if(r>127){if(e[t-1]|=128,e[t]=r>>7&127,++t,r<=16383||(e[t-1]|=128,e[t]=r>>14&127,++t,r<=2097151)||(e[t-1]|=128,e[t]=r>>21&127,++t,r<=268435455)||(e[t-1]|=128,e[t]=r/256>>>21&127,++t,r<=34359738367)||(e[t-1]|=128,e[t]=r/65536>>>21&127,++t,r<=4398046511103))break e;e[t-1]|=128,e[t]=r/16777216>>>21&127,++t}return e[Kt](0,t)}function ef(r){for(var e={l:0},t=[];e.l<r.length;)t.push(us(r,e));return t}function tf(r){return yr(r.map(function(e){return me(e)}))}function si(r){var e=0,t=r[e]&127;return r[e++]<128||(t|=(r[e]&127)<<7,r[e++]<128)||(t|=(r[e]&127)<<14,r[e++]<128)||(t|=(r[e]&127)<<21,r[e++]<128)||(t|=(r[e]&15)<<28),t}function we(r){for(var e=[],t={l:0};t.l<r.length;){var i=t.l,n=us(r,t),s=n&7;n=n/8|0;var a,o=t.l;switch(s){case 0:{for(;r[o++]>=128;);a=r[Kt](t.l,o),t.l=o}break;case 1:a=r[Kt](o,o+8),t.l=o+8;break;case 2:{var l=us(r,t);a=r[Kt](t.l,t.l+l),t.l+=l}break;case 5:a=r[Kt](o,o+4),t.l=o+4;break;default:throw new Error("PB Type ".concat(s," for Field ").concat(n," at offset ").concat(i))}var h={data:a,type:s};e[n]==null&&(e[n]=[]),e[n].push(h)}return e}function be(r){var e=[];return r.forEach(function(t,i){i!=0&&t.forEach(function(n){n.data&&(e.push(me(i*8+n.type)),n.type==2&&e.push(me(n.data.length)),e.push(n.data))})}),yr(e)}function xa(r,e){return(r==null?void 0:r.map(function(t){return e(t.data)}))||[]}function ya(r){for(var e,t=[],i={l:0};i.l<r.length;){var n=us(r,i),s=we(r[Kt](i.l,i.l+n));i.l+=n;var a={id:si(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=we(o.data),h=si(l[3][0].data);a.messages.push({meta:l,data:r[Kt](i.l,i.l+h)}),i.l+=h}),(e=s[3])!=null&&e[0]&&(a.merge=si(s[3][0].data)>>>0>0),t.push(a)}return t}function vn(r){var e=[];return r.forEach(function(t){var i=[[],[{data:me(t.id),type:0}],[]];t.merge!=null&&(i[3]=[{data:me(+!!t.merge),type:0}]);var n=[];t.messages.forEach(function(a){n.push(a.data),a.meta[3]=[{type:0,data:me(a.data.length)}],i[2].push({data:be(a.meta),type:2})});var s=be(i);e.push(me(s.length)),e.push(s),n.forEach(function(a){return e.push(a)})}),yr(e)}function vS(r,e){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var t={l:0},i=us(e,t),n=[],s=t.l;s<e.length;){var a=e[s]&3;if(a==0){var o=e[s++]>>2;if(o<60)++o;else{var l=o-59;o=e[s],l>1&&(o|=e[s+1]<<8),l>2&&(o|=e[s+2]<<16),l>3&&(o|=e[s+3]<<24),o>>>=0,o++,s+=l}n.push(e[Kt](s,s+o)),s+=o;continue}else{var h=0,u=0;if(a==1?(u=(e[s]>>2&7)+4,h=(e[s++]&224)<<3,h|=e[s++]):(u=(e[s++]>>2)+1,a==2?(h=e[s]|e[s+1]<<8,s+=2):(h=(e[s]|e[s+1]<<8|e[s+2]<<16|e[s+3]<<24)>>>0,s+=4)),h==0)throw new Error("Invalid offset 0");for(var d=n.length-1,c=h;d>=0&&c>=n[d].length;)c-=n[d].length,--d;if(d<0)if(c==0)c=n[d=0].length;else throw new Error("Invalid offset beyond length");if(u<c)n.push(n[d][Kt](n[d].length-c,n[d].length-c+u));else{for(c>0&&(n.push(n[d][Kt](n[d].length-c)),u-=c),++d;u>=n[d].length;)n.push(n[d]),u-=n[d].length,++d;u&&n.push(n[d][Kt](0,u))}n.length>25&&(n=[yr(n)])}}for(var f=0,p=0;p<n.length;++p)f+=n[p].length;if(f!=i)throw new Error("Unexpected length: ".concat(f," != ").concat(i));return n}function Ea(r){Array.isArray(r)&&(r=new Uint8Array(r));for(var e=[],t=0;t<r.length;){var i=r[t++],n=r[t]|r[t+1]<<8|r[t+2]<<16;t+=3,e.push.apply(e,vS(i,r[Kt](t,t+n))),t+=n}if(t!==r.length)throw new Error("data is not a valid framed stream!");return e.length==1?e[0]:yr(e)}function bn(r){for(var e=[],t=0;t<r.length;){var i=Math.min(r.length-t,268435455),n=new Uint8Array(4);e.push(n);var s=me(i),a=s.length;e.push(s),i<=60?(a++,e.push(new Uint8Array([i-1<<2]))):i<=256?(a+=2,e.push(new Uint8Array([240,i-1&255]))):i<=65536?(a+=3,e.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(a+=4,e.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(a+=5,e.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),e.push(r[Kt](t,t+i)),a+=i,n[0]=0,n[1]=a&255,n[2]=a>>8&255,n[3]=a>>16&255,t+=i}return yr(e)}function wo(r,e){var t=new Uint8Array(32),i=wa(t),n=12,s=0;switch(t[0]=5,r.t){case"n":if(r.z&&Gr(r.z)){t[1]=5,i.setFloat64(n,(fn(r.v+1462).getTime()-Date.UTC(2001,0,1))/1e3,!0),s|=4,n+=8;break}else t[1]=2,gS(t,n,r.v),s|=1,n+=16;break;case"b":t[1]=6,i.setFloat64(n,r.v?1:0,!0),s|=2,n+=8;break;case"s":{var a=r.v==null?"":String(r.v);if(r.l){var o=e.rsst.findIndex(function(h){var u;return h.v==a&&h.l==((u=r.l)==null?void 0:u.Target)});o==-1&&(e.rsst[o=e.rsst.length]={v:a,l:r.l.Target}),t[1]=9,i.setUint32(n,o,!0),s|=16,n+=4}else{var l=e.sst.indexOf(a);l==-1&&(e.sst[l=e.sst.length]=a),t[1]=3,i.setUint32(n,l,!0),s|=8,n+=4}}break;case"d":t[1]=5,i.setFloat64(n,(r.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),s|=4,n+=8;break;case"z":t[1]=0;break;default:throw"unsupported cell type "+r.t}return r.c&&(e.cmnt.push(bS(r.c)),i.setUint32(n,e.cmnt.length-1,!0),s|=524288,n+=4),i.setUint32(8,s,!0),t[Kt](0,n)}function xo(r,e){var t=new Uint8Array(32),i=wa(t),n=12,s=0,a="";switch(t[0]=4,r.t){case"n":break;case"b":break;case"s":if(a=r.v==null?"":String(r.v),r.l){var o=e.rsst.findIndex(function(h){var u;return h.v==a&&h.l==((u=r.l)==null?void 0:u.Target)});o==-1&&(e.rsst[o=e.rsst.length]={v:a,l:r.l.Target}),t[1]=9,i.setUint32(n,o,!0),s|=512,n+=4}break;case"d":break;case"e":break;case"z":break;default:throw"unsupported cell type "+r.t}switch(r.c&&(i.setUint32(n,e.cmnt.length-1,!0),s|=4096,n+=4),r.t){case"n":t[1]=2,i.setFloat64(n,r.v,!0),s|=32,n+=8;break;case"b":t[1]=6,i.setFloat64(n,r.v?1:0,!0),s|=32,n+=8;break;case"s":if(a=r.v==null?"":String(r.v),!r.l){var l=e.sst.indexOf(a);l==-1&&(e.sst[l=e.sst.length]=a),t[1]=3,i.setUint32(n,l,!0),s|=16,n+=4}break;case"d":t[1]=5,i.setFloat64(n,(r.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),s|=64,n+=8;break;case"z":t[1]=0;break;default:throw"unsupported cell type "+r.t}return i.setUint32(8,s,!0),t[Kt](0,n)}function bt(r){var e=we(r);return si(e[1][0].data)}function Pt(r){return be([[],[{type:0,data:me(r)}]])}function Lt(r,e){var t,i=(t=r.messages[0].meta[5])!=null&&t[0]?ef(r.messages[0].meta[5][0].data):[],n=i.indexOf(e);n==-1&&(i.push(e),r.messages[0].meta[5]=[{type:2,data:tf(i)}])}function Vi(r,e){var t,i=(t=r.messages[0].meta[5])!=null&&t[0]?ef(r.messages[0].meta[5][0].data):[];r.messages[0].meta[5]=[{type:2,data:tf(i.filter(function(n){return n!=e}))}]}function bS(r){for(var e={a:"",t:"",replies:[]},t=0;t<r.length;++t)t==0?(e.a=r[t].a,e.t=r[t].t):e.replies.push({a:r[t].a,t:r[t].t});return e}function wS(r,e,t){var i,n,s,a=[[],[{type:0,data:me(0)}],[{type:0,data:me(0)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:me(5)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:me(1)}]];if(!((i=a[6])!=null&&i[0])||!((n=a[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var o=0;if(a[7][0].data.length<2*r.length){var l=new Uint8Array(2*r.length);l.set(a[7][0].data),a[7][0].data=l}if(a[4][0].data.length<2*r.length){var h=new Uint8Array(2*r.length);h.set(a[4][0].data),a[4][0].data=h}for(var u=wa(a[7][0].data),d=0,c=[],f=wa(a[4][0].data),p=0,v=[],m=4,g=0;g<r.length;++g){if(r[g]==null||r[g].t=="z"&&!((s=r[g].c)!=null&&s.length)||r[g].t=="e"){u.setUint16(g*2,65535,!0),f.setUint16(g*2,65535);continue}u.setUint16(g*2,d/m,!0),f.setUint16(g*2,p/m,!0);var x,b;switch(r[g].t){case"d":if(r[g].v instanceof Date){x=wo(r[g],e),b=xo(r[g],e);break}x=wo(r[g],e),b=xo(r[g],e);break;case"s":case"n":case"b":case"z":x=wo(r[g],e),b=xo(r[g],e);break;default:throw new Error("Unsupported value "+r[g])}c.push(x),d+=x.length,v.push(b),p+=b.length,++o}for(a[2][0].data=me(o),a[5][0].data=me(5);g<a[7][0].data.length/2;++g)u.setUint16(g*2,65535,!0),f.setUint16(g*2,65535,!0);return a[6][0].data=yr(c),a[3][0].data=yr(v),a[8]=[{type:0,data:me(1)}],a}function ol(r,e){return{meta:[[],[{type:0,data:me(r)}]],data:e}}function Di(r,e){e.last||(e.last=927262);for(var t=e.last;t<2e6;++t)if(!e[t])return e[e.last=t]=r,t;throw new Error("Too many messages")}function xS(r){var e={},t=[];return r.FileIndex.map(function(i,n){return[i,r.FullPaths[n]]}).forEach(function(i){var n=i[0],s=i[1];n.type==2&&n.name.match(/\.iwa/)&&n.content[0]==0&&ya(Ea(n.content)).forEach(function(a){t.push(a.id),e[a.id]={deps:[],location:s,type:si(a.messages[0].meta[1][0].data)}})}),r.FileIndex.forEach(function(i){i.name.match(/\.iwa/)&&i.content[0]==0&&ya(Ea(i.content)).forEach(function(n){n.messages.forEach(function(s){[5,6].forEach(function(a){s.meta[a]&&s.meta[a].forEach(function(o){e[n.id].deps.push(si(o.data))})})})})}),e}function Ns(r,e,t){return be([[],[{type:0,data:me(1)}],[],[{type:5,data:new Uint8Array(Float32Array.from([r/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([e/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([t/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([1]).buffer)}],[],[],[],[],[],[{type:0,data:me(1)}]])}function Tu(r){switch(r){case 0:return Ns(99,222,171);case 1:return Ns(162,197,240);case 2:return Ns(255,189,189)}return Ns(Math.random()*255,Math.random()*255,Math.random()*255)}function yS(r,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=Ze.read(e.numbers,{type:"base64"}),i=xS(t),n=ki(t,i,1);if(n==null)throw"Could not find message ".concat(1," in Numbers template");var s=xa(we(n.messages[0].data)[1],bt);if(s.length>1)throw new Error("Template NUMBERS file must have exactly one sheet");return r.SheetNames.forEach(function(a,o){o>=1&&(CS(t,i,o+1),n=ki(t,i,1),s=xa(we(n.messages[0].data)[1],bt)),_S(t,i,r.Sheets[a],a,o,s[o])}),t}function Xe(r,e,t,i){var n=Ze.find(r,e[t].location);if(!n)throw"Could not find ".concat(e[t].location," in Numbers template");var s=ya(Ea(n.content)),a=s.find(function(o){return o.id==t});i(a,s),n.content=bn(vn(s)),n.size=n.content.length}function ki(r,e,t){var i=Ze.find(r,e[t].location);if(!i)throw"Could not find ".concat(e[t].location," in Numbers template");var n=ya(Ea(i.content)),s=n.find(function(a){return a.id==t});return s}function ll(r,e,t){r[3].push({type:2,data:be([[],[{type:0,data:me(e)}],[{type:2,data:Gt(t.replace(/-[\s\S]*$/,""))}],[{type:2,data:Gt(t)}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:me(0)}],[],[{type:0,data:me(0)}]])}),r[1]=[{type:0,data:me(Math.max(e+1,si(r[1][0].data)))}]}function Sr(r,e,t,i,n,s){s||(s=Di({deps:[],location:"",type:e},n));var a="".concat(i,"-").concat(s,".iwa");n[s].location="Root Entry"+a,Ze.utils.cfb_add(r,a,bn(vn([{id:s,messages:[ol(e,be(t))]}])));var o=a.replace(/^[\/]/,"").replace(/^Index\//,"").replace(/\.iwa$/,"");return Xe(r,n,2,function(l){var h=we(l.messages[0].data);ll(h,s||0,o),l.messages[0].data=be(h)}),s}function Jt(r,e,t,i){var n=e[t].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),s=r[3].findIndex(function(o){var l,h,u=we(o.data);return(l=u[3])!=null&&l[0]?hs(u[3][0].data)==n:!!((h=u[2])!=null&&h[0]&&hs(u[2][0].data)==n)}),a=we(r[3][s].data);a[6]||(a[6]=[]),(Array.isArray(i)?i:[i]).forEach(function(o){a[6].push({type:2,data:be([[],[{type:0,data:me(o)}]])})}),r[3][s].data=be(a)}function ES(r,e,t,i){var n=e[t].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),s=r[3].findIndex(function(o){var l,h,u=we(o.data);return(l=u[3])!=null&&l[0]?hs(u[3][0].data)==n:!!((h=u[2])!=null&&h[0]&&hs(u[2][0].data)==n)}),a=we(r[3][s].data);a[6]||(a[6]=[]),a[6]=a[6].filter(function(o){return si(we(o.data)[1][0].data)!=i}),r[3][s].data=be(a)}function CS(r,e,t){var i=-1,n=-1,s={};Xe(r,e,1,function(l,h){var u=we(l.messages[0].data);i=bt(we(l.messages[0].data)[1][0].data),n=Di({deps:[1],location:e[i].location,type:2},e),s[i]=n,Lt(l,n),u[1].push({type:2,data:Pt(n)});var d=ki(r,e,i);d.id=n,e[1].location==e[n].location?h.push(d):Xe(r,e,n,function(c,f){return f.push(d)}),l.messages[0].data=be(u)});var a=-1;Xe(r,e,n,function(l,h){for(var u=we(l.messages[0].data),d=3;d<=69;++d)delete u[d];var c=xa(u[2],bt);c.forEach(function(p){return Vi(l,p)}),a=Di({deps:[n],location:e[c[0]].location,type:e[c[0]].type},e),Lt(l,a),s[c[0]]=a,u[2]=[{type:2,data:Pt(a)}];var f=ki(r,e,c[0]);f.id=a,e[c[0]].location==e[n].location?h.push(f):(Xe(r,e,2,function(p){var v=we(p.messages[0].data);Jt(v,e,n,a),p.messages[0].data=be(v)}),Xe(r,e,a,function(p,v){return v.push(f)})),l.messages[0].data=be(u)});var o=-1;Xe(r,e,a,function(l,h){for(var u=we(l.messages[0].data),d=we(u[1][0].data),c=3;c<=69;++c)delete d[c];var f=bt(d[2][0].data);d[2][0].data=Pt(s[f]),u[1][0].data=be(d);var p=bt(u[2][0].data);Vi(l,p),o=Di({deps:[a],location:e[p].location,type:e[p].type},e),Lt(l,o),s[p]=o,u[2][0].data=Pt(o);var v=ki(r,e,p);v.id=o,e[a].location==e[o].location?h.push(v):Xe(r,e,o,function(m,g){return g.push(v)}),l.messages[0].data=be(u)}),Xe(r,e,o,function(l,h){var u,d,c=we(l.messages[0].data),f=hs(c[1][0].data),p=f.replace(/-[A-Z0-9]*/,"-".concat(("0000"+t.toString(16)).slice(-4)));if(c[1][0].data=Gt(p),[12,13,29,31,32,33,39,44,47,81,82,84].forEach(function(A){return delete c[A]}),c[45]){var v=we(c[45][0].data),m=bt(v[1][0].data);Vi(l,m),delete c[45]}if(c[70]){var g=we(c[70][0].data);(u=g[2])==null||u.forEach(function(A){var _=we(A.data);[2,3].map(function(y){return _[y][0]}).forEach(function(y){var R=we(y.data);if(R[8]){var M=bt(R[8][0].data);Vi(l,M)}})}),delete c[70]}[46,30,34,35,36,38,48,49,60,61,62,63,64,71,72,73,74,75,85,86,87,88,89].forEach(function(A){if(c[A]){var _=bt(c[A][0].data);delete c[A],Vi(l,_)}});var x=we(c[4][0].data);{[2,4,5,6,11,12,13,15,16,17,18,19,20,21,22].forEach(function(A){var _;if((_=x[A])!=null&&_[0]){var y=bt(x[A][0].data),R=Di({deps:[o],location:e[y].location,type:e[y].type},e);Vi(l,y),Lt(l,R),s[y]=R;var M=ki(r,e,y);if(M.id=R,e[y].location==e[o].location)h.push(M);else{e[R].location=e[y].location.replace(y.toString(),R.toString()),e[R].location==e[y].location&&(e[R].location=e[R].location.replace(/\.iwa/,"-".concat(R,".iwa"))),Ze.utils.cfb_add(r,e[R].location,bn(vn([M])));var I=e[R].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");Xe(r,e,2,function(P){var N=we(P.messages[0].data);ll(N,R,I),Jt(N,e,o,R),P.messages[0].data=be(N)})}x[A][0].data=Pt(R)}});var b=we(x[1][0].data);(d=b[2])==null||d.forEach(function(A){var _=bt(A.data),y=Di({deps:[o],location:e[_].location,type:e[_].type},e);Vi(l,_),Lt(l,y),s[_]=y;var R=ki(r,e,_);if(R.id=y,e[_].location==e[o].location)h.push(R);else{e[y].location=e[_].location.replace(_.toString(),y.toString()),e[y].location==e[_].location&&(e[y].location=e[y].location.replace(/\.iwa/,"-".concat(y,".iwa"))),Ze.utils.cfb_add(r,e[y].location,bn(vn([R])));var M=e[y].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");Xe(r,e,2,function(I){var P=we(I.messages[0].data);ll(P,y,M),Jt(P,e,o,y),I.messages[0].data=be(P)})}A.data=Pt(y)}),x[1][0].data=be(b);var F=we(x[3][0].data);F[1].forEach(function(A){var _=we(A.data),y=bt(_[2][0].data),R=s[y];if(!s[y]){R=Di({deps:[o],location:"",type:e[y].type},e),e[R].location="Root Entry/Index/Tables/Tile-".concat(R,".iwa"),s[y]=R;var M=ki(r,e,y);M.id=R,Vi(l,y),Lt(l,R),Ze.utils.cfb_add(r,"/Index/Tables/Tile-".concat(R,".iwa"),bn(vn([M]))),Xe(r,e,2,function(I){var P=we(I.messages[0].data);P[3].push({type:2,data:be([[],[{type:0,data:me(R)}],[{type:2,data:Gt("Tables/Tile")}],[{type:2,data:Gt("Tables/Tile-".concat(R))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:me(0)}],[],[{type:0,data:me(0)}]])}),P[1]=[{type:0,data:me(Math.max(R+1,si(P[1][0].data)))}],Jt(P,e,o,R),I.messages[0].data=be(P)})}_[2][0].data=Pt(R),A.data=be(_)}),x[3][0].data=be(F)}c[4][0].data=be(x),l.messages[0].data=be(c)})}function _S(r,e,t,i,n,s){var a=[];Xe(r,e,s,function(h){var u=we(h.messages[0].data);u[1]=[{type:2,data:Gt(i)}],a=xa(u[2],bt),h.messages[0].data=be(u)});var o=ki(r,e,a[0]),l=bt(we(o.messages[0].data)[2][0].data);Xe(r,e,l,function(h,u){return TS(r,e,t,h,u,l)})}function TS(r,e,t,i,n,s){if(!t["!ref"])throw new Error("Cannot export empty sheet to NUMBERS");var a=Ft(t["!ref"]);a.s.r=a.s.c=0;var o=!1;a.e.c>999&&(o=!0,a.e.c=999),a.e.r>999999&&(o=!0,a.e.r=999999),o&&console.error("Truncating to ".concat(yt(a)));var l=[];if(t["!data"])l=t["!data"];else{for(var h=[],u=0;u<=a.e.c;++u)h[u]=$e(u);for(var d=0;d<=a.e.r;++d){l[d]=[];var c=""+(d+1);for(u=0;u<=a.e.c;++u){var f=t[h[u]+c];f&&(l[d][u]=f)}}}var p={cmnt:[{a:"~54ee77S~",t:"... the people who are crazy enough to think they can change the world, are the ones who do."}],rsst:[{v:"~54ee77S~",l:"https://sheetjs.com/"}],sst:["~Sh33tJ5~"]},v=we(i.messages[0].data);{v[6][0].data=me(a.e.r+1),v[7][0].data=me(a.e.c+1),delete v[46];var m=we(v[4][0].data);{var g=bt(we(m[1][0].data)[2][0].data);Xe(r,e,g,function(De,Fe){var Ae,Ne=we(De.messages[0].data);if((Ae=Ne==null?void 0:Ne[2])!=null&&Ae[0])for(var He=0;He<l.length;++He){var Oe=we(Ne[2][0].data);Oe[1][0].data=me(He),Oe[4][0].data=me(l[He].length),Ne[2][He]={type:Ne[2][0].type,data:be(Oe)}}De.messages[0].data=be(Ne)});var x=bt(m[2][0].data);Xe(r,e,x,function(De,Fe){for(var Ae=we(De.messages[0].data),Ne=0;Ne<=a.e.c;++Ne){var He=we(Ae[2][0].data);He[1][0].data=me(Ne),He[4][0].data=me(a.e.r+1),Ae[2][Ne]={type:Ae[2][0].type,data:be(He)}}De.messages[0].data=be(Ae)});var b=we(m[9][0].data);b[1]=[];var F=we(m[3][0].data);{var A=256;F[2]=[{type:0,data:me(A)}];var _=bt(we(F[1][0].data)[2][0].data),y=function(){var De=ki(r,e,2),Fe=we(De.messages[0].data),Ae=Fe[3].filter(function(Ne){return si(we(Ne.data)[1][0].data)==_});return Ae!=null&&Ae.length?si(we(Ae[0].data)[12][0].data):0}();Ze.utils.cfb_del(r,e[_].location),Xe(r,e,2,function(De){var Fe=we(De.messages[0].data);Fe[3]=Fe[3].filter(function(Ae){return si(we(Ae.data)[1][0].data)!=_}),ES(Fe,e,s,_),De.messages[0].data=be(Fe)}),Vi(i,_),F[1]=[];for(var R=Math.ceil((a.e.r+1)/A),M=0;M<R;++M){var I=Di({deps:[],location:"",type:6002},e);e[I].location="Root Entry/Index/Tables/Tile-".concat(I,".iwa");for(var P=[[],[{type:0,data:me(0)}],[{type:0,data:me(Math.min(a.e.r+1,(M+1)*A))}],[{type:0,data:me(0)}],[{type:0,data:me(Math.min((M+1)*A,a.e.r+1)-M*A)}],[],[{type:0,data:me(5)}],[{type:0,data:me(1)}],[{type:0,data:me(1)}]],N=M*A;N<=Math.min(a.e.r,(M+1)*A-1);++N){var ne=wS(l[N],p);ne[1][0].data=me(N-M*A),P[5].push({data:be(ne),type:2})}F[1].push({type:2,data:be([[],[{type:0,data:me(M)}],[{type:2,data:Pt(I)}]])});var he={id:I,messages:[ol(6002,be(P))]},se=bn(vn([he]));Ze.utils.cfb_add(r,"/Index/Tables/Tile-".concat(I,".iwa"),se),Xe(r,e,2,function(De){var Fe=we(De.messages[0].data);Fe[3].push({type:2,data:be([[],[{type:0,data:me(I)}],[{type:2,data:Gt("Tables/Tile")}],[{type:2,data:Gt("Tables/Tile-".concat(I))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:me(0)}],[],[{type:0,data:me(y)}]])}),Fe[1]=[{type:0,data:me(Math.max(I+1,si(Fe[1][0].data)))}],Jt(Fe,e,s,I),De.messages[0].data=be(Fe)}),Lt(i,I),b[1].push({type:2,data:be([[],[{type:0,data:me(M*A)}],[{type:0,data:me(M)}]])})}}if(m[3][0].data=be(F),m[9][0].data=be(b),m[10]=[{type:2,data:new Uint8Array([])}],t["!merges"]){var fe=Di({type:6144,deps:[s],location:e[s].location},e);n.push({id:fe,messages:[ol(6144,be([[],t["!merges"].map(function(De){return{type:2,data:be([[],[{type:2,data:be([[],[{type:5,data:new Uint8Array(new Uint16Array([De.s.r,De.s.c]).buffer)}]])}],[{type:2,data:be([[],[{type:5,data:new Uint8Array(new Uint16Array([De.e.r-De.s.r+1,De.e.c-De.s.c+1]).buffer)}]])}]])}})]))]}),m[13]=[{type:2,data:Pt(fe)}],Xe(r,e,2,function(De){var Fe=we(De.messages[0].data);Jt(Fe,e,s,fe),De.messages[0].data=be(Fe)}),Lt(i,fe)}else delete m[13];var ee=bt(m[4][0].data);Xe(r,e,ee,function(De){var Fe=we(De.messages[0].data);Fe[3]=[],p.sst.forEach(function(Ae,Ne){Ne!=0&&Fe[3].push({type:2,data:be([[],[{type:0,data:me(Ne)}],[{type:0,data:me(1)}],[{type:2,data:Gt(Ae)}]])})}),De.messages[0].data=be(Fe)});var ge=bt(m[17][0].data);if(Xe(r,e,ge,function(De){var Fe=we(De.messages[0].data);Fe[3]=[];var Ae=[904980,903835,903815,903845];p.rsst.forEach(function(Ne,He){if(He!=0){var Oe=[[],[{type:0,data:new Uint8Array([5])}],[],[{type:2,data:Gt(Ne.v)}]];Oe[10]=[{type:0,data:new Uint8Array([1])}],Oe[19]=[{type:2,data:new Uint8Array([10,6,8,0,18,2,101,110])}],Oe[5]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,155,149,55])}],Oe[2]=[{type:2,data:new Uint8Array([8,148,158,55])}],Oe[6]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],Oe[7]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,135,149,55])}],Oe[8]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,165,149,55])}],Oe[14]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],Oe[24]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}];var k=Di({deps:[],location:"",type:2001},e),U=[];if(Ne.l){var L=Sr(r,2032,[[],[],[{type:2,data:Gt(Ne.l)}]],"/Index/Tables/DataList",e);Oe[11]=[];var O=[[],[]];O[1]||(O[1]=[]),O[1].push({type:2,data:be([[],[{type:0,data:me(0)}],[{type:2,data:Pt(L)}]])}),Oe[11][0]={type:2,data:be(O)},U.push(L)}Sr(r,2001,Oe,"/Index/Tables/DataList",e,k),Xe(r,e,k,function(de){Ae.forEach(function(oe){return Lt(de,oe)}),U.forEach(function(oe){return Lt(de,oe)})});var K=Sr(r,6218,[[],[{type:2,data:Pt(k)}],[],[{type:2,data:new Uint8Array([13,255,255,255,0,18,10,16,255,255,1,24,255,255,255,255,7])}]],"/Index/Tables/DataList",e);Xe(r,e,K,function(de){return Lt(de,k)}),Fe[3].push({type:2,data:be([[],[{type:0,data:me(He)}],[{type:0,data:me(1)}],[],[],[],[],[],[],[{type:2,data:Pt(K)}]])}),Lt(De,K),Xe(r,e,2,function(de){var oe=we(de.messages[0].data);Jt(oe,e,ge,K),Jt(oe,e,K,k),Jt(oe,e,k,U),Jt(oe,e,k,Ae),de.messages[0].data=be(oe)})}}),De.messages[0].data=be(Fe)}),p.cmnt.length>1){var _e=bt(m[19][0].data),Je={},tt=0;Xe(r,e,_e,function(De){var Fe=we(De.messages[0].data);Fe[3]=[],p.cmnt.forEach(function(Ae,Ne){if(Ne!=0){var He=[];Ae.replies&&Ae.replies.forEach(function(U){Je[U.a||""]||(Je[U.a||""]=Sr(r,212,[[],[{type:2,data:Gt(U.a||"")}],[{type:2,data:Tu(++tt)}],[],[{type:0,data:me(0)}]],"/Index/Tables/DataList",e));var L=Je[U.a||""],O=Sr(r,3056,[[],[{type:2,data:Gt(U.t||"")}],[{type:2,data:be([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:Pt(L)}]],"/Index/Tables/DataList",e);Xe(r,e,O,function(K){return Lt(K,L)}),He.push(O),Xe(r,e,2,function(K){var de=we(K.messages[0].data);Jt(de,e,O,L),K.messages[0].data=be(de)})}),Je[Ae.a||""]||(Je[Ae.a||""]=Sr(r,212,[[],[{type:2,data:Gt(Ae.a||"")}],[{type:2,data:Tu(++tt)}],[],[{type:0,data:me(0)}]],"/Index/Tables/DataList",e));var Oe=Je[Ae.a||""],k=Sr(r,3056,[[],[{type:2,data:Gt(Ae.t||"")}],[{type:2,data:be([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:Pt(Oe)}],He.map(function(U){return{type:2,data:Pt(U)}}),[{type:2,data:be([[],[{type:0,data:me(Ne)}],[{type:0,data:me(0)}]])}]],"/Index/Tables/DataList",e);Xe(r,e,k,function(U){Lt(U,Oe),He.forEach(function(L){return Lt(U,L)})}),Fe[3].push({type:2,data:be([[],[{type:0,data:me(Ne)}],[{type:0,data:me(1)}],[],[],[],[],[],[],[],[{type:2,data:Pt(k)}]])}),Lt(De,k),Xe(r,e,2,function(U){var L=we(U.messages[0].data);Jt(L,e,_e,k),Jt(L,e,k,Oe),He.length&&Jt(L,e,k,He),U.messages[0].data=be(L)})}}),Fe[2][0].data=me(p.cmnt.length+1),De.messages[0].data=be(Fe)})}}v[4][0].data=be(m)}i.messages[0].data=be(v)}function SS(r){return function(t){for(var i=0;i!=r.length;++i){var n=r[i];t[n[0]]===void 0&&(t[n[0]]=n[1]),n[2]==="n"&&(t[n[0]]=Number(t[n[0]]))}}}function Ul(r){SS([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(r)}function DS(r,e){r&&!r.SSF&&(r.SSF=Vt(rt)),r&&r.SSF&&(Ba(),Ia(r.SSF),e.revssf=Ha(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Kn?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="bin",i=!0,n=fd();Ul(e=e||{});var s=Rl(),a="",o=0;if(e.cellXfs=[],Er(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),a="docProps/core.xml",Te(s,a,vd(r.Props,e)),n.coreprops.push(a),We(e.rels,2,a,Pe.CORE_PROPS),a="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var l=[],h=0;h<r.SheetNames.length;++h)(r.Workbook.Sheets[h]||{}).Hidden!=2&&l.push(r.SheetNames[h]);r.Props.SheetNames=l}r.Props.Worksheets=r.Props.SheetNames.length,Te(s,a,wd(r.Props)),n.extprops.push(a),We(e.rels,3,a,Pe.EXT_PROPS),r.Custprops!==r.Props&&xt(r.Custprops||{}).length>0&&(a="docProps/custom.xml",Te(s,a,xd(r.Custprops)),n.custprops.push(a),We(e.rels,4,a,Pe.CUST_PROPS));var u=["SheetJ5"];for(e.tcid=0,o=1;o<=r.SheetNames.length;++o){var d={"!id":{}},c=r.Sheets[r.SheetNames[o-1]],f=(c||{})["!type"]||"sheet";switch(f){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,Te(s,a,lT(o-1,e,r,d)),n.sheets.push(a),We(e.wbrels,-1,"worksheets/sheet"+o+"."+t,Pe.WS[0])}if(c){var p=c["!comments"],v=!1,m="";if(p&&p.length>0){var g=!1;p.forEach(function(b){b[1].forEach(function(F){F.T==!0&&(g=!0)})}),g&&(m="xl/threadedComments/threadedComment"+o+".xml",Te(s,m,Ld(p,u,e)),n.threadedcomments.push(m),We(d,-1,"../threadedComments/threadedComment"+o+".xml",Pe.TCMNT)),m="xl/comments"+o+"."+t,Te(s,m,JE(p)),n.comments.push(m),We(d,-1,"../comments"+o+"."+t,Pe.CMNT),v=!0}c["!legacy"]&&v&&Te(s,"xl/drawings/vmlDrawing"+o+".vml",Od(o,c["!comments"])),delete c["!comments"],delete c["!legacy"]}d["!id"].rId1&&Te(s,md(a),mn(d))}e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,Te(s,a,lE(e.Strings)),n.strs.push(a),We(e.wbrels,-1,"sharedStrings."+t,Pe.SST)),a="xl/workbook."+t,Te(s,a,RT(r)),n.workbooks.push(a),We(e.rels,1,a,Pe.WB),a="xl/theme/theme1.xml";var x=Ad(r.Themes,e);return Te(s,a,x),n.themes.push(a),We(e.wbrels,-1,"theme/theme1.xml",Pe.THEME),a="xl/styles."+t,Te(s,a,NE(r,e)),n.styles.push(a),We(e.wbrels,-1,"styles."+t,Pe.STY),r.vbaraw&&i&&(a="xl/vbaProject.bin",Te(s,a,r.vbaraw),n.vba.push(a),We(e.wbrels,-1,"vbaProject.bin",Pe.VBA)),a="xl/metadata."+t,Te(s,a,GE()),n.metadata.push(a),We(e.wbrels,-1,"metadata."+t,Pe.XLMETA),u.length>1&&(a="xl/persons/person.xml",Te(s,a,Pd(u)),n.people.push(a),We(e.wbrels,-1,"persons/person.xml",Pe.PEOPLE)),Te(s,"[Content_Types].xml",pd(n,e)),Te(s,"_rels/.rels",mn(e.rels)),Te(s,"xl/_rels/workbook."+t+".rels",mn(e.wbrels)),delete e.revssf,delete e.ssf,s}function kS(r,e){r&&!r.SSF&&(r.SSF=Vt(rt)),r&&r.SSF&&(Ba(),Ia(r.SSF),e.revssf=Ha(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Kn?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",i=eC.indexOf(e.bookType)>-1,n=fd();Ul(e=e||{});var s=Rl(),a="",o=0;if(e.cellXfs=[],Er(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),a="docProps/core.xml",Te(s,a,vd(r.Props,e)),n.coreprops.push(a),We(e.rels,2,a,Pe.CORE_PROPS),a="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var l=[],h=0;h<r.SheetNames.length;++h)(r.Workbook.Sheets[h]||{}).Hidden!=2&&l.push(r.SheetNames[h]);r.Props.SheetNames=l}r.Props.Worksheets=r.Props.SheetNames.length,Te(s,a,wd(r.Props)),n.extprops.push(a),We(e.rels,3,a,Pe.EXT_PROPS),r.Custprops!==r.Props&&xt(r.Custprops||{}).length>0&&(a="docProps/custom.xml",Te(s,a,xd(r.Custprops)),n.custprops.push(a),We(e.rels,4,a,Pe.CUST_PROPS));var u=["SheetJ5"];for(e.tcid=0,o=1;o<=r.SheetNames.length;++o){var d={"!id":{}},c=r.Sheets[r.SheetNames[o-1]],f=(c||{})["!type"]||"sheet";switch(f){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,Te(s,a,K_(o-1,e,r,d)),n.sheets.push(a),We(e.wbrels,-1,"worksheets/sheet"+o+"."+t,Pe.WS[0])}if(c){var p=c["!comments"],v=!1,m="";if(p&&p.length>0){var g=!1;p.forEach(function(x){x[1].forEach(function(b){b.T==!0&&(g=!0)})}),g&&(m="xl/threadedComments/threadedComment"+o+".xml",Te(s,m,Ld(p,u,e)),n.threadedcomments.push(m),We(d,-1,"../threadedComments/threadedComment"+o+".xml",Pe.TCMNT)),m="xl/comments"+o+"."+t,Te(s,m,$E(p)),n.comments.push(m),We(d,-1,"../comments"+o+"."+t,Pe.CMNT),v=!0}c["!legacy"]&&v&&Te(s,"xl/drawings/vmlDrawing"+o+".vml",Od(o,c["!comments"])),delete c["!comments"],delete c["!legacy"]}d["!id"].rId1&&Te(s,md(a),mn(d))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,Te(s,a,nE(e.Strings,e)),n.strs.push(a),We(e.wbrels,-1,"sharedStrings."+t,Pe.SST)),a="xl/workbook."+t,Te(s,a,mT(r)),n.workbooks.push(a),We(e.rels,1,a,Pe.WB),a="xl/theme/theme1.xml",Te(s,a,Ad(r.Themes,e)),n.themes.push(a),We(e.wbrels,-1,"theme/theme1.xml",Pe.THEME),a="xl/styles."+t,Te(s,a,mE(r,e)),n.styles.push(a),We(e.wbrels,-1,"styles."+t,Pe.STY),r.vbaraw&&i&&(a="xl/vbaProject.bin",Te(s,a,r.vbaraw),n.vba.push(a),We(e.wbrels,-1,"vbaProject.bin",Pe.VBA)),a="xl/metadata."+t,Te(s,a,YE()),n.metadata.push(a),We(e.wbrels,-1,"metadata."+t,Pe.XLMETA),u.length>1&&(a="xl/persons/person.xml",Te(s,a,Pd(u)),n.people.push(a),We(e.wbrels,-1,"persons/person.xml",Pe.PEOPLE)),Te(s,"[Content_Types].xml",pd(n,e)),Te(s,"_rels/.rels",mn(e.rels)),Te(s,"xl/_rels/workbook."+t+".rels",mn(e.wbrels)),delete e.revssf,delete e.ssf,s}function RS(r,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":t=wr(r.slice(0,12));break;case"binary":t=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function rf(r,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return gs(e.file,Ze.write(r,{type:Ve?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Ze.write(r,e)}function FS(r,e){switch(e.bookType){case"ods":return Zd(r,e);case"numbers":return yS(r,e);case"xlsb":return DS(r,e);default:return kS(r,e)}}function MS(r,e){var t=Vt(e||{}),i=FS(r,t);return AS(i,t)}function AS(r,e){var t={},i=Ve?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=i;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=i;break;default:throw new Error("Unrecognized type "+e.type)}var n=r.FullPaths?Ze.write(r,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):r.generate(t);if(typeof Deno<"u"&&typeof n=="string"){if(e.type=="binary"||e.type=="base64")return n;n=new Uint8Array(Na(n))}return e.password&&typeof encrypt_agile<"u"?rf(encrypt_agile(n,e.password),e):e.type==="file"?gs(e.file,n):e.type=="string"?pn(n):n}function OS(r,e){var t=e||{},i=UT(r,t);return rf(i,t)}function _i(r,e,t){t||(t="");var i=t+r;switch(e.type){case"base64":return aa(ns(i));case"binary":return ns(i);case"string":return r;case"file":return gs(e.file,i,"utf8");case"buffer":return Ve?Hi(i,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(i):_i(i,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function LS(r,e){switch(e.type){case"base64":return Lw(r);case"binary":return r;case"string":return r;case"file":return gs(e.file,r,"binary");case"buffer":return Ve?Hi(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Is(r,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",i=0;i<r.length;++i)t+=String.fromCharCode(r[i]);return e.type=="base64"?aa(t):e.type=="string"?pn(t):t;case"file":return gs(e.file,r);case"buffer":return r;default:throw new Error("Unrecognized type "+e.type)}}function nf(r,e){Ow(),pT(r);var t=Vt(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var i=nf(r,t);return t.type="array",Na(i)}var n=0;if(t.sheet&&(typeof t.sheet=="number"?n=t.sheet:n=r.SheetNames.indexOf(t.sheet),!r.SheetNames[n]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return _i(WT(r,t),t);case"slk":case"sylk":return _i(eE.from_sheet(r.Sheets[r.SheetNames[n]],t,r),t);case"htm":case"html":return _i(Qd(r.Sheets[r.SheetNames[n]],t),t);case"txt":return LS(sf(r.Sheets[r.SheetNames[n]],t),t);case"csv":return _i(Gl(r.Sheets[r.SheetNames[n]],t),t,"\uFEFF");case"dif":return _i(tE.from_sheet(r.Sheets[r.SheetNames[n]],t),t);case"dbf":return Is(Zy.from_sheet(r.Sheets[r.SheetNames[n]],t),t);case"prn":return _i(iE.from_sheet(r.Sheets[r.SheetNames[n]],t),t);case"rtf":return _i(uE(r.Sheets[r.SheetNames[n]]),t);case"eth":return _i(Dd.from_sheet(r.Sheets[r.SheetNames[n]],t),t);case"fods":return _i(Zd(r,t),t);case"wk1":return Is(fu.sheet_to_wk1(r.Sheets[r.SheetNames[n]],t),t);case"wk3":return Is(fu.book_to_wk3(r,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Is(Kd(r,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),OS(r,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return MS(r,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function PS(r){if(!r.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=r.file.slice(r.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(r.bookType=t.slice(1)),r.bookType=e[r.bookType]||r.bookType}}function NS(r,e,t){var i=t||{};return i.type="file",i.file=e,PS(i),nf(r,i)}function IS(r,e,t,i,n,s,a){var o=qe(t),l=a.defval,h=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),u=!0,d=r["!data"]!=null,c=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(c,"__rowNum__",{value:t,enumerable:!1})}catch{c.__rowNum__=t}else c.__rowNum__=t;if(!d||r["!data"][t])for(var f=e.s.c;f<=e.e.c;++f){var p=d?(r["!data"][t]||[])[f]:r[i[f]+o];if(p==null||p.t===void 0){if(l===void 0)continue;s[f]!=null&&(c[s[f]]=l);continue}var v=p.v;switch(p.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"b":case"n":if(!p.z||!Gr(p.z)||(v=fn(v),typeof v=="number"))break;case"d":a&&(a.UTC||a.raw===!1)||(v=Sn(new Date(v)));break;default:throw new Error("unrecognized type "+p.t)}if(s[f]!=null){if(v==null)if(p.t=="e"&&v===null)c[s[f]]=null;else if(l!==void 0)c[s[f]]=l;else if(h&&v===null)c[s[f]]=null;else continue;else c[s[f]]=(p.t==="n"&&typeof a.rawNumbers=="boolean"?a.rawNumbers:h)?v:ir(p,v,a);v!=null&&(u=!1)}}return{row:c,isempty:u}}function hl(r,e){if(r==null||r["!ref"]==null)return[];var t={t:"n",v:0},i=0,n=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},h=e||{},u=h.range!=null?h.range:r["!ref"];switch(h.header===1?i=1:h.header==="A"?i=2:Array.isArray(h.header)?i=3:h.header==null&&(i=0),typeof u){case"string":l=nt(u);break;case"number":l=nt(r["!ref"]),l.s.r=u;break;default:l=u}i>0&&(n=0);var d=qe(l.s.r),c=[],f=[],p=0,v=0,m=r["!data"]!=null,g=l.s.r,x=0,b={};m&&!r["!data"][g]&&(r["!data"][g]=[]);var F=h.skipHidden&&r["!cols"]||[],A=h.skipHidden&&r["!rows"]||[];for(x=l.s.c;x<=l.e.c;++x)if(!(F[x]||{}).hidden)switch(c[x]=$e(x),t=m?r["!data"][g][x]:r[c[x]+d],i){case 1:s[x]=x-l.s.c;break;case 2:s[x]=c[x];break;case 3:s[x]=h.header[x-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=a=ir(t,null,h),v=b[a]||0,!v)b[a]=1;else{do o=a+"_"+v++;while(b[o]);b[a]=v,b[o]=1}s[x]=o}for(g=l.s.r+n;g<=l.e.r;++g)if(!(A[g]||{}).hidden){var _=IS(r,l,g,c,i,s,h);(_.isempty===!1||(i===1?h.blankrows!==!1:h.blankrows))&&(f[p++]=_.row)}return f.length=p,f}var Su=/"/g;function BS(r,e,t,i,n,s,a,o,l){for(var h=!0,u=[],d="",c=qe(t),f=r["!data"]!=null,p=f&&r["!data"][t]||[],v=e.s.c;v<=e.e.c;++v)if(i[v]){var m=f?p[v]:r[i[v]+c];if(m==null)d="";else if(m.v!=null){h=!1,d=""+(l.rawNumbers&&m.t=="n"?m.v:ir(m,null,l));for(var g=0,x=0;g!==d.length;++g)if((x=d.charCodeAt(g))===n||x===s||x===34||l.forceQuotes){d='"'+d.replace(Su,'""')+'"';break}d=="ID"&&o==0&&u.length==0&&(d='"ID"')}else m.f!=null&&!m.F?(h=!1,d="="+m.f,d.indexOf(",")>=0&&(d='"'+d.replace(Su,'""')+'"')):d="";u.push(d)}if(l.strip)for(;u[u.length-1]==="";)--u.length;return l.blankrows===!1&&h?null:u.join(a)}function Gl(r,e){var t=[],i=e??{};if(r==null||r["!ref"]==null)return"";for(var n=nt(r["!ref"]),s=i.FS!==void 0?i.FS:",",a=s.charCodeAt(0),o=i.RS!==void 0?i.RS:`
`,l=o.charCodeAt(0),h="",u=[],d=i.skipHidden&&r["!cols"]||[],c=i.skipHidden&&r["!rows"]||[],f=n.s.c;f<=n.e.c;++f)(d[f]||{}).hidden||(u[f]=$e(f));for(var p=0,v=n.s.r;v<=n.e.r;++v)(c[v]||{}).hidden||(h=BS(r,n,v,u,a,l,s,p,i),h!=null&&(h||i.blankrows!==!1)&&t.push((p++?o:"")+h));return t.join("")}function sf(r,e){e||(e={}),e.FS="	",e.RS=`
`;var t=Gl(r,e);return t}function HS(r,e){var t="",i,n="";if(r==null||r["!ref"]==null)return[];var s=nt(r["!ref"]),a="",o=[],l,h=[],u=r["!data"]!=null;for(l=s.s.c;l<=s.e.c;++l)o[l]=$e(l);for(var d=s.s.r;d<=s.e.r;++d)for(a=qe(d),l=s.s.c;l<=s.e.c;++l)if(t=o[l]+a,i=u?(r["!data"][d]||[])[l]:r[t],n="",i!==void 0){if(i.F!=null){if(t=i.F,!i.f)continue;n=i.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(i.f!=null)n=i.f;else{if(e&&e.values===!1)continue;if(i.t=="z")continue;if(i.t=="n"&&i.v!=null)n=""+i.v;else if(i.t=="b")n=i.v?"TRUE":"FALSE";else if(i.w!==void 0)n="'"+i.w;else{if(i.v===void 0)continue;i.t=="s"?n="'"+i.v:n=""+i.v}}h[h.length]=t+"="+n}return h}function af(r,e,t){var i=t||{},n=r?r["!data"]!=null:i.dense,s=+!i.skipHeader,a=r||{};!r&&n&&(a["!data"]=[]);var o=0,l=0;if(a&&i.origin!=null)if(typeof i.origin=="number")o=i.origin;else{var h=typeof i.origin=="string"?lt(i.origin):i.origin;o=h.r,l=h.c}var u={s:{c:0,r:0},e:{c:l,r:o+e.length-1+s}};if(a["!ref"]){var d=nt(a["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(o=d.e.r+1,u.e.r=o+e.length-1+s)}else o==-1&&(o=0,u.e.r=e.length-1+s);var c=i.header||[],f=0,p=[];e.forEach(function(m,g){n&&!a["!data"][o+g+s]&&(a["!data"][o+g+s]=[]),n&&(p=a["!data"][o+g+s]),xt(m).forEach(function(x){(f=c.indexOf(x))==-1&&(c[f=c.length]=x);var b=m[x],F="z",A="",_=n?"":$e(l+f)+qe(o+g+s),y=n?p[l+f]:a[_];b&&typeof b=="object"&&!(b instanceof Date)?n?p[l+f]=b:a[_]=b:(typeof b=="number"?F="n":typeof b=="boolean"?F="b":typeof b=="string"?F="s":b instanceof Date?(F="d",i.UTC||(b=za(b)),i.cellDates||(F="n",b=Mt(b)),A=y!=null&&y.z&&Gr(y.z)?y.z:i.dateNF||rt[14]):b===null&&i.nullError&&(F="e",b=0),y?(y.t=F,y.v=b,delete y.w,delete y.R,A&&(y.z=A)):n?p[l+f]=y={t:F,v:b}:a[_]=y={t:F,v:b},A&&(y.z=A))})}),u.e.c=Math.max(u.e.c,l+c.length-1);var v=qe(o);if(n&&!a["!data"][o]&&(a["!data"][o]=[]),s)for(f=0;f<c.length;++f)n?a["!data"][o][f+l]={t:"s",v:c[f]}:a[$e(f+l)+v]={t:"s",v:c[f]};return a["!ref"]=yt(u),a}function zS(r,e){return af(null,r,e)}function Ca(r,e,t){if(typeof e=="string"){if(r["!data"]!=null){var i=lt(e);return r["!data"][i.r]||(r["!data"][i.r]=[]),r["!data"][i.r][i.c]||(r["!data"][i.r][i.c]={t:"z"})}return r[e]||(r[e]={t:"z"})}return typeof e!="number"?Ca(r,ct(e)):Ca(r,$e(t||0)+qe(e))}function WS(r,e){if(typeof e=="number"){if(e>=0&&r.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=r.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function VS(r,e){var t={SheetNames:[],Sheets:{}};return r&&Yl(t,r,e||"Sheet1"),t}function Yl(r,e,t,i){var n=1;if(!t)for(;n<=65535&&r.SheetNames.indexOf(t="Sheet"+n)!=-1;++n,t=void 0);if(!t||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&r.SheetNames.indexOf(t)>=0&&t.length<32){var s=t.match(/\d+$/);n=s&&+s[0]||0;var a=s&&t.slice(0,s.index)||t;for(++n;n<=65535&&r.SheetNames.indexOf(t=a+n)!=-1;++n);}if(jd(t),r.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return r.SheetNames.push(t),r.Sheets[t]=e,t}function US(r,e,t){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var i=WS(r,e);switch(r.Workbook.Sheets[i]||(r.Workbook.Sheets[i]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}r.Workbook.Sheets[i].Hidden=t}function GS(r,e){return r.z=e,r}function of(r,e,t){return e?(r.l={Target:e},t&&(r.l.Tooltip=t)):delete r.l,r}function YS(r,e,t){return of(r,"#"+e,t)}function jS(r,e,t){r.c||(r.c=[]),r.c.push({t:e,a:t||"SheetJS"})}function XS(r,e,t,i){for(var n=typeof e!="string"?e:nt(e),s=typeof e=="string"?e:yt(e),a=n.s.r;a<=n.e.r;++a)for(var o=n.s.c;o<=n.e.c;++o){var l=Ca(r,a,o);l.t="n",l.F=s,delete l.v,a==n.s.r&&o==n.s.c&&(l.f=t,i&&(l.D=!0))}var h=Ft(r["!ref"]);return h.s.r>n.s.r&&(h.s.r=n.s.r),h.s.c>n.s.c&&(h.s.c=n.s.c),h.e.r<n.e.r&&(h.e.r=n.e.r),h.e.c<n.e.c&&(h.e.c=n.e.c),r["!ref"]=yt(h),r}var yo={encode_col:$e,encode_row:qe,encode_cell:ct,encode_range:yt,decode_col:Pl,decode_row:Ll,split_cell:Vx,decode_cell:lt,decode_range:Ft,format_cell:ir,sheet_new:Ux,sheet_add_aoa:ld,sheet_add_json:af,sheet_add_dom:qd,aoa_to_sheet:Mn,json_to_sheet:zS,table_to_sheet:Jd,table_to_book:dS,sheet_to_csv:Gl,sheet_to_txt:sf,sheet_to_json:hl,sheet_to_html:Qd,sheet_to_formulae:HS,sheet_to_row_object_array:hl,sheet_get_cell:Ca,book_new:VS,book_append_sheet:Yl,book_set_sheet_visibility:US,cell_set_number_format:GS,cell_set_hyperlink:of,cell_set_internal_link:YS,cell_add_comment:jS,sheet_set_array_formula:XS,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const rD=(r,e,t="table_data.xlsx",i="Sheet1")=>{if(!r||e!=="ready"){console.error("Table instance not ready:",r,e);return}try{const n=r.getData();if(!n||n.length===0){console.warn("No data available to download");return}const s=r.getColumns(),a=s.map(d=>d.getDefinition().title),o=s.map(d=>d.getField()),l=[a,...n.map(d=>o.map(c=>d[c]))],h=yo.aoa_to_sheet(l),u=yo.book_new();yo.book_append_sheet(u,h,i),NS(u,t)}catch(n){console.error("Excel download failed:",n)}};export{ZS as M,eD as T,iD as c,rD as h,JS as i,vi as s};
//# sourceMappingURL=tableExcel-CSYl1U_U.js.map
