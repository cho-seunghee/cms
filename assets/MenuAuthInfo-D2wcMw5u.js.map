{"version":3,"file":"MenuAuthInfo-D2wcMw5u.js","sources":["../../src/pages/oper/MenuAuthInfo.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useNavigate } from 'react-router-dom';\nimport { fetchData } from \"../../utils/dataUtils\";\nimport useStore from '../../store/store';\nimport { hasPermission } from '../../utils/authUtils';\nimport { errorMsgPopup } from \"../../utils/errorMsgPopup\";\nimport { msgPopup } from \"../../utils/msgPopup\";\nimport styles from './MenuAuthInfo.module.css';\n\nconst MenuAuthInfo = () => {\n  const { user } = useStore();\n  const navigate = useNavigate();\n  const [data, setData] = useState([]);\n  const [initialData, setInitialData] = useState([]);\n  const [authFields, setAuthFields] = useState([]);\n  const [changedCells, setChangedCells] = useState(new Map());\n  const [loading, setLoading] = useState(false);\n\n  useEffect(() => {\n    if (!user || !hasPermission(user.auth, 'menuAuth')) {\n      navigate('/');\n      return;\n    }\n    fetchMenuAuthData();\n  }, [user, navigate]);\n\n  const calculateMenuLevel = (row, data, visited = new Set()) => {\n    if (!row.UPPERMENUID) return 1;\n    if (visited.has(row.MENUID)) return 1;\n    visited.add(row.MENUID);\n    const parent = data.find(item => item.MENUID === row.UPPERMENUID);\n    if (!parent) return 1;\n    return calculateMenuLevel(parent, data, visited) + 1;\n  };\n\n  const fetchMenuAuthData = async () => {\n    const params = { param1: \"F\" };\n    try {\n      const response = await fetchData(\"oper/menuauthinfo/list\", params );\n\n      if (!response.success) {\n        errorMsgPopup(response.message || \"메뉴 권한 데이터를 가져오는 중 오류가 발생했습니다.\");\n        setData([]);\n        setInitialData([]);\n        setAuthFields([]);\n        return;\n      } else {\n        if (response.errMsg !== '') {\n          errorMsgPopup(response.errMsg);\n          setData([]);\n          setInitialData([]);\n          setAuthFields([]);\n          return;\n        }\n      }\n\n      const responseData = Array.isArray(response.data) ? response.data : [];\n\n      const authNames = responseData.length > 0 && Array.isArray(responseData[0].children)\n        ? responseData[0].children.map(child => child.AUTHNM)\n        : [];\n\n      const leveledData = responseData.map(row => ({\n        ...row,\n        MENULEVEL: calculateMenuLevel(row, responseData)\n      }));\n\n      const isConsistent = responseData.every(row =>\n        Array.isArray(row.children) &&\n        row.children.map(child => child.AUTHNM).join(',') === authNames.join(',')\n      );\n      if (!isConsistent) {\n        console.warn('Warning: Inconsistent AUTHNM order across menu items');\n      }\n\n      setData(leveledData);\n      setInitialData(leveledData);\n      setAuthFields(authNames);\n      setChangedCells(new Map());\n    } catch (error) {\n      console.error(\"메뉴 권한 데이터 조회 실패:\", {\n        message: error.message,\n        response: error.response ? {\n          status: error.response.status,\n          data: error.response.data,\n          headers: error.response.headers\n        } : 'No response received'\n      });\n      errorMsgPopup(error.response?.data?.message || \"메뉴 권한 데이터를 가져오는 중 오류가 발생했습니다.\");\n      setData([]);\n      setInitialData([]);\n      setAuthFields([]);\n    }\n  };\n\n  const formatMenuName = (menuName, level) => {\n    if (level === 1) return menuName;\n    return `${\"  \".repeat(level - 2)}└${menuName}`;\n  };\n\n  const getAuthYn = (menu, authName) => {\n    const auth = menu.children.find(child => child.AUTHNM === authName);\n    return auth ? auth.AUTHYN : \"N\";\n  };\n\n  const updateAuthYn = (menu, authName, value) => {\n    return {\n      ...menu,\n      children: menu.children.map(child =>\n        child.AUTHNM === authName ? { ...child, AUTHYN: value } : child\n      )\n    };\n  };\n\n  const isCellChanged = (menuId, authName) => {\n    const row = data.find(r => r.MENUID === menuId);\n    const initialRow = initialData.find(r => r.MENUID === menuId);\n    if (!row || !initialRow) return false;\n    const currentAuth = row.children.find(c => c.AUTHNM === authName);\n    const initialAuth = initialRow.children.find(c => c.AUTHNM === authName);\n    return currentAuth && initialAuth && currentAuth.AUTHYN !== initialAuth.AUTHYN;\n  };\n\n  const isRowChanged = (menuId) => {\n    return authFields.some(authName => changedCells.has(`${menuId}-${authName}`));\n  };\n\n  const handleRadioChange = (menuId, authName, value) => {\n    setData(prevData =>\n      prevData.map(row =>\n        row.MENUID === menuId ? updateAuthYn(row, authName, value) : row\n      )\n    );\n\n    setChangedCells(prev => {\n      const newChangedCells = new Map(prev);\n      const key = `${menuId}-${authName}`;\n      \n      const updatedData = data.map(row =>\n        row.MENUID === menuId ? updateAuthYn(row, authName, value) : row\n      );\n      const row = updatedData.find(r => r.MENUID === menuId);\n      const initialRow = initialData.find(r => r.MENUID === menuId);\n      if (!row || !initialRow) return newChangedCells;\n\n      const currentAuth = row.children.find(c => c.AUTHNM === authName);\n      const initialAuth = initialRow.children.find(c => c.AUTHNM === authName);\n      const isChanged = currentAuth && initialAuth && currentAuth.AUTHYN !== initialAuth.AUTHYN;\n\n      if (isChanged) {\n        newChangedCells.set(key, true);\n      } else {\n        newChangedCells.delete(key);\n      }\n      \n      return newChangedCells;\n    });\n  };\n\n  const handleSelectAll = (authName, checked) => {\n    setData(prevData =>\n      prevData.map(row => updateAuthYn(row, authName, checked ? \"Y\" : \"N\"))\n    );\n\n    setChangedCells(prev => {\n      const newChangedCells = new Map(prev);\n      data.forEach(row => {\n        const key = `${row.MENUID}-${authName}`;\n        const initialRow = initialData.find(r => r.MENUID === row.MENUID);\n        if (!initialRow) return;\n        \n        const updatedRow = updateAuthYn(row, authName, checked ? \"Y\" : \"N\");\n        const currentAuth = updatedRow.children.find(c => c.AUTHNM === authName);\n        const initialAuth = initialRow.children.find(c => c.AUTHNM === authName);\n        const isChanged = currentAuth && initialAuth && currentAuth.AUTHYN !== initialAuth.AUTHYN;\n\n        if (isChanged) {\n          newChangedCells.set(key, true);\n        } else {\n          newChangedCells.delete(key);\n        }\n      });\n      return newChangedCells;\n    });\n  };\n\n  const handleReset = () => {\n    fetchMenuAuthData();\n    setChangedCells(new Map());\n  };\n\n  const handleCheckboxChange = (menuId) => {\n    setChangedCells(prev => {\n      const newChangedCells = new Map(prev);\n      const hasChanges = authFields.some(authName => \n        newChangedCells.has(`${menuId}-${authName}`)\n      );\n      \n      if (hasChanges) {\n        authFields.forEach(authName => {\n          const key = `${menuId}-${authName}`;\n          if (newChangedCells.has(key)) {\n            newChangedCells.delete(key);\n          } else if (isCellChanged(menuId, authName)) {\n            newChangedCells.set(key, true);\n          }\n        });\n      }\n      return newChangedCells;\n    });\n  };\n\n  const handleSave = async (e) => {\n    e.preventDefault();\n\n    const saveData = [];\n    const changedRows = new Set();\n\n    changedCells.forEach((_, key) => {\n      const [menuId, authName] = key.split('-');\n      if (isRowChanged(menuId)) {\n        changedRows.add(menuId);\n        const row = data.find(r => r.MENUID === menuId);\n        if (row) {\n          const auth = row.children.find(c => c.AUTHNM === authName);\n          if (auth) {\n            saveData.push({\n              pGUBUN: 'U',\n              pAUTHID: auth.AUTHID,\n              pMENUID: row.MENUID,\n              pUSEYN: auth.AUTHYN\n            });\n          }\n        }\n      }\n    });\n\n    if (saveData.length === 0) {\n      errorMsgPopup(\"변경된 데이터가 없습니다.\");\n      return;\n    }\n\n    setLoading(true);\n\n    try {\n      const promises = saveData.map(async (item) => {\n        const params = {\n          pGUBUN: item.pGUBUN,\n          pAUTHID: item.pAUTHID,\n          pMENUID: item.pMENUID,\n          pUSEYN: item.pUSEYN\n        };\n\n        try {\n          const response = await fetchData(\"oper/menuauthinfo/save\", params );\n\n          if (!response.success) {\n            throw new Error(response.message || `Failed to update menu auth ${item.pMENUID}-${item.pAUTHID}`);\n          }\n\n          return { ...item, success: true };\n        } catch (error) {\n          console.error(`Error processing update for MENUID: ${item.pMENUID}, AUTHID: ${item.pAUTHID}`, error);\n          return { ...item, success: false, error: error.message };\n        }\n      });\n\n      const results = await Promise.all(promises);\n\n      const errors = results.filter((result) => !result.success);\n      if (errors.length > 0) {\n        errorMsgPopup(`일부 작업이 실패했습니다: ${errors.map((e) => e.error).join(\", \")}`);\n      } else {\n        msgPopup(\"모든 변경사항이 성공적으로 저장되었습니다.\");\n        await fetchMenuAuthData();\n      }\n    } catch (err) {\n      console.error(\"Save operation failed:\", err);\n      errorMsgPopup(err.message || \"저장 중 오류가 발생했습니다.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className={`container mt-1 ${styles.container}`}>\n      <div className=\"btn-group-custom d-flex justify-content-end gap-2 mb-3\">\n        <button className={`btn text-bg-secondary ${styles.btnCancel}`} onClick={handleReset}>초기화</button>\n        <button className={`btn text-bg-success ${styles.btnReg}`} onClick={handleSave} disabled={loading}>\n          {loading ? \"저장 중...\" : \"저장\"}\n        </button>\n      </div>\n\n      <div className={`table-responsive ${styles.tableResponsive}`}>\n        <table className={`table table-bordered ${styles.table}`}>\n          <thead className={styles.stickyTop}>\n            <tr>\n              <th className={`${styles.textCenter} ${styles.stickyColumn}`}>목차관리</th>\n              <th className={`${styles.textCenter} ${styles.stickyColumn2}`}>작업대상</th>\n              {authFields.map((authName) => (\n                <th key={authName} className={styles.textCenter}>\n                  {authName}\n                  <div className=\"form-check d-flex justify-content-center mt-1\">\n                    <input\n                      type=\"checkbox\"\n                      className={styles.formCheckInput}\n                      onChange={(e) => handleSelectAll(authName, e.target.checked)}\n                      checked={Array.isArray(data) && data.length > 0 && data.every((row) => getAuthYn(row, authName) === \"Y\")}\n                      disabled={!Array.isArray(data) || data.length === 0}\n                    />\n                  </div>\n                </th>\n              ))}\n            </tr>\n          </thead>\n          <tbody>\n            {Array.isArray(data) && data.length > 0 ? (\n              data.map((row) => (\n                <tr key={row.MENUID}>\n                  <td className={`${styles.textLeft} ${styles.stickyColumn}`}>\n                    <span>{formatMenuName(row.MENUNM, row.MENULEVEL)}</span>\n                  </td>\n                  <td className={`${styles.textCenter} ${styles.stickyColumn2}`}>\n                    <input\n                      type=\"checkbox\"\n                      className={styles.formCheckInput}\n                      checked={isRowChanged(row.MENUID)}\n                      onChange={() => handleCheckboxChange(row.MENUID)}\n                    />\n                  </td>\n                  {authFields.map((authName) => (\n                    <td\n                      key={authName}\n                      className={`${styles.textCenter} ${changedCells.has(`${row.MENUID}-${authName}`) ? styles.changedCell : ''}`}\n                    >\n                      <div className=\"d-flex justify-content-center gap-2\">\n                        <div className={`form-check form-check-inline ${styles.formCheckInline}`}>\n                          <input\n                            type=\"radio\"\n                            className={styles.formCheckInput}\n                            name={`${authName}-${row.MENUID}`}\n                            value=\"Y\"\n                            checked={getAuthYn(row, authName) === \"Y\"}\n                            onChange={() => handleRadioChange(row.MENUID, authName, \"Y\")}\n                          />\n                          <label className=\"form-check-label\">Y</label>\n                        </div>\n                        <div className={`form-check form-check-inline ${styles.formCheckInline}`}>\n                          <input\n                            type=\"radio\"\n                            className={styles.formCheckInput}\n                            name={`${authName}-${row.MENUID}`}\n                            value=\"N\"\n                            checked={getAuthYn(row, authName) === \"N\"}\n                            onChange={() => handleRadioChange(row.MENUID, authName, \"N\")}\n                          />\n                          <label className=\"form-check-label\">N</label>\n                        </div>\n                      </div>\n                    </td>\n                  ))}\n                </tr>\n              ))\n            ) : (\n              <tr>\n                <td colSpan={authFields.length + 2} className={styles.textCenter}>\n                  데이터가 없습니다.\n                </td>\n              </tr>\n            )}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  );\n};\n\nexport default MenuAuthInfo;"],"names":["MenuAuthInfo","user","useStore","navigate","useNavigate","data","setData","useState","initialData","setInitialData","authFields","setAuthFields","changedCells","setChangedCells","loading","setLoading","useEffect","hasPermission","fetchMenuAuthData","calculateMenuLevel","row","visited","parent","item","params","response","fetchData","errorMsgPopup","responseData","authNames","child","leveledData","error","_b","_a","formatMenuName","menuName","level","getAuthYn","menu","authName","auth","updateAuthYn","value","isCellChanged","menuId","r","initialRow","currentAuth","initialAuth","isRowChanged","handleRadioChange","prevData","prev","newChangedCells","key","c","handleSelectAll","checked","handleReset","handleCheckboxChange","handleSave","saveData","changedRows","_","promises","errors","result","e","msgPopup","err","styles","jsxs","jsx"],"mappings":"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"}